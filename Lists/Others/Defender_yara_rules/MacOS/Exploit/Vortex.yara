rule Exploit_MacOS_Vortex_B_2147816729_0
{
    meta:
        author = "defender2yara"
        detection_name = "Exploit:MacOS/Vortex.B!MTB"
        threat_id = "2147816729"
        type = "Exploit"
        platform = "MacOS: "
        family = "Vortex"
        severity = "Critical"
        info = "MTB: Microsoft Threat Behavior"
        signature_type = "SIGNATURE_TYPE_MACHOHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "/Users/coolstar/Developer/Odyssey14/Taurine/exploit" ascii //weight: 1
        $x_1_2 = "/taurine/amfidebilitate.plist" ascii //weight: 1
        $x_1_3 = "/taurine/launchjailbreak" ascii //weight: 1
        $x_1_4 = "/.disable_tweakinject" ascii //weight: 1
        $x_1_5 = "/var/MobileSoftwareUpdate/rootfsmnt" ascii //weight: 1
        $x_1_6 = "/taurine/pspawn_payload.dylib" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (5 of ($x*))
}

rule Exploit_MacOS_Vortex_D_2147903260_0
{
    meta:
        author = "defender2yara"
        detection_name = "Exploit:MacOS/Vortex.D!MTB"
        threat_id = "2147903260"
        type = "Exploit"
        platform = "MacOS: "
        family = "Vortex"
        severity = "Critical"
        info = "MTB: Microsoft Threat Behavior"
        signature_type = "SIGNATURE_TYPE_MACHOHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "checkra1n" ascii //weight: 1
        $x_1_2 = "jailbreak-capability" ascii //weight: 1
        $x_1_3 = "usr/libexec/cydia/cydo" ascii //weight: 1
        $x_1_4 = "webra1n" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Exploit_MacOS_Vortex_F_2147906204_0
{
    meta:
        author = "defender2yara"
        detection_name = "Exploit:MacOS/Vortex.F!MTB"
        threat_id = "2147906204"
        type = "Exploit"
        platform = "MacOS: "
        family = "Vortex"
        severity = "Critical"
        info = "MTB: Microsoft Threat Behavior"
        signature_type = "SIGNATURE_TYPE_MACHOHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "Fugu15KernelExploit" ascii //weight: 2
        $x_1_2 = "runningUnderPiranha" ascii //weight: 1
        $x_1_3 = "JailbreakViewV4body" ascii //weight: 1
        $x_1_4 = "codelessKext.swift" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_2_*) and 2 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule Exploit_MacOS_Vortex_G_2147910255_0
{
    meta:
        author = "defender2yara"
        detection_name = "Exploit:MacOS/Vortex.G!MTB"
        threat_id = "2147910255"
        type = "Exploit"
        platform = "MacOS: "
        family = "Vortex"
        severity = "Critical"
        info = "MTB: Microsoft Threat Behavior"
        signature_type = "SIGNATURE_TYPE_MACHOHSTR_EXT"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "openpwnage" ascii //weight: 1
        $x_1_2 = "spray_ports" ascii //weight: 1
        $x_1_3 = "unsandboxing" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Exploit_MacOS_Vortex_H_2147913927_0
{
    meta:
        author = "defender2yara"
        detection_name = "Exploit:MacOS/Vortex.H!MTB"
        threat_id = "2147913927"
        type = "Exploit"
        platform = "MacOS: "
        family = "Vortex"
        severity = "Critical"
        info = "MTB: Microsoft Threat Behavior"
        signature_type = "SIGNATURE_TYPE_MACHOHSTR_EXT"
        threshold = "12"
        strings_accuracy = "High"
    strings:
        $x_5_1 = "checkra1n_flags" ascii //weight: 5
        $x_5_2 = "palera1n_flags" ascii //weight: 5
        $x_1_3 = "status_exploit_code_exec" ascii //weight: 1
        $x_1_4 = "cores/create_fakefs.sh" ascii //weight: 1
        $x_1_5 = "setup-fakefs" ascii //weight: 1
        $x_1_6 = "checkra1n-kpf-ploosh" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((2 of ($x_5_*) and 2 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule Exploit_MacOS_Vortex_I_2147923851_0
{
    meta:
        author = "defender2yara"
        detection_name = "Exploit:MacOS/Vortex.I!MTB"
        threat_id = "2147923851"
        type = "Exploit"
        platform = "MacOS: "
        family = "Vortex"
        severity = "Critical"
        info = "MTB: Microsoft Threat Behavior"
        signature_type = "SIGNATURE_TYPE_MACHOHSTR_EXT"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "running v0rtex" ascii //weight: 1
        $x_1_2 = "DoubleH3lix" ascii //weight: 1
        $x_1_3 = "totally-not.spyware.lol/bootstrap/" ascii //weight: 1
        $x_1_4 = "Kernel has been pwned >:D" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (3 of ($x*))
}

rule Exploit_MacOS_Vortex_J_2147933191_0
{
    meta:
        author = "defender2yara"
        detection_name = "Exploit:MacOS/Vortex.J!MTB"
        threat_id = "2147933191"
        type = "Exploit"
        platform = "MacOS: "
        family = "Vortex"
        severity = "Critical"
        info = "MTB: Microsoft Threat Behavior"
        signature_type = "SIGNATURE_TYPE_MACHOHSTR_EXT"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "pac_exploit_doIt_cont" ascii //weight: 1
        $x_1_2 = "Fugu15PACBypass" ascii //weight: 1
        $x_1_3 = "exploitPmap" ascii //weight: 1
        $x_1_4 = "PWNUserServer" ascii //weight: 1
        $x_1_5 = "pacBypass2Stashd" ascii //weight: 1
        $x_1_6 = "exploit_init_block_invoke" ascii //weight: 1
        $x_1_7 = "launchedByFugu15" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (3 of ($x*))
}

rule Exploit_MacOS_Vortex_K_2147937779_0
{
    meta:
        author = "defender2yara"
        detection_name = "Exploit:MacOS/Vortex.K!MTB"
        threat_id = "2147937779"
        type = "Exploit"
        platform = "MacOS: "
        family = "Vortex"
        severity = "Critical"
        info = "MTB: Microsoft Threat Behavior"
        signature_type = "SIGNATURE_TYPE_MACHOHSTR_EXT"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "reinstallCydia" ascii //weight: 1
        $x_1_2 = "findphys_real" ascii //weight: 1
        $x_1_3 = "leak_kernel_base" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Exploit_MacOS_Vortex_L_2147940722_0
{
    meta:
        author = "defender2yara"
        detection_name = "Exploit:MacOS/Vortex.L!MTB"
        threat_id = "2147940722"
        type = "Exploit"
        platform = "MacOS: "
        family = "Vortex"
        severity = "Critical"
        info = "MTB: Microsoft Threat Behavior"
        signature_type = "SIGNATURE_TYPE_MACHOHSTR_EXT"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "fake_port_buffer" ascii //weight: 1
        $x_1_2 = "leak20AndFree" ascii //weight: 1
        $x_1_3 = "tmp/.jailbroken" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Exploit_MacOS_Vortex_M_2147940723_0
{
    meta:
        author = "defender2yara"
        detection_name = "Exploit:MacOS/Vortex.M!MTB"
        threat_id = "2147940723"
        type = "Exploit"
        platform = "MacOS: "
        family = "Vortex"
        severity = "Critical"
        info = "MTB: Microsoft Threat Behavior"
        signature_type = "SIGNATURE_TYPE_MACHOHSTR_EXT"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "bearded_old_man_no_stash" ascii //weight: 1
        $x_1_2 = "IOSurface_spray_with_gc" ascii //weight: 1
        $x_1_3 = "extractPayloadFromIM4P" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Exploit_MacOS_Vortex_N_2147940724_0
{
    meta:
        author = "defender2yara"
        detection_name = "Exploit:MacOS/Vortex.N!MTB"
        threat_id = "2147940724"
        type = "Exploit"
        platform = "MacOS: "
        family = "Vortex"
        severity = "Critical"
        info = "MTB: Microsoft Threat Behavior"
        signature_type = "SIGNATURE_TYPE_MACHOHSTR_EXT"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "tappedOnJailbreak" ascii //weight: 1
        $x_1_2 = "pwn20wndstuff" ascii //weight: 1
        $x_1_3 = "DumpAPTicketSwitch" ascii //weight: 1
        $x_1_4 = "electra-prejailbreak" ascii //weight: 1
        $x_1_5 = "spawnAndShaiHulud" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (3 of ($x*))
}

rule Exploit_MacOS_Vortex_O_2147946392_0
{
    meta:
        author = "defender2yara"
        detection_name = "Exploit:MacOS/Vortex.O!MTB"
        threat_id = "2147946392"
        type = "Exploit"
        platform = "MacOS: "
        family = "Vortex"
        severity = "Critical"
        info = "MTB: Microsoft Threat Behavior"
        signature_type = "SIGNATURE_TYPE_MACHOHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "is checkra1n clone" ascii //weight: 2
        $x_2_2 = "is checkra1n" ascii //weight: 2
        $x_1_3 = "checkra1n.XXXXXX" ascii //weight: 1
        $x_1_4 = "override-libcheckra1nhelper" ascii //weight: 1
        $x_1_5 = "src/stage1/checkm8.c" ascii //weight: 1
        $x_1_6 = "YOLO:checkra1n" ascii //weight: 1
        $x_1_7 = "init_checkra1n" ascii //weight: 1
        $x_1_8 = "/home/runner/work/palera1n/palera1n" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((5 of ($x_1_*))) or
            ((1 of ($x_2_*) and 3 of ($x_1_*))) or
            ((2 of ($x_2_*) and 1 of ($x_1_*))) or
            (all of ($x*))
        )
}

