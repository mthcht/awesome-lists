rule _PseudoThreat_c0000807_0
{
    meta:
        author = "defender2yara"
        detection_name = "!PseudoThreat_c0000807"
        threat_id = "3221227527"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {c1 ea 05 89 4c 24 ?? 89 54 24 ?? 8b 84 24 ?? ?? ?? ?? 01 44 24 ?? 8d 04 33 31 44 24 ?? 81 3d ?? ?? ?? ?? f5 03 00 00 c7 05 ?? ?? ?? ?? 36 06 ea e9 75}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule _PseudoThreat_c0000818_0
{
    meta:
        author = "defender2yara"
        detection_name = "!PseudoThreat_c0000818"
        threat_id = "3221227544"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {c1 e9 05 89 44 24 ?? 89 4c 24 ?? 8b 84 24 ?? ?? ?? ?? 01 44 24 ?? 8d 14 2e 31 54 24 ?? 81 3d ?? ?? ?? ?? f5 03 00 00 c7 05 ?? ?? ?? ?? 36 06 ea e9 75}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule _PseudoThreat_c0000822_0
{
    meta:
        author = "defender2yara"
        detection_name = "!PseudoThreat_c0000822"
        threat_id = "3221227554"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_ARHSTR_EXT"
        threshold = "1"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {55 8b ec 83 ec ?? 53 (33 c9 56 57|56 57) [0-32] 99 f7 7d 0c 8b ?? ?? (89|8b) ?? ?? (89|8b) [0-10] 88 45 ff 60 33 c0 8a 45 ff 33 c9 8b 4d f4 d2 c8 88 45 ff 61 8b}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule _PseudoThreat_c0000823_0
{
    meta:
        author = "defender2yara"
        detection_name = "!PseudoThreat_c0000823"
        threat_id = "3221227555"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_ARHSTR_EXT"
        threshold = "1"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {55 8b ec b8 ?? ?? ?? ?? e8 ?? ?? ?? ?? 53 56 57 60 32 db 74 03 83 c4 50 61 60 e8 00 00 00 00 d1 c0 80 04 24 07 c3}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule _PseudoThreat_c0000824_0
{
    meta:
        author = "defender2yara"
        detection_name = "!PseudoThreat_c0000824"
        threat_id = "3221227556"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_ARHSTR_EXT"
        threshold = "3"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {6a 04 68 00 10 00 00 68 b0 36 00 00 6a 00 ff 15}  //weight: 1, accuracy: High
        $x_1_2 = {6a 04 68 00 10 00 00 68 9a 42 0f 00 6a 00 [0-3] ff 15}  //weight: 1, accuracy: Low
        $x_1_3 = {6a 04 68 00 10 00 00 68 10 27 00 00 6a 00 [0-3] ff 15}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule _PseudoThreat_c0000825_0
{
    meta:
        author = "defender2yara"
        detection_name = "!PseudoThreat_c0000825"
        threat_id = "3221227557"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_ARHSTR_EXT"
        threshold = "2"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {55 8b ec 83 ec [0-4] 53 56 57 60 83 ec 04 b0 01 fe c0 75 06 81 c4}  //weight: 1, accuracy: Low
        $x_1_2 = {90 00 00 00 83 c4 04 61 60 53 66 bb 30 db 75 fc 5b 61}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule _PseudoThreat_c000085e_0
{
    meta:
        author = "defender2yara"
        detection_name = "!PseudoThreat_c000085e"
        threat_id = "3221227614"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "11"
        strings_accuracy = "Low"
    strings:
        $x_4_1 = {56 57 be d8 07 01 00 8b fe b9 f0 00 00 00}  //weight: 4, accuracy: High
        $x_3_2 = {8b 45 0c c7 40 18 00 00 00 00 [0-1] 83 60 1c 00 6a 00 ff 75 0c}  //weight: 3, accuracy: Low
        $x_3_3 = {02 01 00 64 ff 35 00 00 00 00 89 25 ?? ?? 01 00 64 89 25 00 00 00 00 8d 0d ?? ?? 01 00 ba 40 02 00 00 e8}  //weight: 3, accuracy: Low
        $x_2_4 = {c7 00 18 00 00 00 89 48 08 89 50 0c}  //weight: 2, accuracy: High
        $x_3_5 = {01 00 c7 00 18 00 00 00 c7 40 04 00 00 00 00 89 48 08 89 50 0c c7}  //weight: 3, accuracy: High
        $x_2_6 = {01 00 8b 73 0c 8d b8 ?? ?? 01 00 b9 10 00 00 00 f3 a4 68}  //weight: 2, accuracy: Low
        $x_2_7 = {01 00 8b 33 8d b8 ?? ?? 01 00 b9 1a 00 00 00 f3 a4 68}  //weight: 2, accuracy: Low
        $x_2_8 = {8d 05 c8 07 01 00 8b f0 8b fe b9 f5 00 00 00}  //weight: 2, accuracy: High
        $x_2_9 = {8b 44 24 12 80 3d ?? ?? 01 00 03 75 18 c7 05 ?? ?? 01 00 2d 00 00 00 50 ff 35}  //weight: 2, accuracy: Low
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_3_*) and 4 of ($x_2_*))) or
            ((2 of ($x_3_*) and 3 of ($x_2_*))) or
            ((3 of ($x_3_*) and 1 of ($x_2_*))) or
            ((1 of ($x_4_*) and 4 of ($x_2_*))) or
            ((1 of ($x_4_*) and 1 of ($x_3_*) and 2 of ($x_2_*))) or
            ((1 of ($x_4_*) and 2 of ($x_3_*) and 1 of ($x_2_*))) or
            ((1 of ($x_4_*) and 3 of ($x_3_*))) or
            (all of ($x*))
        )
}

rule _PseudoThreat_c000085f_0
{
    meta:
        author = "defender2yara"
        detection_name = "!PseudoThreat_c000085f"
        threat_id = "3221227615"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "20"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "\\\\.\\mailslot\\loper-la100s" ascii //weight: 2
        $x_2_2 = "\\\\.\\mailslot\\loper-la100s5B9C0FB4" ascii //weight: 2
        $x_2_3 = "\\\\.\\mailslot\\loper-lac" ascii //weight: 2
        $x_2_4 = "\\\\.\\mailslot\\loper-lab" ascii //weight: 2
        $x_2_5 = "\\\\.\\mailslot\\loper-las" ascii //weight: 2
        $x_2_6 = "\\\\.\\loperDriver" ascii //weight: 2
        $x_2_7 = "Prefetch\\*.pf" ascii //weight: 2
        $x_2_8 = " -:bd:- " ascii //weight: 2
        $x_2_9 = "u#ht,I" ascii //weight: 2
        $x_2_10 = "LOPERER" ascii //weight: 2
        $x_2_11 = "-:LOPIN" ascii //weight: 2
        $x_2_12 = "-:LOPFRESH" ascii //weight: 2
        $x_2_13 = "-:LOPNO" ascii //weight: 2
        $x_2_14 = "-:LOPUN" ascii //weight: 2
        $x_2_15 = "-:BD:-" ascii //weight: 2
        $x_2_16 = "^^[_]" ascii //weight: 2
        $x_2_17 = " -+bd:- " ascii //weight: 2
        $x_2_18 = "-+INSTALLONLY" ascii //weight: 2
        $x_2_19 = "-+REFRESH" ascii //weight: 2
        $x_2_20 = "-+NOSERVICE" ascii //weight: 2
        $x_2_21 = "-+UNINSTALL" ascii //weight: 2
        $x_2_22 = "-+BD:-" ascii //weight: 2
        $x_2_23 = "[HIDDEN TABLE]" ascii //weight: 2
        $x_2_24 = "[HIDDEN PROCESSES]" ascii //weight: 2
        $x_2_25 = "[ROOT PROCESSES]" ascii //weight: 2
        $x_2_26 = "[HIDDEN SERVICES]" ascii //weight: 2
        $x_2_27 = "[HIDDEN REGKEYS]" ascii //weight: 2
        $x_2_28 = "[HIDDEN REGVALUES]" ascii //weight: 2
        $x_2_29 = "[HIDDEN PORTS]" ascii //weight: 2
        $x_1_30 = "PASSWORD" ascii //weight: 1
        $x_1_31 = "BACKDOORSHELL" ascii //weight: 1
        $x_1_32 = "SERVICENAME" ascii //weight: 1
        $x_1_33 = "SERVICEDISPLAYNAME" ascii //weight: 1
        $x_1_34 = "SERVICEDESCRIPTION" ascii //weight: 1
        $x_1_35 = "DRIVERNAME" ascii //weight: 1
        $x_1_36 = "DRIVERFILENAME" ascii //weight: 1
        $x_1_37 = "FILEMAPPINGNAME" ascii //weight: 1
        $x_5_38 = "_.-=[Hacker Defender]=-._" ascii //weight: 5
        $x_1_39 = "lopersbloperslop" ascii //weight: 1
        $x_2_40 = "\\\\.\\mailslot\\DirectXDriverc" ascii //weight: 2
        $x_2_41 = "\\\\.\\mailslot\\DirectXDriverb" ascii //weight: 2
        $x_2_42 = "\\\\.\\mailslot\\DirectXDriver100s" ascii //weight: 2
        $x_2_43 = "\\\\.\\mailslot\\DirectXDriver100s5B9C0FB" ascii //weight: 2
        $x_30_44 = {d1 e6 56 6a 00 e8 83 a7 ff ff 85 c0 74 35 89 45 fc 6a 00 56 50 50 55 b8 05 00 00 00 89 c5 58 89 c5 58 ff 75 08 ff 15 c0 dc 48 00 a9 00 00 00 c0 74 16 3d 04 00 00 c0 75 0a ff 75 fc e8 54 a7 ff ff eb bd 6a 00 8f 45 fc 8b 45 fc 5e}  //weight: 30, accuracy: High
        $x_1_45 = "OpenSCManagerA" ascii //weight: 1
        $x_1_46 = "NtLoadDriver" ascii //weight: 1
        $x_1_47 = "NtQuerySystemInformation" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((4 of ($x_2_*) and 12 of ($x_1_*))) or
            ((5 of ($x_2_*) and 10 of ($x_1_*))) or
            ((6 of ($x_2_*) and 8 of ($x_1_*))) or
            ((7 of ($x_2_*) and 6 of ($x_1_*))) or
            ((8 of ($x_2_*) and 4 of ($x_1_*))) or
            ((9 of ($x_2_*) and 2 of ($x_1_*))) or
            ((10 of ($x_2_*))) or
            ((1 of ($x_5_*) and 2 of ($x_2_*) and 11 of ($x_1_*))) or
            ((1 of ($x_5_*) and 3 of ($x_2_*) and 9 of ($x_1_*))) or
            ((1 of ($x_5_*) and 4 of ($x_2_*) and 7 of ($x_1_*))) or
            ((1 of ($x_5_*) and 5 of ($x_2_*) and 5 of ($x_1_*))) or
            ((1 of ($x_5_*) and 6 of ($x_2_*) and 3 of ($x_1_*))) or
            ((1 of ($x_5_*) and 7 of ($x_2_*) and 1 of ($x_1_*))) or
            ((1 of ($x_5_*) and 8 of ($x_2_*))) or
            ((1 of ($x_30_*))) or
            (all of ($x*))
        )
}

rule _PseudoThreat_c00008b0_0
{
    meta:
        author = "defender2yara"
        detection_name = "!PseudoThreat_c00008b0"
        threat_id = "3221227696"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "402"
        strings_accuracy = "Low"
    strings:
        $x_100_1 = "SOFTWARE\\Borland\\Delphi\\RTL" ascii //weight: 100
        $x_100_2 = {6d 70 5f 66 69 6c 65 64 6f 77 6e [0-4] 2e 70 68 70 3f 73 6e 3d}  //weight: 100, accuracy: Low
        $x_100_3 = {6d 70 5f 63 6e 74 73 [0-4] 2e 70 68 70 3f 73 6e 3d}  //weight: 100, accuracy: Low
        $x_100_4 = {63 3a 5c 6d 70 72 [0-5] 2e 69 6e 69}  //weight: 100, accuracy: Low
        $x_1_5 = "Software\\Microsoft\\Windows\\CurrentVersion\\Run" ascii //weight: 1
        $x_1_6 = "IEFrame" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule _PseudoThreat_c00008b1_0
{
    meta:
        author = "defender2yara"
        detection_name = "!PseudoThreat_c00008b1"
        threat_id = "3221227697"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "9"
        strings_accuracy = "High"
    strings:
        $x_3_1 = "CRYPTKEY" ascii //weight: 3
        $x_3_2 = "CRYPTEND" ascii //weight: 3
        $x_3_3 = {00 5c 00 64 00 65 00 76 00 69 00 63 00 65 00 5c 00 70 00 68 00 79 00 73 00 69 00 63 00 61 00 6c 00 6d 00 65 00 6d 00 6f 00 72 00 79}  //weight: 3, accuracy: High
        $x_3_4 = {55 89 e5 83 ec 24 89 7c 24 08 89 74 24 04 89 1c 24 83 ec 10 8b 45 14 8b 7d 10 8b 5d 0c 89 44 24 0c}  //weight: 3, accuracy: High
        $x_3_5 = {46 69 6e 64 4e 65 78 74 46 69 6c 65 41 00 55 89 e5 83 ec 18 89 7c 24 08 89 74 24 04 89 1c 24 ff 75 0c ff 75 08}  //weight: 3, accuracy: High
        $x_3_6 = {46 69 6e 64 4e 65 78 74 46 69 6c 65 57 00 55 89 e5 83 ec 18 89 7c 24 08 89 74 24 04 89 1c 24 ff 75 0c ff 75 08}  //weight: 3, accuracy: High
    condition:
        (filesize < 20MB) and
        (3 of ($x*))
}

rule _PseudoThreat_c00008b3_0
{
    meta:
        author = "defender2yara"
        detection_name = "!PseudoThreat_c00008b3"
        threat_id = "3221227699"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "25"
        strings_accuracy = "Low"
    strings:
        $x_2_1 = "Software\\Microsoft\\Windows\\CurrentVersion\\ShellServiceObjectDelayLoad" ascii //weight: 2
        $x_2_2 = "Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\SharedTaskScheduler" ascii //weight: 2
        $x_5_3 = "Software\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\System Alert Popup" ascii //weight: 5
        $x_2_4 = "Software\\Microsoft\\Windows\\CurrentVersion\\Uninstall" ascii //weight: 2
        $x_2_5 = "Software\\MicrosoftWindowsXp2003" ascii //weight: 2
        $x_5_6 = {43 3a 5c 57 49 4e 44 4f 57 53 5c 53 59 53 54 45 4d 33 32 5c [0-8] 2e 64 6c 6c 2c 77 69 6e 64 6f 77 73}  //weight: 5, accuracy: Low
        $x_2_7 = "%s /del2" ascii //weight: 2
        $x_2_8 = "SYSRES" ascii //weight: 2
        $x_5_9 = "Each process has an environment block associated with it. The environment block consists of a null-terminated block of null-terminated strings (meaning there are two null bytes at the end of the block), where each string is in the form:" ascii //weight: 5
        $x_5_10 = "windows xp amigo yo man friends hello go-go" ascii //weight: 5
        $x_2_11 = "Error Load hDelete" ascii //weight: 2
        $x_2_12 = "%s\\higehsg.dll" ascii //weight: 2
        $x_2_13 = "c:\\windows\\sysmsg.dll" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (
            ((2 of ($x_5_*) and 8 of ($x_2_*))) or
            ((3 of ($x_5_*) and 5 of ($x_2_*))) or
            ((4 of ($x_5_*) and 3 of ($x_2_*))) or
            (all of ($x*))
        )
}

rule _PseudoThreat_c00008b4_0
{
    meta:
        author = "defender2yara"
        detection_name = "!PseudoThreat_c00008b4"
        threat_id = "3221227700"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = " is infected" ascii //weight: 1
        $x_1_2 = {55 8b ec 81 c4 18 fe ff ff [0-3] e8 ?? ?? ?? ?? 83 f8 00 0f 85 ?? 00 00 00}  //weight: 1, accuracy: Low
        $x_1_3 = {30 fe ff ff 00 8d 85 18 fe ff ff 50 6a 01 e8 ?? ?? ?? ?? [0-4] 0b c0 75 00}  //weight: 1, accuracy: Low
        $x_1_4 = {6a 06 6a 00 6a 00 6a 00 6a 00 6a ff ff 75 08 e8}  //weight: 1, accuracy: High
        $x_1_5 = {75 1e 6a 64 ff 35 ?? ?? ?? ?? e8 ?? ?? ?? ?? a3 ?? ?? ?? ?? c7 05 ?? ?? ?? ?? 01 00 00 00 eb 1c 6a 66 ff 35 ?? ?? ?? ?? e8 ?? ?? ?? ?? a3 ?? ?? ?? ?? c7 05 ?? ?? ?? ?? 00 00 00 00 68 ?? ?? ?? ?? 6a 01 e8 ?? ?? ?? ?? c9 c2 10 00}  //weight: 1, accuracy: Low
        $x_1_6 = {68 e0 93 04 00 68 ?? ?? ?? ?? ff 75 08 e8 ?? ?? ?? ?? e9 ?? 00 00 00 81 7d 14 03 02 00 00 74 ?? 81 7d 14 04 02 00 00 74 ?? 81 7d 14 01 02 00 00 74 ?? 81 7d 14 05 04 00 00}  //weight: 1, accuracy: Low
        $x_1_7 = {55 8b ec 81 c4 00 fe ff ff 51 56 57 68 ff 00 00 00 8d ?? 01 ff ff ff ?? e8 ?? ?? ?? ?? 8d 85 02 fe ff ff 50 6a 00 68 ?? ?? ?? ?? 8d 85 01 ff ff ff 50 e8 ?? ?? ?? ?? 8d 85 02 fe ff ff 50 e8 ?? ?? ?? ?? 8d 85 02 fe ff ff 50 ff 15 ?? ?? ?? ?? 83 c4 04 b9 03 00 00 00 2b c1 8d bd 02 fe ff ff}  //weight: 1, accuracy: Low
        $x_1_8 = {8d 85 02 fe ff ff 50 ff 75 08 e8 ?? ?? ?? ?? 83 f8 01 75 30}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (5 of ($x*))
}

rule _PseudoThreat_c00008b5_0
{
    meta:
        author = "defender2yara"
        detection_name = "!PseudoThreat_c00008b5"
        threat_id = "3221227701"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "12"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = "SpywareLocked" ascii //weight: 1
        $x_2_2 = "spylocked.com/?aff=" ascii //weight: 2
        $x_3_3 = "keratomir2.biz/get.php?partner=" ascii //weight: 3
        $x_3_4 = "keratomir.biz/get.php?partner=" ascii //weight: 3
        $x_1_5 = "pornmag.com/install/" ascii //weight: 1
        $x_2_6 = "Your system is infected" ascii //weight: 2
        $x_1_7 = "Are you fucking crazy man?" ascii //weight: 1
        $x_1_8 = "All porn links what are worth your visit." ascii //weight: 1
        $x_5_9 = {68 74 74 70 3a 2f 2f 6b 65 72 61 74 6f 6d 69 72 [0-2] 2e 62 69 7a 2f 67 65 74 2e 70 68 70 3f 70 61 72 74 6e 65 72 3d [0-4] 53 70 79 77 61 72 65 4c 6f 63 6b 65 64}  //weight: 5, accuracy: Low
        $x_5_10 = {68 74 74 70 3a 2f 2f 6b 65 72 61 74 6f 6d 69 72 [0-2] 2e 62 69 7a 2f 67 65 74 2e 70 68 70 3f 70 61 72 74 6e 65 72 3d [0-4] 53 70 79 6c 6f 63 6b 65 64}  //weight: 5, accuracy: Low
        $x_5_11 = {68 74 74 70 3a 2f 2f 6b 65 72 61 74 6f 6d 69 72 [0-2] 2e 62 69 7a 2f 67 65 74 2e 70 68 70 3f 70 61 72 74 6e 65 72 3d [0-4] 6b 48 41 74 77 5b 53 5d}  //weight: 5, accuracy: Low
        $x_5_12 = {50 4c 4c 48 02 17 17 53 5d 4a 59 4c 57 55 51 4a}  //weight: 5, accuracy: High
        $x_5_13 = {81 7d 14 03 02 00 00 74 20 81 7d 14 04 02 00 00 74 17 81 7d 14 01 02 00 00 74 0e 81 7d 14 05 04 00 00 74 05 e9 8e 00 00 00 e8 [0-5] 83 f8 01 75 07 e8 [0-5] eb 2d 80 3d}  //weight: 5, accuracy: Low
        $x_5_14 = {81 7d 14 03 02 00 00 74 1d 81 7d 14 04 02 00 00 74 14 81 7d 14 01 02 00 00 74 0b 81 7d 14 05 04 00 00 74 02 eb 6b e8 [0-5] 83 f8 01 75 07 e8}  //weight: 5, accuracy: Low
        $x_4_15 = {8b ec 83 c4 f8 6a 01 6a 00 ff 75 08 8d 05 [0-4] 50 8d 05 [0-4] 50 6a 00 ff 15 [0-4] b8 01 00 00 00 c9}  //weight: 4, accuracy: Low
    condition:
        (filesize < 20MB) and
        (
            ((2 of ($x_3_*) and 1 of ($x_2_*) and 4 of ($x_1_*))) or
            ((2 of ($x_3_*) and 2 of ($x_2_*) and 2 of ($x_1_*))) or
            ((1 of ($x_4_*) and 2 of ($x_2_*) and 4 of ($x_1_*))) or
            ((1 of ($x_4_*) and 1 of ($x_3_*) and 1 of ($x_2_*) and 3 of ($x_1_*))) or
            ((1 of ($x_4_*) and 1 of ($x_3_*) and 2 of ($x_2_*) and 1 of ($x_1_*))) or
            ((1 of ($x_4_*) and 2 of ($x_3_*) and 2 of ($x_1_*))) or
            ((1 of ($x_4_*) and 2 of ($x_3_*) and 1 of ($x_2_*))) or
            ((1 of ($x_5_*) and 2 of ($x_2_*) and 3 of ($x_1_*))) or
            ((1 of ($x_5_*) and 1 of ($x_3_*) and 4 of ($x_1_*))) or
            ((1 of ($x_5_*) and 1 of ($x_3_*) and 1 of ($x_2_*) and 2 of ($x_1_*))) or
            ((1 of ($x_5_*) and 1 of ($x_3_*) and 2 of ($x_2_*))) or
            ((1 of ($x_5_*) and 2 of ($x_3_*) and 1 of ($x_1_*))) or
            ((1 of ($x_5_*) and 2 of ($x_3_*) and 1 of ($x_2_*))) or
            ((1 of ($x_5_*) and 1 of ($x_4_*) and 3 of ($x_1_*))) or
            ((1 of ($x_5_*) and 1 of ($x_4_*) and 1 of ($x_2_*) and 1 of ($x_1_*))) or
            ((1 of ($x_5_*) and 1 of ($x_4_*) and 2 of ($x_2_*))) or
            ((1 of ($x_5_*) and 1 of ($x_4_*) and 1 of ($x_3_*))) or
            ((2 of ($x_5_*) and 2 of ($x_1_*))) or
            ((2 of ($x_5_*) and 1 of ($x_2_*))) or
            ((2 of ($x_5_*) and 1 of ($x_3_*))) or
            ((2 of ($x_5_*) and 1 of ($x_4_*))) or
            ((3 of ($x_5_*))) or
            (all of ($x*))
        )
}

rule _PseudoThreat_c00008b7_0
{
    meta:
        author = "defender2yara"
        detection_name = "!PseudoThreat_c00008b7"
        threat_id = "3221227703"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "68"
        strings_accuracy = "High"
    strings:
        $x_10_1 = "{ABCDECF0-4B15-11D1-ABED-709549C10000}" ascii //weight: 10
        $x_10_2 = "{393921-e939391-3919139-3d3a738-11}" ascii //weight: 10
        $x_10_3 = "SYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\StandardProfile\\AuthorizedApplications\\List" ascii //weight: 10
        $x_10_4 = "DisableRegistryTools" ascii //weight: 10
        $x_10_5 = "EnableBalloonTips" ascii //weight: 10
        $x_5_6 = "\\drivers\\etc\\hosts" ascii //weight: 5
        $x_3_7 = "windowsupdate.microsoft.com" ascii //weight: 3
        $x_3_8 = "kaspersky.com" ascii //weight: 3
        $x_3_9 = "mcafee.com" ascii //weight: 3
        $x_3_10 = "symantec.com" ascii //weight: 3
        $x_1_11 = "192.168.200.3" ascii //weight: 1
        $x_1_12 = "Warning! Potential Spyware Operation!" ascii //weight: 1
        $x_1_13 = "Your computer is making unauthorized copies of your system and" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((5 of ($x_10_*) and 1 of ($x_5_*) and 4 of ($x_3_*) and 1 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule _PseudoThreat_c00008b8_0
{
    meta:
        author = "defender2yara"
        detection_name = "!PseudoThreat_c00008b8"
        threat_id = "3221227704"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "215"
        strings_accuracy = "High"
    strings:
        $x_100_1 = "download.php?&advid=" ascii //weight: 100
        $x_50_2 = "C:\\Windows\\xpupdate.exe" ascii //weight: 50
        $x_10_3 = "ForceActiveDesktopOn" ascii //weight: 10
        $x_10_4 = "SOFTWARE\\Microsoft\\Internet Explorer\\Desktop\\General" ascii //weight: 10
        $x_10_5 = "WallpaperFileTime" ascii //weight: 10
        $x_10_6 = "Windows update loader" ascii //weight: 10
        $x_10_7 = "SOFTWARE\\Install" ascii //weight: 10
        $x_5_8 = "ProxyServer" ascii //weight: 5
        $x_5_9 = "ProxyEnable" ascii //weight: 5
        $x_5_10 = "Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings" ascii //weight: 5
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule _PseudoThreat_c00008b9_0
{
    meta:
        author = "defender2yara"
        detection_name = "!PseudoThreat_c00008b9"
        threat_id = "3221227705"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "6"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = "Host: download.%s.com" ascii //weight: 1
        $x_1_2 = "C:\\Windows\\xpupdate.exe" ascii //weight: 1
        $x_1_3 = "Windows update loader" ascii //weight: 1
        $x_1_4 = "C:\\Install" ascii //weight: 1
        $x_1_5 = "SOFTWARE\\Microsoft\\Internet Explorer\\Desktop\\General" ascii //weight: 1
        $x_1_6 = {47 45 54 20 2f [0-8] 2e 70 68 70 3f 26 61 64 76 69 64 3d}  //weight: 1, accuracy: Low
        $x_1_7 = {47 45 54 20 68 74 74 70 3a 2f 2f 64 6f 77 6e 6c 6f 61 64 2e 25 73 2e 63 6f 6d 2f [0-8] 2e 70 68 70 3f 26 61 64 76 69 64 3d}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (6 of ($x*))
}

rule _PseudoThreat_c00008ba_0
{
    meta:
        author = "defender2yara"
        detection_name = "!PseudoThreat_c00008ba"
        threat_id = "3221227706"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "31"
        strings_accuracy = "Low"
    strings:
        $x_10_1 = "Windows\\xpupdate.exe" ascii //weight: 10
        $x_10_2 = {4e 6f 43 68 61 6e 67 69 6e 67 57 61 6c 6c 70 61 70 65 72 [0-16] 53 4f 46 54 57 41 52 45 5c 4d 69 63 72 6f 73 6f 66 74 5c 57 69 6e 64 6f 77 73 5c 43 75 72 72 65 6e 74 56 65 72 73 69 6f 6e 5c 50 6f 6c 69 63 69 65 73 5c 41 63 74 69 76 65 44 65 73 6b 74 6f 70}  //weight: 10, accuracy: Low
        $x_10_3 = {46 6f 72 63 65 41 63 74 69 76 65 44 65 73 6b 74 6f 70 4f 6e [0-16] 53 4f 46 54 57 41 52 45 5c 4d 69 63 72 6f 73 6f 66 74 5c 57 69 6e 64 6f 77 73 5c 43 75 72 72 65 6e 74 56 65 72 73 69 6f 6e 5c 50 6f 6c 69 63 69 65 73 5c 45 78 70 6c 6f 72 65 72}  //weight: 10, accuracy: Low
        $x_1_4 = "69.50.1" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule _PseudoThreat_c00008bb_0
{
    meta:
        author = "defender2yara"
        detection_name = "!PseudoThreat_c00008bb"
        threat_id = "3221227707"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "8"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "IEHlprObj.IEHlprObj.1 = s 'IEHlprObj Class'" ascii //weight: 1
        $x_1_2 = "CLSID = s '{ABCDECF0-4B15-11D1-ABED-709549C10000}'" ascii //weight: 1
        $x_1_3 = "IEHlprObj.IEHlprObj = s 'IEHlprObj Class'" ascii //weight: 1
        $x_1_4 = "CurVer = s 'IEHlprObj.IEHlprObj.1'" ascii //weight: 1
        $x_1_5 = "ForceRemove {ABCDECF0-4B15-11D1-ABED-709549C10000} = s 'IEHlprObj Class'" ascii //weight: 1
        $x_1_6 = "ProgID = s 'IEHlprObj.IEHlprObj.1'" ascii //weight: 1
        $x_1_7 = "VersionIndependentProgID = s 'IEHlprObj.IEHlprObj'" ascii //weight: 1
        $x_1_8 = {49 00 6e 00 74 00 65 00 72 00 6e 00 61 00 6c 00 4e 00 61 00 6d 00 65 00 00 00 49 00 45 00 48 00 45 00 4c 00 50 00 45 00 52 00 00 00 00 00 42 00 0f 00 01 00 4c 00 65 00 67 00 61 00 6c 00 43 00 6f 00 70 00 79 00 72 00 69 00 67 00 68 00 74 00 00 00 43 00 6f 00 70 00 79 00 72 00 69 00 67 00 68 00 74 00 20 00 31 00 39 00 39 00 37 00 00 00 00 00 42 00 0d 00 01 00 4f 00 72 00 69 00 67 00 69 00 6e 00 61 00 6c 00 46 00 69 00 6c 00 65 00 6e 00 61 00 6d 00 65 00 00 00 49 00 45 00 48 00 45 00 4c 00 50 00 45 00 52 00 2e 00 44 00 4c 00 4c 00 00 00 00 00 40 00 10 00 01 00 50 00 72 00 6f 00 64 00 75 00 63 00 74 00 4e 00 61 00 6d 00 65 00 00 00 00 00 49 00 45 00 48 00 65 00 6c 00 70 00 65 00 72 00 20 00 4d 00 6f 00 64 00 75 00 6c 00 65}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule _PseudoThreat_c00008bc_0
{
    meta:
        author = "defender2yara"
        detection_name = "!PseudoThreat_c00008bc"
        threat_id = "3221227708"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "41"
        strings_accuracy = "Low"
    strings:
        $x_10_1 = {47 45 54 20 2f [0-8] 2e 70 68 70 3f 26 61 64 76 69 64 3d}  //weight: 10, accuracy: Low
        $x_10_2 = "Windows update loader" ascii //weight: 10
        $x_10_3 = {4e 6f 43 68 61 6e 67 69 6e 67 57 61 6c 6c 70 61 70 65 72 [0-16] 53 4f 46 54 57 41 52 45 5c 4d 69 63 72 6f 73 6f 66 74 5c 57 69 6e 64 6f 77 73 5c 43 75 72 72 65 6e 74 56 65 72 73 69 6f 6e 5c 50 6f 6c 69 63 69 65 73 5c 41 63 74 69 76 65 44 65 73 6b 74 6f 70}  //weight: 10, accuracy: Low
        $x_10_4 = {46 6f 72 63 65 41 63 74 69 76 65 44 65 73 6b 74 6f 70 4f 6e [0-16] 53 4f 46 54 57 41 52 45 5c 4d 69 63 72 6f 73 6f 66 74 5c 57 69 6e 64 6f 77 73 5c 43 75 72 72 65 6e 74 56 65 72 73 69 6f 6e 5c 50 6f 6c 69 63 69 65 73 5c 45 78 70 6c 6f 72 65 72}  //weight: 10, accuracy: Low
        $x_1_5 = "69.50.1" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule _PseudoThreat_c00008bd_0
{
    meta:
        author = "defender2yara"
        detection_name = "!PseudoThreat_c00008bd"
        threat_id = "3221227709"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "6"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {4e 6f 52 65 6d 6f 76 65 20 41 70 70 49 44 ?? ?? ?? ?? ?? ?? ?? ?? 27 25 41 50 50 49 44 25 27 20 3d 20 73 20 27 53 70 79 53 68 72 65 64 64 65 72 27 ?? ?? ?? ?? 27 77 65 62 69 6e 73 74 2e 64 6c 6c 27}  //weight: 1, accuracy: Low
        $x_1_2 = {53 70 79 53 68 72 65 64 64 65 72 2e 57 65 62 49 6e 73 74 61 6c 6c 2e 31 20 3d 20 73 20 27 57 65 62 49 6e 73 74 61 6c 6c 20 43 6c 61 73 73 27 ?? ?? ?? ?? ?? ?? ?? ?? 43 4c 53 49 44 20 3d 20 73 20 27 7b 33 34 33 43 45 32 31 34 2d 39 39 39 38 2d 34 42 32 31 2d 41 31 35 31 2d 46 46 45 39 37 30 31 36 37 32 39 37 7d 27}  //weight: 1, accuracy: Low
        $x_1_3 = {53 70 79 53 68 72 65 64 64 65 72 2e 57 65 62 49 6e 73 74 61 6c 6c 20 3d 20 73 20 27 57 65 62 49 6e 73 74 61 6c 6c 20 43 6c 61 73 73 27 ?? ?? ?? ?? ?? ?? ?? ?? 43 4c 53 49 44 20 3d 20 73 20 27 7b 33 34 33 43 45 32 31 34 2d 39 39 39 38 2d 34 42 32 31 2d 41 31 35 31 2d 46 46 45 39 37 30 31 36 37 32 39 37 7d 27}  //weight: 1, accuracy: Low
        $x_1_4 = {43 75 72 56 65 72 20 3d 20 73 20 27 53 70 79 53 68 72 65 64 64 65 72 2e 57 65 62 49 6e 73 74 61 6c 6c 2e 31 27 ?? ?? ?? ?? ?? ?? ?? 4e 6f 52 65 6d 6f 76 65 20 43 4c 53 49 44 ?? ?? ?? ?? ?? ?? ?? ?? 46 6f 72 63 65 52 65 6d 6f 76 65 20 7b 33 34 33 43 45 32 31 34 2d 39 39 39 38 2d 34 42 32 31 2d 41 31 35 31 2d 46 46 45 39 37 30 31 36 37 32 39 37 7d 20 3d 20 73 20 27 57 65 62 49 6e 73 74 61 6c 6c 20 43 6c 61 73 73 27}  //weight: 1, accuracy: Low
        $x_1_5 = {50 72 6f 67 49 44 20 3d 20 73 20 27 53 70 79 53 68 72 65 64 64 65 72 2e 57 65 62 49 6e 73 74 61 6c 6c 2e 31 27 ?? ?? ?? ?? ?? 56 65 72 73 69 6f 6e 49 6e 64 65 70 65 6e 64 65 6e 74 50 72 6f 67 49 44 20 3d 20 73 20 27 53 70 79 53 68 72 65 64 64 65 72 2e 57 65 62 49 6e 73 74 61 6c 6c 27}  //weight: 1, accuracy: Low
        $x_1_6 = "'TypeLib' = s '{D2436533-33F9-495C-9CD9-DAF21E67FFEB}'" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule _PseudoThreat_c00008be_0
{
    meta:
        author = "defender2yara"
        detection_name = "!PseudoThreat_c00008be"
        threat_id = "3221227710"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "26"
        strings_accuracy = "Low"
    strings:
        $x_10_1 = {78 3a 5c 44 65 76 5f 43 50 50 5c 57 6f 72 6b 5c 56 53 5f 4b 6e 7a 53 74 72 5f 41 64 77 61 72 65 5c 52 65 6c 65 61 73 65 5c 56 53 5f 57 6f 72 6b ?? 2e 70 64 62}  //weight: 10, accuracy: Low
        $x_10_2 = {8b 45 14 85 c0 0f 8c 4b 01 00 00 83 f8 01 0f 84 42 01 00 00 83 f8 24 0f 8f 39 01 00 00 85 c0 75 2a 80 fb 30 74 09 c7 45 14 0a 00 00 00 eb 34}  //weight: 10, accuracy: High
        $x_5_3 = "safe-strip-download.com" ascii //weight: 5
        $x_1_4 = {72 65 67 65 64 69 74 20 2d 73 20 72 65 67 ?? 2e 72 65 67 20}  //weight: 1, accuracy: Low
        $x_1_5 = {52 45 47 20 49 4d 50 4f 52 54 20 72 65 67 ?? 2e 72 65 67 20}  //weight: 1, accuracy: Low
        $x_1_6 = {65 72 61 73 65 20 72 65 67 ?? 2e 72 65 67 20}  //weight: 1, accuracy: Low
        $x_1_7 = {65 72 61 73 65 20 72 65 67 78 ?? 2e 62 61 74 20}  //weight: 1, accuracy: Low
        $x_1_8 = "WARNING: Your computer is infected" ascii //weight: 1
        $x_1_9 = "Windows has detected spyware infection!" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((2 of ($x_10_*) and 6 of ($x_1_*))) or
            ((2 of ($x_10_*) and 1 of ($x_5_*) and 1 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule _PseudoThreat_c00008bf_0
{
    meta:
        author = "defender2yara"
        detection_name = "!PseudoThreat_c00008bf"
        threat_id = "3221227711"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "33"
        strings_accuracy = "High"
    strings:
        $x_10_1 = {73 00 68 00 65 00 72 00 69 00 66 00 66 00 2e 00 65 00 78 00 65 00 00 00 77}  //weight: 10, accuracy: High
        $x_10_2 = "InternetGetConnectedState" ascii //weight: 10
        $x_10_3 = "gethostbyname" ascii //weight: 10
        $x_1_4 = "System error: spyware intrusion detected!" ascii //weight: 1
        $x_1_5 = "Critical error: system in danger!" ascii //weight: 1
        $x_1_6 = "Windows has detected spyware" ascii //weight: 1
        $x_1_7 = "System Alert!" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((3 of ($x_10_*) and 3 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule _PseudoThreat_c000097d_0
{
    meta:
        author = "defender2yara"
        detection_name = "!PseudoThreat_c000097d"
        threat_id = "3221227901"
        severity = "Critical"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {8b 45 e8 8b 55 ?? 01 02 8b 45 ?? 03 45 ?? 03 45 ?? 8b 55 ?? 31 02 83 45 e8 04}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule _PseudoThreat_c00009a1_0
{
    meta:
        author = "defender2yara"
        detection_name = "!PseudoThreat_c00009a1"
        threat_id = "3221227937"
        severity = "Critical"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {8b 85 48 ff ff ff 40 89 85 48 ff ff ff 8b 85 58 ff ff ff 8b 8d 48 ff ff ff 3b 48 02 73 1c 8b 45 f0 03 85 48 ff ff ff 8b 8d 58 ff ff ff 03 8d 48 ff ff ff 8a 49 3a 88 08}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule _PseudoThreat_c0000a39_0
{
    meta:
        author = "defender2yara"
        detection_name = "!PseudoThreat_c0000a39"
        threat_id = "3221228089"
        severity = "6"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {6a 40 68 00 10 00 00 8b 45 08 8b 40 04 ff 70 09 6a 00 8b 45 08 ff 50 24 89 45 f8 83 65 f4 00 6a 00 8d 45 f4 50 ff 75 f8 8b 45 08 8b 40 04 ff 30}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule _PseudoThreat_c0000a56_0
{
    meta:
        author = "defender2yara"
        detection_name = "!PseudoThreat_c0000a56"
        threat_id = "3221228118"
        severity = "6"
        signature_type = "SIGNATURE_TYPE_MACHOHSTR_EXT"
        threshold = "9"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "cnc.app.cymulate.com" ascii //weight: 1
        $x_1_2 = "3502f9dd-e22e-4bae-8c08-01b20737fb7a" ascii //weight: 1
        $x_1_3 = "CymulateLinuxRansomware" ascii //weight: 1
        $x_1_4 = ".CymCrypt" ascii //weight: 1
        $x_1_5 = "CymulateEDRScenarioExecutor" ascii //weight: 1
        $x_1_6 = ".conf" ascii //weight: 1
        $x_1_7 = ".docx" ascii //weight: 1
        $x_1_8 = ".pptx" ascii //weight: 1
        $x_1_9 = ".xlsx" ascii //weight: 1
        $x_1_10 = ".tbz2" ascii //weight: 1
        $x_1_11 = "CommonCrypto_aes256" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (9 of ($x*))
}

rule _PseudoThreat_c0000a59_0
{
    meta:
        author = "defender2yara"
        detection_name = "!PseudoThreat_c0000a59"
        threat_id = "3221228121"
        severity = "6"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "2"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {5f 00 6b 00 61 00 73 00 73 00 73 00 70 00 65 00 72 00 73 00 6b 00 64 00 79 00 2c 01 01 09 30 2d 39 41 2d 5a 61 2d 7a 02 00 2c 01 01 09 30 2d 39 41 2d 5a 61 2d 7a}  //weight: 1, accuracy: Low
        $x_1_2 = {5b 00 54 00 69 00 6d 00 65 00 3a 00 5d 00 25 00 64 00 2d 00 25 00 64 00 2d 00 25 00 64 00 20 00 25 00 64 00 3a 00 25 00 64 00 3a 00 25 00 64 00 2c 01 01 09 30 2d 39 41 2d 5a 61 2d 7a 02 00 2c 01 01 09 30 2d 39 41 2d 5a 61 2d 7a}  //weight: 1, accuracy: Low
        $x_1_3 = {7b 00 53 00 44 00 54 00 42 00 38 00 48 00 51 00 39 00 2d 00 39 00 36 00 48 00 56 00 2d 00 53 00 37 00 38 00 48 00 2d 00 5a 00 33 00 47 00 49 00 2d 00 4a 00 37 00 55 00 43 00 54 00 59 00 37 00 38 00 34 00 48 00 48 00 43 00 7d 00 2c 01 01 09 30 2d 39 41 2d 5a 61 2d 7a 02 00 2c 01 01 09 30 2d 39 41 2d 5a 61 2d 7a}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (2 of ($x*))
}

rule Aconti_0
{
    meta:
        author = "defender2yara"
        detection_name = "Aconti"
        threat_id = "1605"
        severity = "Critical"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "8"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "aconti NetService" wide //weight: 1
        $x_1_2 = "port.aconti.net/dialer" ascii //weight: 1
        $x_1_3 = "ALifestyle.aconti" ascii //weight: 1
        $x_1_4 = "ALifeDialer" ascii //weight: 1
        $x_1_5 = "SecureDialer" ascii //weight: 1
        $x_1_6 = "goodthinxx" ascii //weight: 1
        $x_1_7 = "dialer/stub.exe" ascii //weight: 1
        $x_1_8 = "dialerhashwert=%s&dialerversion=%u%s%s" ascii //weight: 1
        $x_1_9 = "Software\\ALifestyle\\" ascii //weight: 1
        $x_1_10 = "ShowErotic" ascii //weight: 1
        $x_1_11 = "%s?UID=%u&Nr=%s&Country=%s&indcode=%u" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (8 of ($x*))
}

rule AdRotator_0
{
    meta:
        author = "defender2yara"
        detection_name = "AdRotator"
        threat_id = "1692"
        severity = "33"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "7D9362F8-77D8-4b29-97B5-621D550890C0" ascii //weight: 1
        $x_1_2 = "rightonads optimizer" ascii //weight: 1
        $x_1_3 = "Fukuruku.DLL" ascii //weight: 1
        $x_1_4 = "CreateMutexW" ascii //weight: 1
        $x_1_5 = "InternetReadFile" ascii //weight: 1
        $x_1_6 = "InternetCloseHandle" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule AdRotator_1
{
    meta:
        author = "defender2yara"
        detection_name = "AdRotator"
        threat_id = "1692"
        severity = "33"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Microsoft Visual C++ Runtime Library" ascii //weight: 1
        $x_1_2 = "fibkickupd.exe" ascii //weight: 1
        $x_1_3 = "fibulaticker.com" ascii //weight: 1
        $x_1_4 = "multi-pops.com/adsDirect.php?" ascii //weight: 1
        $x_1_5 = "InternetOpenUrlA" ascii //weight: 1
        $x_1_6 = "HttpQueryInfoA" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule AdRotator_2
{
    meta:
        author = "defender2yara"
        detection_name = "AdRotator"
        threat_id = "1692"
        severity = "33"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "14"
        strings_accuracy = "High"
    strings:
        $x_10_1 = "BannerRotator" ascii //weight: 10
        $x_2_2 = {44 6c 6c 41 75 78 45 6e 74 72 79 50 6f 69 6e 74 00 44 6c 6c 43 61 6e 55 6e 6c 6f 61 64 4e 6f 77}  //weight: 2, accuracy: High
        $x_1_3 = {6c 61 73 74 5f 75 70 64 61 74 65 5f 61 74 74 65 6d 70 74 00}  //weight: 1, accuracy: High
        $x_1_4 = {66 65 65 64 5f 73 74 61 74 73 00}  //weight: 1, accuracy: High
        $x_1_5 = {66 65 65 64 5f 63 61 70 73 00}  //weight: 1, accuracy: High
        $x_1_6 = {63 6c 69 63 6b 5f 63 6f 75 6e 74 65 72 00 00 74 69 6d 65 73 74 61 6d 70}  //weight: 1, accuracy: High
        $x_1_7 = {69 6d 70 72 65 73 73 5f 73 74 61 74 00}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_10_*) and 4 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_2_*) and 2 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule AdRotator_3
{
    meta:
        author = "defender2yara"
        detection_name = "AdRotator"
        threat_id = "1692"
        severity = "33"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "50"
        strings_accuracy = "High"
    strings:
        $x_10_1 = "SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Browser Helper Objects\\" ascii //weight: 10
        $x_10_2 = "NoProtectedModeBanner" ascii //weight: 10
        $x_10_3 = "Tagging System Streamrevenue" ascii //weight: 10
        $x_10_4 = "%%\\regsvr32.exe\" /s \"" ascii //weight: 10
        $x_10_5 = "/aff=" ascii //weight: 10
        $x_1_6 = "urlmon::URLDownloadToFileA" ascii //weight: 1
        $x_1_7 = "Software\\Microsoft\\Internet Explorer\\Low Rights\\ElevationPolicy\\" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((5 of ($x_10_*))) or
            (all of ($x*))
        )
}

rule AdRotator_4
{
    meta:
        author = "defender2yara"
        detection_name = "AdRotator"
        threat_id = "1692"
        severity = "33"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "30"
        strings_accuracy = "High"
    strings:
        $x_10_1 = "\"http://iesettingsupdate\"" wide //weight: 10
        $x_10_2 = "Software\\Microsoft\\Rotator" wide //weight: 10
        $x_10_3 = "bannerrotator_startup" wide //weight: 10
        $x_1_4 = "http://bannercpm.com/bc" wide //weight: 1
        $x_1_5 = "trafficsolution.com/bc/adrotator.php" wide //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((3 of ($x_10_*))) or
            (all of ($x*))
        )
}

rule AdRotator_5
{
    meta:
        author = "defender2yara"
        detection_name = "AdRotator"
        threat_id = "1692"
        severity = "33"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "13"
        strings_accuracy = "High"
    strings:
        $x_10_1 = {00 42 61 6e 6e 65 72 52 6f 74 61 74 6f 72 2e 44 4c 4c 00 44 6c 6c 43 61 6e 55 6e 6c 6f 61 64 4e 6f 77 00}  //weight: 10, accuracy: High
        $x_1_2 = {00 00 00 00 49 00 73 00 52 00 6f 00 74 00 61 00 74 00 6f 00 72 00 50 00 6f 00 70 00 75 00 70 00 00 00 00 00}  //weight: 1, accuracy: High
        $x_1_3 = {72 00 65 00 66 00 72 00 65 00 73 00 68 00 5f 00 74 00 69 00 6d 00 65 00 00 00 00 00 63 00 6c 00 69 00 63 00 6b 00 00 00 63 00 6c 00 69 00 63 00 6b 00 6c 00 69 00 6d 00 69 00 74 00}  //weight: 1, accuracy: High
        $x_1_4 = {26 00 6e 00 65 00 74 00 5f 00 69 00 64 00 3d 00 00 00 00 00 26 00 61 00 66 00 66 00 5f 00 69 00 64 00 3d 00 00 00 00 00 26 00 74 00 6d 00 3d 00}  //weight: 1, accuracy: High
        $x_1_5 = {6d 00 61 00 78 00 5f 00 69 00 6d 00 70 00 72 00 65 00 73 00 73 00 00 00 75 00 70 00 64 00 61 00 74 00 65 00 5f 00 75 00 72 00 6c 00}  //weight: 1, accuracy: High
        $x_1_6 = {26 00 76 00 65 00 72 00 73 00 69 00 6f 00 6e 00 3d 00 00 00 26 00 63 00 6c 00 69 00 63 00 6b 00 65 00 64 00 3d 00 00 00 73 00 68 00 6f 00 77 00 65 00 64 00 3d 00}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_10_*) and 3 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule AdRotator_6
{
    meta:
        author = "defender2yara"
        detection_name = "AdRotator"
        threat_id = "1692"
        severity = "33"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "25"
        strings_accuracy = "High"
    strings:
        $x_20_1 = "/bc/nsi_install.php?aff_id" ascii //weight: 20
        $x_1_2 = "NoProtectedModeBanner" ascii //weight: 1
        $x_1_3 = "Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\Zones\\" ascii //weight: 1
        $x_1_4 = "Software\\Microsoft\\Internet Explorer\\Low Rights\\ElevationPolicy\\" ascii //weight: 1
        $x_1_5 = "activation_key" ascii //weight: 1
        $x_1_6 = "RON Tool" ascii //weight: 1
        $x_1_7 = {00 6f 66 66 65 72 73 66 6f 72 74 6f 64 61 79 00}  //weight: 1, accuracy: High
        $x_1_8 = {00 61 64 64 65 73 74 69 6e 61 74 69 6f 6e 00}  //weight: 1, accuracy: High
        $x_1_9 = {00 61 64 73 6f 6e 6d 65 64 69 61 00}  //weight: 1, accuracy: High
        $x_1_10 = {00 74 61 72 67 65 74 65 64 62 61 6e 6e 65 72 00}  //weight: 1, accuracy: High
        $x_1_11 = {00 62 6c 61 7a 69 6e 67 61 64 73 00}  //weight: 1, accuracy: High
        $x_1_12 = {00 63 70 6d 73 6b 79 00}  //weight: 1, accuracy: High
        $x_1_13 = {00 67 6f 6f 6f 63 68 69 00}  //weight: 1, accuracy: High
        $x_1_14 = {00 68 6f 72 69 7a 6f 6e 61 64 73 00}  //weight: 1, accuracy: High
        $x_1_15 = {00 6d 69 6c 65 68 69 67 68 61 64 73 00}  //weight: 1, accuracy: High
        $x_1_16 = {00 6e 65 78 74 61 64 73 00}  //weight: 1, accuracy: High
        $x_1_17 = {00 72 69 67 68 74 6f 6e 61 64 7a 00}  //weight: 1, accuracy: High
        $x_1_18 = {00 73 75 70 65 72 69 6f 72 61 64 73 00}  //weight: 1, accuracy: High
        $x_1_19 = {00 67 69 61 6e 74 61 64 73 00}  //weight: 1, accuracy: High
        $x_1_20 = {00 6d 78 6c 69 76 65 6d 65 64 69 61 00}  //weight: 1, accuracy: High
        $x_1_21 = {00 61 67 61 64 6f 6f 00}  //weight: 1, accuracy: High
        $x_1_22 = {00 62 61 6e 6e 65 72 73 74 79 6c 65 00}  //weight: 1, accuracy: High
        $x_1_23 = {00 62 61 6e 6e 65 72 73 74 79 6c 65 73 00}  //weight: 1, accuracy: High
        $x_1_24 = {00 62 61 6e 6e 65 72 61 64 73 67 61 6c 6f 72 65 00}  //weight: 1, accuracy: High
        $x_1_25 = {00 6f 69 6e 61 64 73 65 72 76 69 6e 67 00}  //weight: 1, accuracy: High
        $x_1_26 = {00 66 75 6e 78 79 00}  //weight: 1, accuracy: High
        $x_1_27 = {00 72 61 64 62 61 6e 6e 65 72 00}  //weight: 1, accuracy: High
        $x_1_28 = {00 61 64 73 65 72 76 65 66 61 73 74 00}  //weight: 1, accuracy: High
        $x_1_29 = {00 74 61 6e 67 6f 6d 61 74 00}  //weight: 1, accuracy: High
        $x_1_30 = {00 70 72 65 63 69 73 65 61 64 00}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (
            ((25 of ($x_1_*))) or
            ((1 of ($x_20_*) and 5 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule AdRotator_7
{
    meta:
        author = "defender2yara"
        detection_name = "AdRotator"
        threat_id = "1692"
        severity = "33"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "brwsr_" wide //weight: 1
        $x_1_2 = "fromated" wide //weight: 1
        $x_3_3 = {64 72 63 74 00 00 00 00 65 6e 63 00 65 6e 62 6c}  //weight: 3, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule AdRotator_8
{
    meta:
        author = "defender2yara"
        detection_name = "AdRotator"
        threat_id = "1692"
        severity = "33"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "11"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {eb 15 8b 15 ?? ?? ?? ?? 0f be cb 83 e9 28 8a 0c 0a 88 0f}  //weight: 1, accuracy: Low
        $x_1_2 = {eb 19 8b 15 ?? ?? ?? ?? 0f be cb 83 e9 28 8a 0c 0a 8b 54 24 14 88 0a}  //weight: 1, accuracy: Low
        $x_10_3 = {80 fb 28 7c ?? 80 fb 7e 7f ?? 85 c0 75 14}  //weight: 10, accuracy: Low
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_10_*) and 1 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule AdRotator_9
{
    meta:
        author = "defender2yara"
        detection_name = "AdRotator"
        threat_id = "1692"
        severity = "33"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "3"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {44 69 73 70 6c 61 79 4e 61 6d 65 00 52 4f 4e 20 54 6f 6f 31}  //weight: 1, accuracy: High
        $x_1_2 = "Nullsoft Install System" ascii //weight: 1
        $x_1_3 = {61 66 66 5f 69 64 [0-6] 62 32 73 65 61 72 63 68 00 64 65 66 61 75 6c 74}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule AdRotator_10
{
    meta:
        author = "defender2yara"
        detection_name = "AdRotator"
        threat_id = "1692"
        severity = "33"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "2"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {33 c0 83 4d fc ff a3 ?? ?? ?? ?? 8b 30 57 ff 15 ?? ?? ?? ?? ff 75 0c ff 75 08 56 50 ff 15 ?? ?? ?? ?? ff d0}  //weight: 1, accuracy: Low
        $x_1_2 = {0f b6 55 0b 33 d0 8b 46 08 2b c1 88 55 0b 8a 55 0b 83 c0 0b 32 10 8b 06 88 14 01 41 83 f9 0b 72 ?? ff 76 08}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule AdRotator_11
{
    meta:
        author = "defender2yara"
        detection_name = "AdRotator"
        threat_id = "1692"
        severity = "33"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "2"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {8d 4d ec e8 ?? ?? ?? ?? 8b f8 8d 4d ec 81 e7 f0 00 00 00 e8 ?? ?? ?? ?? 83 e0 0f 0b c7 04 ?? 88 45 f3 8d 45 f3 50 8b c6 e8 ?? ?? ?? ?? 8b 45 ec 80 38 00 75 cb}  //weight: 1, accuracy: Low
        $x_1_2 = {2d 30 30 30 30 2d 30 30 30 30 30 30 30 30 30 30 31 32 46 38 36 38 7d 00}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule AdRotator_12
{
    meta:
        author = "defender2yara"
        detection_name = "AdRotator"
        threat_id = "1692"
        severity = "33"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "C7DDEE9F-CD4B-40fb-9030-E1709644F4BD}" ascii //weight: 1
        $x_1_2 = "wave.ShDl = s 'wave" ascii //weight: 1
        $x_1_3 = {70 69 6f 31 32 00 00 70 6f 74 79 00 00 00 00 71 75 69 70}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule AdRotator_13
{
    meta:
        author = "defender2yara"
        detection_name = "AdRotator"
        threat_id = "1692"
        severity = "33"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "3"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {7a c3 3f 19 c7 45 d6 29 4d aa 57 c7 45 da 1a cd 87 c2 66 c7 45 de 6b 66}  //weight: 1, accuracy: High
        $x_1_2 = {74 09 8b 06 53 57 56 ff 10 eb 54}  //weight: 1, accuracy: High
        $x_1_3 = {8b 44 24 04 eb 04 80 00 ?? 40 3b 44 24 08 75 f6 c2 08 00}  //weight: 1, accuracy: Low
        $x_1_4 = {66 8b 34 01 66 33 70 fe 66 89 30 83 c0 02 4a 75 ef}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (3 of ($x*))
}

rule AdRotator_14
{
    meta:
        author = "defender2yara"
        detection_name = "AdRotator"
        threat_id = "1692"
        severity = "33"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "3"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = "browser enhancer" ascii //weight: 1
        $x_1_2 = {8a 04 3e 3c 28 7c ?? 3c 7e 7f [0-4] 0f be d0 a1 ?? ?? ?? ?? 8a 54 02 ?? 88 11 eb 02}  //weight: 1, accuracy: Low
        $x_1_3 = {8b f0 ff d5 2b f0 83 ee ?? eb 0e 10 00 74 19 68 ?? ?? ?? ?? 57 ff d5 68 ?? ?? ?? ?? 57}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule AdRotator_15
{
    meta:
        author = "defender2yara"
        detection_name = "AdRotator"
        threat_id = "1692"
        severity = "33"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "F6054841-5556-4748-8F6E-AAD37DB4A06C}" ascii //weight: 1
        $x_1_2 = "FastRX.CustomRX = s 'CustomRX" ascii //weight: 1
        $x_1_3 = {66 61 73 74 72 78 00 6d 6d 70 00 62 79 61 7a 6f 6d 79 61 7a 6f}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule AdRotator_16
{
    meta:
        author = "defender2yara"
        detection_name = "AdRotator"
        threat_id = "1692"
        severity = "33"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "3"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = "DllAction" ascii //weight: 1
        $x_1_2 = "DllCanUnloadNow" ascii //weight: 1
        $x_1_3 = {b8 32 00 00 00 66 a3 ?? ?? ?? ?? b9 79 00 00 00 66 89 0d ?? ?? ?? ?? b8 52 00 00 00 66 a3 ?? ?? ?? ?? ba 44 00 00 00 66 89 15 ?? ?? ?? ?? b9 5c 00 00 00 66 89 0d ?? ?? ?? ?? 33 c9 b8 49 00 00 00 66 a3}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule AdRotator_17
{
    meta:
        author = "defender2yara"
        detection_name = "AdRotator"
        threat_id = "1692"
        severity = "33"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "AA1A4F83-B4AC-4859-8C91-21DBE6C5625B}" ascii //weight: 1
        $x_1_2 = "core.Iconizer = s 'Iconizer" ascii //weight: 1
        $x_1_3 = "advert://advertserver.com/%d" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule AdRotator_18
{
    meta:
        author = "defender2yara"
        detection_name = "AdRotator"
        threat_id = "1692"
        severity = "33"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "3"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {44 69 73 70 6c 61 79 4e 61 6d 65 00 42 72 6f 77 73 65 72 20 4f 70 74 69 6d 69 7a 65 72 20 41 64 73 73 69 74 65}  //weight: 1, accuracy: High
        $x_1_2 = "Nullsoft Install System" ascii //weight: 1
        $x_1_3 = {46 72 69 65 6e 64 6c 79 41 64 77 61 72 65 20 ?? ?? ?? 20 69 6e 73 74 61 6c 6c 65 64 21 00}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule AdRotator_19
{
    meta:
        author = "defender2yara"
        detection_name = "AdRotator"
        threat_id = "1692"
        severity = "33"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {66 8b 34 01 66 33 70 fe 66 89 30 83 c0 02 4a 75 ef}  //weight: 1, accuracy: High
        $x_1_2 = {74 15 89 7d 0c 66 8b 38 66 33 3c 02 ff 4d 0c 8b 19 66 89 3c 1e 75 ee}  //weight: 1, accuracy: High
        $x_1_3 = {0f b6 54 10 03 8d 4c 01 02 8b 0e 30 54 01 03 8b 56 04 0f b6 54 10 04 8d 4c 01 03}  //weight: 1, accuracy: High
        $x_1_4 = {c6 45 fc 06 8b 45 f0 89 07 89 75 f0 c6 45 fc 05 c7 45 ec 01 00 00 00 c6 45 fc 02}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (3 of ($x*))
}

rule AdRotator_20
{
    meta:
        author = "defender2yara"
        detection_name = "AdRotator"
        threat_id = "1692"
        severity = "33"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "3"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {8d 4d ec e8 ?? ?? ?? ?? 8b f8 8d 4d ec 81 e7 f0 00 00 00 e8 ?? ?? ?? ?? 83 e0 0f 0b c7 04 ?? 88 45 f3 56 8d 45 f3 50 8b 45 e8 e8 ?? ?? ?? ?? 8b 45 ec 80 38 00 75 c9}  //weight: 1, accuracy: Low
        $x_1_2 = {4e 53 5f 46 72 65 65 00 78 70 63 6f 6d 2e 64 6c 6c 00}  //weight: 1, accuracy: High
        $x_1_3 = {50 52 5f 41 74 6f 6d 69 63 44 65 63 72 65 6d 65 6e 74 00 00 6e 73 70 72 34 2e 64 6c 6c 00}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule AdRotator_21
{
    meta:
        author = "defender2yara"
        detection_name = "AdRotator"
        threat_id = "1692"
        severity = "33"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Nullsoft Install System" ascii //weight: 1
        $x_1_2 = {44 69 73 70 6c 61 79 4e 61 6d 65 00 54 61 67 67 69 6e 67 20 53 79 73 74 65 6d 20 52 65 76 65 6e 75 65 62 75 73 74 65 72}  //weight: 1, accuracy: High
        $x_1_3 = "::DllDispatch(i 9, t 'revenuebuster', t .r9)" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule AdRotator_22
{
    meta:
        author = "defender2yara"
        detection_name = "AdRotator"
        threat_id = "1692"
        severity = "33"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "3"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = "browser enhancer" ascii //weight: 1
        $x_1_2 = "adSpotWnd" ascii //weight: 1
        $x_1_3 = {0f 8c c3 00 00 00 3b 6e f8 0f 8f ba 00 00 00 68 ?? ?? ?? ?? 89 6e f4 57 c6 04 2e 00 ff d3 8b e8 68 ?? ?? ?? ?? 2b ef 57 89 44 24 30}  //weight: 1, accuracy: Low
        $x_1_4 = {8a 0f 80 f9 28 7c 12 80 f9 7e 7f 0d 8b 1d ?? ?? ?? ?? 0f be c9 8a 4c 19 ?? 88 0a 42 47 48 75 e0}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (3 of ($x*))
}

rule AdRotator_23
{
    meta:
        author = "defender2yara"
        detection_name = "AdRotator"
        threat_id = "1692"
        severity = "33"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "9C8A568E-4201-478a-8536-526CF371D2E2}" ascii //weight: 1
        $x_1_2 = "optimizer.adssite2 = s 'ads_optimizer" ascii //weight: 1
        $x_1_3 = "hexa5 .c3{padding-left:53.5%}.imglinklist1" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule AdRotator_24
{
    meta:
        author = "defender2yara"
        detection_name = "AdRotator"
        threat_id = "1692"
        severity = "33"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_3_1 = "RON ads by snappyads" wide //weight: 3
        $x_1_2 = "/bc/2ndtier.php" wide //weight: 1
        $x_2_3 = ".?AVCBannerRotator@@" ascii //weight: 2
        $x_2_4 = "afx_cpcxdRt" wide //weight: 2
    condition:
        (filesize < 20MB) and
        (
            ((2 of ($x_2_*) and 1 of ($x_1_*))) or
            ((1 of ($x_3_*) and 1 of ($x_2_*))) or
            (all of ($x*))
        )
}

rule AdRotator_25
{
    meta:
        author = "defender2yara"
        detection_name = "AdRotator"
        threat_id = "1692"
        severity = "33"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "3"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {c6 45 fc 07 8b 45 f0 89 (06|07) 89 (5d|75) f0 c6 45 fc 06 c7 45 e8 01 00 00 00 c6 45 fc 02}  //weight: 1, accuracy: Low
        $x_1_2 = {c6 45 fc 07 8b 45 ec 89 06 89 7d ec c6 45 fc 06 c7 45 e4 01 00 00 00 c6 45 fc 02}  //weight: 1, accuracy: High
        $x_1_3 = {89 55 08 83 65 fc 00 8b 4d 0c 8b 39 89 3a 83 21 00 83 4d fc ff}  //weight: 1, accuracy: High
        $x_1_4 = {66 33 3c 02 ff (4d|6d) 0c 8b 19 66 89 3c 1e 75 ee 66 8b 3c 02 66 33 38}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (3 of ($x*))
}

rule AdRotator_26
{
    meta:
        author = "defender2yara"
        detection_name = "AdRotator"
        threat_id = "1692"
        severity = "33"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "23"
        strings_accuracy = "High"
    strings:
        $x_10_1 = ".?AVMapikapitapitooo@@" ascii //weight: 10
        $x_10_2 = ".?AVCShoopadoop@@" ascii //weight: 10
        $x_1_3 = ".?AVHlowekop@@" ascii //weight: 1
        $x_1_4 = ".?AVPatipati@@" ascii //weight: 1
        $x_1_5 = ".?AVDjkejdkehs@@" ascii //weight: 1
        $x_1_6 = ".?AVCklopex@@" ascii //weight: 1
        $x_1_7 = ".?AVNujitra@@" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((2 of ($x_10_*) and 3 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule AdRotator_27
{
    meta:
        author = "defender2yara"
        detection_name = "AdRotator"
        threat_id = "1692"
        severity = "33"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {68 96 00 00 00 6a 64 e8 ?? ?? ?? ?? 83 c4 08 50 ff 15 ?? ?? ?? ?? 6a 1c 8d 54 24 4c 52 6a 01 ff d6 8b 44 24 0c 8b 4c 24 08 50 51 ff 15}  //weight: 1, accuracy: Low
        $x_1_2 = {6a 0a 6a 00 e8 ?? ?? ?? ?? 8b 4c 24 1c 6a 0a 6a 00 8d 74 08 55 e8 ?? ?? ?? ?? 8b 54 24 20 8d 44 10 6e 56 50 e8}  //weight: 1, accuracy: Low
        $x_1_3 = "aff_id=" wide //weight: 1
        $x_1_4 = "glob_click_limit" wide //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule AdRotator_28
{
    meta:
        author = "defender2yara"
        detection_name = "AdRotator"
        threat_id = "1692"
        severity = "33"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Are you sure you would like to uninstall" ascii //weight: 1
        $x_1_2 = "not run exactly the same as before)?" ascii //weight: 1
        $x_1_3 = "Nullsoft Install System" ascii //weight: 1
        $x_1_4 = {fd 80 80 5f 61 75 74 6f 72 75 6e}  //weight: 1, accuracy: High
        $x_1_5 = {69 6e 73 74 61 6c 6c 5f 69 64 00 61 66 66 5f 69 64}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (4 of ($x*))
}

rule AdRotator_29
{
    meta:
        author = "defender2yara"
        detection_name = "AdRotator"
        threat_id = "1692"
        severity = "33"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "971C3384-F75E-4562-95B3-CBE7417529BC}" ascii //weight: 1
        $x_1_2 = "Rotator.Gizmo5 = s 'rightonadz browser optimizer" ascii //weight: 1
        $x_1_3 = {26 00 69 00 64 00 3d 00 00 00 00 00 26 00 72 00 6e 00 64 00 3d 00 00 00 26 00 76 00 65 00 72 00 73 00 69 00 6f 00 6e 00 3d 00 00 00 26 00 63 00 6c 00 69 00 63 00 6b 00 65 00 64 00 3d 00}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule AdRotator_30
{
    meta:
        author = "defender2yara"
        detection_name = "AdRotator"
        threat_id = "1692"
        severity = "33"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "7"
        strings_accuracy = "Low"
    strings:
        $x_5_1 = {68 96 00 00 00 6a 64 e8 ?? ?? ?? ?? 59 59 50 ff 15 ?? ?? ?? ?? 57 8d 45 a0 50 53 ff d6 ff 75 f8 ff 75 f4 ff 15}  //weight: 5, accuracy: Low
        $x_1_2 = "glob_click_limit" wide //weight: 1
        $x_1_3 = "IsRotatorPopup" wide //weight: 1
        $x_1_4 = {63 00 6c 00 69 00 63 00 6b 00 00 00 63 00 6c 00 69 00 63 00 6b 00 6c 00 69 00 6d 00 69 00 74 00}  //weight: 1, accuracy: High
        $x_1_5 = "&clicked=" wide //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_5_*) and 2 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule AdRotator_31
{
    meta:
        author = "defender2yara"
        detection_name = "AdRotator"
        threat_id = "1692"
        severity = "33"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "3"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {c7 44 24 24 7a c3 3f 19 c6 44 24 2c aa c6 44 24 2d 57 c6 44 24 2e 1a c6 44 24 2f cd c6 44 24 30 87 c6 44 24 31 c2 c6 44 24 32 6b c6 44 24 33 66 8b 10 8b 12}  //weight: 1, accuracy: High
        $x_1_2 = {66 89 44 24 40 89 5c 24 48 c6 84 24 88 01 00 00 0e 8b 4c 24 40 8b 54 24 44 8b 7c 24 48 8b 6c 24 4c}  //weight: 1, accuracy: High
        $x_1_3 = {33 d1 8b 4e 08 88 54 24 08 0f b6 54 24 08 2b c8 8a 49 ?? 32 d1 8b 0e 88 14 08}  //weight: 1, accuracy: Low
        $x_1_4 = {66 33 14 01 03 c8 66 89 51 02 8b 4e 08 0f b7 (54|7c) 08 02 83 c0 04 83 f8 ?? 72 cf 33 c0 b9}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (3 of ($x*))
}

rule AdRotator_32
{
    meta:
        author = "defender2yara"
        detection_name = "AdRotator"
        threat_id = "1692"
        severity = "33"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "11"
        strings_accuracy = "Low"
    strings:
        $x_5_1 = {c7 44 24 28 7a c3 3f 19 c6 44 24 30 aa c6 44 24 31 57 c6 44 24 32 1a c6 44 24 33 cd c6 44 24 34 87 c6 44 24 35 c2 c6 44 24 36 6b c6 44 24 37 66}  //weight: 5, accuracy: High
        $x_5_2 = {74 0c 8d 64 24 00 80 00 ?? 40 3b c1 75 f8}  //weight: 5, accuracy: Low
        $x_1_3 = {fe c9 8a d0 fe c0 3a d1}  //weight: 1, accuracy: High
        $x_1_4 = {8a c8 fe c0 8a 14 32 3a d1 a2}  //weight: 1, accuracy: High
        $x_1_5 = {fe c8 fe c9 a2 ?? ?? ?? ?? 88 0d ?? ?? ?? ?? 3a c1}  //weight: 1, accuracy: Low
        $x_1_6 = {fe c0 fe c9 3a c1 a2 ?? ?? ?? ?? 88 0d}  //weight: 1, accuracy: Low
        $x_1_7 = {2a d0 2a d9 3a da a2}  //weight: 1, accuracy: High
        $x_1_8 = {fe c0 fe c9 fe c8 fe c9 a2 ?? ?? ?? ?? 88 0d}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_5_*) and 6 of ($x_1_*))) or
            ((2 of ($x_5_*) and 1 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule AdRotator_33
{
    meta:
        author = "defender2yara"
        detection_name = "AdRotator"
        threat_id = "1692"
        severity = "33"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "Low"
    strings:
        $x_2_1 = "BannerRotator" ascii //weight: 2
        $x_2_2 = "IsRotatorPopup" wide //weight: 2
        $x_2_3 = {61 00 64 00 73 00 20 00 62 00 79 00 20 00 6f 00 66 00 66 00 65 00 72 00 73 00 66 00 6f 00 72 00 74 00 6f 00 64 00 61 00 79 00 00 00}  //weight: 2, accuracy: High
        $x_1_4 = "afx_cpcxdRt" wide //weight: 1
        $x_1_5 = {68 61 72 76 65 73 74 [0-4] 2e 64 6c 6c 00 44 6c 6c 43 61 6e 55 6e 6c 6f 61 64 4e 6f 77}  //weight: 1, accuracy: Low
        $x_1_6 = {63 00 6c 00 69 00 63 00 6b 00 00 00 66 00 65 00 65 00 64 00 5f 00 63 00 61 00 70 00}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_2_*) and 3 of ($x_1_*))) or
            ((2 of ($x_2_*) and 1 of ($x_1_*))) or
            ((3 of ($x_2_*))) or
            (all of ($x*))
        )
}

rule AdRotator_34
{
    meta:
        author = "defender2yara"
        detection_name = "AdRotator"
        threat_id = "1692"
        severity = "33"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "51"
        strings_accuracy = "High"
    strings:
        $x_10_1 = "Software\\Microsoft\\Internet Explorer\\New Windows" wide //weight: 10
        $x_10_2 = "clicklimit" wide //weight: 10
        $x_10_3 = "update_url" wide //weight: 10
        $x_10_4 = "PopupMgr" wide //weight: 10
        $x_10_5 = "GetLastActivePopup" ascii //weight: 10
        $x_1_6 = "rotator" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule AdRotator_35
{
    meta:
        author = "defender2yara"
        detection_name = "AdRotator"
        threat_id = "1692"
        severity = "33"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "14"
        strings_accuracy = "High"
    strings:
        $x_10_1 = {42 61 6e 6e 65 72 52 6f 74 61 74 6f 72 2e 44 4c 4c 00 44 6c 6c 43 61 6e 55 6e 6c 6f 61 64 4e 6f 77}  //weight: 10, accuracy: High
        $x_2_2 = {00 00 49 00 73 00 52 00 6f 00 74 00 61 00 74 00 6f 00 72 00 50 00 6f 00 70 00 75 00 70 00 00 00}  //weight: 2, accuracy: High
        $x_1_3 = {64 6f 77 6e 6c 6f 61 64 00 64 6f 77 6e 6c 6f 61 64 5f 71 75 69 65 74}  //weight: 1, accuracy: High
        $x_1_4 = {43 6f 6e 6e 65 63 74 69 6e 67 20 2e 2e 2e 00 00 44 6f 77 6e 6c 6f 61 64 69 6e 67 20 25 73}  //weight: 1, accuracy: High
        $x_1_5 = "Timed out on connecting." ascii //weight: 1
        $x_1_6 = "Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_10_*) and 4 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_2_*) and 2 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule AdRotator_36
{
    meta:
        author = "defender2yara"
        detection_name = "AdRotator"
        threat_id = "1692"
        severity = "33"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "203"
        strings_accuracy = "Low"
    strings:
        $x_100_1 = "'Browser Helper Objects'" ascii //weight: 100
        $x_100_2 = {77 00 77 00 77 00 2e 00 74 00 72 00 61 00 66 00 66 00 69 00 63 00 [0-32] 2e 00 62 00 69 00 7a 00 2f 00 61 00 64 00 73}  //weight: 100, accuracy: Low
        $x_1_3 = "popups_delay" wide //weight: 1
        $x_1_4 = "popup_delay" wide //weight: 1
        $x_1_5 = "popups_enabled" wide //weight: 1
        $x_1_6 = {6e 00 65 00 78 00 74 00 74 00 69 00 6d 00 65 00 5f 00 [0-10] 70 00 6f 00 70 00 75 00 70 00 73}  //weight: 1, accuracy: Low
        $x_1_7 = "denied_pop" wide //weight: 1
        $x_1_8 = "show_pop" wide //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((2 of ($x_100_*) and 3 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule AdRotator_37
{
    meta:
        author = "defender2yara"
        detection_name = "AdRotator"
        threat_id = "1692"
        severity = "33"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "6"
        strings_accuracy = "Low"
    strings:
        $x_2_1 = "DllWorker" ascii //weight: 2
        $x_2_2 = {b8 44 65 00 00 66 89 46 1c b8 74 6f 00 00 66 89 46 1e b8 75 72 00 00 66 89 46 20 b8 73 21 00 00 66 89 46 22}  //weight: 2, accuracy: High
        $x_1_3 = {58 6a 69 66 a3 ?? ?? ?? ?? 58}  //weight: 1, accuracy: Low
        $x_1_4 = {58 6a 6f 66 a3 ?? ?? ?? ?? 58}  //weight: 1, accuracy: Low
        $x_1_5 = {58 6a 5f 66 a3 ?? ?? ?? ?? 58}  //weight: 1, accuracy: Low
        $x_1_6 = {58 6a 65 66 a3 ?? ?? ?? ?? 58}  //weight: 1, accuracy: Low
        $x_2_7 = {6a 01 68 00 00 10 00 80 00 b9 ?? 00 00 00 66 89 0d ?? ?? ?? ?? ba ?? 00 00 00 b8 ?? 00 00 00 b9 ?? 00 00 00 66 89 15 ?? ?? ?? ?? 66 a3 ?? ?? ?? ?? 66 89 0d}  //weight: 2, accuracy: Low
        $x_2_8 = {6a 01 68 00 00 10 00 a0 00 66 89 15 ?? ?? ?? ?? 66 a3 ?? ?? ?? ?? 66 89 0d ?? ?? ?? ?? ba ?? 00 00 00 66 89 15 ?? ?? ?? ?? b8 ?? 00 00 00 66 a3 ?? ?? ?? ?? b9 ?? 00 00 00 66 89 0d ?? ?? ?? ?? ba ?? 00 00 00}  //weight: 2, accuracy: Low
        $x_2_9 = {6a 01 68 00 00 10 00 50 00 66 89 15 ?? ?? ?? ?? 66 89 15 ?? ?? ?? ?? 66 a3 ?? ?? ?? ?? 66 89 0d}  //weight: 2, accuracy: Low
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_2_*) and 4 of ($x_1_*))) or
            ((2 of ($x_2_*) and 2 of ($x_1_*))) or
            ((3 of ($x_2_*))) or
            (all of ($x*))
        )
}

rule AdRotator_38
{
    meta:
        author = "defender2yara"
        detection_name = "AdRotator"
        threat_id = "1692"
        severity = "33"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "98"
        strings_accuracy = "High"
    strings:
        $x_10_1 = "DllCanUnloadNow" ascii //weight: 10
        $x_10_2 = "DllGetClassObject" ascii //weight: 10
        $x_10_3 = "DllRegisterServer" ascii //weight: 10
        $x_10_4 = "DllUnregisterServer" ascii //weight: 10
        $x_10_5 = "Delete" wide //weight: 10
        $x_10_6 = "NoRemove" wide //weight: 10
        $x_10_7 = "ForceRemove" wide //weight: 10
        $x_10_8 = ".?AVCBannerRotator@@" ascii //weight: 10
        $x_10_9 = ".?AVCLiteBHO@@" ascii //weight: 10
        $x_1_10 = "aff_id" ascii //weight: 1
        $x_1_11 = "click_counter" ascii //weight: 1
        $x_1_12 = "click_stat" ascii //weight: 1
        $x_1_13 = "feed_caps" ascii //weight: 1
        $x_1_14 = "feed_stats" ascii //weight: 1
        $x_1_15 = "impress_stat" ascii //weight: 1
        $x_1_16 = "last_update_attempt" ascii //weight: 1
        $x_1_17 = "max_impress" ascii //weight: 1
        $x_1_18 = "timestamp" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((9 of ($x_10_*) and 8 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule AdRotator_39
{
    meta:
        author = "defender2yara"
        detection_name = "AdRotator"
        threat_id = "1692"
        severity = "33"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "16"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = "addestination" ascii //weight: 1
        $x_1_2 = "adsonmedia" ascii //weight: 1
        $x_1_3 = "banneradsgalore" ascii //weight: 1
        $x_1_4 = "blazingads" ascii //weight: 1
        $x_1_5 = "gooochi" ascii //weight: 1
        $x_1_6 = "horizonads" ascii //weight: 1
        $x_1_7 = "milehighads" ascii //weight: 1
        $x_1_8 = "nextads" ascii //weight: 1
        $x_1_9 = "rightonadz" ascii //weight: 1
        $x_1_10 = "superiorads" ascii //weight: 1
        $x_1_11 = "giantads" ascii //weight: 1
        $x_1_12 = "funxy" ascii //weight: 1
        $x_1_13 = "SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Browser Helper Objects\\" ascii //weight: 1
        $x_1_14 = "NoProtectedModeBanner" ascii //weight: 1
        $x_1_15 = "DllRegisterServer" ascii //weight: 1
        $x_1_16 = {2f 62 63 2f 6e 73 69 5f 69 6e 73 74 61 6c 6c 2e 70 68 70 3f 61 66 66 5f 69 64 3d [0-16] 26 69 6e 73 74 5f 72 65 73 75 6c 74 3d}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule AdRotator_40
{
    meta:
        author = "defender2yara"
        detection_name = "AdRotator"
        threat_id = "1692"
        severity = "33"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "104"
        strings_accuracy = "High"
    strings:
        $x_10_1 = "DllCanUnloadNow" ascii //weight: 10
        $x_10_2 = "DllGetClassObject" ascii //weight: 10
        $x_10_3 = "DllRegisterServer" ascii //weight: 10
        $x_10_4 = "DllUnregisterServer" ascii //weight: 10
        $x_10_5 = "Delete" wide //weight: 10
        $x_10_6 = "NoRemove" wide //weight: 10
        $x_10_7 = "ForceRemove" wide //weight: 10
        $x_10_8 = "IsRotatorPopup" wide //weight: 10
        $x_10_9 = ".?AVCBannerRotator@@" ascii //weight: 10
        $x_10_10 = ".?AVCLiteBHO@@" ascii //weight: 10
        $x_1_11 = "EMBED" wide //weight: 1
        $x_1_12 = "OBJECT" wide //weight: 1
        $x_1_13 = "IFRAME" wide //weight: 1
        $x_1_14 = "feed_cap" wide //weight: 1
        $x_1_15 = "Internet Explorer_Server" wide //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((10 of ($x_10_*) and 4 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule AdRotator_41
{
    meta:
        author = "defender2yara"
        detection_name = "AdRotator"
        threat_id = "1692"
        severity = "33"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "32"
        strings_accuracy = "High"
    strings:
        $x_30_1 = "cpmsky_autorun" ascii //weight: 30
        $x_30_2 = "gooochi_autorun" ascii //weight: 30
        $x_30_3 = "agadoo_autorun" ascii //weight: 30
        $x_30_4 = "superiorads_autorun" ascii //weight: 30
        $x_30_5 = "radbanner_autorun" ascii //weight: 30
        $x_30_6 = "primeadserving_autorun" ascii //weight: 30
        $x_30_7 = "voguecash_autorun" ascii //weight: 30
        $x_30_8 = "precisead_autorun" ascii //weight: 30
        $x_30_9 = "milehighads_autorun" ascii //weight: 30
        $x_30_10 = "du-little_autorun" ascii //weight: 30
        $x_30_11 = "adservefast_autorun" ascii //weight: 30
        $x_30_12 = "rightonadz_autorun" ascii //weight: 30
        $x_30_13 = "bannerstyle_autorun" ascii //weight: 30
        $x_30_14 = "addestination_autorun" ascii //weight: 30
        $x_30_15 = "banneradsgalore_autorun" ascii //weight: 30
        $x_30_16 = "blazingads_autorun" ascii //weight: 30
        $x_30_17 = "targetedbanner_autorun" ascii //weight: 30
        $x_30_18 = "bannerstyles_autorun" ascii //weight: 30
        $x_30_19 = "horizonads_autorun" ascii //weight: 30
        $x_30_20 = "chargeyourprofit_autorun" ascii //weight: 30
        $x_30_21 = "thesuperads_autorun" ascii //weight: 30
        $x_30_22 = "profitharbor_autorun" ascii //weight: 30
        $x_30_23 = "hotrevenue_autorun" ascii //weight: 30
        $x_30_24 = "solads_autorun" ascii //weight: 30
        $x_30_25 = "snappyads_autorun" ascii //weight: 30
        $x_30_26 = "blueskyadagency_autorun" ascii //weight: 30
        $x_30_27 = "worldadmarketplace_autorun" ascii //weight: 30
        $x_30_28 = "ressrevenue_autorun" ascii //weight: 30
        $x_30_29 = "streamrevenue_autorun" ascii //weight: 30
        $x_30_30 = "incomeland_autorun" ascii //weight: 30
        $x_30_31 = "earnforfun_autorun" ascii //weight: 30
        $x_30_32 = "profitizeme_autorun" ascii //weight: 30
        $x_30_33 = "cashtitan_autorun" ascii //weight: 30
        $x_30_34 = "revenuestreaming_autorun" ascii //weight: 30
        $x_30_35 = "moneycharger_autorun" ascii //weight: 30
        $x_1_36 = ".?AV?$One1@VGuess@@" ascii //weight: 1
        $x_1_37 = ".?AVHstsHolder@@" ascii //weight: 1
        $x_1_38 = ".?AVCBanRot@@" ascii //weight: 1
        $x_1_39 = ".?AVCBHOLite@@" ascii //weight: 1
        $x_1_40 = ".?AVAdvertGnome@@" ascii //weight: 1
        $x_1_41 = ".?AVPikaPika@@" ascii //weight: 1
        $x_1_42 = ".?AVCDomainNameChanger@@" ascii //weight: 1
        $x_1_43 = ".?AVCQuickReloader@@" ascii //weight: 1
        $x_1_44 = ".?AVCBannerRotator@@" ascii //weight: 1
        $x_1_45 = ".?AVCLiteBHO@@" ascii //weight: 1
        $x_1_46 = ".?AVCShoopadoop@@" ascii //weight: 1
        $x_1_47 = ".?AVMapikapitapitooo@@" ascii //weight: 1
        $x_1_48 = ".?AVCKoopaboop@@" ascii //weight: 1
        $x_1_49 = ".?AVCkapitapi@@" ascii //weight: 1
        $x_1_50 = ".?AVBnnej3@@" ascii //weight: 1
        $x_1_51 = ".?AVPoleoei8@@" ascii //weight: 1
        $x_1_52 = ".?AVPoeiru@@" ascii //weight: 1
        $x_1_53 = ".?AVMuqpotropo@@" ascii //weight: 1
        $x_1_54 = ".?AVDekdjxtt@@" ascii //weight: 1
        $x_1_55 = ".?AVCsscs@@" ascii //weight: 1
        $x_1_56 = ".?AVIolemimio@@" ascii //weight: 1
        $x_1_57 = ".?AVLopertopinom@@" ascii //weight: 1
        $x_1_58 = ".?AVVoopsy@@" ascii //weight: 1
        $x_1_59 = ".?AVKopypo@@" ascii //weight: 1
        $x_1_60 = ".?AVAsqeduqi@@" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_30_*) and 2 of ($x_1_*))) or
            ((2 of ($x_30_*))) or
            (all of ($x*))
        )
}

rule AdRotator_42
{
    meta:
        author = "defender2yara"
        detection_name = "AdRotator"
        threat_id = "1692"
        severity = "33"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "832"
        strings_accuracy = "High"
    strings:
        $x_800_1 = "autorun" wide //weight: 800
        $x_30_2 = "cpmsky_" wide //weight: 30
        $x_30_3 = "gooochi_" wide //weight: 30
        $x_30_4 = "agadoo_" wide //weight: 30
        $x_30_5 = "superiorads_" wide //weight: 30
        $x_30_6 = "radbanner_" wide //weight: 30
        $x_30_7 = "primeadserving_" wide //weight: 30
        $x_30_8 = "voguecash_" wide //weight: 30
        $x_30_9 = "precisead_" wide //weight: 30
        $x_30_10 = "milehighads_" wide //weight: 30
        $x_30_11 = "du-little_" wide //weight: 30
        $x_30_12 = "adservefast_" wide //weight: 30
        $x_30_13 = "rightonadz_" wide //weight: 30
        $x_30_14 = "bannerstyle_" wide //weight: 30
        $x_30_15 = "addestination_" wide //weight: 30
        $x_30_16 = "banneradsgalore_" wide //weight: 30
        $x_30_17 = "blazingads_" wide //weight: 30
        $x_30_18 = "targetedbanner_" wide //weight: 30
        $x_30_19 = "bannerstyles_" wide //weight: 30
        $x_30_20 = "horizonads_" wide //weight: 30
        $x_30_21 = "chargeyourprofit_" wide //weight: 30
        $x_30_22 = "thesuperads_" wide //weight: 30
        $x_30_23 = "profitharbor_" wide //weight: 30
        $x_30_24 = "hotrevenue" wide //weight: 30
        $x_30_25 = "solads_" wide //weight: 30
        $x_30_26 = "snappyads_" wide //weight: 30
        $x_30_27 = "blueskyadagency_" wide //weight: 30
        $x_30_28 = "worldadmarketplace_" wide //weight: 30
        $x_30_29 = "ressrevenue_" wide //weight: 30
        $x_30_30 = "streamrevenue_" wide //weight: 30
        $x_30_31 = "incomeland_" wide //weight: 30
        $x_30_32 = "earnforfun_" wide //weight: 30
        $x_30_33 = "profitizeme_" wide //weight: 30
        $x_30_34 = "cashtitan_" wide //weight: 30
        $x_30_35 = "revenuestreaming" wide //weight: 30
        $x_30_36 = "moneycharger_" wide //weight: 30
        $x_1_37 = ".?AV?$One1@VGuess@@" ascii //weight: 1
        $x_1_38 = ".?AVHstsHolder@@" ascii //weight: 1
        $x_1_39 = ".?AVCBanRot@@" ascii //weight: 1
        $x_1_40 = ".?AVCBHOLite@@" ascii //weight: 1
        $x_1_41 = ".?AVAdvertGnome@@" ascii //weight: 1
        $x_1_42 = ".?AVPikaPika@@" ascii //weight: 1
        $x_1_43 = ".?AVCDomainNameChanger@@" ascii //weight: 1
        $x_1_44 = ".?AVCQuickReloader@@" ascii //weight: 1
        $x_1_45 = ".?AVCBannerRotator@@" ascii //weight: 1
        $x_1_46 = ".?AVCLiteBHO@@" ascii //weight: 1
        $x_1_47 = ".?AVCShoopadoop@@" ascii //weight: 1
        $x_1_48 = ".?AVMapikapitapitooo@@" ascii //weight: 1
        $x_1_49 = ".?AVCKoopaboop@@" ascii //weight: 1
        $x_1_50 = ".?AVCkapitapi@@" ascii //weight: 1
        $x_1_51 = ".?AVBnnej3@@" ascii //weight: 1
        $x_1_52 = ".?AVPoleoei8@@" ascii //weight: 1
        $x_1_53 = ".?AVPoeiru@@" ascii //weight: 1
        $x_1_54 = ".?AVMuqpotropo@@" ascii //weight: 1
        $x_1_55 = ".?AVDekdjxtt@@" ascii //weight: 1
        $x_1_56 = ".?AVCsscs@@" ascii //weight: 1
        $x_1_57 = ".?AVIolemimio@@" ascii //weight: 1
        $x_1_58 = ".?AVLopertopinom@@" ascii //weight: 1
        $x_1_59 = ".?AVVoopsy@@" ascii //weight: 1
        $x_1_60 = ".?AVKopypo@@" ascii //weight: 1
        $x_1_61 = ".?AVAsqeduqi@@" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((27 of ($x_30_*) and 22 of ($x_1_*))) or
            ((28 of ($x_30_*))) or
            ((1 of ($x_800_*) and 1 of ($x_30_*) and 2 of ($x_1_*))) or
            ((1 of ($x_800_*) and 2 of ($x_30_*))) or
            (all of ($x*))
        )
}

rule AdRotator_43
{
    meta:
        author = "defender2yara"
        detection_name = "AdRotator"
        threat_id = "1692"
        severity = "33"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "3"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = "VMware_Virtual" wide //weight: 1
        $x_1_2 = "irtual_HD" wide //weight: 1
        $x_1_3 = "Virtual_HDD" wide //weight: 1
        $x_1_4 = "VMware SVGA" wide //weight: 1
        $x_1_5 = "Virtual PC" wide //weight: 1
        $x_1_6 = "{0}/mod/forbid.php?net={1}&v={2}" wide //weight: 1
        $x_1_7 = "{0}/mod/notify.php?res=success&aff={1}&hw={2}" wide //weight: 1
        $x_1_8 = "{0}/mod/unotify.php?aff={1}&hw={2}" wide //weight: 1
        $x_1_9 = "{0}/mod/fkdm_db2.php?net={1}&v={2}" wide //weight: 1
        $x_1_10 = "{0} {1}_{2}" wide //weight: 1
        $x_1_11 = {54 00 65 00 6d 00 70 00 6f 00 72 00 61 00 72 00 79 00 20 00 49 00 6e 00 74 00 65 00 72 00 6e 00 65 00 74 00 20 00 46 00 69 00 6c 00 65 00 73 00 00 00 6c 00 6f 00 77 00}  //weight: 1, accuracy: High
        $x_1_12 = {33 d8 8b 46 08 03 c2 66 89 5d 08 66 8b 5d 08 66 33 18 8b 06 4a 66 89 1c 01}  //weight: 1, accuracy: High
        $x_1_13 = {33 d8 66 89 5d 08 8b 46 08 66 8b 5d 08 03 c2 66 33 18 8b 06 66 89 1c 48}  //weight: 1, accuracy: High
        $x_1_14 = {33 c3 88 45 ff 0f b6 45 ff 83 ?? ?? 88 45 ff 8a 45 ff 32 01 8b 5e ?? 88 04 1a}  //weight: 1, accuracy: Low
        $x_1_15 = {33 d1 8b 4e 08 88 54 24 08 0f b6 54 24 08 2b c8 8a 49 ?? 32 d1 8b 0e 88 14 08}  //weight: 1, accuracy: Low
        $x_1_16 = {8b 4b 10 66 8b 0c 01 66 33 4b 08 8b 53 0c 66 89 0c 10}  //weight: 1, accuracy: High
        $x_1_17 = {eb 09 8b 4c 24 04 8a 09 30 08 40 3b 44 24 08 75 f1 c2 08 00}  //weight: 1, accuracy: High
        $x_1_18 = {8a 4c 24 04 3b c2 74 0a 30 08 0f be 08 40 3b c2 75 f6}  //weight: 1, accuracy: High
        $x_1_19 = {74 10 8a 4c 24 0c 30 08 0f be 08 40 3b 44 24 08 75 f4}  //weight: 1, accuracy: High
        $x_1_20 = {eb 06 30 08 0f be 08 40 3b 44 24 04 75 f4}  //weight: 1, accuracy: High
        $x_1_21 = {8b 44 24 04 eb 04 80 00 8f 40 3b 44 24 08 75 f6 c2 08 00}  //weight: 1, accuracy: High
        $x_1_22 = {66 33 3c 02 ff (4d|6d) 0c 8b 19 66 89 3c 1e 75 ee 66 8b 3c 02 66 33 38}  //weight: 1, accuracy: Low
        $x_1_23 = "revenuestreaming" wide //weight: 1
        $x_1_24 = "clickbuster" wide //weight: 1
        $x_1_25 = "earnforfun" wide //weight: 1
        $x_1_26 = "expressrevenue" wide //weight: 1
        $x_1_27 = "cashtitan" wide //weight: 1
        $x_1_28 = "hotrevenue" wide //weight: 1
        $x_1_29 = "topgearmoney" wide //weight: 1
        $x_1_30 = "voguecash" wide //weight: 1
        $x_1_31 = "brincome" wide //weight: 1
        $x_1_32 = "yourprofitclub" wide //weight: 1
        $x_1_33 = "findyourprofitsky" wide //weight: 1
        $x_1_34 = "profithand" wide //weight: 1
        $x_1_35 = "profitaction" wide //weight: 1
        $x_1_36 = "lightspeedincome" wide //weight: 1
        $x_1_37 = "yourmoneybox" wide //weight: 1
        $x_1_38 = "qualityads" wide //weight: 1
        $x_1_39 = "incrediads" wide //weight: 1
        $x_1_40 = "vanillaclicks" wide //weight: 1
        $x_1_41 = "uberclicks" wide //weight: 1
        $x_1_42 = "advertzilla" wide //weight: 1
        $x_1_43 = "extrafind" wide //weight: 1
        $x_1_44 = "searchenginesuggestor" wide //weight: 1
        $x_1_45 = "keywordsuggestor" wide //weight: 1
        $x_1_46 = "adsflow" wide //weight: 1
        $x_1_47 = "internetspooler" wide //weight: 1
        $x_1_48 = "Advertzil1a" wide //weight: 1
        $x_1_49 = ".?AVLopertopinom@@" ascii //weight: 1
        $x_1_50 = ".?AVVoopsy@@" ascii //weight: 1
        $x_1_51 = ".?AVKopypo@@" ascii //weight: 1
        $x_1_52 = ".?AVAsqeduqi@@" ascii //weight: 1
        $x_1_53 = ".?AVNoepwksdq@@" ascii //weight: 1
        $x_1_54 = ".?AVPeoslkwsl112@@" ascii //weight: 1
        $x_1_55 = ".?AVCeopdiejklelw@@" ascii //weight: 1
        $x_1_56 = ".?AVMmekjdkeobx@@" ascii //weight: 1
        $x_1_57 = ".?AVKdnopoppopopo@@" ascii //weight: 1
        $x_1_58 = ".?AVLoepwksxm@@" ascii //weight: 1
        $x_1_59 = ".?AVPqqrprtu@@" ascii //weight: 1
        $x_1_60 = {8b 54 24 04 8a 14 10 8b 4e 04 88 14 08 40 83 f8 ?? 76 ed}  //weight: 1, accuracy: Low
        $x_1_61 = {83 ef 28 b8 67 66 66 66 f7 ef c1 fa 04 8b c2 c1 e8 1f 03 c2 83 c4 08 83 ee 28 83 f8 01}  //weight: 1, accuracy: High
        $x_1_62 = {89 55 08 83 65 fc 00 8b 4d 0c 8b 39 89 3a 83 21 00 83 4d fc ff}  //weight: 1, accuracy: High
        $x_1_63 = {8a 14 1a 8a c2 02 c0 02 d0 c0 e2 ?? 80 fa ?? 7d}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (3 of ($x*))
}

rule CnsMin_0
{
    meta:
        author = "defender2yara"
        detection_name = "CnsMin"
        threat_id = "3782"
        severity = "153"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "assist\\CnsMinKP." ascii //weight: 1
        $x_1_2 = "3721\\Assist\\Modules" ascii //weight: 1
        $x_1_3 = "CatchSexStyle" ascii //weight: 1
        $x_1_4 = "\\msinfosys.dll" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule CnsMin_1
{
    meta:
        author = "defender2yara"
        detection_name = "CnsMin"
        threat_id = "3782"
        severity = "153"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "System\\CurrentControlSet\\Services\\CnsMinKP" ascii //weight: 1
        $x_1_2 = {63 6e 73 6d 69 6e 2e 64 6c 6c 00 00 44 6c 6c 55 6e 72 65 67 69 73 74 65 72 53 65 72 76 65 72}  //weight: 1, accuracy: High
        $x_1_3 = "%s\\ycns.dat" ascii //weight: 1
        $x_1_4 = "\\3721\\AutoLive" ascii //weight: 1
        $x_1_5 = "\\drivers\\msdrivs.sys" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (4 of ($x*))
}

rule CnsMin_2
{
    meta:
        author = "defender2yara"
        detection_name = "CnsMin"
        threat_id = "3782"
        severity = "153"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "11"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "\\\\.\\Global\\CnsMinKP" ascii //weight: 2
        $x_2_2 = "\\\\.\\CnsMinKP.Vxd" ascii //weight: 2
        $x_4_3 = "%scnsdtu.cab" ascii //weight: 4
        $x_3_4 = "%s3721\\cns1.dat" ascii //weight: 3
        $x_1_5 = "%scns.dat" ascii //weight: 1
        $x_1_6 = "cns1u.cpr" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_4_*) and 1 of ($x_3_*) and 1 of ($x_2_*) and 2 of ($x_1_*))) or
            ((1 of ($x_4_*) and 1 of ($x_3_*) and 2 of ($x_2_*))) or
            (all of ($x*))
        )
}

rule CnsMin_3
{
    meta:
        author = "defender2yara"
        detection_name = "CnsMin"
        threat_id = "3782"
        severity = "153"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = "Software\\3721\\Cns" ascii //weight: 1
        $x_1_2 = "3721Helper_CNS" ascii //weight: 1
        $x_1_3 = "CNSHelperMutex" ascii //weight: 1
        $x_1_4 = {53 74 61 72 74 52 65 66 65 72 65 72 [0-4] 61 6c 72 65 78 2e 64 6c 6c}  //weight: 1, accuracy: Low
        $x_1_5 = "AutoLive\\alrex" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (4 of ($x*))
}

rule CnsMin_4
{
    meta:
        author = "defender2yara"
        detection_name = "CnsMin"
        threat_id = "3782"
        severity = "153"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "7"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "K89657MUTEX_REMOTE" ascii //weight: 2
        $x_2_2 = "75048700-EF1F-11D0-9888-006097DEACF9}\\Count\\HRZR_EHAC" ascii //weight: 2
        $x_2_3 = "download.3721.com/download" ascii //weight: 2
        $x_1_4 = "CdnClient" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule CnsMin_5
{
    meta:
        author = "defender2yara"
        detection_name = "CnsMin"
        threat_id = "3782"
        severity = "153"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {63 6e 73 69 6e 73 74 68 6c 70 65 72 2e 64 6c 6c 00 66 75 6e 63}  //weight: 1, accuracy: High
        $x_1_2 = {77 69 6e 69 6e 69 74 2e 69 6e 69 00 5c [0-4] 44 4f 57 4e 4c 4f 7e 31 5c 43 4e 53 00}  //weight: 1, accuracy: Low
        $x_1_3 = "SYSTEM\\CurrentControlSet\\Control\\Session Manager" ascii //weight: 1
        $x_1_4 = "PendingFileRenameOperations" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule CnsMin_6
{
    meta:
        author = "defender2yara"
        detection_name = "CnsMin"
        threat_id = "3782"
        severity = "153"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "10"
        strings_accuracy = "High"
    strings:
        $x_3_1 = "\\\\.\\CnsMinKP.vxd" ascii //weight: 3
        $x_1_2 = "idnmail.exe" ascii //weight: 1
        $x_1_3 = "cnnic" ascii //weight: 1
        $x_1_4 = "bdbar.exe" ascii //weight: 1
        $x_1_5 = "setup_bd.exe" ascii //weight: 1
        $x_1_6 = "hjbar.exe" ascii //weight: 1
        $x_3_7 = "CLSID\\{BB936323-19FA-4521-BA29-ECA6A121BC78}" ascii //weight: 3
        $x_3_8 = "Software\\CNREDIRECT" ascii //weight: 3
    condition:
        (filesize < 20MB) and
        (
            ((2 of ($x_3_*) and 4 of ($x_1_*))) or
            ((3 of ($x_3_*) and 1 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule CnsMin_7
{
    meta:
        author = "defender2yara"
        detection_name = "CnsMin"
        threat_id = "3782"
        severity = "153"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "23"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "cnsio.dll" ascii //weight: 2
        $x_1_2 = "AddChinAddr" ascii //weight: 1
        $x_1_3 = "DelChinAddr" ascii //weight: 1
        $x_1_4 = "SetSwitch" ascii //weight: 1
        $x_3_5 = "CnsMinChinAddrAutoCompleteMutex" ascii //weight: 3
        $x_2_6 = "cns_temp/" ascii //weight: 2
        $x_2_7 = "cns_temp\\" ascii //weight: 2
        $x_3_8 = "CnsMinAutoCompleteFMapStr" ascii //weight: 3
        $x_5_9 = "Software\\3721\\CnsUrl" ascii //weight: 5
        $x_5_10 = "Software\\3721\\CnsMin" ascii //weight: 5
    condition:
        (filesize < 20MB) and
        (
            ((2 of ($x_5_*) and 2 of ($x_3_*) and 2 of ($x_2_*) and 3 of ($x_1_*))) or
            ((2 of ($x_5_*) and 2 of ($x_3_*) and 3 of ($x_2_*) and 1 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule CnsMin_8
{
    meta:
        author = "defender2yara"
        detection_name = "CnsMin"
        threat_id = "3782"
        severity = "153"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "11"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "\\\\.\\Global\\CnsMinKP" ascii //weight: 2
        $x_2_2 = "\\\\.\\CnsMinKP.Vxd" ascii //weight: 2
        $x_2_3 = "CnsMinDT.dll" ascii //weight: 2
        $x_2_4 = "System\\CurrentControlSet\\Services\\CnsMinKP" ascii //weight: 2
        $x_2_5 = "{C22D6D40-47D8-40fe-825A-CC7F4D88B3B8}" ascii //weight: 2
        $x_2_6 = "Software\\3721\\CnsMin\\Variant" ascii //weight: 2
        $x_1_7 = "CNSCFGF.DAT" ascii //weight: 1
        $x_1_8 = "CNSMIN.DAT" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((5 of ($x_2_*) and 1 of ($x_1_*))) or
            ((6 of ($x_2_*))) or
            (all of ($x*))
        )
}

rule CnsMin_9
{
    meta:
        author = "defender2yara"
        detection_name = "CnsMin"
        threat_id = "3782"
        severity = "153"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "14"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "cnshint.dll" ascii //weight: 2
        $x_2_2 = "\\CnsMinIO.dll" ascii //weight: 2
        $x_2_3 = "CLSID\\{B83FC273-3522-4CC6-92EC-75CC86678DA4}\\InprocServer32" ascii //weight: 2
        $x_2_4 = "3721CnsBarProp" ascii //weight: 2
        $x_2_5 = "CnsTips" ascii //weight: 2
        $x_2_6 = "CNSCollect" ascii //weight: 2
        $x_2_7 = "cnsplus.dll" ascii //weight: 2
        $x_2_8 = "SOFTWARE\\Microsoft\\Internet Explorer\\AdvancedOptions\\!CNS" ascii //weight: 2
        $x_2_9 = "http://cns.3721.com/cns.dll?" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (7 of ($x*))
}

rule CnsMin_10
{
    meta:
        author = "defender2yara"
        detection_name = "CnsMin"
        threat_id = "3782"
        severity = "153"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "14"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "\\\\.\\Global\\CnsMinKP" ascii //weight: 2
        $x_2_2 = "\\\\.\\CnsMinKP.Vxd" ascii //weight: 2
        $x_1_3 = "CnsMinEx.dll" ascii //weight: 1
        $x_1_4 = "Software\\3721\\CnsMin" ascii //weight: 1
        $x_2_5 = "http://seek.3721.com/srchasst.htm" ascii //weight: 2
        $x_1_6 = "\\cns.dll" ascii //weight: 1
        $x_1_7 = "\\cns.exe" ascii //weight: 1
        $x_1_8 = "CnsMinHK.CnsHook.1" ascii //weight: 1
        $x_1_9 = "CLSID\\{A5ADEAE7-A8B4-4F94-9128-BF8D8DB5E927}" ascii //weight: 1
        $x_1_10 = "CnsHook.dll" ascii //weight: 1
        $x_2_11 = "http://download.3721.com/download/CnsMinExM.ini" ascii //weight: 2
        $x_2_12 = "%sCnsMinSe.dll" ascii //weight: 2
        $x_1_13 = "CnsMinUp.cab" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((3 of ($x_2_*) and 8 of ($x_1_*))) or
            ((4 of ($x_2_*) and 6 of ($x_1_*))) or
            ((5 of ($x_2_*) and 4 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule CnsMin_11
{
    meta:
        author = "defender2yara"
        detection_name = "CnsMin"
        threat_id = "3782"
        severity = "153"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "12"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "CNSSearch" ascii //weight: 2
        $x_2_2 = "CnsMinCg.ini" ascii //weight: 2
        $x_2_3 = "http://assistant.3721.com/help/uninstcns.htm" ascii //weight: 2
        $x_2_4 = "download.3721.com/download/cns" ascii //weight: 2
        $x_2_5 = "CnsHook.dll" ascii //weight: 2
        $x_2_6 = "Software\\3721\\CnsMin\\CnsMinEx" ascii //weight: 2
        $x_2_7 = "Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Browser Helper Objects\\{D157330A-9EF3-49F8-9A67-4141AC41ADD4}" ascii //weight: 2
        $x_2_8 = "System\\CurrentControlSet\\Services\\CnsMinKP" ascii //weight: 2
        $x_2_9 = "cnsmin.dat" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (6 of ($x*))
}

rule CnsMin_12
{
    meta:
        author = "defender2yara"
        detection_name = "CnsMin"
        threat_id = "3782"
        severity = "153"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "15"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "3721CnsBarProp" ascii //weight: 2
        $x_2_2 = "CnsHint.dll" ascii //weight: 2
        $x_2_3 = "CLSID\\{B83FC273-3522-4CC6-92EC-75CC86678DA4}\\InprocServer32" ascii //weight: 2
        $x_2_4 = "Software\\3721\\Assist\\Plugins" ascii //weight: 2
        $x_1_5 = "%s,RunSettings -repairie" ascii //weight: 1
        $x_2_6 = "CNSEnable" ascii //weight: 2
        $x_2_7 = "System\\CurrentControlSet\\Services\\CnsMinKP" ascii //weight: 2
        $x_1_8 = "AssisantShare" ascii //weight: 1
        $x_2_9 = "Uninstall\\{1B0E7716-898E-48cc-9690-4E338E8DE1D3}" ascii //weight: 2
        $x_2_10 = "http://cns.3721.com/cns.dll?" ascii //weight: 2
        $x_2_11 = "AssistantRegisterUserMutex" ascii //weight: 2
        $x_2_12 = "3721Helper_CNS" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (
            ((7 of ($x_2_*) and 1 of ($x_1_*))) or
            ((8 of ($x_2_*))) or
            (all of ($x*))
        )
}

rule CnsMin_13
{
    meta:
        author = "defender2yara"
        detection_name = "CnsMin"
        threat_id = "3782"
        severity = "153"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "20"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "CnsMin.DLL" ascii //weight: 2
        $x_2_2 = "software\\InterChina\\Chin@ddress" ascii //weight: 2
        $x_2_3 = "chinaddrmainmutexstr" ascii //weight: 2
        $x_4_4 = "http://assistant.3721.com/instok" ascii //weight: 4
        $x_2_5 = "software\\3721\\CnsMin" ascii //weight: 2
        $x_2_6 = "assistcns" ascii //weight: 2
        $x_4_7 = "http://download.3721.com/download/CnsMinUp" ascii //weight: 4
        $x_2_8 = "\\\\.\\CnsMinKP.Vxd" ascii //weight: 2
        $x_2_9 = "System\\CurrentControlSet\\Services\\CnsMinKP" ascii //weight: 2
        $x_2_10 = "CLSID\\{7CA83CF1-3AEA-42D0-A4E3-1594FC6E48B2}\\InprocServer32" ascii //weight: 2
        $x_3_11 = "CnsMinCg.ini" ascii //weight: 3
        $x_4_12 = "CnsAutoUpdateMutex" ascii //weight: 4
        $x_4_13 = "CnsMinBypassNameMutex" ascii //weight: 4
        $x_3_14 = "Software\\3721\\CnsMin\\Variant" ascii //weight: 3
    condition:
        (filesize < 20MB) and
        (
            ((2 of ($x_3_*) and 7 of ($x_2_*))) or
            ((1 of ($x_4_*) and 8 of ($x_2_*))) or
            ((1 of ($x_4_*) and 1 of ($x_3_*) and 7 of ($x_2_*))) or
            ((1 of ($x_4_*) and 2 of ($x_3_*) and 5 of ($x_2_*))) or
            ((2 of ($x_4_*) and 6 of ($x_2_*))) or
            ((2 of ($x_4_*) and 1 of ($x_3_*) and 5 of ($x_2_*))) or
            ((2 of ($x_4_*) and 2 of ($x_3_*) and 3 of ($x_2_*))) or
            ((3 of ($x_4_*) and 4 of ($x_2_*))) or
            ((3 of ($x_4_*) and 1 of ($x_3_*) and 3 of ($x_2_*))) or
            ((3 of ($x_4_*) and 2 of ($x_3_*) and 1 of ($x_2_*))) or
            ((4 of ($x_4_*) and 2 of ($x_2_*))) or
            ((4 of ($x_4_*) and 1 of ($x_3_*) and 1 of ($x_2_*))) or
            ((4 of ($x_4_*) and 2 of ($x_3_*))) or
            (all of ($x*))
        )
}

rule CnsMin_14
{
    meta:
        author = "defender2yara"
        detection_name = "CnsMin"
        threat_id = "3782"
        severity = "153"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "10"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "cns.dat" ascii //weight: 2
        $x_2_2 = "\\SystemRoot\\cnsinfo.dat" wide //weight: 2
        $x_2_3 = "\\Registry\\Machine\\Software\\CNREDIRECT" wide //weight: 2
        $x_2_4 = "\\SystemRoot\\System32\\cns.dll" wide //weight: 2
        $x_2_5 = "\\SystemRoot\\System32\\cns.exe" wide //weight: 2
        $x_2_6 = "\\Device\\CnsMinKP" wide //weight: 2
        $x_2_7 = "\\DosDevices\\CnsMinKP" wide //weight: 2
        $x_2_8 = "CnsminKP" ascii //weight: 2
        $x_2_9 = "{D157330A-9EF3-49F8-9A67-4141AC41ADD4}" wide //weight: 2
        $x_2_10 = "\\BaseNamedObjects\\CnsMinKPEvent" wide //weight: 2
    condition:
        (filesize < 20MB) and
        (5 of ($x*))
}

rule CnsMin_15
{
    meta:
        author = "defender2yara"
        detection_name = "CnsMin"
        threat_id = "3782"
        severity = "153"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "11"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Software\\3721\\CnsMin" ascii //weight: 1
        $x_1_2 = "http://auto.search." ascii //weight: 1
        $x_2_3 = "cns.dll?" ascii //weight: 2
        $x_2_4 = "cns.3721.com" ascii //weight: 2
        $x_1_5 = "DelChinAddr" ascii //weight: 1
        $x_1_6 = "SOFTWARE\\Microsoft\\Internet Explorer\\AdvancedOptions\\!CNS\\Reset" ascii //weight: 1
        $x_1_7 = "SOFTWARE\\Microsoft\\Internet Explorer\\AdvancedOptions\\!CNS\\List" ascii //weight: 1
        $x_2_8 = "Software\\3721\\InputCns" ascii //weight: 2
        $x_2_9 = "Software\\3721\\CnsUrl" ascii //weight: 2
        $n_50_10 = "http://www.jword.jp/" ascii //weight: -50
    condition:
        (filesize < 20MB) and
        (not (any of ($n*))) and
        (
            ((3 of ($x_2_*) and 5 of ($x_1_*))) or
            ((4 of ($x_2_*) and 3 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule Coulomb_0
{
    meta:
        author = "defender2yara"
        detection_name = "Coulomb"
        threat_id = "3931"
        severity = "3"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "10"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "dload.ipbill.com" ascii //weight: 2
        $x_2_2 = "GET /exit HTTP/1.0" ascii //weight: 2
        $x_2_3 = "http://127.0.0.1:8081/dial.html?" ascii //weight: 2
        $x_2_4 = "GeoTargetting" ascii //weight: 2
        $x_2_5 = "DiallerClass" ascii //weight: 2
        $x_2_6 = "/dlrdir.html" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (5 of ($x*))
}

rule Coulomb_1
{
    meta:
        author = "defender2yara"
        detection_name = "Coulomb"
        threat_id = "3931"
        severity = "3"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "9"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "Software\\Coulomb" ascii //weight: 2
        $x_3_2 = "/del/dlrdir.html?DiallerIP=%s&dialled=%s&site=%s&did=%s&udata=%s&country=%" ascii //weight: 3
        $x_3_3 = "http://127.0.0.1:8089/index.html?" ascii //weight: 3
        $x_1_4 = "DiallerClass" ascii //weight: 1
        $x_1_5 = "exitpp.html" ascii //weight: 1
        $x_1_6 = "ccard.ipbill.com" ascii //weight: 1
        $x_1_7 = "GET /exit HTTP/1.0" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_3_*) and 1 of ($x_2_*) and 4 of ($x_1_*))) or
            ((2 of ($x_3_*) and 3 of ($x_1_*))) or
            ((2 of ($x_3_*) and 1 of ($x_2_*) and 1 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule Coulomb_2
{
    meta:
        author = "defender2yara"
        detection_name = "Coulomb"
        threat_id = "3931"
        severity = "3"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "8"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "Software\\Coulomb" ascii //weight: 2
        $x_3_2 = "/del/dlrdir.html?DiallerIP=%s&dialled=%s&site=%s&did=%s&udata=%s&country=%" ascii //weight: 3
        $x_1_3 = "Incorrect PIN entered" ascii //weight: 1
        $x_2_4 = "E-mail addresses don't match - please check and correct" ascii //weight: 2
        $x_2_5 = "Coulomb BrowserWWW" ascii //weight: 2
        $x_1_6 = "ATLBROWSERLibWWW" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((3 of ($x_2_*) and 2 of ($x_1_*))) or
            ((1 of ($x_3_*) and 2 of ($x_2_*) and 1 of ($x_1_*))) or
            ((1 of ($x_3_*) and 3 of ($x_2_*))) or
            (all of ($x*))
        )
}

rule Coolwebsearch_J_0
{
    meta:
        author = "defender2yara"
        detection_name = "Coolwebsearch.J"
        threat_id = "4092"
        severity = "57"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "7"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "CLSID\\{98DBBF16-CA43-4c33-BE80-99E6694468A4}" ascii //weight: 1
        $x_1_2 = "Software\\Microsoft\\Internet Explorer\\Vendor" ascii //weight: 1
        $x_1_3 = "KillExe" ascii //weight: 1
        $x_1_4 = "RAPDOS.dll" ascii //weight: 1
        $x_1_5 = "[InternetShortcut]" ascii //weight: 1
        $x_1_6 = "\\regedit.exe /s" ascii //weight: 1
        $x_1_7 = "[_task]" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Coolwebsearch_J_1
{
    meta:
        author = "defender2yara"
        detection_name = "Coolwebsearch.J"
        threat_id = "4092"
        severity = "57"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "{FD9BC004-8331-4457-B830-4759FF704C22}" ascii //weight: 1
        $x_1_2 = "SearchHook.SearchHookObject.1" ascii //weight: 1
        $x_1_3 = "SearchHook.DLL" ascii //weight: 1
        $x_1_4 = "http://www.search-aid.com/search.php?qq=" wide //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule DialXS_0
{
    meta:
        author = "defender2yara"
        detection_name = "DialXS"
        threat_id = "4411"
        severity = "Low"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "8"
        strings_accuracy = "High"
    strings:
        $x_1_1 = ".nl/" ascii //weight: 1
        $x_3_2 = "(C)DialXS" ascii //weight: 3
        $x_2_3 = "License voilated" ascii //weight: 2
        $x_1_4 = "RasSetEntryPropertiesA" ascii //weight: 1
        $x_1_5 = "ProxyEnable" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule DialXS_1
{
    meta:
        author = "defender2yara"
        detection_name = "DialXS"
        threat_id = "4411"
        severity = "Low"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "10"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "DialXS.Ocx" ascii //weight: 1
        $x_2_2 = "DialXSWndClass" ascii //weight: 2
        $x_1_3 = "DialXS.HLP" ascii //weight: 1
        $x_2_4 = "DialXSCtl" ascii //weight: 2
        $x_2_5 = "(C)DialXS, http://dialxs.nl" ascii //weight: 2
        $x_2_6 = "http://x0.nl/install/" ascii //weight: 2
        $x_2_7 = "http://dialxs.nl/install/" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (
            ((4 of ($x_2_*) and 2 of ($x_1_*))) or
            ((5 of ($x_2_*))) or
            (all of ($x*))
        )
}

rule Hotbar_0
{
    meta:
        author = "defender2yara"
        detection_name = "Hotbar"
        threat_id = "6204"
        severity = "10"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "12"
        strings_accuracy = "High"
    strings:
        $x_10_1 = "source_sa\\Bin\\Release\\Setup.pdb" ascii //weight: 10
        $x_1_2 = "Smart Shopper" ascii //weight: 1
        $x_1_3 = "Zango" ascii //weight: 1
        $x_1_4 = "appbundler.com" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_10_*) and 2 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule Hotbar_1
{
    meta:
        author = "defender2yara"
        detection_name = "Hotbar"
        threat_id = "6204"
        severity = "10"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "CntntCntr.CntntDisp" wide //weight: 1
        $x_1_2 = "http://hotbar.com" ascii //weight: 1
        $x_1_3 = "javascript:window.open" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Hotbar_2
{
    meta:
        author = "defender2yara"
        detection_name = "Hotbar"
        threat_id = "6204"
        severity = "10"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "41"
        strings_accuracy = "High"
    strings:
        $x_10_1 = "HbHostOEPath" ascii //weight: 10
        $x_10_2 = "Outlook Express Browser Class" ascii //weight: 10
        $x_10_3 = "hbhostol.dll" ascii //weight: 10
        $x_10_4 = "HbHostOE.DLL" ascii //weight: 10
        $x_1_5 = "Software\\Zango\\Zango\\" ascii //weight: 1
        $x_1_6 = "Software\\Seekmo\\Seekmo\\" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((4 of ($x_10_*) and 1 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule Hotbar_3
{
    meta:
        author = "defender2yara"
        detection_name = "Hotbar"
        threat_id = "6204"
        severity = "10"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "ZangoSAHook.dll" ascii //weight: 1
        $x_1_2 = "seekmosa|zangosa|sbusa|hotbarsa" ascii //weight: 1
        $x_1_3 = "Software\\Zango" ascii //weight: 1
        $x_1_4 = "180search Assistant" ascii //weight: 1
        $n_4_5 = "eAcceleration Corp" wide //weight: -4
    condition:
        (filesize < 20MB) and
        (not (any of ($n*))) and
        (3 of ($x*))
}

rule Hotbar_4
{
    meta:
        author = "defender2yara"
        detection_name = "Hotbar"
        threat_id = "6204"
        severity = "10"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "2"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {48 62 54 6f 6f 6c 62 61 72 2e 44 4c 4c 00 44 6c 6c 43 61 6e 55 6e 6c 6f 61 64 4e 6f 77 00 44 6c 6c 47 65 74 43 6c 61 73 73 4f 62 6a 65 63 74 00 44 6c 6c 52 65 67 69 73 74 65 72 53 65 72 76 65 72 00 44 6c 6c 54 56 52 65 6d 6f 74 65 45 78 65 63 00 44 6c 6c 55 6e 72 65 67 69 73 74 65 72 53 65 72 76 65 72}  //weight: 1, accuracy: High
        $x_1_2 = "CHbToolbarCtl::OnAdServerReturn" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Hotbar_5
{
    meta:
        author = "defender2yara"
        detection_name = "Hotbar"
        threat_id = "6204"
        severity = "10"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "GetLastActivePopup" ascii //weight: 1
        $x_1_2 = "B60B6603-ACCF-4ce9-BF54-D59DEE0EAAC6" wide //weight: 1
        $x_1_3 = "http://open/?url=" ascii //weight: 1
        $x_1_4 = "its.not.ok" ascii //weight: 1
        $x_1_5 = "\\hotbar_release\\" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Hotbar_6
{
    meta:
        author = "defender2yara"
        detection_name = "Hotbar"
        threat_id = "6204"
        severity = "10"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "7"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "installs.hotbar.com" ascii //weight: 1
        $x_1_2 = "Software\\Zango\\Zango\\" ascii //weight: 1
        $x_1_3 = "zango.com" ascii //weight: 1
        $x_1_4 = "HBInstIE.DLL" ascii //weight: 1
        $x_1_5 = "installs.zango.com" ascii //weight: 1
        $x_1_6 = ".?AUIHbInstObj@@" ascii //weight: 1
        $x_1_7 = "InstIE.HbInstObj" wide //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Hotbar_7
{
    meta:
        author = "defender2yara"
        detection_name = "Hotbar"
        threat_id = "6204"
        severity = "10"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "108"
        strings_accuracy = "High"
    strings:
        $x_100_1 = {00 00 53 6f 66 74 77 61 72 65 5c 48 6f 74 62 61 72 5c 48 6f 74 62 61 72 5c 00 53 6f 66 74 77 61 72 65 5c 48 6f 74 62 61 72 5c 00 00 00 00}  //weight: 100, accuracy: High
        $x_2_2 = "Hotbar\\bin" ascii //weight: 2
        $x_2_3 = "Software\\Hotbar" ascii //weight: 2
        $x_2_4 = "hotbar.com" ascii //weight: 2
        $x_1_5 = "InternetConnectA" ascii //weight: 1
        $x_1_6 = "SOFTWARE\\Microsoft\\Windows\\CurrentVersion" ascii //weight: 1
        $x_1_7 = "hbinst" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_100_*) and 3 of ($x_2_*) and 2 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule Hotbar_8
{
    meta:
        author = "defender2yara"
        detection_name = "Hotbar"
        threat_id = "6204"
        severity = "10"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Pinball.vbp" wide //weight: 1
        $x_1_2 = "origin-ics.hotbar.com" wide //weight: 1
        $x_1_3 = "installerDomain=config.hotbar.com" wide //weight: 1
        $x_1_4 = "&v.method=popover" wide //weight: 1
    condition:
        (filesize < 20MB) and
        (3 of ($x*))
}

rule Hotbar_9
{
    meta:
        author = "defender2yara"
        detection_name = "Hotbar"
        threat_id = "6204"
        severity = "10"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_10_1 = "Pinball Corporation" wide //weight: 10
        $x_1_2 = "npclntax_HBLiteSA.dll" ascii //weight: 1
        $x_1_3 = "SOAPActionWeather" ascii //weight: 1
        $x_1_4 = "\\WeSkin.pdb" ascii //weight: 1
        $x_1_5 = "Seekmo Privacy Mode" wide //weight: 1
        $x_1_6 = {53 65 74 75 70 2e 64 6c 6c 00 56 65 72 69 66 79 53 69 67 6e 61 74 75 72 65}  //weight: 1, accuracy: High
        $x_1_7 = {47 65 74 4e 43 4d 59 42 46 69 6c 65 56 65 72 73 69 6f 6e 00 47 65 74 4e 43 4d 59 42 46 69 6c 65 56 65 72 73 69 6f 6e 4d 61 6a 6f 72}  //weight: 1, accuracy: High
        $x_1_8 = {47 65 74 45 6c 65 76 61 74 69 6f 6e 54 79 70 65 00 49 73 45 6c 65 76 61 74 65 64}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_1_*))) or
            ((1 of ($x_10_*))) or
            (all of ($x*))
        )
}

rule Hotbar_10
{
    meta:
        author = "defender2yara"
        detection_name = "Hotbar"
        threat_id = "6204"
        severity = "10"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "15"
        strings_accuracy = "High"
    strings:
        $x_5_1 = "This ad is from Hotbar and not from the site visited - click here for more information." ascii //weight: 5
        $x_1_2 = "http://cts.hotbar.com/" ascii //weight: 1
        $x_1_3 = "http://ping.180solutions.com" ascii //weight: 1
        $x_1_4 = "http://downloads.180solutions.com/" ascii //weight: 1
        $x_1_5 = "http://bis.180solutions.com/" ascii //weight: 1
        $x_1_6 = "nowhere.180solutions.com" ascii //weight: 1
        $x_1_7 = "tv.hotbar.com/" ascii //weight: 1
        $x_1_8 = "uploads.180solutions.com" ascii //weight: 1
        $x_1_9 = "http://www.hotbar.com" ascii //weight: 1
        $x_5_10 = "HotBar.com, Inc." wide //weight: 5
    condition:
        (filesize < 20MB) and
        (
            ((2 of ($x_5_*) and 5 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule Hotbar_11
{
    meta:
        author = "defender2yara"
        detection_name = "Hotbar"
        threat_id = "6204"
        severity = "10"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "16"
        strings_accuracy = "High"
    strings:
        $x_5_1 = "%s search assistant" ascii //weight: 5
        $x_5_2 = {4f 6e 65 38 54 53 6f 6c 75 74 69 6f 6e 73 50 40 73 73 57 25 72 64 00}  //weight: 5, accuracy: High
        $x_1_3 = {4f 6e 65 38 54 53 6f 6c 75 74 69 6f 6e 73 53 69 67 6e 40 74 75 72 33 00}  //weight: 1, accuracy: High
        $x_1_4 = {4f 6e 65 38 54 53 6f 6c 75 74 69 6f 6e 73 43 6f 6e 74 40 69 6e 33 72 4e 40 6d 65 00}  //weight: 1, accuracy: High
        $x_1_5 = "Bkup_ad_url" ascii //weight: 1
        $x_1_6 = "software\\zango" ascii //weight: 1
        $x_1_7 = {77 6d 5f 73 68 6f 77 5f 61 64 20 72 65 71 75 65 73 74 20 72 65 63 65 69 76 65 64 00}  //weight: 1, accuracy: High
        $x_1_8 = "popping a GAD ad - ad id (%s)  keyword id (%s)" ascii //weight: 1
        $x_1_9 = {61 74 74 65 6d 70 74 20 74 6f 20 73 68 6f 77 20 61 6e 20 61 64 20 74 69 6d 65 64 20 6f 75 74 00}  //weight: 1, accuracy: High
        $x_1_10 = {63 6f 75 6c 64 20 6e 6f 74 20 63 6f 6e 6e 65 63 74 20 74 6f 20 61 64 73 2e 61 73 70 78 00}  //weight: 1, accuracy: High
        $x_1_11 = {61 64 5f 68 69 73 74 6f 72 79 5f 63 6f 75 6e 74 00}  //weight: 1, accuracy: High
        $x_1_12 = "downloads.180solutions.com/" ascii //weight: 1
        $x_1_13 = {31 38 30 67 65 74 65 78 65 6e 61 6d 65 00}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_5_*) and 11 of ($x_1_*))) or
            ((2 of ($x_5_*) and 6 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule Hotbar_12
{
    meta:
        author = "defender2yara"
        detection_name = "Hotbar"
        threat_id = "6204"
        severity = "10"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "vicparameters" ascii //weight: 1
        $x_1_2 = "defbrowser=" ascii //weight: 1
        $x_1_3 = {8b 4e 1c 8b 56 10 53 53 51 52 53 ff d0 3b c3 7d}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Hotbar_13
{
    meta:
        author = "defender2yara"
        detection_name = "Hotbar"
        threat_id = "6204"
        severity = "10"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = ".\\Source\\180SA.cpp" ascii //weight: 1
        $x_1_2 = "180sa|180adsolution" ascii //weight: 1
        $x_1_3 = "/show_ads=" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Hotbar_14
{
    meta:
        author = "defender2yara"
        detection_name = "Hotbar"
        threat_id = "6204"
        severity = "10"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {48 62 48 6f 73 74 49 45 2e 44 4c 4c 00}  //weight: 1, accuracy: High
        $x_1_2 = "echo.hotbar.com/smartoffers" ascii //weight: 1
        $x_1_3 = "UpgradeSkinSystem" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Hotbar_15
{
    meta:
        author = "defender2yara"
        detection_name = "Hotbar"
        threat_id = "6204"
        severity = "10"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "3"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {0f be 14 37 8a 92 ?? ?? ?? ?? 88 16 46 3b f1 76 ef}  //weight: 1, accuracy: Low
        $x_1_2 = "&bname=&bver=&ver=&mt=00UNKNOWN" ascii //weight: 1
        $x_1_3 = "|cscid|hdid|mt" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Hotbar_16
{
    meta:
        author = "defender2yara"
        detection_name = "Hotbar"
        threat_id = "6204"
        severity = "10"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {48 62 48 6f 73 74 4f 45 2e 44 4c 4c 00}  //weight: 1, accuracy: High
        $x_1_2 = {53 6f 66 74 77 61 72 65 5c 48 6f 74 62 61 72 5c 48 6f 74 62 61 72 5c 00 49 6e 73 74 61 6c 6c 00 48 6f 74 62 61 72}  //weight: 1, accuracy: High
        $x_1_3 = {52 65 67 69 73 74 65 72 52 65 62 61 72 00}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Hotbar_17
{
    meta:
        author = "defender2yara"
        detection_name = "Hotbar"
        threat_id = "6204"
        severity = "10"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {48 6f 74 62 61 72 53 41 48 6f 6f 6b 2e 64 6c 6c 00}  //weight: 1, accuracy: High
        $x_1_2 = "seekmosa|zangosa|sbusa|hotbarsa" ascii //weight: 1
        $x_1_3 = "%s Search Assistant" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Hotbar_18
{
    meta:
        author = "defender2yara"
        detection_name = "Hotbar"
        threat_id = "6204"
        severity = "10"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {56 8b 74 24 08 8b 0e 8b 01 8b 50 10 57 ff d2 83 7e 0c 00 8d 4e 0c 7c ?? 3b 06 75 ?? 8b fe b8 01 00 00 00 f0 0f c1 01}  //weight: 1, accuracy: Low
        $x_1_2 = "its.not.ok" ascii //weight: 1
        $x_1_3 = "http://open/?url=" ascii //weight: 1
        $x_1_4 = "seekmo" ascii //weight: 1
        $x_1_5 = "hotbar" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Hotbar_19
{
    meta:
        author = "defender2yara"
        detection_name = "Hotbar"
        threat_id = "6204"
        severity = "10"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = "install.securewebsiteaccess.com" ascii //weight: 1
        $x_1_2 = "installer/zcdownload" ascii //weight: 1
        $x_1_3 = "crazyloader.com" ascii //weight: 1
        $x_1_4 = {50 61 72 74 6e 65 72 ?? ?? ?? ?? ?? 43 72 61 7a 79 4c 6f 61 64 65 72 20 31 2e 33}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Hotbar_20
{
    meta:
        author = "defender2yara"
        detection_name = "Hotbar"
        threat_id = "6204"
        severity = "10"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "3"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = "downloads1.zango.com" ascii //weight: 1
        $x_1_2 = "Are you sure you want to cancel the download?" ascii //weight: 1
        $x_1_3 = {03 c1 8b 4d 0c 8d 4c 08 ff 80 39 00 74 ?? 8b 7d 10 8b f0 2b f8 0f be 14 37 8a 92 ?? ?? ?? ?? 88 16 46 3b f1 76 ef}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Hotbar_21
{
    meta:
        author = "defender2yara"
        detection_name = "Hotbar"
        threat_id = "6204"
        severity = "10"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "installerDomain=config.hotbar.com" ascii //weight: 1
        $x_1_2 = "sel=hblite&ix=PPNHBLite" ascii //weight: 1
        $x_1_3 = "Hotbar Syndication Platform Installer" ascii //weight: 1
        $x_1_4 = "Hotbar Upgrade" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (3 of ($x*))
}

rule Hotbar_22
{
    meta:
        author = "defender2yara"
        detection_name = "Hotbar"
        threat_id = "6204"
        severity = "10"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {53 6f 66 74 77 61 72 65 5c 48 6f 74 62 61 72 5c 48 6f 74 62 61 72 5c 00 69 6e 73 74 61 6c 6c 00 48 6f 74 62 61 72}  //weight: 1, accuracy: High
        $x_1_2 = ".hotbar.com" ascii //weight: 1
        $x_1_3 = "NHbHostOEPath" ascii //weight: 1
        $x_1_4 = "CHbCoreServices:" ascii //weight: 1
        $x_1_5 = "$hotbarbin$" ascii //weight: 1
        $x_1_6 = {48 62 48 6f 73 74 4f 45 2e 44 4c 4c 00}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (3 of ($x*))
}

rule Hotbar_23
{
    meta:
        author = "defender2yara"
        detection_name = "Hotbar"
        threat_id = "6204"
        severity = "10"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "22"
        strings_accuracy = "High"
    strings:
        $x_10_1 = {56 65 72 69 66 79 53 69 67 6e 61 74 75 72 65 00}  //weight: 10, accuracy: High
        $x_10_2 = {56 65 72 69 66 79 53 69 67 6e 61 74 75 72 65 4f 6e 50 61 72 65 6e 74 00}  //weight: 10, accuracy: High
        $x_1_3 = {50 69 6e 62 61 6c 6c 20 43 6f 72 70 6f 72 61 74 69 6f 6e 2e 00}  //weight: 1, accuracy: High
        $x_1_4 = {50 6c 61 74 72 69 75 6d 20 4c 4c 43 00}  //weight: 1, accuracy: High
        $x_1_5 = "_SmartShopper_Build_SmartShopper_" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((2 of ($x_10_*) and 2 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule Hotbar_24
{
    meta:
        author = "defender2yara"
        detection_name = "Hotbar"
        threat_id = "6204"
        severity = "10"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "Low"
    strings:
        $x_3_1 = {74 17 57 8b fa 2b f8 0f be 14 37 8a 92 ?? ?? ?? ?? 88 16 46 3b f1 76 ef 5f}  //weight: 3, accuracy: Low
        $x_1_2 = "/Silent /Welcome=false /AffiliateId=$" ascii //weight: 1
        $x_1_3 = {70 69 6e 62 61 6c 6c 70 75 62 6c 69 73 68 65 72 6e 65 74 77 6f 72 6b 2e 63 6f 6d 00}  //weight: 1, accuracy: High
        $x_1_4 = "ics.hotbar.com/Software/" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_3_*) and 2 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule Hotbar_25
{
    meta:
        author = "defender2yara"
        detection_name = "Hotbar"
        threat_id = "6204"
        severity = "10"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "8"
        strings_accuracy = "High"
    strings:
        $x_3_1 = ".WeSkin.dll" ascii //weight: 3
        $x_5_2 = "weather.zango.com/" ascii //weight: 5
        $x_1_3 = "radar-updatedon" ascii //weight: 1
        $x_1_4 = "RADARSMALL" ascii //weight: 1
        $x_1_5 = "RADARBIG" ascii //weight: 1
        $x_1_6 = "SATELLITESMALL" ascii //weight: 1
        $x_1_7 = "SATELLITEBIG" ascii //weight: 1
        $x_3_8 = "Zango, Inc." ascii //weight: 3
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_3_*) and 5 of ($x_1_*))) or
            ((2 of ($x_3_*) and 2 of ($x_1_*))) or
            ((1 of ($x_5_*) and 3 of ($x_1_*))) or
            ((1 of ($x_5_*) and 1 of ($x_3_*))) or
            (all of ($x*))
        )
}

rule Hotbar_26
{
    meta:
        author = "defender2yara"
        detection_name = "Hotbar"
        threat_id = "6204"
        severity = "10"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {44 65 62 75 67 53 65 74 74 69 6e 67 73 5f 50 6c 61 74 72 69 75 6d 00}  //weight: 1, accuracy: High
        $x_1_2 = {70 6c 61 74 72 69 75 6d 5f 68 6f 73 74 5f 66 69 6c 65 5f 65 64 69 74 00}  //weight: 1, accuracy: High
        $x_1_3 = "One8TSolutions" ascii //weight: 1
        $x_1_4 = {50 69 6e 62 61 6c 6c 20 43 6f 72 70 6f 72 61 74 69 6f 6e 2e 00}  //weight: 1, accuracy: High
        $x_1_5 = "ver=%s&pkg_ver=%s&eparams=s" ascii //weight: 1
        $x_1_6 = {61 64 5f 54 61 6b 65 66 6f 63 75 73 00}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (3 of ($x*))
}

rule Hotbar_27
{
    meta:
        author = "defender2yara"
        detection_name = "Hotbar"
        threat_id = "6204"
        severity = "10"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "OnSAIBeginInstall(%s)" ascii //weight: 1
        $x_1_2 = "No '%s' in VIC response" ascii //weight: 1
        $x_1_3 = "AppBundler_RSA_Signer" ascii //weight: 1
        $x_1_4 = "VIC URL: %s" ascii //weight: 1
        $x_1_5 = "SAItest.txt" ascii //weight: 1
        $x_1_6 = "AVCASAIApp@appenv" ascii //weight: 1
        $x_1_7 = "SAIEcho" wide //weight: 1
    condition:
        (filesize < 20MB) and
        (4 of ($x*))
}

rule Hotbar_28
{
    meta:
        author = "defender2yara"
        detection_name = "Hotbar"
        threat_id = "6204"
        severity = "10"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "7"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "\\compile\\source_tb\\hbhostie\\" ascii //weight: 1
        $x_1_2 = "Software\\Hotbar\\" ascii //weight: 1
        $x_1_3 = "$hotbarbin$" ascii //weight: 1
        $x_1_4 = "$hotbar$" ascii //weight: 1
        $x_1_5 = "hotbar_promo" ascii //weight: 1
        $x_1_6 = "-Hotbar-hbr." ascii //weight: 1
        $x_1_7 = "Hotbar.com/" ascii //weight: 1
        $x_1_8 = "GetHotbarHomeDir" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (7 of ($x*))
}

rule Hotbar_29
{
    meta:
        author = "defender2yara"
        detection_name = "Hotbar"
        threat_id = "6204"
        severity = "10"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {54 65 73 74 69 6e 67 20 66 6f 72 [0-8] 54 6f 6f 6c 62 61 72}  //weight: 1, accuracy: Low
        $x_1_2 = "Matched sa" ascii //weight: 1
        $x_1_3 = "did=%s&brandid=%s&os=%s&%s&ver=%s&pkg_ver=%s&eparams=%s" ascii //weight: 1
        $x_1_4 = "One8TSolutions" ascii //weight: 1
        $x_1_5 = "ZangoToolbar" ascii //weight: 1
        $x_1_6 = "HotbarToolbar" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (5 of ($x*))
}

rule Hotbar_30
{
    meta:
        author = "defender2yara"
        detection_name = "Hotbar"
        threat_id = "6204"
        severity = "10"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "91EE2532-A17E-11DE-BB95-7CB755D89593" ascii //weight: 1
        $x_1_2 = "pinballpublishernetwork.com" ascii //weight: 1
        $x_1_3 = "HtTp://UCI%20Page%20Dwnload" ascii //weight: 1
        $x_1_4 = {53 6d 61 72 74 20 53 68 6f 70 70 65 72 20 49 6e 63 00 00 00 5a 61 6e 67 6f 00 00 00 42 6c 69 6e 6b 78 00 00 50 69 6e 62 61 6c 6c 20 43 6f 72 70 6f 72 61 74 69 6f 6e 2e}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Hotbar_31
{
    meta:
        author = "defender2yara"
        detection_name = "Hotbar"
        threat_id = "6204"
        severity = "10"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "3"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {54 65 73 74 69 6e 67 20 66 6f 72 20 48 42 [0-4] 4c 69 74 65 00}  //weight: 1, accuracy: Low
        $x_1_2 = {63 6c 69 65 6e 74 61 78 70 72 6f 78 79 2e 64 6c 6c 00}  //weight: 1, accuracy: High
        $x_1_3 = "SAAlias: %s" ascii //weight: 1
        $x_1_4 = {53 41 25 73 3a 20 25 73 00 00 00 00 41 6c 69 61 73}  //weight: 1, accuracy: High
        $x_1_5 = "did=%s&brandid=%s&os=%s&%s&ver=%s&pkg_ver=%s&eparams=%s" ascii //weight: 1
        $x_1_6 = "One8TSolutions" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (3 of ($x*))
}

rule Hotbar_32
{
    meta:
        author = "defender2yara"
        detection_name = "Hotbar"
        threat_id = "6204"
        severity = "10"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "6"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = "HOOK_DLL: Sending new URL message to search assistant window(0x%08X)" ascii //weight: 1
        $x_1_2 = {48 4f 4f 4b 5f 44 4c 4c 3a 20 48 69 64 65 20 41 [0-8] 77 69 6e 64 6f 77 20 28 30 78 25 78 29}  //weight: 1, accuracy: Low
        $x_1_3 = "Search Assistant" ascii //weight: 1
        $x_1_4 = "software\\zango" ascii //weight: 1
        $x_1_5 = "enable_ts_logging" ascii //weight: 1
        $x_2_6 = "Lite" wide //weight: 2
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_2_*) and 4 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule Hotbar_33
{
    meta:
        author = "defender2yara"
        detection_name = "Hotbar"
        threat_id = "6204"
        severity = "10"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "12"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {6e 70 63 6c 6e 74 61 78 5f 48 42 [0-5] 53 41 2e 64 6c 6c}  //weight: 1, accuracy: Low
        $x_1_2 = {48 00 42 00 4c 00 69 00 74 00 65 00 [0-2] 41 00 58 00 2e 00 49 00 6e 00 [0-2] 66 00 6f 00}  //weight: 1, accuracy: Low
        $x_1_3 = {48 00 6f 00 74 00 62 00 61 00 72 00 20 00 46 00 69 00 72 00 65 00 66 00 6f 00 78 00 20 00 50 00 6c 00 75 00 67 00 69 00 6e 00 00 00}  //weight: 1, accuracy: High
        $x_1_4 = {6e 70 63 6c 6e 74 61 78 5f 48 6f 74 62 61 72 53 41 2e 64 6c 6c 00}  //weight: 1, accuracy: High
        $x_10_5 = {4e 50 5f 47 65 74 45 6e 74 72 79 50 6f 69 6e 74 73 00 4e 50 5f 49 6e 69 74 69 61 6c 69 7a 65 00 4e 50 5f 53 68 75 74 64 6f 77 6e}  //weight: 10, accuracy: High
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_10_*) and 2 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule Hotbar_34
{
    meta:
        author = "defender2yara"
        detection_name = "Hotbar"
        threat_id = "6204"
        severity = "10"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "7"
        strings_accuracy = "Low"
    strings:
        $x_5_1 = "HBLiteSAHook.dll" ascii //weight: 5
        $x_1_2 = {48 4f 4f 4b 5f 44 4c 4c 3a 20 48 69 64 65 20 41 [0-8] 77 69 6e 64 6f 77 20 28 30 78 25 78 29}  //weight: 1, accuracy: Low
        $x_1_3 = "IEListener tried to disconnect, but" ascii //weight: 1
        $x_1_4 = {42 69 6c 6c 79 42 6f 62 [0-8] 20 77 69 6e 64 6f 77 20 63 6c 61 73 73 20 72 65 67 69 73 74 65 72 20 65 72 72 6f 72 3a 20 25 64 2e}  //weight: 1, accuracy: Low
        $x_1_5 = "HOOK_DLL: AD process ID (0x%08X) equals" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_5_*) and 2 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule Hotbar_35
{
    meta:
        author = "defender2yara"
        detection_name = "Hotbar"
        threat_id = "6204"
        severity = "10"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "34"
        strings_accuracy = "High"
    strings:
        $x_10_1 = "httpopenrequesta" ascii //weight: 10
        $x_10_2 = "internetconnecta" ascii //weight: 10
        $x_10_3 = "HBInstIE.HbInstObj" wide //weight: 10
        $x_1_4 = "upgradeinfo.ver" ascii //weight: 1
        $x_1_5 = "hotbar\\bin\\" ascii //weight: 1
        $x_1_6 = "http://installs.hotbar.com/installs/hotbar/programs/" ascii //weight: 1
        $x_1_7 = "Hotbar.exe" ascii //weight: 1
        $x_1_8 = "WeatherOnTray" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((3 of ($x_10_*) and 4 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule Hotbar_36
{
    meta:
        author = "defender2yara"
        detection_name = "Hotbar"
        threat_id = "6204"
        severity = "10"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "7"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Hotbar.com Inc." wide //weight: 1
        $x_1_2 = "Hotbar.com, Inc." wide //weight: 1
        $x_2_3 = "; Hotbar" ascii //weight: 2
        $x_2_4 = "\\hotbar_*.log" ascii //weight: 2
        $x_1_5 = "Hotbar.com/" ascii //weight: 1
        $x_2_6 = "Software\\HbTools\\HbTools\\" ascii //weight: 2
        $x_1_7 = "HbResource.dll" ascii //weight: 1
        $x_2_8 = "GetHotbarBinDir" ascii //weight: 2
        $x_2_9 = "GetHotbarHomeDir" ascii //weight: 2
        $x_1_10 = "partners.hotbar.com" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_2_*) and 5 of ($x_1_*))) or
            ((2 of ($x_2_*) and 3 of ($x_1_*))) or
            ((3 of ($x_2_*) and 1 of ($x_1_*))) or
            ((4 of ($x_2_*))) or
            (all of ($x*))
        )
}

rule Hotbar_37
{
    meta:
        author = "defender2yara"
        detection_name = "Hotbar"
        threat_id = "6204"
        severity = "10"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "6"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {68 57 00 07 80 e8 ?? ?? ?? ?? 8b 03 57 ff 75 0c 8b 78 f4 2b f0 e8 ?? ?? ?? ?? 3b f7 5f ff 75 0c 77 ?? 8d 0c 30 51 ff 75 0c 50 e8}  //weight: 1, accuracy: Low
        $x_1_2 = "TB.dll" ascii //weight: 1
        $x_1_3 = "enable_ts_logging" ascii //weight: 1
        $x_1_4 = "&comp_id=" ascii //weight: 1
        $x_1_5 = "software\\zango" ascii //weight: 1
        $x_1_6 = {4f 6e 65 38 54 53 6f 6c 75 74 69 6f 6e 73 50 40 73 73 57 25 72 64 00}  //weight: 1, accuracy: High
        $x_1_7 = "hook.dll" ascii //weight: 1
        $x_1_8 = "%s search assistant" ascii //weight: 1
        $x_1_9 = "&adurl=%s&errorurl=%s&adid=%s&status=%d" ascii //weight: 1
        $x_2_10 = "HBLite" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (
            ((6 of ($x_1_*))) or
            ((1 of ($x_2_*) and 4 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule Hotbar_38
{
    meta:
        author = "defender2yara"
        detection_name = "Hotbar"
        threat_id = "6204"
        severity = "10"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "7"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "pinballpublishernetwork.com" ascii //weight: 2
        $x_1_2 = "HtTp://UCI%20Page%20Dwnload" ascii //weight: 1
        $x_1_3 = {53 6d 61 72 74 20 53 68 6f 70 70 65 72 20 49 6e 63 00 00 00 5a 61 6e 67 6f 00 00 00 42 6c 69 6e 6b 78 00 00 50 69 6e 62 61 6c 6c 20 43 6f 72 70 6f 72 61 74 69 6f 6e 2e}  //weight: 1, accuracy: High
        $x_1_4 = "seekmo" ascii //weight: 1
        $x_1_5 = "conout$" ascii //weight: 1
        $x_1_6 = "/BannerId=${v.banid}" ascii //weight: 1
        $x_1_7 = "hotbar.com" ascii //weight: 1
        $x_2_8 = "clickpotato.tv" ascii //weight: 2
        $x_1_9 = "/Silent /Welcome=false /AffiliateId=$" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((7 of ($x_1_*))) or
            ((1 of ($x_2_*) and 5 of ($x_1_*))) or
            ((2 of ($x_2_*) and 3 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule Hotbar_39
{
    meta:
        author = "defender2yara"
        detection_name = "Hotbar"
        threat_id = "6204"
        severity = "10"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = "icname|icversion|cscid|mt|locale|lang|tid|sairnd" ascii //weight: 1
        $x_1_2 = "sai_the_debug_win_main" ascii //weight: 1
        $x_1_3 = {6d 61 6e 69 66 65 73 74 [0-1] 72 65 61 64 66 61 69 6c 65 64}  //weight: 1, accuracy: Low
        $x_1_4 = "vicparameters" ascii //weight: 1
        $x_1_5 = {69 63 73 6d [0-1] 61 6e 69 66 65 73 74 00}  //weight: 1, accuracy: Low
        $x_1_6 = {53 65 74 74 69 6e 67 [0-2] 4b 65 79 [0-8] 44 65 62 75 67}  //weight: 1, accuracy: Low
        $x_1_7 = {5f 6b 65 79 [0-2] 6f 66 [0-2] 64 65 62 75 67 [0-2] 73 65 74 74 69 6e 67 73}  //weight: 1, accuracy: Low
        $x_1_8 = {5f 72 65 67 [0-2] 76 61 6c 75 65 [0-2] 6e 61 6d 65 [0-2] 6c 6f 67 [0-2] 65 6e 61 62 6c 65}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (4 of ($x*))
}

rule Hotbar_40
{
    meta:
        author = "defender2yara"
        detection_name = "Hotbar"
        threat_id = "6204"
        severity = "10"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "111"
        strings_accuracy = "Low"
    strings:
        $x_100_1 = {74 18 8b 7d 10 8b f0 2b f8 0f be 14 37 8a 92 ?? ?? ?? ?? 88 16 46 3b f1 76 ef}  //weight: 100, accuracy: Low
        $x_10_2 = {76 61 6c 75 65 61 64 64 2f 50 69 6e 67 2f [0-5] 2e 68 74 6d}  //weight: 10, accuracy: Low
        $x_10_3 = "InsatllStarted" wide //weight: 10
        $x_1_4 = {64 6f 77 6e 6c 6f 61 64 73 [0-3] 2e 70 6c 61 74 72 69 75 6d 2e 63 6f 6d}  //weight: 1, accuracy: Low
        $x_1_5 = {64 6f 77 6e 6c 6f 61 64 73 [0-3] 2e 70 69 6e 62 61 6c 6c 63 6f 72 70 2e 63 6f 6d}  //weight: 1, accuracy: Low
        $x_1_6 = {64 6f 77 6e 6c 6f 61 64 73 2f 62 62 2f 62 62 2f 61 61 2e 68 74 6d 00}  //weight: 1, accuracy: High
        $x_1_7 = "BSAIMainWin" wide //weight: 1
        $x_1_8 = "AppBundlerMainWin" wide //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_100_*) and 1 of ($x_10_*) and 1 of ($x_1_*))) or
            ((1 of ($x_100_*) and 2 of ($x_10_*))) or
            (all of ($x*))
        )
}

rule Hotbar_41
{
    meta:
        author = "defender2yara"
        detection_name = "Hotbar"
        threat_id = "6204"
        severity = "10"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {54 68 69 73 20 69 73 20 61 20 63 6c 65 61 6e 20 73 79 73 74 65 6d 2e 00 4c 65 61 76 69 6e 67 20 4c 65 67 61 63 79 44 65 74 65 63 74 69 6f 6e}  //weight: 1, accuracy: High
        $x_1_2 = {53 68 6f 70 70 65 72 52 65 70 6f 72 74 20 4f 70 74 20 49 6e 20 52 65 66 75 73 65 64 2e 00}  //weight: 1, accuracy: High
        $x_1_3 = {44 65 6c 65 74 65 41 6c 6c 43 6f 6f 6b 69 65 73 00 2a 7a 61 6e 67 6f 2a 2e 74 78 74}  //weight: 1, accuracy: High
        $x_1_4 = {6c 65 67 61 63 79 5f 73 68 6f 70 70 65 72 72 65 70 6f 72 74 73 5f 61 66 66 69 64 00}  //weight: 1, accuracy: High
        $x_1_5 = {50 69 6e 62 61 6c 6c 20 43 6f 72 70 6f 72 61 74 69 6f 6e 2e 00}  //weight: 1, accuracy: High
        $x_1_6 = "HBHintSearchTermFields=" ascii //weight: 1
        $x_1_7 = {44 69 73 70 6c 61 79 4e 61 6d 65 00 48 6f 74 62 61 72 20 53 65 61 72 63 68}  //weight: 1, accuracy: High
        $x_1_8 = {50 61 69 64 20 48 6f 74 62 61 72 20 44 65 74 65 63 74 65 64 00}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (4 of ($x*))
}

rule Hotbar_42
{
    meta:
        author = "defender2yara"
        detection_name = "Hotbar"
        threat_id = "6204"
        severity = "10"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "8"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "ZangoDebugWindow" ascii //weight: 1
        $x_1_2 = "180solutions.com" ascii //weight: 1
        $x_1_3 = "www.zango.com/tbd" ascii //weight: 1
        $x_1_4 = "/Uploads/Direct/" ascii //weight: 1
        $x_1_5 = "HKCU\\Software\\ZangoDebugSettings" ascii //weight: 1
        $x_1_6 = "This ad is from Hotbar and Zango, Inc. - Click here for info on how you got Hotbar Search Assistant." ascii //weight: 1
        $x_1_7 = "Hotbar Search Assistant" wide //weight: 1
        $x_1_8 = "Hotbar Setup" wide //weight: 1
        $x_1_9 = "Hotbar.com/" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (8 of ($x*))
}

rule Hotbar_43
{
    meta:
        author = "defender2yara"
        detection_name = "Hotbar"
        threat_id = "6204"
        severity = "10"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "16"
        strings_accuracy = "High"
    strings:
        $x_4_1 = "%s&errorurl=%s&adid=%s&status=%d" ascii //weight: 4
        $x_4_2 = {6f 6e 65 38 74 73 6f 6c 75 74 69 6f 6e 73 70 40 73 73 77 25 72 64 00}  //weight: 4, accuracy: High
        $x_2_3 = {31 38 30 67 65 74 65 78 65 6e 61 6d 65 00}  //weight: 2, accuracy: High
        $x_2_4 = "software\\zango" ascii //weight: 2
        $x_2_5 = "180Client Multiple Instance Lock" ascii //weight: 2
        $x_2_6 = "bis.180solutions.com+adforce.img" ascii //weight: 2
        $x_2_7 = "&did=%s&ver=%s&partner_id=" ascii //weight: 2
        $x_2_8 = "m_pPopBrowser->get_Document()" ascii //weight: 2
        $x_1_9 = {61 64 5f 68 69 73 74 6f 72 79 5f 63 6f 75 6e 74 00}  //weight: 1, accuracy: High
        $x_1_10 = "/disable_tv_ads=n" ascii //weight: 1
        $x_1_11 = "http://trialpayno" ascii //weight: 1
        $x_1_12 = "AdWebBrowserEvents.cpp" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((6 of ($x_2_*) and 4 of ($x_1_*))) or
            ((1 of ($x_4_*) and 4 of ($x_2_*) and 4 of ($x_1_*))) or
            ((1 of ($x_4_*) and 5 of ($x_2_*) and 2 of ($x_1_*))) or
            ((1 of ($x_4_*) and 6 of ($x_2_*))) or
            ((2 of ($x_4_*) and 2 of ($x_2_*) and 4 of ($x_1_*))) or
            ((2 of ($x_4_*) and 3 of ($x_2_*) and 2 of ($x_1_*))) or
            ((2 of ($x_4_*) and 4 of ($x_2_*))) or
            (all of ($x*))
        )
}

rule Hotbar_44
{
    meta:
        author = "defender2yara"
        detection_name = "Hotbar"
        threat_id = "6204"
        severity = "10"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_2_1 = ".appbundler.net/" wide //weight: 2
        $x_2_2 = "|avira|antivir|avast!|avg" wide //weight: 2
        $x_1_3 = "TrackedEvents.URL" wide //weight: 1
        $x_1_4 = "InstallReport" wide //weight: 1
        $x_1_5 = "&defaultbrowser=" ascii //weight: 1
        $x_1_6 = "Pinball Corporation" wide //weight: 1
        $x_1_7 = "<cscid>%s</cscid>" ascii //weight: 1
        $x_1_8 = ".securewebsiteaccess.com/" wide //weight: 1
        $x_1_9 = "Added by icsmanifest" ascii //weight: 1
        $x_2_10 = "downloads.seekmo.com" wide //weight: 2
    condition:
        (filesize < 20MB) and
        (
            ((6 of ($x_1_*))) or
            ((1 of ($x_2_*) and 4 of ($x_1_*))) or
            ((2 of ($x_2_*) and 2 of ($x_1_*))) or
            ((3 of ($x_2_*))) or
            (all of ($x*))
        )
}

rule Hotbar_45
{
    meta:
        author = "defender2yara"
        detection_name = "Hotbar"
        threat_id = "6204"
        severity = "10"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "9"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "HBCheckPermission.txt" ascii //weight: 1
        $x_1_2 = "Spam Blocker Utility" ascii //weight: 1
        $x_1_3 = "C:\\Program Files\\SpamBlockerUtility" ascii //weight: 1
        $x_1_4 = "a subsidiary of Zango, Inc" ascii //weight: 1
        $x_1_5 = "By installing the Zango Software" ascii //weight: 1
        $x_1_6 = "keyword search in Internet Explorer address bar and change my search assistant" ascii //weight: 1
        $x_1_7 = "&Installer=1&SysTime=" ascii //weight: 1
        $x_1_8 = "Shopper Reports" ascii //weight: 1
        $x_1_9 = "forcePromoByInstaller" ascii //weight: 1
        $x_1_10 = "https://secure.hotbar.com/" ascii //weight: 1
        $x_1_11 = "Installation/Browsing/EndExeInstall.aspx" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (9 of ($x*))
}

rule Hotbar_46
{
    meta:
        author = "defender2yara"
        detection_name = "Hotbar"
        threat_id = "6204"
        severity = "10"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "bsa$i_upg$rade_url" wide //weight: 1
        $x_1_2 = "|avira|antivir|avast!|avg|bitdefender|bullguard|err:|cyberdefender|eset|" wide //weight: 1
        $x_1_3 = "Cannot read desktop manifest: %s" wide //weight: 1
        $x_1_4 = "install.securewe$bsiteaccess.com" wide //weight: 1
        $x_1_5 = "OnSAIVerifyInstall():" wide //weight: 1
        $x_1_6 = "VIC Params:" wide //weight: 1
    condition:
        (filesize < 20MB) and
        (4 of ($x*))
}

rule Hotbar_47
{
    meta:
        author = "defender2yara"
        detection_name = "Hotbar"
        threat_id = "6204"
        severity = "10"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "b$sai_upgrade$_url" wide //weight: 1
        $x_1_2 = "downloads.seekmo.com/downloads/aa/aa/bb.htm" wide //weight: 1
        $x_1_3 = "avira|antivir|avast!|avg|bitdefender|bullguard|err:|cyberdefender|eset|net" wide //weight: 1
        $x_1_4 = "_setup_app_win_class_01_" wide //weight: 1
        $x_1_5 = "sai_test=%lu" wide //weight: 1
        $x_1_6 = {73 00 65 00 63 00 75 00 72 00 65 00 77 00 65 00 90 00 02 00 01 00 62 00 73 00 69 00 74 00 65 00 61 00 63 00 63 00 65 00 73 00 73 00 2e 00 63 00 6f 00 6d 00}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (5 of ($x*))
}

rule Hotbar_48
{
    meta:
        author = "defender2yara"
        detection_name = "Hotbar"
        threat_id = "6204"
        severity = "10"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "30"
        strings_accuracy = "Low"
    strings:
        $x_10_1 = {54 68 69 73 20 [0-4] 61 64 [0-4] 69 73 20 66 72 6f 6d 20 48 6f 74 62 61 72}  //weight: 10, accuracy: Low
        $x_10_2 = "hotbar.com" wide //weight: 10
        $x_5_3 = "downloads.180solutions.com/" ascii //weight: 5
        $x_5_4 = "%s&errorurl=%s&adid=%s&status=%d" ascii //weight: 5
        $x_5_5 = {4f 6e 65 38 54 53 6f 6c 75 74 69 6f 6e 73 50 40 73 73 57 25 72 64 00}  //weight: 5, accuracy: High
        $x_1_6 = "%s Search Assistant" ascii //weight: 1
        $x_1_7 = "/disable_tv_ads=n" ascii //weight: 1
        $x_1_8 = {61 74 74 65 6d 70 74 20 74 6f 20 73 68 6f 77 20 61 6e 20 61 64 20 74 69 6d 65 64 20 6f 75 74 00}  //weight: 1, accuracy: High
        $x_1_9 = {77 6d 5f 73 68 6f 77 5f 61 64 20 72 65 71 75 65 73 74 20 72 65 63 65 69 76 65 64 00}  //weight: 1, accuracy: High
        $x_1_10 = "popping a GAD ad - ad id (%s)  keyword id (%s)" ascii //weight: 1
        $x_1_11 = {63 6f 75 6c 64 20 6e 6f 74 20 63 6f 6e 6e 65 63 74 20 74 6f 20 61 64 73 2e 61 73 70 78 00}  //weight: 1, accuracy: High
        $x_1_12 = {61 64 5f 68 69 73 74 6f 72 79 5f 63 6f 75 6e 74 00}  //weight: 1, accuracy: High
        $x_1_13 = "software\\zango" ascii //weight: 1
        $x_1_14 = {31 38 30 67 65 74 65 78 65 6e 61 6d 65 00}  //weight: 1, accuracy: High
        $x_1_15 = {2e 5c 53 6f 75 72 63 65 5c 31 38 30 53 41 2e 63 70 70 00}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_10_*) and 2 of ($x_5_*) and 10 of ($x_1_*))) or
            ((1 of ($x_10_*) and 3 of ($x_5_*) and 5 of ($x_1_*))) or
            ((2 of ($x_10_*) and 10 of ($x_1_*))) or
            ((2 of ($x_10_*) and 1 of ($x_5_*) and 5 of ($x_1_*))) or
            ((2 of ($x_10_*) and 2 of ($x_5_*))) or
            (all of ($x*))
        )
}

rule Hotbar_49
{
    meta:
        author = "defender2yara"
        detection_name = "Hotbar"
        threat_id = "6204"
        severity = "10"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "8"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Http/VER_STR_COMMA" wide //weight: 1
        $x_1_2 = "%cver=%s&rnd=%lu" wide //weight: 1
        $x_1_3 = "%d/%d/%04d %d:%02d:%02d %s" wide //weight: 1
        $x_1_4 = "%04d%02d%02d%02d%02d%02d.%03u.%u" wide //weight: 1
        $x_1_5 = "VICParameterNameList" wide //weight: 1
        $x_1_6 = "/bsaitest=%lu (0x%x)" wide //weight: 1
        $x_1_7 = "SAISetHotkey" wide //weight: 1
        $x_1_8 = "Launch '%s' in %s, pathkey=%d, status %s" wide //weight: 1
        $x_2_9 = "HKCU\\software\\Appbundler\\debugwinmain" wide //weight: 2
    condition:
        (filesize < 20MB) and
        (
            ((8 of ($x_1_*))) or
            ((1 of ($x_2_*) and 6 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule Hotbar_50
{
    meta:
        author = "defender2yara"
        detection_name = "Hotbar"
        threat_id = "6204"
        severity = "10"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "23"
        strings_accuracy = "Low"
    strings:
        $x_10_1 = "_sa\\bin\\Release\\ClientSAHook.pdb" ascii //weight: 10
        $x_5_2 = {65 6e 61 62 6c 65 [0-2] 74 73 [0-2] 6c 6f 67}  //weight: 5, accuracy: Low
        $x_5_3 = "180BBClass" ascii //weight: 5
        $x_5_4 = "180uninstaller" ascii //weight: 5
        $x_5_5 = "zangouninstaller" ascii //weight: 5
        $x_5_6 = "180search Assistant" ascii //weight: 5
        $x_5_7 = "180$search Assistant" ascii //weight: 5
        $x_5_8 = "18$0search Assistant" ascii //weight: 5
        $x_5_9 = "1$80search Assistant" ascii //weight: 5
        $x_5_10 = "CHookedWindowMSN9.cpp" ascii //weight: 5
        $x_1_11 = "hook_dll: ad props timer is killed on ie window" ascii //weight: 1
        $x_1_12 = "hook_dll: user surfing away from original ad" ascii //weight: 1
        $x_1_13 = "normal if it's not on an ad IE" ascii //weight: 1
        $x_1_14 = "hook_dll: hide ad" ascii //weight: 1
        $x_1_15 = "HOOK_DLL: Start to check for hide Ad" ascii //weight: 1
        $x_1_16 = "hook_dll: ad process id (0x%08x) equals" ascii //weight: 1
        $x_1_17 = "hook_dll: sending new url message to search assistant window(0x%08x)" ascii //weight: 1
        $x_1_18 = "HOOK_DLL: Hide IE(Ad) window (0x%x)" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((3 of ($x_5_*) and 8 of ($x_1_*))) or
            ((4 of ($x_5_*) and 3 of ($x_1_*))) or
            ((5 of ($x_5_*))) or
            ((1 of ($x_10_*) and 1 of ($x_5_*) and 8 of ($x_1_*))) or
            ((1 of ($x_10_*) and 2 of ($x_5_*) and 3 of ($x_1_*))) or
            ((1 of ($x_10_*) and 3 of ($x_5_*))) or
            (all of ($x*))
        )
}

rule Hotbar_51
{
    meta:
        author = "defender2yara"
        detection_name = "Hotbar"
        threat_id = "6204"
        severity = "10"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "3"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = "one8tsolutions" ascii //weight: 1
        $x_1_2 = ".180solutions.com" ascii //weight: 1
        $x_1_3 = ".hippogeek.com" ascii //weight: 1
        $x_1_4 = ".TeeveeWatch.com" ascii //weight: 1
        $x_1_5 = ".gigglinggames.com" ascii //weight: 1
        $x_1_6 = "&did=%s&ver=%s&partner_id=" ascii //weight: 1
        $x_1_7 = "&%s=%s&errorurl=%s&status=%d&adid=%s" ascii //weight: 1
        $x_1_8 = "did=%s&mt=%s&partner_id=%s" ascii //weight: 1
        $x_1_9 = "mt=%s&did=%s&ui_source=%s&ui_item_id=%s" ascii //weight: 1
        $x_1_10 = "did=%s&name=%s&mt=%s&partner_id=%s" ascii //weight: 1
        $x_1_11 = "mt=%s&did=%s&name=%s&partner_id=%s" ascii //weight: 1
        $x_1_12 = "mt=%s&partner_id=%s&did=%s&name=%s" ascii //weight: 1
        $x_1_13 = "&%s=%s&status=%d&errorurl=%s&adid=%s" ascii //weight: 1
        $x_1_14 = "&%s=%s&status=%d&adid=%s&errorurl=%s" ascii //weight: 1
        $x_1_15 = "did=%s&mt=%s&ui_item_id=%s&ui_source=%s" ascii //weight: 1
        $x_1_16 = "adid=%lu&kwid=%lu&adtime=%s" ascii //weight: 1
        $x_1_17 = "mt=%s&name=%s&partner_id=%s&did=%s" ascii //weight: 1
        $x_1_18 = {61 64 5f 68 69 73 74 6f 72 79 5f 63 6f 75 6e 74 00}  //weight: 1, accuracy: High
        $x_1_19 = "disable_tv_a" ascii //weight: 1
        $x_1_20 = "&disable_ads=y" ascii //weight: 1
        $x_1_21 = {61 64 5f 54 61 6b 65 66 6f 63 75 73 00}  //weight: 1, accuracy: High
        $x_1_22 = "no_ad_req_on_body" ascii //weight: 1
        $x_1_23 = {78 78 5f 64 69 64 5f 78 78 00}  //weight: 1, accuracy: High
        $x_1_24 = {78 78 5f 75 63 69 5f 73 69 67 5f 78 78 00}  //weight: 1, accuracy: High
        $x_1_25 = {65 6e 61 62 6c 65 [0-2] 74 73 [0-2] 6c 6f 67}  //weight: 1, accuracy: Low
        $x_1_26 = "AdWebBrowserEvents.cpp" ascii //weight: 1
        $x_1_27 = "you may receive Adult-oriented ads" ascii //weight: 1
        $x_1_28 = "applications distributed by Platrium." ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (3 of ($x*))
}

rule Hotbar_52
{
    meta:
        author = "defender2yara"
        detection_name = "Hotbar"
        threat_id = "6204"
        severity = "10"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "23"
        strings_accuracy = "High"
    strings:
        $x_10_1 = {5f 73 61 5c 62 69 6e 5c 52 65 6c 65 61 73 65 5c 43 6c 69 65 6e 74 53 41 43 42 2e 70 64 62 00}  //weight: 10, accuracy: High
        $x_5_2 = {57 65 62 20 62 72 6f 77 73 65 72 20 63 72 65 61 74 65 20 66 61 69 6c 65 64 2c 20 68 72 3d 30 78 25 30 38 58 2e 00}  //weight: 5, accuracy: High
        $x_5_3 = {57 65 62 20 25 73 20 63 72 65 61 74 65 20 66 61 69 6c 65 64 2c 20 68 72 3d 30 78 25 30 38 58 2e 00}  //weight: 5, accuracy: High
        $x_5_4 = {57 65 25 73 61 74 65 20 66 61 69 6c 65 64 2c 20 68 72 3d 30 78 25 30 38 58 2e 00}  //weight: 5, accuracy: High
        $x_5_5 = {57 65 62 25 73 61 74 65 20 66 61 69 6c 65 64 2c 20 68 72 3d 30 78 25 30 38 58 2e 00}  //weight: 5, accuracy: High
        $x_5_6 = {41 64 20 64 65 6c 69 76 65 72 65 64 20 69 6e 20 63 6c 69 65 6e 74 20 62 72 6f 77 73 65 72 2c 20 75 72 6c 3a 20 25 73 2c 20 61 64 69 64 3a 20 25 73 2c 20 6b 65 79 77 6f 72 64 69 64 3a 20 25 73 2e 00}  //weight: 5, accuracy: High
        $x_5_7 = {41 64 20 25 73 20 69 6e 20 63 6c 69 65 6e 74 20 62 72 6f 77 73 65 72 2c 20 75 72 6c 3a 20 25 73 2c 20 61 64 69 64 3a 20 25 73 2c 20 6b 65 79 77 6f 72 64 69 64 3a 20 25 73 2e 00}  //weight: 5, accuracy: High
        $x_5_8 = {41 25 73 76 65 72 65 64 20 69 6e 20 63 6c 69 65 6e 74 20 62 72 25 73 72 6c 3a 20 25 73 2c 20 61 64 69 64 3a 20 25 73 2c 20 6b 65 79 77 6f 72 64 69 64 3a 20 25 73 2e 00}  //weight: 5, accuracy: High
        $x_5_9 = {34 30 34 20 73 65 61 72 63 68 20 55 52 4c 20 64 6f 65 73 20 6e 6f 74 20 63 6f 6e 74 61 69 6e 20 61 20 76 61 6c 69 64 20 73 65 61 72 63 68 20 74 65 72 6d 2c 20 73 65 61 72 63 68 55 52 4c 3a 20 25 73 2e 00}  //weight: 5, accuracy: High
        $x_5_10 = "404 search token '%s' not found in searchURL '%s'" wide //weight: 5
        $x_5_11 = {41 64 20 64 65 6c 69 76 65 72 20 74 69 6d 65 6f 75 74 20 69 6e 20 63 6c 69 65 6e 74 20 62 72 6f 77 73 65 72 2c 20 61 64 69 64 3a 20 25 73 2e 00}  //weight: 5, accuracy: High
        $x_5_12 = {41 00 64 00 20 00 64 00 65 00 6c 00 69 00 76 00 65 00 72 00 20 00 74 00 69 00 6d 00 65 00 6f 00 75 00 74 00 20 00 69 00 6e 00 20 00 63 00 6c 00 69 00 65 00 6e 00 74 00 20 00 62 00 72 00 6f 00 77 00 73 00 65 00 72 00 2c 00 20 00 61 00 64 00 69 00 64 00 3a 00 20 00 25 00 73 00 2e 00 00 00}  //weight: 5, accuracy: High
        $x_5_13 = {64 00 65 00 6c 00 69 00 76 00 65 00 72 00 00 00 6b 00 65 00 79 00 77 00 6f 00 72 00 64 00 5f 00 69 00 64 00 00 00}  //weight: 5, accuracy: High
        $x_5_14 = {6b 00 65 00 79 00 77 00 6f 00 72 00 64 00 5f 00 69 00 64 00 00 00 00 00 61 00 64 00 5f 00 69 00 64 00 00 00}  //weight: 5, accuracy: High
        $x_1_15 = "controls/ad_label" wide //weight: 1
        $x_1_16 = "ad_SetReferer" wide //weight: 1
        $x_1_17 = "ad_Fullscreen" wide //weight: 1
        $x_1_18 = "ad_Takefocus" wide //weight: 1
        $x_1_19 = "ad_animate" wide //weight: 1
        $x_1_20 = "ad_source_url" wide //weight: 1
        $x_1_21 = "ad_scpt" wide //weight: 1
        $x_1_22 = "ad$_source_url" wide //weight: 1
        $x_1_23 = "a$d_Set$Referer" wide //weight: 1
        $x_1_24 = "a$d_Fulls$creen" wide //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((3 of ($x_5_*) and 8 of ($x_1_*))) or
            ((4 of ($x_5_*) and 3 of ($x_1_*))) or
            ((5 of ($x_5_*))) or
            ((1 of ($x_10_*) and 1 of ($x_5_*) and 8 of ($x_1_*))) or
            ((1 of ($x_10_*) and 2 of ($x_5_*) and 3 of ($x_1_*))) or
            ((1 of ($x_10_*) and 3 of ($x_5_*))) or
            (all of ($x*))
        )
}

rule Hotbar_53
{
    meta:
        author = "defender2yara"
        detection_name = "Hotbar"
        threat_id = "6204"
        severity = "10"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "6"
        strings_accuracy = "Low"
    strings:
        $x_2_1 = {53 74 61 72 74 49 6e 73 61 74 6c 6c 00}  //weight: 2, accuracy: High
        $x_2_2 = {49 6e 73 61 74 6c 6c 53 74 61 72 74 65 64 00}  //weight: 2, accuracy: High
        $x_2_3 = {80 39 00 74 18 8b 7d ?? 8b f0 2b f8 0f be 14 37 8a 92 ?? ?? ?? ?? 88 16 46 3b f1 76 ef}  //weight: 2, accuracy: Low
        $x_1_4 = {8b c1 32 c9 88 88 00 01 00 00 88 88 01 01 00 00 88 88 02 01 00 00 c3}  //weight: 1, accuracy: High
        $x_2_5 = {0f be 14 37 8a 92 ?? ?? ?? ?? 88 16 46 3b f1 76 ef}  //weight: 2, accuracy: Low
        $x_1_6 = {42 53 41 49 5f 4d 61 69 6e 57 69 6e 00}  //weight: 1, accuracy: High
        $x_1_7 = "BSAI_Build" ascii //weight: 1
        $x_1_8 = "BSAIMain\\source\\Release" ascii //weight: 1
        $x_1_9 = "BSAI2\\source\\Release" ascii //weight: 1
        $x_1_10 = {61 6e 74 69 66 72 61 75 64 75 63 69 74 69 6d 65 72 00}  //weight: 1, accuracy: High
        $x_1_11 = "saitest" ascii //weight: 1
        $x_1_12 = "sai_debug_win" ascii //weight: 1
        $x_1_13 = "sairnd|" ascii //weight: 1
        $x_1_14 = {65 6e 61 62 6c 65 [0-2] 74 73 [0-2] 6c 6f 67}  //weight: 1, accuracy: Low
        $x_1_15 = {65 6e 61 62 6c 65 [0-2] 74 68 65 [0-2] 74 73 [0-2] 6c 6f 67}  //weight: 1, accuracy: Low
        $x_1_16 = {65 6e 61 62 6c 65 [0-2] 6c 6f 67 67 69 6e 67 [0-2] 72 65 67 76 61 6c 75 65 6e 61 6d 65}  //weight: 1, accuracy: Low
        $x_1_17 = {65 6e 61 62 6c 65 5f 6c 6f 67 5f 74 68 65 5f 72 65 67 5f 76 61 6c 75 65 5f 6e 61 6d 65 00}  //weight: 1, accuracy: High
        $x_1_18 = {64 65 62 75 67 [0-2] 73 65 74 74 69 6e 67 73 [0-2] 72 65 67 6b 65 79 6e 61 6d 65}  //weight: 1, accuracy: Low
        $x_1_19 = {72 65 67 5f 6b 65 79 [0-1] 6e 61 6d 65 5f 66 6f 72 [0-5] 64 65 62 75 67 [0-2] 73 65 74 74 69 6e 67 73}  //weight: 1, accuracy: Low
        $x_1_20 = {74 68 65 5f 72 65 67 6b 65 79 5f 6f 66 5f 64 65 62 75 67 5f 73 65 74 74 69 6e 67 73 00}  //weight: 1, accuracy: High
        $x_1_21 = {6c 6f 67 5f 65 6e 61 62 6c 65 5f [0-4] 72 65 67 5f 76 61 6c 75 65 [0-2] 6e 61 6d 65}  //weight: 1, accuracy: Low
        $x_1_22 = {6c 6f 67 67 69 6e 67 [0-2] 65 6e 61 62 6c 65 [0-2] 72 65 67 [0-2] 76 61 6c 75 65 [0-2] 6e 61 6d 65}  //weight: 1, accuracy: Low
        $x_1_23 = {74 68 65 5f 64 65 62 75 67 [0-2] 73 65 74 74 69 6e 67 73 5f 72 65 67 5f 6b 65 79 6e 61 6d 65}  //weight: 1, accuracy: Low
        $x_1_24 = "sai_the_debug_win_main" ascii //weight: 1
        $x_1_25 = {4b 65 79 5f 44 65 62 75 67 5f 53 65 74 74 69 6e 67 00}  //weight: 1, accuracy: High
        $x_1_26 = {54 68 65 5f 44 65 62 75 67 5f 53 65 74 74 69 6e 67 5f 4b 65 79 00}  //weight: 1, accuracy: High
        $x_1_27 = {53 41 49 53 65 74 48 6f 74 6b 65 79 00}  //weight: 1, accuracy: High
        $x_1_28 = "vicparam" ascii //weight: 1
        $x_1_29 = "vic_param" ascii //weight: 1
        $x_1_30 = "parameters_of_vic" ascii //weight: 1
        $x_1_31 = "params_of_vic" ascii //weight: 1
        $x_1_32 = "vicppnskip" ascii //weight: 1
        $x_1_33 = "vic_ppnskip" ascii //weight: 1
        $x_1_34 = "vic_ppn_skip" ascii //weight: 1
        $x_1_35 = "vic_skipppn" ascii //weight: 1
        $x_1_36 = "vic_skip_ppn" ascii //weight: 1
        $x_1_37 = "vicppn_skip" ascii //weight: 1
        $x_1_38 = "vicskip_ppn" ascii //weight: 1
        $x_1_39 = "vicskipppn" ascii //weight: 1
        $x_1_40 = "the_vicppn_skip" ascii //weight: 1
        $x_1_41 = {70 70 6e 5f 76 69 63 [0-1] 73 6b 69 70}  //weight: 1, accuracy: Low
        $x_1_42 = "ppn_skip_vic" ascii //weight: 1
        $x_1_43 = "ppnskip_vic" ascii //weight: 1
        $x_1_44 = "ppnskipvic" ascii //weight: 1
        $x_1_45 = "ppn_skipvic" ascii //weight: 1
        $x_1_46 = "ppnvicskip" ascii //weight: 1
        $x_1_47 = "ppnvic_the_skip" ascii //weight: 1
        $x_1_48 = "ppn_thevicskip" ascii //weight: 1
        $x_1_49 = "ppn_the_vicskip" ascii //weight: 1
        $x_1_50 = "skipvicppn" ascii //weight: 1
        $x_1_51 = "skip_ppnvic" ascii //weight: 1
        $x_1_52 = "skip_ppn_vic" ascii //weight: 1
        $x_1_53 = {73 6b 69 70 5f 76 69 63 5f 70 70 6e 00}  //weight: 1, accuracy: High
        $x_1_54 = "skipvic_ppn" ascii //weight: 1
        $x_1_55 = "ppnvic_skip" ascii //weight: 1
        $x_1_56 = "skipppnvic" ascii //weight: 1
        $x_1_57 = "skipppn_vic" ascii //weight: 1
        $x_1_58 = "ppnvicthe_skip" ascii //weight: 1
        $x_1_59 = "ppn_victhe_skip" ascii //weight: 1
        $x_1_60 = "ppn_vic_the_skip" ascii //weight: 1
        $x_1_61 = "&bname=&bver=&ver=&mt=00UN" ascii //weight: 1
        $x_1_62 = "&bname=&bver=&ver=&mt=00UK" ascii //weight: 1
        $x_1_63 = "&bname=&bver=&ver=0.0.0.0&mt=00" ascii //weight: 1
        $x_1_64 = "&bver=&ver=0.0.0.0&mt=00NKOW" ascii //weight: 1
        $x_1_65 = {26 62 6e 61 6d 65 3d 26 65 69 64 3d ?? ?? ?? ?? 26 62 76 65 72 3d 26 76 65 72 3d 26 6d 74 3d 30 30 4e}  //weight: 1, accuracy: Low
        $x_1_66 = {26 62 6e 61 6d 65 3d 26 65 69 64 3d ?? ?? ?? ?? 26 62 76 65 72 3d 26 74 69 6d 65 3d 2d 30 30 31 2f 2d 31 2f 2d 31 25 32 30 2d 31 3a 2d 31 3a 2d 31}  //weight: 1, accuracy: Low
        $x_1_67 = {26 62 6e 61 6d 65 3d 26 65 69 64 3d ?? ?? ?? ?? 26 75 70 67 3d 6e 26 62 76 65 72 3d 26 74 69 6d 65 3d 2d 30 30 31 2f 2d 31 2f 2d 31 25 32 30 2d 31 3a 2d 31 3a 2d 31}  //weight: 1, accuracy: Low
        $x_1_68 = {26 62 6e 61 6d 65 3d 26 65 69 64 3d ?? ?? ?? ?? 26 68 64 69 64 3d 30 30 2d 30 30 2d 30 30 2d 30 30 2d 30 30 2d 30 30 26 75 70 67 3d 6e 26 62 76 65 72 3d}  //weight: 1, accuracy: Low
        $x_1_69 = {7c 63 73 63 69 64 7c [0-16] 68 64 69 64 7c 6d 74}  //weight: 1, accuracy: Low
        $x_1_70 = "mt|locale|lang|tid|sairnd" ascii //weight: 1
        $x_1_71 = "mt|locale|cscid|tid|sairnd" ascii //weight: 1
        $x_1_72 = "lang|tid|icversion|sairnd" ascii //weight: 1
        $x_1_73 = "tid|icversion|icname|sairnd" ascii //weight: 1
        $x_1_74 = "cscid|tid|lang|sairnd" ascii //weight: 1
        $x_1_75 = "icversion|icname|lang|sairnd" ascii //weight: 1
        $x_1_76 = "tid|locale|icname|lang|sairnd" ascii //weight: 1
        $x_1_77 = "tid|icname|locale|lang|sairnd" ascii //weight: 1
        $x_1_78 = "tid|icname|lang|locale|sairnd" ascii //weight: 1
        $x_1_79 = "cscid|tid|icname|lang|sairnd" ascii //weight: 1
        $x_1_80 = "icname|locale|cscid|tid|sairnd" ascii //weight: 1
        $x_1_81 = "icname|locale|tid|cscid|sairnd" ascii //weight: 1
        $x_1_82 = "mt|icname|locale|tid|sairnd" ascii //weight: 1
        $x_1_83 = "lang|mt|icname|locale|sairnd" ascii //weight: 1
        $x_1_84 = "icversion|lang|mt|icname|sairnd" ascii //weight: 1
        $x_1_85 = "cscid|icversion|lang|mt|sairnd" ascii //weight: 1
        $x_1_86 = {6d 61 6e 69 66 65 73 74 [0-1] 72 65 61 64 66 61 69 6c 65 64}  //weight: 1, accuracy: Low
        $x_1_87 = "bsaitest" wide //weight: 1
        $x_1_88 = {25 30 34 64 25 30 32 64 25 30 32 64 25 30 32 64 25 30 32 64 25 30 32 64 2e 25 30 33 [0-1] 75 2e 25 [0-3] 75 00}  //weight: 1, accuracy: Low
        $x_1_89 = "SAISetHotkey" wide //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((6 of ($x_1_*))) or
            ((1 of ($x_2_*) and 4 of ($x_1_*))) or
            ((2 of ($x_2_*) and 2 of ($x_1_*))) or
            ((3 of ($x_2_*))) or
            (all of ($x*))
        )
}

rule Hotbar_54
{
    meta:
        author = "defender2yara"
        detection_name = "Hotbar"
        threat_id = "6204"
        severity = "10"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = "bname=&bver=&mt=000000&ver=&time=-001/-1/-1%20-1:-1:-&tid=&upg=&" ascii //weight: 1
        $x_1_2 = "bver=&bname=&mt=000000&ver=&time=-001/-1/-1%20-1:-1:-&tid=&upg=&" ascii //weight: 1
        $x_1_3 = "tid=&bver=&bname=&mt=000000&ver=&time=-001/-1/-1%20-1:-1:-&upg=&" ascii //weight: 1
        $x_1_4 = "bver=&tid=&mt=000000&bname=&ver=&time=-001/-1/-1%20-1:-1:-&upg=&" ascii //weight: 1
        $x_1_5 = "bver=&time=-001/-1/-1%20-1:-1:-&tid=&mt=000000&bname=&ver=&upg=&" ascii //weight: 1
        $x_1_6 = "ver=&bver=&time=-001/-1/-1%20-1:-1:-&tid=&mt=000000&bname=&upg=&" ascii //weight: 1
        $x_1_7 = "ver=&mt=000000&bver=&time=-001/-1/-1%20-1:-1:-&tid=&bname=&upg=&" ascii //weight: 1
        $x_1_8 = "bsai_upgrade_url" wide //weight: 1
        $x_1_9 = "b$sai_upgrade_url" wide //weight: 1
        $x_1_10 = "bs$ai_upgrade_url" wide //weight: 1
        $x_1_11 = "bsa$i_upgrade_url" wide //weight: 1
        $x_1_12 = "bsai$_upgrade_url" wide //weight: 1
        $x_1_13 = "bsai_u$pgrade_url" wide //weight: 1
        $x_1_14 = "bsai_up$grade_url" wide //weight: 1
        $x_1_15 = "bsai_upg$rade_url" wide //weight: 1
        $x_1_16 = "bsai_upgr$ade_url" wide //weight: 1
        $x_1_17 = "bsai_upgra$de_url" wide //weight: 1
        $x_1_18 = "b$sai_up$grade_url" wide //weight: 1
        $x_1_19 = "b$sai_up$gra$de_u$rl" wide //weight: 1
        $x_1_20 = "b$sa$i_up$gr$a$de_u$rl" wide //weight: 1
        $x_1_21 = "bs$ai_upgr$ade_url" wide //weight: 1
        $x_1_22 = "bs$ai_upgra$de_url" wide //weight: 1
        $x_1_23 = "bs$ai_upgrade$_url" wide //weight: 1
        $x_1_24 = "bsa$i_upgr$ade_url" wide //weight: 1
        $x_1_25 = "bsa$i_upgra$de_url" wide //weight: 1
        $x_1_26 = "bsa$i_upgrad$e_url" wide //weight: 1
        $x_1_27 = "bsa$i_upgrade$_url" wide //weight: 1
        $x_1_28 = "bsai$_upgr$ade_url" wide //weight: 1
        $x_1_29 = "bsai$_upgrade$_url" wide //weight: 1
        $x_1_30 = "bs$ai_up$gr$ade_h$ash" wide //weight: 1
        $x_1_31 = "bsai_upgrade_hash" wide //weight: 1
        $x_1_32 = "b$sai_upgrade_hash" wide //weight: 1
        $x_1_33 = "bs$ai_upgrade_hash" wide //weight: 1
        $x_1_34 = "bsa$i_upgrade_hash" wide //weight: 1
        $x_1_35 = "bsai_$upgrade_hash" wide //weight: 1
        $x_1_36 = "bsai_up$grade_hash" wide //weight: 1
        $x_1_37 = "bsai_upgr$ade_hash" wide //weight: 1
        $x_1_38 = "bsai_upgra$de_hash" wide //weight: 1
        $x_1_39 = "bsai_upgrad$e_hash" wide //weight: 1
        $x_1_40 = "b$sai_upgrade$_hash" wide //weight: 1
        $x_1_41 = "b$sai_upgrad$e_hash" wide //weight: 1
        $x_1_42 = "b$sai_upg$rad$e_hash" wide //weight: 1
        $x_1_43 = "bs$ai_upgr$ade_hash" wide //weight: 1
        $x_1_44 = "bs$ai_upgra$de_hash" wide //weight: 1
        $x_1_45 = "bsa$i_upgr$ade_hash" wide //weight: 1
        $x_1_46 = "bsa$i_upgra$de_hash" wide //weight: 1
        $x_1_47 = "bsa$i_upgrad$e_hash" wide //weight: 1
        $x_1_48 = "bsa$i_upgrade$_hash" wide //weight: 1
        $x_1_49 = "bsai$_u$pgrade_hash" wide //weight: 1
        $x_1_50 = "bsai$_upgr$ade_hash" wide //weight: 1
        $x_1_51 = "bs$ai$_upg$ra$de_u$rl" wide //weight: 1
        $x_1_52 = "bsaitest" wide //weight: 1
        $x_1_53 = "b_sai_test" wide //weight: 1
        $x_1_54 = "sai_test=%lu (0x%x)" wide //weight: 1
        $x_1_55 = "icname|icversion|tid|arguments.os|locale|arguments.browser|cscid|hdid" wide //weight: 1
        $x_1_56 = "icname|icversion|tid|locale|arguments.os|arguments.browser|cscid|hdid" wide //weight: 1
        $x_1_57 = "icname|tid|icversion|locale|arguments.os|arguments.browser|cscid|hdid" wide //weight: 1
        $x_1_58 = "icname|tid|locale|icversion|arguments.os|arguments.browser|cscid|hdid" wide //weight: 1
        $x_1_59 = "SAISaveSetting('%s', '%s') (was '%s')" wide //weight: 1
        $x_1_60 = "VICParameterNameList" wide //weight: 1
        $x_1_61 = "VIC Upgrade requested, ignored" wide //weight: 1
        $x_1_62 = "SAISetHotkey" wide //weight: 1
        $x_1_63 = {56 00 49 00 43 00 20 00 55 00 52 00 4c 00 3a 00 20 00 25 00 73 00 0d 00 0a 00 56 00 49 00 43 00 20 00 50 00 61 00 72 00 61 00 6d 00 73 00 3a 00}  //weight: 1, accuracy: High
        $x_1_64 = "error reading ASAI signaature: %s" wide //weight: 1
        $x_1_65 = "OnSAIVerifyInstall():" wide //weight: 1
        $x_1_66 = {25 00 64 00 2f 00 25 00 64 00 2f 00 25 00 30 00 34 00 64 00 20 00 25 00 64 00 3a 00 25 00 30 00 32 00 64 00 3a 00 25 00 30 00 32 00 64 00 20 00 25 00 [0-2] 73 00}  //weight: 1, accuracy: Low
        $x_1_67 = {25 00 30 00 34 00 64 00 25 00 30 00 32 00 64 00 25 00 30 00 32 00 64 00 25 00 30 00 32 00 64 00 25 00 30 00 32 00 64 00 25 00 30 00 32 00 64 00 2e 00 25 00 30 00 33 00 75 00 2e 00 25 00 [0-2] 75 00}  //weight: 1, accuracy: Low
        $x_1_68 = "te.aspx?ver=&rnd=" wide //weight: 1
        $x_1_69 = {74 00 65 00 2e 00 61 00 73 00 70 00 78 00 3f 00 72 00 6e 00 64 00 3d 00 [0-6] 26 00 76 00 65 00 72 00 3d 00}  //weight: 1, accuracy: Low
        $x_1_70 = {74 00 65 00 2e 00 61 00 73 00 70 00 78 00 3f 00 61 00 78 00 30 00 3d 00 ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? 26 00 72 00 6e 00 64 00 3d 00 ?? ?? ?? ?? ?? ?? 26 00 76 00 65 00 72 00 3d 00}  //weight: 1, accuracy: Low
        $x_1_71 = "platrium.com" wide //weight: 1
        $x_1_72 = "appbundler.net" wide //weight: 1
        $x_1_73 = "appbundler.com" wide //weight: 1
        $x_1_74 = "pinballcorp.com" wide //weight: 1
        $x_1_75 = "freelandmedia.com" wide //weight: 1
        $x_1_76 = "zango.com" wide //weight: 1
        $x_1_77 = "seekmo.com" wide //weight: 1
        $x_1_78 = "lhoot.com" wide //weight: 1
    condition:
        (filesize < 20MB) and
        (5 of ($x*))
}

rule EGroup_C_0
{
    meta:
        author = "defender2yara"
        detection_name = "EGroup.C"
        threat_id = "6914"
        severity = "8"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "15"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "SOFTWARE\\Microsoft\\Internet Explorer\\AdvancedOptions\\BROWSE\\FRIENDLY_ERRORS" ascii //weight: 1
        $x_5_2 = "electronic-group" ascii //weight: 5
        $x_3_3 = "UNLIMITED ACCESS TO OUR NETWORK" ascii //weight: 3
        $x_4_4 = "SYSTEM\\CurrentControlSet\\Control\\Class\\{4D36E96D-E325-11CE-BFC1-08002BE10318}" ascii //weight: 4
        $x_3_5 = "dial a PREMIUM RATE NUMBER" ascii //weight: 3
        $x_3_6 = "that you are the line subscriber " ascii //weight: 3
        $x_5_7 = "--IEAccess" ascii //weight: 5
        $x_2_8 = "Software\\egroup" ascii //weight: 2
        $x_2_9 = "nocreditcard.com/dial.php" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_4_*) and 2 of ($x_3_*) and 2 of ($x_2_*) and 1 of ($x_1_*))) or
            ((1 of ($x_4_*) and 3 of ($x_3_*) and 1 of ($x_2_*))) or
            ((1 of ($x_5_*) and 2 of ($x_3_*) and 2 of ($x_2_*))) or
            ((1 of ($x_5_*) and 3 of ($x_3_*) and 1 of ($x_1_*))) or
            ((1 of ($x_5_*) and 3 of ($x_3_*) and 1 of ($x_2_*))) or
            ((1 of ($x_5_*) and 1 of ($x_4_*) and 1 of ($x_3_*) and 1 of ($x_2_*) and 1 of ($x_1_*))) or
            ((1 of ($x_5_*) and 1 of ($x_4_*) and 1 of ($x_3_*) and 2 of ($x_2_*))) or
            ((1 of ($x_5_*) and 1 of ($x_4_*) and 2 of ($x_3_*))) or
            ((2 of ($x_5_*) and 2 of ($x_2_*) and 1 of ($x_1_*))) or
            ((2 of ($x_5_*) and 1 of ($x_3_*) and 1 of ($x_2_*))) or
            ((2 of ($x_5_*) and 2 of ($x_3_*))) or
            ((2 of ($x_5_*) and 1 of ($x_4_*) and 1 of ($x_1_*))) or
            ((2 of ($x_5_*) and 1 of ($x_4_*) and 1 of ($x_2_*))) or
            ((2 of ($x_5_*) and 1 of ($x_4_*) and 1 of ($x_3_*))) or
            (all of ($x*))
        )
}

rule IEPlugin_0
{
    meta:
        author = "defender2yara"
        detection_name = "IEPlugin"
        threat_id = "6921"
        severity = "56"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "42"
        strings_accuracy = "High"
    strings:
        $x_10_1 = "SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Browser Helper Objects" ascii //weight: 10
        $x_10_2 = "46fBi500000000000_" ascii //weight: 10
        $x_10_3 = "Profile.Interests.IE.Favorites.%i" ascii //weight: 10
        $x_10_4 = "Name \"Internet Explorer\"" ascii //weight: 10
        $x_1_5 = "{871A54C1-1EB3-48bd-A879-5DBA4EF16BE6}" ascii //weight: 1
        $x_1_6 = "bush_ssevent" ascii //weight: 1
        $x_1_7 = "klinton_ssmmf" ascii //weight: 1
        $x_1_8 = "salan_ssmutant" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((4 of ($x_10_*) and 2 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule IEPlugin_1
{
    meta:
        author = "defender2yara"
        detection_name = "IEPlugin"
        threat_id = "6921"
        severity = "56"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "8"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "IEPluginDesktopToolbar" ascii //weight: 2
        $x_2_2 = "IEPluginDesktopRebar" ascii //weight: 2
        $x_1_3 = "Min ToolBar" ascii //weight: 1
        $x_1_4 = "Go ToolBar" ascii //weight: 1
        $x_2_5 = "Software\\dsktb\\" ascii //weight: 2
        $x_2_6 = "http://search.shopnav.com/" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (
            ((3 of ($x_2_*) and 2 of ($x_1_*))) or
            ((4 of ($x_2_*))) or
            (all of ($x*))
        )
}

rule EGroup_G_0
{
    meta:
        author = "defender2yara"
        detection_name = "EGroup.G"
        threat_id = "7112"
        severity = "36"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "10"
        strings_accuracy = "High"
    strings:
        $x_5_1 = "eghtmldialer.dll" ascii //weight: 5
        $x_2_2 = "http://network.nocreditcard.com/DialHTML" ascii //weight: 2
        $x_2_3 = "SOFTWARE\\egroup" ascii //weight: 2
        $x_1_4 = "IEDiscoShowTime" ascii //weight: 1
        $x_1_5 = "TopMostIEDisco" ascii //weight: 1
        $x_1_6 = "The connection has been cut, do you want to reconnect?" ascii //weight: 1
        $x_1_7 = "RASPHONE.EXE" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_5_*) and 1 of ($x_2_*) and 3 of ($x_1_*))) or
            ((1 of ($x_5_*) and 2 of ($x_2_*) and 1 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule EGroup_G_1
{
    meta:
        author = "defender2yara"
        detection_name = "EGroup.G"
        threat_id = "7112"
        severity = "36"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "9"
        strings_accuracy = "High"
    strings:
        $x_4_1 = "CEGException::CEGException() entered" ascii //weight: 4
        $x_2_2 = "eghost_" ascii //weight: 2
        $x_3_3 = "dorasmonitor" ascii //weight: 3
        $x_2_4 = "instant access.exe" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_4_*) and 1 of ($x_3_*) and 1 of ($x_2_*))) or
            (all of ($x*))
        )
}

rule Look2Me_0
{
    meta:
        author = "defender2yara"
        detection_name = "Look2Me"
        threat_id = "8132"
        severity = "13"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "41"
        strings_accuracy = "High"
    strings:
        $x_10_1 = "http://www.look2me.com/" ascii //weight: 10
        $x_10_2 = "CreateToolhelp32Snapshot" ascii //weight: 10
        $x_10_3 = "User-Agent:" ascii //weight: 10
        $x_10_4 = "DETECTREGUSERS" ascii //weight: 10
        $x_1_5 = "Look2Me_Class" ascii //weight: 1
        $x_1_6 = "NeoSoft_Class" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((4 of ($x_10_*) and 1 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule Look2Me_1
{
    meta:
        author = "defender2yara"
        detection_name = "Look2Me"
        threat_id = "8132"
        severity = "13"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "15"
        strings_accuracy = "High"
    strings:
        $x_3_1 = "CLSID\\%s\\Implemented Categories\\{00021492-0000-0000-C000-000000000046}" ascii //weight: 3
        $x_1_2 = "ad_Class" ascii //weight: 1
        $x_1_3 = "Deskband" ascii //weight: 1
        $x_1_4 = "AdServer" ascii //weight: 1
        $x_1_5 = "sendExternalUrl" ascii //weight: 1
        $x_1_6 = "sendExternalEvent" ascii //weight: 1
        $x_2_7 = "www.ad-w-a-r-e.com" ascii //weight: 2
        $x_2_8 = "www.a-d-w-a-r-e.com" ascii //weight: 2
        $x_3_9 = "http://%s/AD/UCMD?" ascii //weight: 3
        $x_3_10 = "http://%s/AD/CMD?" ascii //weight: 3
        $x_3_11 = "NicTech Networks" ascii //weight: 3
    condition:
        (filesize < 20MB) and
        (
            ((2 of ($x_3_*) and 2 of ($x_2_*) and 5 of ($x_1_*))) or
            ((3 of ($x_3_*) and 1 of ($x_2_*) and 4 of ($x_1_*))) or
            ((3 of ($x_3_*) and 2 of ($x_2_*) and 2 of ($x_1_*))) or
            ((4 of ($x_3_*) and 3 of ($x_1_*))) or
            ((4 of ($x_3_*) and 1 of ($x_2_*) and 1 of ($x_1_*))) or
            ((4 of ($x_3_*) and 2 of ($x_2_*))) or
            (all of ($x*))
        )
}

rule Look2Me_2
{
    meta:
        author = "defender2yara"
        detection_name = "Look2Me"
        threat_id = "8132"
        severity = "13"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "8"
        strings_accuracy = "High"
    strings:
        $n_100_1 = "\\Simply Super Software\\Trojan Remover\\" ascii //weight: -100
        $x_1_2 = "SOFTWARE\\Borland\\Delphi\\RTL" ascii //weight: 1
        $x_1_3 = "ad-w-a-r-e.com" ascii //weight: 1
        $x_1_4 = "rmvtrjan.exe" ascii //weight: 1
        $x_1_5 = "trupd.exe" ascii //weight: 1
        $x_1_6 = "simplysup.com" ascii //weight: 1
        $x_1_7 = "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\explorer\\Browser Helper Objects" ascii //weight: 1
        $x_1_8 = "CreateMutexA" ascii //weight: 1
        $x_1_9 = "URLDownloadToCacheFileA" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (not (any of ($n*))) and
        (all of ($x*))
}

rule Look2Me_3
{
    meta:
        author = "defender2yara"
        detection_name = "Look2Me"
        threat_id = "8132"
        severity = "13"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "12"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Streams\\Desktop" ascii //weight: 1
        $x_3_2 = "CLSID\\%s\\Implemented Categories\\{00021492-0000-0000-C000-000000000046}" ascii //weight: 3
        $x_2_3 = "CLSID\\{DDFFA75A-E81D-4454-89FC-B9FD0631E725}" ascii //weight: 2
        $x_1_4 = "%smsg%d.dll" ascii //weight: 1
        $x_1_5 = "PARTNERID" ascii //weight: 1
        $x_1_6 = "Guardian" ascii //weight: 1
        $x_2_7 = "{DDFFA75A-E81D-4454-89FC-B9FD0631E728}" ascii //weight: 2
        $x_5_8 = "NICTECH NETWORKS LLC (the " ascii //weight: 5
        $x_5_9 = "www.nictechnetworks.com/eula.html  By continuing to use the SOFTWARE PRODUCT after the EULA is " ascii //weight: 5
        $x_5_10 = "ADWARE application\\Core\\Dev\\Installer\\Release\\Install.pdb" ascii //weight: 5
        $x_3_11 = "MyBands Installer" wide //weight: 3
        $x_1_12 = "I Accept" wide //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_3_*) and 2 of ($x_2_*) and 5 of ($x_1_*))) or
            ((2 of ($x_3_*) and 1 of ($x_2_*) and 4 of ($x_1_*))) or
            ((2 of ($x_3_*) and 2 of ($x_2_*) and 2 of ($x_1_*))) or
            ((1 of ($x_5_*) and 1 of ($x_2_*) and 5 of ($x_1_*))) or
            ((1 of ($x_5_*) and 2 of ($x_2_*) and 3 of ($x_1_*))) or
            ((1 of ($x_5_*) and 1 of ($x_3_*) and 4 of ($x_1_*))) or
            ((1 of ($x_5_*) and 1 of ($x_3_*) and 1 of ($x_2_*) and 2 of ($x_1_*))) or
            ((1 of ($x_5_*) and 1 of ($x_3_*) and 2 of ($x_2_*))) or
            ((1 of ($x_5_*) and 2 of ($x_3_*) and 1 of ($x_1_*))) or
            ((1 of ($x_5_*) and 2 of ($x_3_*) and 1 of ($x_2_*))) or
            ((2 of ($x_5_*) and 2 of ($x_1_*))) or
            ((2 of ($x_5_*) and 1 of ($x_2_*))) or
            ((2 of ($x_5_*) and 1 of ($x_3_*))) or
            ((3 of ($x_5_*))) or
            (all of ($x*))
        )
}

rule C2Lop_B_0
{
    meta:
        author = "defender2yara"
        detection_name = "C2Lop.B"
        threat_id = "8144"
        severity = "124"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "22"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "software\\microsoft\\internet explorer\\toolbar" ascii //weight: 1
        $x_1_2 = "http://%s/search/search.cgi?src=autosearch&s=%s" ascii //weight: 1
        $x_10_3 = {53 6f 66 74 77 61 72 65 5c 25 73 00 54 72 69 6e 69 74 79 41 59 42}  //weight: 10, accuracy: High
        $x_10_4 = {73 77 69 73 68 74 6f 6f 6c 62 61 6e 64 00}  //weight: 10, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule C2Lop_B_1
{
    meta:
        author = "defender2yara"
        detection_name = "C2Lop.B"
        threat_id = "8144"
        severity = "124"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "10"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "98047B0354E6472E21E7E658C581EAA5" ascii //weight: 2
        $x_2_2 = "8F569C59BBD4B05BAFD3963A3A0B22" ascii //weight: 2
        $x_2_3 = "4D3A8DC3F9C4F29EE0DB" ascii //weight: 2
        $x_2_4 = "643EC0FBDB2DF584BAC9BCC695B98AA3D2E5DD8627D8A3D5" ascii //weight: 2
        $x_2_5 = {44 45 4c 41 46 46 49 44 00}  //weight: 2, accuracy: High
        $x_2_6 = "760BC9555C116FEB472810F6F05DEF97AFE66A74A2E56BE42" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (5 of ($x*))
}

rule C2Lop_B_2
{
    meta:
        author = "defender2yara"
        detection_name = "C2Lop.B"
        threat_id = "8144"
        severity = "124"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "8"
        strings_accuracy = "High"
    strings:
        $x_2_1 = {c1 e0 10 03 f0 81 f6 b3 3a 29 f0}  //weight: 2, accuracy: High
        $x_2_2 = {25 01 00 00 80 79 05 48 83 c8 fe 40 f7 d8 1b c0 83 e0 02 83 c0 ff 03 45 fc 50}  //weight: 2, accuracy: High
        $x_2_3 = {64 ff 30 64 89 20 6a 0d 59 f3 ab 8b fa 64 8b 48 30 8c da f6 c2 04 75 74 ba 6c 02 fe 7f 8a 22 80 fc 04 8a 42 04 72 05 80 fc 05 76 04 66 b8 33 03 c1 e0 10 66 b8 46 05 ab 8b 51 0c 8b 42 1c 8b 58 08 b8}  //weight: 2, accuracy: High
        $x_2_4 = {ff d6 ab 3b c3 8d ab 00 00 03 00 72 15 3b c5 73 11 2d f1 00 00 00 6a 5f 59 e8 a6 00 00 00 85 c9 75 66 b8}  //weight: 2, accuracy: High
        $x_2_5 = {60 8e 46 00 e8 c8 7d fc ff 83 c4 08 8b 95 0c ff ff ff 52 68 98 8d 46 00 e8 b4 7d fc ff 83 c4 08 8b 85 50 ff}  //weight: 2, accuracy: High
        $x_2_6 = {4c 8a 46 00 e8 de 76 fc ff 83 c4 04 89 45 e4 68 64 8a 46 00 e8 ce 76 fc ff 83 c4 04 89 45 e0 68 78 8a 46}  //weight: 2, accuracy: High
        $x_1_7 = {31 2e 32 2e 31 00 00 00 31 2e 32 2e 31 00 00 00}  //weight: 1, accuracy: High
        $x_1_8 = "UrlMkSetSessionOption" ascii //weight: 1
        $x_1_9 = "FlushInstructionCache" ascii //weight: 1
        $x_1_10 = "list<T> too long" ascii //weight: 1
        $x_1_11 = "deque<T> too long" ascii //weight: 1
        $x_1_12 = "VC20XC00U" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_2_*) and 6 of ($x_1_*))) or
            ((2 of ($x_2_*) and 4 of ($x_1_*))) or
            ((3 of ($x_2_*) and 2 of ($x_1_*))) or
            ((4 of ($x_2_*))) or
            (all of ($x*))
        )
}

rule C2Lop_B_3
{
    meta:
        author = "defender2yara"
        detection_name = "C2Lop.B"
        threat_id = "8144"
        severity = "124"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "13"
        strings_accuracy = "High"
    strings:
        $x_2_1 = {03 f0 81 f6 b3 3a 29 f0 e8}  //weight: 2, accuracy: High
        $x_1_2 = "UrlMkSetSessionOption" ascii //weight: 1
        $x_1_3 = "CreateRemoteThread" ascii //weight: 1
        $x_1_4 = "URLDownloadToFileA" ascii //weight: 1
        $x_1_5 = {e0 34 44 00}  //weight: 1, accuracy: High
        $x_1_6 = {34 35 44 00}  //weight: 1, accuracy: High
        $x_1_7 = {04 35 44 00}  //weight: 1, accuracy: High
        $x_1_8 = {1c 35 44 00}  //weight: 1, accuracy: High
        $x_1_9 = {dc 3e 44 00}  //weight: 1, accuracy: High
        $x_1_10 = {4c 3a 44 00}  //weight: 1, accuracy: High
        $x_1_11 = {78 19 44 00}  //weight: 1, accuracy: High
        $x_1_12 = {8c 19 44 00}  //weight: 1, accuracy: High
        $x_1_13 = {a8 19 44 00}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_2_*) and 11 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule C2Lop_B_4
{
    meta:
        author = "defender2yara"
        detection_name = "C2Lop.B"
        threat_id = "8144"
        severity = "124"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "14"
        strings_accuracy = "High"
    strings:
        $x_2_1 = {03 f0 81 f6 b3 3a 29 f0 e8}  //weight: 2, accuracy: High
        $x_1_2 = "UrlMkSetSessionOption" ascii //weight: 1
        $x_1_3 = "CreateRemoteThread" ascii //weight: 1
        $x_1_4 = "URLDownloadToFileA" ascii //weight: 1
        $x_1_5 = {24 2c 25 44 00}  //weight: 1, accuracy: High
        $x_1_6 = {8c 68 44 25 44 00}  //weight: 1, accuracy: High
        $x_1_7 = {a0 68 5c 25 44 00}  //weight: 1, accuracy: High
        $x_1_8 = {dc 09 44 00}  //weight: 1, accuracy: High
        $x_1_9 = {f8 20 44 00}  //weight: 1, accuracy: High
        $x_1_10 = {a4 09 44 00}  //weight: 1, accuracy: High
        $x_1_11 = {c7 04 24 34 03 44 00}  //weight: 1, accuracy: High
        $x_1_12 = {89 85 f8 e7 ff ff c7 04 24 a4 09 44 00}  //weight: 1, accuracy: High
        $x_1_13 = {08 e8 ff ff c7 04 24 c0 09 44 00}  //weight: 1, accuracy: High
        $x_1_14 = {a0 c7 04 24 04 2f 44 00}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_2_*) and 12 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule C2Lop_B_5
{
    meta:
        author = "defender2yara"
        detection_name = "C2Lop.B"
        threat_id = "8144"
        severity = "124"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "KRSystem v1.0" ascii //weight: 2
        $x_1_2 = "AIEN " ascii //weight: 1
        $x_1_3 = "UrlMkSetSessionOption" ascii //weight: 1
        $x_1_4 = {61 65 72 6f 00 00 00 00 52 4b 4d 57}  //weight: 1, accuracy: High
        $x_1_5 = "CreateRemoteThread" ascii //weight: 1
        $x_2_6 = "http://upd.lop.com/upd/check" ascii //weight: 2
        $x_2_7 = "http://upd.zone-media.com/upd/check" ascii //weight: 2
        $x_2_8 = {c1 e0 10 03 f0 81 f6 b3 3a 29 f0}  //weight: 2, accuracy: High
        $x_2_9 = "643EC0FBDB2DF584BAC9BCC695B98AA3D2E5DD8627D8A3D5" ascii //weight: 2
        $x_1_10 = "Download UBAgent" ascii //weight: 1
        $x_1_11 = "updbho.dll" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((6 of ($x_1_*))) or
            ((1 of ($x_2_*) and 4 of ($x_1_*))) or
            ((2 of ($x_2_*) and 2 of ($x_1_*))) or
            ((3 of ($x_2_*))) or
            (all of ($x*))
        )
}

rule C2Lop_B_6
{
    meta:
        author = "defender2yara"
        detection_name = "C2Lop.B"
        threat_id = "8144"
        severity = "124"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "8B08C94D3F34E2D354F293AFE67707" ascii //weight: 2
        $x_2_2 = "7327650404FE207BF7D9C09DA47B38E0" ascii //weight: 2
        $x_2_3 = "4D3A8DC3F9C4F29EE0DB" ascii //weight: 2
        $x_2_4 = "295C7A21F29E2D56BD59EA8FF97B" ascii //weight: 2
        $x_2_5 = "6B23D2848C471E91F42B9E9E" ascii //weight: 2
        $x_2_6 = "CC35F98FC8EFFDC0B392" ascii //weight: 2
        $x_1_7 = "Bad Elmo" ascii //weight: 1
        $x_1_8 = "You must install this software as part of the parent program.  Press OK to exit." ascii //weight: 1
        $x_1_9 = "CreateRemoteThread" ascii //weight: 1
        $x_1_10 = "URLDownloadToFileA" ascii //weight: 1
        $x_1_11 = "FlushInstructionCache" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_2_*) and 4 of ($x_1_*))) or
            ((2 of ($x_2_*) and 2 of ($x_1_*))) or
            ((3 of ($x_2_*))) or
            (all of ($x*))
        )
}

rule NewDotNet_0
{
    meta:
        author = "defender2yara"
        detection_name = "NewDotNet"
        threat_id = "9108"
        severity = "27"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "10"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Microsoft Visual C++ Runtime Library" ascii //weight: 1
        $x_1_2 = "client.new.tech.new.net" ascii //weight: 1
        $x_1_3 = "nnrun.exe" ascii //weight: 1
        $x_1_4 = "AF8637B0-18E3-44D3-86B7-55E09D9C4261" ascii //weight: 1
        $x_1_5 = "nncore.dll" ascii //weight: 1
        $x_1_6 = "Software\\Microsoft\\Windows\\CurrentVersion\\Run" ascii //weight: 1
        $x_1_7 = "OpenSCManagerA" ascii //weight: 1
        $x_1_8 = "CreateServiceA" ascii //weight: 1
        $x_1_9 = "InternetOpenUrlA" ascii //weight: 1
        $x_1_10 = "GetClipboardData" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule NewDotNet_1
{
    meta:
        author = "defender2yara"
        detection_name = "NewDotNet"
        threat_id = "9108"
        severity = "27"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "10"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Software\\New.net" ascii //weight: 1
        $x_1_2 = "Software\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\New.net" ascii //weight: 1
        $x_1_3 = "New.net Startup" ascii //weight: 1
        $x_1_4 = "rundll32 %s,NewDotNetStartup" ascii //weight: 1
        $x_1_5 = "NewDotNetClass" ascii //weight: 1
        $x_1_6 = "\\NewDotNet\\" ascii //weight: 1
        $x_1_7 = "{DD521A1D-1F98-11D4-9676-00E018981B9E}" ascii //weight: 1
        $x_1_8 = "{5BC27861-314A-11D6-996D-00E018981B9E}" ascii //weight: 1
        $x_1_9 = "{4A2AACF3-ADF6-11D5-98A9-00E018981B9E}" ascii //weight: 1
        $x_1_10 = "Tldctl2.URLLink" ascii //weight: 1
        $x_1_11 = "Tldctl2.URLLink.1" ascii //weight: 1
        $x_1_12 = "Tldctl2.SearchControl" ascii //weight: 1
        $x_1_13 = "Tldctl2.SearchControl.1" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (10 of ($x*))
}

rule Coolwebsearch_L_0
{
    meta:
        author = "defender2yara"
        detection_name = "Coolwebsearch.L"
        threat_id = "11801"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "search--control.com" ascii //weight: 2
        $x_2_2 = "support.php?yz=yes" ascii //weight: 2
        $x_2_3 = "ULWindowSeek" ascii //weight: 2
        $x_2_4 = "sert98.reg" ascii //weight: 2
        $x_2_5 = "sertXP.reg" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (3 of ($x*))
}

rule Tibs_0
{
    meta:
        author = "defender2yara"
        detection_name = "Tibs"
        threat_id = "13043"
        severity = "12"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "tibs://connect" ascii //weight: 2
        $x_1_2 = "Oleacc.dll" ascii //weight: 1
        $x_1_3 = "Test Download" ascii //weight: 1
        $x_2_4 = "http://directplugin.com/dialers/" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Tibs_1
{
    meta:
        author = "defender2yara"
        detection_name = "Tibs"
        threat_id = "13043"
        severity = "12"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Software\\Borland\\Delphi\\Locales" ascii //weight: 1
        $x_1_2 = "TBiDiMode" ascii //weight: 1
        $x_1_3 = "Please wait while we prepare the plugin" ascii //weight: 1
        $x_1_4 = "Thank you for choosing to be on our web site" ascii //weight: 1
        $x_1_5 = "TIBSBRW" ascii //weight: 1
        $x_2_6 = "tibs://connect" wide //weight: 2
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_2_*) and 4 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule Tibs_2
{
    meta:
        author = "defender2yara"
        detection_name = "Tibs"
        threat_id = "13043"
        severity = "12"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "7"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "There appears to be no modem installed on your computer" ascii //weight: 1
        $x_2_2 = "tibsystems.com/cgi-bin/blocked." ascii //weight: 2
        $x_1_3 = "Dialing already in progress" ascii //weight: 1
        $x_2_4 = "The Web Site you are about to enter is an ADULT SITE and as such you MUST be over 18 or over the age " ascii //weight: 2
        $x_2_5 = "www.dialeradmin.com" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (
            ((3 of ($x_2_*) and 1 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule Conducent_0
{
    meta:
        author = "defender2yara"
        detection_name = "Conducent"
        threat_id = "13058"
        severity = "32"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "11"
        strings_accuracy = "High"
    strings:
        $x_4_1 = "TimeSink Kill Ad Client" ascii //weight: 4
        $x_2_2 = "TS_MgmtGetAdClickThroughURL" ascii //weight: 2
        $x_3_3 = "Conducent AdGateway" wide //weight: 3
        $x_2_4 = "Conducent Technologies, Inc." wide //weight: 2
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Wintrim_0
{
    meta:
        author = "defender2yara"
        detection_name = "Wintrim"
        threat_id = "13255"
        severity = "7"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {5c 68 6f 73 74 2e 64 62 00}  //weight: 1, accuracy: High
        $x_1_2 = {53 45 4c 45 43 54 20 2a 20 46 52 4f 4d 20 64 6f 6d 61 69 6e 20 57 48 45 52 45 20 27 25 73 27 20 4c 49 4b 45 20 64 6f 6d 61 69 6e 20 41 4e 44 20 74 79 70 65 3d 34 00}  //weight: 1, accuracy: High
        $x_1_3 = {55 50 44 41 54 45 20 61 64 76 65 72 74 69 73 65 20 53 45 54 20 73 68 6f 77 63 6e 74 3d 73 68 6f 77 63 6e 74 2b 31 20 57 48 45 52 45 20 69 64 78 3d 25 64 00}  //weight: 1, accuracy: High
        $x_1_4 = {53 45 4c 45 43 54 20 69 64 78 2c 61 64 76 20 46 52 4f 4d 20 61 64 76 65 72 74 69 73 65 20 57 48 45 52 45 20 25 73 20 4f 52 44 45 52 20 42 59 20 73 68 6f 77 63 6e 74 20 41 53 43 00}  //weight: 1, accuracy: High
        $x_1_5 = {55 50 44 41 54 45 20 61 64 76 65 72 74 69 73 65 20 53 45 54 20 73 68 6f 77 63 6e 74 3d 73 68 6f 77 63 6e 74 2b 31 2c 20 6c 61 73 74 73 68 6f 77 3d 25 64 20 57 48 45 52 45 20 69 64 78 3d 25 64 00}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Wintrim_1
{
    meta:
        author = "defender2yara"
        detection_name = "Wintrim"
        threat_id = "13255"
        severity = "7"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "8"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "mymutsglwork" ascii //weight: 2
        $x_1_2 = "software\\epk_extr" ascii //weight: 1
        $x_1_3 = "Software\\livesvc" ascii //weight: 1
        $x_1_4 = "<_EGMC_>" ascii //weight: 1
        $x_1_5 = "Finstall_dir" ascii //weight: 1
        $x_2_6 = "HotTVPlayer" ascii //weight: 2
        $x_1_7 = "CEGTools::CreateDirectory() entered" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((2 of ($x_2_*) and 4 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule Mostrar_0
{
    meta:
        author = "defender2yara"
        detection_name = "Mostrar"
        threat_id = "14790"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "http://acceso.masminutos.com" ascii //weight: 1
        $x_1_2 = "http://vip.escritorioactivo.com/controlContinuidad.htm" ascii //weight: 1
        $x_1_3 = "RasDialA" ascii //weight: 1
        $x_1_4 = "EF6D6AE3-2625-40D6-A5AB-920DFD2DAF8C" ascii //weight: 1
        $x_1_5 = "Ventana Minidialer" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule MediaTicketsCDT_0
{
    meta:
        author = "defender2yara"
        detection_name = "MediaTicketsCDT"
        threat_id = "14900"
        severity = "13"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "RU Store Value" ascii //weight: 1
        $x_1_2 = "remote_update" ascii //weight: 1
        $x_1_3 = "seedremote_update" ascii //weight: 1
        $x_2_4 = "Clickspring Autorun" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_2_*) and 2 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule MediaTicketsCDT_1
{
    meta:
        author = "defender2yara"
        detection_name = "MediaTicketsCDT"
        threat_id = "14900"
        severity = "13"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "nf.outerinfo.com/nf404.php" ascii //weight: 1
        $x_1_2 = "%s?url=%s&rid=%010.0f" ascii //weight: 1
        $x_1_3 = "{2E9D4C81-9F27-4c14-B804-7B0F6BC88A4F}" ascii //weight: 1
        $x_1_4 = "ndrv.dll" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (3 of ($x*))
}

rule MediaTicketsCDT_2
{
    meta:
        author = "defender2yara"
        detection_name = "MediaTicketsCDT"
        threat_id = "14900"
        severity = "13"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "8"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "fp.clickspring.net/fingerprint.php" ascii //weight: 2
        $x_2_2 = "SOFTWARE\\ClickSpring" ascii //weight: 2
        $x_1_3 = "/dispatcher.php" ascii //weight: 1
        $x_2_4 = "fp.outerinfo.com" ascii //weight: 2
        $x_1_5 = "63.251.135.24" ascii //weight: 1
        $x_1_6 = "Outerinfo" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((3 of ($x_2_*) and 2 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule MediaTicketsCDT_3
{
    meta:
        author = "defender2yara"
        detection_name = "MediaTicketsCDT"
        threat_id = "14900"
        severity = "13"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "8"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Software\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\Outerinfo" ascii //weight: 1
        $x_1_2 = "\\outerinfo.ico" ascii //weight: 1
        $x_1_3 = "Outerinfo Setup" ascii //weight: 1
        $x_1_4 = "Removes Outerinfo from this computer" ascii //weight: 1
        $x_1_5 = "Outerinfo.exe" ascii //weight: 1
        $x_1_6 = "Outerinfo.dll" ascii //weight: 1
        $x_1_7 = "KillNDrv.dll" ascii //weight: 1
        $x_1_8 = "C:\\Program Files\\Outerinfo" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule MediaTicketsCDT_4
{
    meta:
        author = "defender2yara"
        detection_name = "MediaTicketsCDT"
        threat_id = "14900"
        severity = "13"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "8"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "outerinfo.com/consumers " ascii //weight: 1
        $x_1_2 = "iframe" ascii //weight: 1
        $x_1_3 = "ad.oinadserver.com" ascii //weight: 1
        $x_1_4 = "Entering GetOINAdWindowsCount" ascii //weight: 1
        $x_1_5 = "%%CONTEXTUAL_KEYWORDS%%" ascii //weight: 1
        $x_1_6 = "%%CONTEXTUAL_DOMAIN%%" ascii //weight: 1
        $x_1_7 = "CONTEXTUAL" ascii //weight: 1
        $x_1_8 = "OuterinfoTemp" ascii //weight: 1
        $x_1_9 = "SOFTWARE\\ClickSpring" ascii //weight: 1
        $x_1_10 = "globalLimitAdWindowsOpened" ascii //weight: 1
        $x_1_11 = "displayRONAds" ascii //weight: 1
        $x_1_12 = "displayCtxAds" ascii //weight: 1
        $x_1_13 = "numberOfAds" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (8 of ($x*))
}

rule MediaTicketsCDT_5
{
    meta:
        author = "defender2yara"
        detection_name = "MediaTicketsCDT"
        threat_id = "14900"
        severity = "13"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "18"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "outerinfo.ico" ascii //weight: 1
        $x_1_2 = "OiUninstaller.exe" ascii //weight: 1
        $x_1_3 = "Software\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\Outerinfo" ascii //weight: 1
        $x_2_4 = "OinUninstall.exe" ascii //weight: 2
        $x_2_5 = "OuterinfoUpdate.exe" ascii //weight: 2
        $x_1_6 = "mailto:uninstaller@outerinfo.com" ascii //weight: 1
        $x_1_7 = "\\OinFP.exe" ascii //weight: 1
        $x_1_8 = "\\OinADInst.exe" ascii //weight: 1
        $x_1_9 = "\\KillNDrv.dll" ascii //weight: 1
        $x_1_10 = "KillRU" ascii //weight: 1
        $x_1_11 = "C:\\Program Files\\Outerinfo" ascii //weight: 1
        $x_1_12 = "[rename]" ascii //weight: 1
        $x_4_13 = "Software\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\Mediatickets" ascii //weight: 4
        $x_4_14 = "MediaTicketsInstaller.ocx" ascii //weight: 4
        $x_4_15 = "mtuninst.exe" ascii //weight: 4
        $x_1_16 = "Invalid code! Please try again." ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_4_*) and 2 of ($x_2_*) and 10 of ($x_1_*))) or
            ((2 of ($x_4_*) and 10 of ($x_1_*))) or
            ((2 of ($x_4_*) and 1 of ($x_2_*) and 8 of ($x_1_*))) or
            ((2 of ($x_4_*) and 2 of ($x_2_*) and 6 of ($x_1_*))) or
            ((3 of ($x_4_*) and 6 of ($x_1_*))) or
            ((3 of ($x_4_*) and 1 of ($x_2_*) and 4 of ($x_1_*))) or
            ((3 of ($x_4_*) and 2 of ($x_2_*) and 2 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule SysWebTelecomInt_0
{
    meta:
        author = "defender2yara"
        detection_name = "SysWebTelecomInt"
        threat_id = "14987"
        severity = "6"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "8"
        strings_accuracy = "High"
    strings:
        $x_5_1 = "SysWebTelecom.DLL" ascii //weight: 5
        $x_1_2 = "RasGetEntryDialParamsA" ascii //weight: 1
        $x_1_3 = "seguro que desea desconectarse?" ascii //weight: 1
        $x_1_4 = "Error conectando con el siguiente c" ascii //weight: 1
        $x_1_5 = "Ha habido un error intentando conectar." ascii //weight: 1
        $x_1_6 = "spanish-dominican republic" ascii //weight: 1
        $x_1_7 = "english-trinidad y tobago" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_5_*) and 3 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule INetBar_0
{
    meta:
        author = "defender2yara"
        detection_name = "INetBar"
        threat_id = "15149"
        severity = "Mid"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Commander Toolbar" ascii //weight: 1
        $x_1_2 = {53 4f 46 54 57 41 52 45 5c 4d 69 63 72 6f 73 6f 66 74 5c 57 69 6e 64 6f 77 73 5c 43 75 72 72 65 6e 74 56 65 72 73 69 6f 6e 5c 55 6e 69 6e 73 74 61 6c 6c 00 49 45 54 42}  //weight: 1, accuracy: High
        $x_1_3 = "Commander IE Toolbar\\VisitedPopups" ascii //weight: 1
        $x_1_4 = "http://www.direct-ip.com/" ascii //weight: 1
        $x_1_5 = "{6596829B-37D4-40ad-971B-1E9041725C52}" ascii //weight: 1
        $x_1_6 = {69 65 74 62 2e 64 6c 6c 00 44 6c 6c 43 61 6e 55 6e 6c 6f 61 64 4e 6f 77}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (5 of ($x*))
}

rule PornDialer_0
{
    meta:
        author = "defender2yara"
        detection_name = "PornDialer"
        threat_id = "15261"
        severity = "Low"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "RasDialA" ascii //weight: 1
        $x_1_2 = "shing\\Trust Database\\0" ascii //weight: 1
        $x_2_3 = "SysWebSoft S.R.L." ascii //weight: 2
        $x_2_4 = "einer 0190-Nummer" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_2_*) and 2 of ($x_1_*))) or
            ((2 of ($x_2_*))) or
            (all of ($x*))
        )
}

rule Coolwebsearch_R_0
{
    meta:
        author = "defender2yara"
        detection_name = "Coolwebsearch.R"
        threat_id = "15342"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "SearchHook.SearchHook" ascii //weight: 1
        $x_1_2 = "{FD9BC004-8331-4457-B830-4759FF704C22}\\URLSearchHooks" ascii //weight: 1
        $x_1_3 = "http://www.search-and-find.net" wide //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule WebDir_0
{
    meta:
        author = "defender2yara"
        detection_name = "WebDir"
        threat_id = "16190"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "8"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "Browser Helper Objects" ascii //weight: 2
        $x_2_2 = "\\webdir project\\" ascii //weight: 2
        $x_2_3 = {2e 64 6c 6c 00 44 6c 6c 43 61 6e 55 6e 6c 6f 61 64 4e 6f 77}  //weight: 2, accuracy: High
        $x_2_4 = {49 6e 74 65 72 6e 65 74 47 65 74 43 6f 6e 6e 65 63 74 65 64 53 74 61 74 65 00}  //weight: 2, accuracy: High
        $x_1_5 = "376892AE-1825-4E5F-9F85-23F9640051CC" ascii //weight: 1
        $x_1_6 = "1FD79A59-37B1-459B-9097-09F9FAB8A523" ascii //weight: 1
        $x_1_7 = "DNSCacheModule" ascii //weight: 1
        $x_1_8 = "dns.everer.com" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((2 of ($x_2_*) and 4 of ($x_1_*))) or
            ((3 of ($x_2_*) and 2 of ($x_1_*))) or
            ((4 of ($x_2_*))) or
            (all of ($x*))
        )
}

rule _2Search_0
{
    meta:
        author = "defender2yara"
        detection_name = "2Search"
        threat_id = "16269"
        severity = "27"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {53 6f 6d 65 20 63 72 61 7a 79 20 75 6e 6b 6e 6f 77 6e 20 65 72 72 6f 72 00}  //weight: 1, accuracy: High
        $x_1_2 = {47 65 74 57 65 62 46 69 6c 65 00}  //weight: 1, accuracy: High
        $x_1_3 = {61 6d 61 7a 69 6e 67 2d 76 69 64 65 6f 73 2e 6e 65 74 00}  //weight: 1, accuracy: High
        $x_1_4 = {34 35 30 38 45 32 30 43 2d 41 43 41 44 2d 31 31 44 32 2d 39 46 43 30 2d 30 30 35 35 30 30 37 36 45 30 36 46 7d 00}  //weight: 1, accuracy: High
        $x_1_5 = {64 6f 77 6e 6c 6f 61 64 2e 30 30 37 67 75 61 72 64 2e 63 6f 6d 00}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (3 of ($x*))
}

rule _2Search_1
{
    meta:
        author = "defender2yara"
        detection_name = "2Search"
        threat_id = "16269"
        severity = "27"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "102"
        strings_accuracy = "Low"
    strings:
        $x_50_1 = "IMAdvertiser" ascii //weight: 50
        $x_50_2 = "<reserved entry, do not use>" ascii //weight: 50
        $x_1_3 = "Check it ouy man" ascii //weight: 1
        $x_1_4 = "Yo watch these amazing videos" ascii //weight: 1
        $x_1_5 = {4c 6f 6f 6b 20 61 74 20 74 68 69 73 20 73 69 74 65 3a 20 [0-32] 20 28 69 74 27 73 20 66 72 65 65 29}  //weight: 1, accuracy: Low
        $x_1_6 = {49 20 67 6f 74 20 6d 79 20 41 49 4d 20 4e 61 6d 65 73 20 66 72 6f 6d 20 [0-40] 2c 20 74 68 65 79 27 72 65 20 66 72 65 65 21}  //weight: 1, accuracy: Low
        $x_1_7 = "Get the greatest AIM nicknames on " ascii //weight: 1
        $x_1_8 = "Get screen names that suit your mood on " ascii //weight: 1
        $x_1_9 = {44 6f 20 79 6f 75 20 72 65 6d 65 6d 62 65 72 20 77 68 65 72 65 20 77 65 20 74 6f 6f 6b 20 74 68 69 73 20 70 69 63 74 75 72 65 3f 20 [0-48] 28 69 74 27 73 20 66 72 65 65 20 74 6f 20 6a 6f 69 6e 29}  //weight: 1, accuracy: Low
        $x_1_10 = "Do you remember her?:)) i found it on my pc" ascii //weight: 1
        $x_1_11 = "Dont tell me that this is you :))" ascii //weight: 1
        $x_1_12 = ":-D !!! http" ascii //weight: 1
        $x_1_13 = ":) !!! http" ascii //weight: 1
        $x_1_14 = ":~( !!! http" ascii //weight: 1
        $x_1_15 = ":D !!! http" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((2 of ($x_50_*) and 2 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule SmartDove_0
{
    meta:
        author = "defender2yara"
        detection_name = "SmartDove"
        threat_id = "17255"
        severity = "29"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "13"
        strings_accuracy = "Low"
    strings:
        $x_2_1 = "C:\\TEMP\\_checktemptest" ascii //weight: 2
        $x_1_2 = "ALLUSERSPROFILE" ascii //weight: 1
        $x_6_3 = {25 73 5c 5f 63 68 65 63 6b 74 65 6d 70 74 65 73 74 00 00 00 25 73 5c 41 70 70 6c 69 63 61 74 69 6f 6e 20 44 61 74 61 5c 4d 69 63 72 6f 73 6f 66 74 5c}  //weight: 6, accuracy: High
        $x_2_4 = {4d 41 43 48 49 4e 45 5c 53 6f 66 74 77 61 72 65 5c 43 6c 61 73 73 65 73 5c 43 4c 53 49 44 5c 7b 31 36 ?? 37 37 30 41 30 2d 30 45 38 37 2d 34 32 37 38 2d 42 37 34 38 2d 32 34 36 30 44 36 34 41 38 33 38 36 7d 5c 49 6e 70 72 6f 63 53 65 72 76 65 72 33 32}  //weight: 2, accuracy: Low
        $x_2_5 = {49 45 48 65 6c 70 65 72 5f ?? ?? ?? ?? 2e 64 6c 6c}  //weight: 2, accuracy: Low
        $x_2_6 = "DllRegisterServer" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_6_*) and 3 of ($x_2_*) and 1 of ($x_1_*))) or
            ((1 of ($x_6_*) and 4 of ($x_2_*))) or
            (all of ($x*))
        )
}

rule SmartDove_1
{
    meta:
        author = "defender2yara"
        detection_name = "SmartDove"
        threat_id = "17255"
        severity = "29"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "13"
        strings_accuracy = "Low"
    strings:
        $x_2_1 = "C:\\TEMP\\_checktemptest" ascii //weight: 2
        $x_1_2 = "ALLUSERSPROFILE" ascii //weight: 1
        $x_6_3 = {53 6f 66 74 77 61 72 65 5c 4d 69 63 72 6f 73 6f 66 74 5c 57 69 6e 64 6f 77 73 5c 43 75 72 72 65 6e 74 56 65 72 73 69 6f 6e 5c 45 78 74 5c 53 65 74 74 69 6e 67 73 5c 7b 31 36 ?? 37 37 30 41 30 2d 30 45 38 37 2d 34 32 37 38 2d 42 37 34 38 2d 32 34 36 30 44 36 34 41 38 33 38 36 7d [0-16] 25 73 5c 5f 63 68 65 63 6b 74 65 6d 70 74 65 73 74}  //weight: 6, accuracy: Low
        $x_2_4 = "DllRegisterServer" ascii //weight: 2
        $x_2_5 = "SetEntriesInAcl Error %u" ascii //weight: 2
        $x_2_6 = "SetNamedSecurityInfo Error %u" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_6_*) and 3 of ($x_2_*) and 1 of ($x_1_*))) or
            ((1 of ($x_6_*) and 4 of ($x_2_*))) or
            (all of ($x*))
        )
}

rule SmartDove_2
{
    meta:
        author = "defender2yara"
        detection_name = "SmartDove"
        threat_id = "17255"
        severity = "29"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "13"
        strings_accuracy = "Low"
    strings:
        $x_2_1 = "C:\\TEMP\\_checktemptest" ascii //weight: 2
        $x_1_2 = "ALLUSERSPROFILE" ascii //weight: 1
        $x_2_3 = {25 73 5c 5f 63 68 65 63 6b 74 65 6d 70 74 65 73 74 00 00 00 25 73 5c 41 70 70 6c 69 63 61 74 69 6f 6e 20 44 61 74 61 5c 4d 69 63 72 6f 73 6f 66 74 5c}  //weight: 2, accuracy: High
        $x_2_4 = {4d 41 43 48 49 4e 45 5c 53 6f 66 74 77 61 72 65 5c 43 6c 61 73 73 65 73 5c 43 4c 53 49 44 5c 7b 31 36 ?? 37 37 30 41 30 2d 30 45 38 37 2d 34 32 37 38 2d 42 37 34 38 2d 32 34 36 30 44 36 34 41 38 33 38 36 7d 5c 49 6e 70 72 6f 63 53 65 72 76 65 72 33 32}  //weight: 2, accuracy: Low
        $x_2_5 = {49 45 48 65 6c 70 65 72 5f ?? ?? ?? ?? 2e 64 6c 6c}  //weight: 2, accuracy: Low
        $x_2_6 = "DllRegisterServer" ascii //weight: 2
        $x_2_7 = "SetEntriesInAcl Error %u" ascii //weight: 2
        $x_2_8 = "SetNamedSecurityInfo Error %u" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (
            ((6 of ($x_2_*) and 1 of ($x_1_*))) or
            ((7 of ($x_2_*))) or
            (all of ($x*))
        )
}

rule SmartDove_3
{
    meta:
        author = "defender2yara"
        detection_name = "SmartDove"
        threat_id = "17255"
        severity = "29"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "14"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "IEHelper%d%d%d_%s.dll" ascii //weight: 2
        $x_2_2 = "client.yiqilai.com:1207" ascii //weight: 2
        $x_2_3 = "IEHelper.DLL" ascii //weight: 2
        $x_2_4 = "login.yiqilai.com:1207" ascii //weight: 2
        $x_2_5 = "regcode" ascii //weight: 2
        $x_2_6 = "request.yiqilai.com:1207" ascii //weight: 2
        $x_2_7 = "Software\\Classes\\CLSID\\{16A770A0-0E87-4278-B748-2460D64A8386}\\InprocServer32" ascii //weight: 2
        $x_2_8 = "Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Browser Helper Objects\\{16A770A0-0E87-4278-B748-2460D64A8386}" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (7 of ($x*))
}

rule PornDialer_G_0
{
    meta:
        author = "defender2yara"
        detection_name = "PornDialer.G"
        threat_id = "17298"
        severity = "Critical"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "8"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Webdialer" ascii //weight: 1
        $x_1_2 = "dialer.com" ascii //weight: 1
        $x_1_3 = "dialup." ascii //weight: 1
        $x_1_4 = "dialin." ascii //weight: 1
        $x_1_5 = "{1FBA04EE-3024-11D2-8F1F-0000F87ABD16}" ascii //weight: 1
        $x_1_6 = "Software\\Microsoft\\Internet Explorer\\Extensions" ascii //weight: 1
        $x_1_7 = "rasapi32" ascii //weight: 1
        $x_1_8 = "modem" ascii //weight: 1
        $x_1_9 = "Software\\Microsoft\\RAS Phonebook" ascii //weight: 1
        $x_1_10 = "900 telephone" ascii //weight: 1
        $x_1_11 = "18 years" ascii //weight: 1
        $x_1_12 = "18 YEARS" ascii //weight: 1
        $x_1_13 = "Stardialer" ascii //weight: 1
        $x_1_14 = "%s\\- %s -\\%s %s.lnk" ascii //weight: 1
        $x_1_15 = "/min" ascii //weight: 1
        $x_1_16 = "/Min" ascii //weight: 1
        $x_1_17 = "*sendman" ascii //weight: 1
        $x_1_18 = "sterreich" ascii //weight: 1
        $x_1_19 = "019084638815" ascii //weight: 1
        $x_1_20 = "0930820704" ascii //weight: 1
        $x_1_21 = "190080788" ascii //weight: 1
        $x_1_22 = "finden Sie hier www.global-netcom.de/Dialer-AGB" ascii //weight: 1
        $n_100_23 = "Print with zodiac sign between degrees and minutes" ascii //weight: -100
    condition:
        (filesize < 20MB) and
        (not (any of ($n*))) and
        (8 of ($x*))
}

rule Navihelper_0
{
    meta:
        author = "defender2yara"
        detection_name = "Navihelper"
        threat_id = "17322"
        severity = "Mid"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Microsoft Visual C++ Runtime Library" ascii //weight: 1
        $x_1_2 = "NaviHelper.DLL" ascii //weight: 1
        $x_1_3 = "HttpSendRequestA" ascii //weight: 1
        $x_1_4 = "InternetSetCookieA" ascii //weight: 1
        $x_1_5 = "13FACA62-5FC4-4817-9175-9C8D00975916" wide //weight: 1
        $x_1_6 = "SharedMemoryMutex" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule CarpeDiem_0
{
    meta:
        author = "defender2yara"
        detection_name = "CarpeDiem"
        threat_id = "17395"
        severity = "3"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "ipwatchwinshoenolog" ascii //weight: 1
        $x_1_2 = "SoftWare\\CarpeDiemVars\\Kit\\" ascii //weight: 1
        $x_1_3 = "dialup.carpediem." ascii //weight: 1
        $x_1_4 = "perl/countdialupinter.pl?name=" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule CarpeDiem_1
{
    meta:
        author = "defender2yara"
        detection_name = "CarpeDiem"
        threat_id = "17395"
        severity = "3"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "16"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "RasDialEvent" ascii //weight: 1
        $x_3_2 = "CDUpdater.exe" ascii //weight: 3
        $x_2_3 = "C:\\Montorgueil\\" ascii //weight: 2
        $x_5_4 = "http://dialup.carpediem.fr/perl/dialup.pl" ascii //weight: 5
        $x_5_5 = "http://dialup.carpediem.fr/perl/countdialupinter.pl?" ascii //weight: 5
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule CarpeDiem_2
{
    meta:
        author = "defender2yara"
        detection_name = "CarpeDiem"
        threat_id = "17395"
        severity = "3"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "14"
        strings_accuracy = "High"
    strings:
        $x_3_1 = "uiDialModemGetPingEvent" ascii //weight: 3
        $x_2_2 = "dialup.pl" ascii //weight: 2
        $x_5_3 = "http://dialup.carpediem.fr/perl/countdialupinter.pl?" ascii //weight: 5
        $x_5_4 = "http://adsl.carpediem.fr/perl/invoc_oneway.pl?" ascii //weight: 5
        $x_2_5 = "CD_Dialer" ascii //weight: 2
        $x_2_6 = "CDUpdater.exe" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_5_*) and 1 of ($x_3_*) and 3 of ($x_2_*))) or
            ((2 of ($x_5_*) and 2 of ($x_2_*))) or
            ((2 of ($x_5_*) and 1 of ($x_3_*) and 1 of ($x_2_*))) or
            (all of ($x*))
        )
}

rule Dialui_0
{
    meta:
        author = "defender2yara"
        detection_name = "Dialui"
        threat_id = "17480"
        severity = "Critical"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "15"
        strings_accuracy = "High"
    strings:
        $x_5_1 = "DialUI" ascii //weight: 5
        $x_2_2 = "Would you like to reconnect to the internet?" ascii //weight: 2
        $x_2_3 = "Time limit reached.  You are now being disconnected" ascii //weight: 2
        $x_2_4 = "We hope you've enjoyed the games!" ascii //weight: 2
        $x_2_5 = "software\\microsoft\\windows\\currentversion\\wintrust\\trust providers\\software publishing\\trust database\\0" ascii //weight: 2
        $x_2_6 = "update.php" ascii //weight: 2
        $x_2_7 = " [%d%s/min]" ascii //weight: 2
        $x_2_8 = "reconn_url" ascii //weight: 2
        $x_6_9 = "http://127.0.0.1:20202/remind.html" ascii //weight: 6
        $x_2_10 = "AOL_Frame25" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (
            ((8 of ($x_2_*))) or
            ((1 of ($x_5_*) and 5 of ($x_2_*))) or
            ((1 of ($x_6_*) and 5 of ($x_2_*))) or
            ((1 of ($x_6_*) and 1 of ($x_5_*) and 2 of ($x_2_*))) or
            (all of ($x*))
        )
}

rule Axis_B_0
{
    meta:
        author = "defender2yara"
        detection_name = "Axis.B"
        threat_id = "17482"
        severity = "Critical"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "9"
        strings_accuracy = "High"
    strings:
        $x_3_1 = "iexplore.exe http://" ascii //weight: 3
        $x_3_2 = "@mmprs" ascii //weight: 3
        $x_3_3 = "AXIS" ascii //weight: 3
        $x_1_4 = "premium" ascii //weight: 1
        $x_2_5 = "/file.exe" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (
            ((2 of ($x_3_*) and 1 of ($x_2_*) and 1 of ($x_1_*))) or
            ((3 of ($x_3_*))) or
            (all of ($x*))
        )
}

rule WebDialler_0
{
    meta:
        author = "defender2yara"
        detection_name = "WebDialler"
        threat_id = "17483"
        severity = "Critical"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "9"
        strings_accuracy = "High"
    strings:
        $x_3_1 = "playground.com" ascii //weight: 3
        $x_1_2 = "BADxTICKETxSTATUS" ascii //weight: 1
        $x_1_3 = "DialerIconEvent" ascii //weight: 1
        $x_1_4 = "64.159.91.193" ascii //weight: 1
        $x_1_5 = "Obtained fresh ticket: " ascii //weight: 1
        $x_1_6 = "SOFTWARE\\WebDialler" ascii //weight: 1
        $x_1_7 = "teenpussy.andlotsmore.com" ascii //weight: 1
        $x_1_8 = "n6ddlaappmutex" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_3_*) and 6 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule WebDialler_1
{
    meta:
        author = "defender2yara"
        detection_name = "WebDialler"
        threat_id = "17483"
        severity = "Critical"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "9"
        strings_accuracy = "High"
    strings:
        $x_3_1 = "%02d:%02d:%02d, %c%02d.%02d per min" ascii //weight: 3
        $x_3_2 = "@mmprs" ascii //weight: 3
        $x_3_3 = "AOL Dial-On-Demand feature" ascii //weight: 3
        $x_1_4 = "premium" ascii //weight: 1
        $x_2_5 = "membersplayground.com/" ascii //weight: 2
        $x_3_6 = "SOFTWARE\\WebDialler" ascii //weight: 3
        $x_3_7 = "SOFTWARE\\SimpleDeliveryVehicle" ascii //weight: 3
    condition:
        (filesize < 20MB) and
        (
            ((2 of ($x_3_*) and 1 of ($x_2_*) and 1 of ($x_1_*))) or
            ((3 of ($x_3_*))) or
            (all of ($x*))
        )
}

rule WebDialler_2
{
    meta:
        author = "defender2yara"
        detection_name = "WebDialler"
        threat_id = "17483"
        severity = "Critical"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "7"
        strings_accuracy = "High"
    strings:
        $x_3_1 = "Bei Benutzung dieser Software wird Ihr Modem eine 0190 (Deutschland)," ascii //weight: 3
        $x_1_2 = "RasEnumConnectionsA" ascii //weight: 1
        $x_2_3 = "BTV Industries" ascii //weight: 2
        $x_3_4 = "SOFTWARE\\DiallerProgram\\%s" ascii //weight: 3
        $x_2_5 = "che erhebt und es mit seiner Genehmigung geschieht, wenn er durch den" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_3_*) and 2 of ($x_2_*))) or
            ((2 of ($x_3_*) and 1 of ($x_1_*))) or
            ((2 of ($x_3_*) and 1 of ($x_2_*))) or
            (all of ($x*))
        )
}

rule WebDialler_3
{
    meta:
        author = "defender2yara"
        detection_name = "WebDialler"
        threat_id = "17483"
        severity = "Critical"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "10"
        strings_accuracy = "High"
    strings:
        $x_3_1 = "RasDial" ascii //weight: 3
        $x_5_2 = "playground.com" ascii //weight: 5
        $x_3_3 = {44 49 44 49 00 70 72 65 6d 69 75 6d 00 64 70 5f 00 40 6d 6d 70 72 73 00}  //weight: 3, accuracy: High
        $x_3_4 = {44 49 44 49 00 00 31 31 34 00 30 35 38 33 34 33 00}  //weight: 3, accuracy: High
        $x_2_5 = "http://community.derbiz.com/" ascii //weight: 2
        $x_1_6 = "andlotsmore.com" ascii //weight: 1
        $x_2_7 = "surfya.com" ascii //weight: 2
        $x_1_8 = "http://www.mypaymate.com/dialerplatform/tmp.htm" ascii //weight: 1
        $x_1_9 = "194.67.87.33" ascii //weight: 1
        $x_1_10 = "222.2.111.55" ascii //weight: 1
        $x_1_11 = "ASDPLUGIN" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_3_*) and 1 of ($x_2_*) and 5 of ($x_1_*))) or
            ((1 of ($x_3_*) and 2 of ($x_2_*) and 3 of ($x_1_*))) or
            ((2 of ($x_3_*) and 4 of ($x_1_*))) or
            ((2 of ($x_3_*) and 1 of ($x_2_*) and 2 of ($x_1_*))) or
            ((2 of ($x_3_*) and 2 of ($x_2_*))) or
            ((3 of ($x_3_*) and 1 of ($x_1_*))) or
            ((3 of ($x_3_*) and 1 of ($x_2_*))) or
            ((1 of ($x_5_*) and 5 of ($x_1_*))) or
            ((1 of ($x_5_*) and 1 of ($x_2_*) and 3 of ($x_1_*))) or
            ((1 of ($x_5_*) and 2 of ($x_2_*) and 1 of ($x_1_*))) or
            ((1 of ($x_5_*) and 1 of ($x_3_*) and 2 of ($x_1_*))) or
            ((1 of ($x_5_*) and 1 of ($x_3_*) and 1 of ($x_2_*))) or
            ((1 of ($x_5_*) and 2 of ($x_3_*))) or
            (all of ($x*))
        )
}

rule Trafficadvance_0
{
    meta:
        author = "defender2yara"
        detection_name = "Trafficadvance"
        threat_id = "17484"
        severity = "Critical"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = ".trafficadvance.net" ascii //weight: 1
        $x_1_2 = " ad Internet" ascii //weight: 1
        $x_1_3 = "\\Microsoft\\Internet Explorer\\Quick Launch" ascii //weight: 1
        $x_1_4 = "RCF.%hd.%hd|MoD.%hd" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Trafficadvance_1
{
    meta:
        author = "defender2yara"
        detection_name = "Trafficadvance"
        threat_id = "17484"
        severity = "Critical"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_1_1 = ".trafficadvance.net" ascii //weight: 1
        $x_1_2 = {53 6f 66 74 77 61 72 65 5c 4d 69 63 72 6f 73 6f 66 74 5c 53 79 73 74 65 6d 43 65 72 74 69 66 69 63 61 74 65 73 5c 54 72 75 73 74 65 64 50 75 62 6c 69 73 68 65 72 5c 43 65 72 74 69 66 69 63 61 74 65 73 00}  //weight: 1, accuracy: High
        $x_1_3 = {52 41 53 41 70 69 33 32 2e 64 6c 6c 00}  //weight: 1, accuracy: High
        $x_1_4 = "SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\Zones" ascii //weight: 1
        $x_1_5 = "AccessMySQL." ascii //weight: 1
        $x_1_6 = "&Recupera" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Trafficadvance_2
{
    meta:
        author = "defender2yara"
        detection_name = "Trafficadvance"
        threat_id = "17484"
        severity = "Critical"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "16"
        strings_accuracy = "High"
    strings:
        $x_10_1 = "RasDial" ascii //weight: 10
        $x_3_2 = "trafficadvance.net" ascii //weight: 3
        $x_1_3 = "Connessione terminata, riconnettersi?" ascii //weight: 1
        $x_1_4 = "dial709" ascii //weight: 1
        $x_3_5 = "NWDialerMini" ascii //weight: 3
        $x_3_6 = "NETVISION" ascii //weight: 3
        $x_1_7 = "dcikpcfhalmblomhkcfcebnnefiledge anjpbmbpjjaghgmoncmmkfhmmmd" ascii //weight: 1
        $x_1_8 = "goicfboogidikkejccmclpieicihhlpo ahkdca" ascii //weight: 1
        $x_2_9 = "Passe-partout" ascii //weight: 2
        $x_1_10 = "Pronostici" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((3 of ($x_3_*) and 1 of ($x_2_*) and 5 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_2_*) and 4 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_3_*) and 3 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_3_*) and 1 of ($x_2_*) and 1 of ($x_1_*))) or
            ((1 of ($x_10_*) and 2 of ($x_3_*))) or
            (all of ($x*))
        )
}

rule Trafficadvance_3
{
    meta:
        author = "defender2yara"
        detection_name = "Trafficadvance"
        threat_id = "17484"
        severity = "Critical"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "11"
        strings_accuracy = "High"
    strings:
        $x_3_1 = "Recupera" ascii //weight: 3
        $x_1_2 = "TempoEntra" ascii //weight: 1
        $x_3_3 = "trafficadvance.net" ascii //weight: 3
        $x_3_4 = "NWDialerMini" ascii //weight: 3
        $x_1_5 = "NETVISION" ascii //weight: 1
        $x_1_6 = "SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\Zones" ascii //weight: 1
        $x_1_7 = "Non ci sono modem configurati nel sistema." ascii //weight: 1
        $x_1_8 = "Connessione terminata, riconnettersi?" ascii //weight: 1
        $x_3_9 = "http://www.3000.ws/" ascii //weight: 3
        $x_3_10 = " Disinstalla.lnk" ascii //weight: 3
        $x_3_11 = "No modem has taken shape in this system." ascii //weight: 3
    condition:
        (filesize < 20MB) and
        (
            ((2 of ($x_3_*) and 5 of ($x_1_*))) or
            ((3 of ($x_3_*) and 2 of ($x_1_*))) or
            ((4 of ($x_3_*))) or
            (all of ($x*))
        )
}

rule Rapido_0
{
    meta:
        author = "defender2yara"
        detection_name = "Rapido"
        threat_id = "17485"
        severity = "Critical"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_3_1 = "Gracias por utilizar los servicios de acceso" ascii //weight: 3
        $x_3_2 = ".accesorapido.com" ascii //weight: 3
        $x_2_3 = " por minuto." ascii //weight: 2
        $x_2_4 = "Tiempo aprox. restante: %dm %ds" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_3_*) and 1 of ($x_2_*))) or
            ((2 of ($x_3_*))) or
            (all of ($x*))
        )
}

rule DlStwoyle_0
{
    meta:
        author = "defender2yara"
        detection_name = "DlStwoyle"
        threat_id = "17489"
        severity = "Critical"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_3_1 = "{B5959C25-CBBD-4dcc-8C98-DA25EBB3D89F}" ascii //weight: 3
        $x_2_2 = "&dtype=%s&dname=%s&phone=%s" ascii //weight: 2
        $x_2_3 = "q%d_disk.dll" ascii //weight: 2
        $x_2_4 = "acc%d" ascii //weight: 2
        $x_2_5 = "&tmmin=%d" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (
            ((3 of ($x_2_*))) or
            ((1 of ($x_3_*) and 1 of ($x_2_*))) or
            (all of ($x*))
        )
}

rule Adialer_0
{
    meta:
        author = "defender2yara"
        detection_name = "Adialer"
        threat_id = "17490"
        severity = "Critical"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {64 69 61 6c 65 72 2d 70 6c 2d 74 65 6d 70 5c 64 69 61 6c 2d 69 6e 74 65 6c 6c 69 2d 76 [0-5] 5c 6b 6f 6c 2e 70 61 73}  //weight: 1, accuracy: Low
        $x_1_2 = {49 6e 74 65 72 6e 65 74 20 53 65 78 70 6c 6f 72 65 72 20 [0-5] 20 50 4c}  //weight: 1, accuracy: Low
        $x_1_3 = "S E X P L O R E R" ascii //weight: 1
        $x_1_4 = "SOFTWARE\\Microsoft\\Windows\\Currentversion\\Run" ascii //weight: 1
        $x_1_5 = "/min z vat. Nazwa operatora podana jest poni" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Adialer_1
{
    meta:
        author = "defender2yara"
        detection_name = "Adialer"
        threat_id = "17490"
        severity = "Critical"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "lKa3GYT3jydNhXwixyxi4Xdi8Bm0GNl6qYCibrLP5OQXY8FAJSie/viNtJmkw10Qq1wNMst/EyFeKkaUhKeZqgOdLtJUaEmubqkyhWRB" ascii //weight: 2
        $x_2_2 = "lLytujakGNW58PaCJ5hc+d/YrhcTVRGpe2gxIDuYJkPRIUcOhGCCSBEgmKOojsxB9lDpC1kcv1Ic8A==" ascii //weight: 2
        $x_2_3 = "lJygpruDLj57lvzH5DU5V722qy+Koe5Qj6cYifYoljTFww==" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Adialer_2
{
    meta:
        author = "defender2yara"
        detection_name = "Adialer"
        threat_id = "17490"
        severity = "Critical"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "7"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {26 73 69 74 65 3d [0-8] 26 63 6f 75 6e 74 72 79 3d [0-8] 3f 77 65 62 6d 61 73 74 65 72 3d}  //weight: 1, accuracy: Low
        $x_1_2 = "Dial error! Code: %d!" ascii //weight: 1
        $x_1_3 = "if exist \"%s\" goto Loop" ascii //weight: 1
        $x_1_4 = "UninstallDialer..." ascii //weight: 1
        $x_1_5 = "%02d.%02d.%04d %02d:%02d:%02d" ascii //weight: 1
        $x_1_6 = "C:\\WINDOWS\\Coder\\coder.log" ascii //weight: 1
        $x_1_7 = {52 65 73 74 61 72 74 2e 2e 2e [0-5] 48 61 6e 67 55 70 2e 2e 2e}  //weight: 1, accuracy: Low
        $x_1_8 = {43 3a 5c 57 49 4e 44 4f 57 53 5c 43 6f 64 65 72 5c 5f ?? 2d [0-5] 2d ?? 2d ?? 2d 2e 65 78 65}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (7 of ($x*))
}

rule Adialer_3
{
    meta:
        author = "defender2yara"
        detection_name = "Adialer"
        threat_id = "17490"
        severity = "Critical"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "6"
        strings_accuracy = "Low"
    strings:
        $x_2_1 = {81 bc 24 b0 02 00 00 39 1b 00 00 0f 85 c0 01 00 00 a1 ?? ?? 40 00 85 c0 75 1f 8b 84 24 a8 02 00 00 68 39 1b 00 00 50 ff 15 ?? ?? 40 00}  //weight: 2, accuracy: Low
        $x_2_2 = {52 c7 84 24 fc 06 00 00 1c 04 00 00 ff d6 8d 84 24 fb 08 00 00 68 ?? ?? 40 00 50 88 9c 24 01 08 00 00 88 9c 24 82 08 00 00 ff d6 8d 8c 24 fc 09 00 00 68 ?? ?? 40 00 51 ff d6 8b 54 24 0c 53 53 8d 44 24 14 52 50 68 ?? ?? 40 00 53 88 9c 24 15 0b 00 00 e8 ?? ?? 00 00}  //weight: 2, accuracy: Low
        $x_1_3 = "www.top69.org" ascii //weight: 1
        $x_1_4 = "RasDialA" ascii //weight: 1
        $x_1_5 = {4e 65 74 73 63 61 70 65 2e 65 78 65 [0-16] 49 45 78 70 6c 6f 72 65 2e 65 78 65 [0-16] 53 4f 46 54 57 41 52 45 5c 4d 69 63 72 6f 73 6f 66 74 5c 57 69 6e 64 6f 77 73 5c 43 75 72 72 65 6e 74 56 65 72 73 69 6f 6e 5c 41 70 70 20 50 61 74 68 73 5c}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (
            ((2 of ($x_2_*) and 2 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule Adialer_4
{
    meta:
        author = "defender2yara"
        detection_name = "Adialer"
        threat_id = "17490"
        severity = "Critical"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "8"
        strings_accuracy = "High"
    strings:
        $x_2_1 = {53 4f 46 54 57 41 52 45 5c 4d 69 63 72 6f 73 6f 66 74 5c 57 69 6e 64 6f 77 73 5c 43 75 72 72 65 6e 74 56 65 72 73 69 6f 6e 5c 55 6e 69 6e 73 74 61 6c 6c 5c 64 65 6c 73 69 6d 00 00 75 6e 69 6e 73 74 53 68 6f 72 74 63 75 74 00 00 75 6e 69 6e 73 74 45 78 65 00 00 00 5c 00 00 00 55 6e 69 6e 73 74 61 6c 6c 53 74 72 69 6e 67}  //weight: 2, accuracy: High
        $x_2_2 = {44 69 73 70 6c 61 79 4e 61 6d 65 00 44 65 6c 73 69 6d 20 44 69 61 6c 65 72 00 00 00 49 6e 74 65 72 6e 65 74 20 44 69 61 6c 65 72}  //weight: 2, accuracy: High
        $x_2_3 = {68 74 74 70 3a 2f 2f 77 77 77 2e 74 72 61 66 66 69 63 6a 61 6d 2e 6e 6c 2f 3f 66 61 69 6c 65 64 3d 69 6e 69 74 69 61 6c 69 7a 65 2e 64 65 6c 73 69 6d 00 00 50 72 6f 67 72 61 6d 46 69 6c 65 73 44 69 72 00}  //weight: 2, accuracy: High
        $x_2_4 = "http://prs.payperdownload.nl/radius/dialer_admin/geoip.asp" ascii //weight: 2
        $x_2_5 = "D:\\Work\\Splendo\\Dialer\\working\\dialer hidden_ip2code_code2nrs_uninst\\InternetDialer\\C++ Sources\\Dialer\\BsdMainDlg.cpp" ascii //weight: 2
        $x_2_6 = "Delsim Dialer Module" wide //weight: 2
    condition:
        (filesize < 20MB) and
        (4 of ($x*))
}

rule DialPlatform_B_0
{
    meta:
        author = "defender2yara"
        detection_name = "DialPlatform.B"
        threat_id = "17491"
        severity = "Critical"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "7"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "c:\\progra~1\\intern~1\\iexplore.exe %1" ascii //weight: 2
        $x_2_2 = "<head><title>Members Area Access</title></head>" ascii //weight: 2
        $x_3_3 = "Save the login and password generated for you. It will grant access for 7 days." ascii //weight: 3
        $x_3_4 = "<br>To access use your usual connection." ascii //weight: 3
        $x_1_5 = "System\\CurrentControlSet\\Control\\Class\\{4D36E96D-E325-11CE-BFC1-08002BE10318}" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_3_*) and 2 of ($x_2_*))) or
            ((2 of ($x_3_*) and 1 of ($x_1_*))) or
            ((2 of ($x_3_*) and 1 of ($x_2_*))) or
            (all of ($x*))
        )
}

rule DialerHub_0
{
    meta:
        author = "defender2yara"
        detection_name = "DialerHub"
        threat_id = "17494"
        severity = "Critical"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "21"
        strings_accuracy = "High"
    strings:
        $x_3_1 = "/del/cmb_" ascii //weight: 3
        $x_3_2 = "/minilog.php" ascii //weight: 3
        $x_3_3 = "/md.php?data=" ascii //weight: 3
        $x_6_4 = "/dlrdir.html?did=" ascii //weight: 6
        $x_6_5 = "@dialerhub.com" ascii //weight: 6
        $x_3_6 = "DiallerClass" ascii //weight: 3
        $x_3_7 = "Wanadoo" ascii //weight: 3
        $x_3_8 = "T-Online StartCenter" ascii //weight: 3
        $x_3_9 = "AOL Frame25" ascii //weight: 3
        $x_3_10 = "Online timer" ascii //weight: 3
    condition:
        (filesize < 20MB) and
        (
            ((7 of ($x_3_*))) or
            ((1 of ($x_6_*) and 5 of ($x_3_*))) or
            ((2 of ($x_6_*) and 3 of ($x_3_*))) or
            (all of ($x*))
        )
}

rule Adialer_0
{
    meta:
        author = "defender2yara"
        detection_name = "Adialer"
        threat_id = "17495"
        severity = "Critical"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "6"
        strings_accuracy = "Low"
    strings:
        $x_2_1 = {55 8b ec 83 c4 f4 ff 75 08 e8 ?? ?? 00 00 89 45 fc 03 45 08 89 45 f8 80 3d ?? ?? 40 00 31 74 24 c6 45 f7 7d eb 18 ff 4d fc ff 4d f8 8b 5d f8 b8 00 00 00 00 8a 03 2a 45 f7 88 03 88 45 f7 83 7d fc 00 75 e2 c9 c2 04 00 55 8b ec 68}  //weight: 2, accuracy: Low
        $x_2_2 = "TAPI32.DLL" ascii //weight: 2
        $x_2_3 = "lineGetDevCapsA" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Adialer_1
{
    meta:
        author = "defender2yara"
        detection_name = "Adialer"
        threat_id = "17495"
        severity = "Critical"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "14"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "00881939110" ascii //weight: 1
        $x_2_2 = "StartDispatchEXEProcess" ascii //weight: 2
        $x_2_3 = "%s PID:%d EXE:\"%s\"" ascii //weight: 2
        $x_1_4 = {49 53 44 4e 00 00 00 00 4d 4f 44 45 4d}  //weight: 1, accuracy: High
        $x_4_5 = {43 68 65 63 6b 20 25 69 00 00 00 00 6f 70 65 6e 00 00 00 00 25 69}  //weight: 4, accuracy: High
        $x_6_6 = {53 4f 46 54 57 41 52 45 5c 43 61 73 69 6f 70 00}  //weight: 6, accuracy: High
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_6_*) and 1 of ($x_4_*) and 1 of ($x_2_*) and 2 of ($x_1_*))) or
            ((1 of ($x_6_*) and 1 of ($x_4_*) and 2 of ($x_2_*))) or
            (all of ($x*))
        )
}

rule Adialer_2
{
    meta:
        author = "defender2yara"
        detection_name = "Adialer"
        threat_id = "17495"
        severity = "Critical"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "7"
        strings_accuracy = "High"
    strings:
        $x_2_1 = ">Link Uninstall</a>" ascii //weight: 2
        $x_2_2 = "\\disinstalla.htm" ascii //weight: 2
        $x_2_3 = "ADVPLUGIN|K" ascii //weight: 2
        $x_1_4 = "SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\User Agent\\Post Platform" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Adialer_3
{
    meta:
        author = "defender2yara"
        detection_name = "Adialer"
        threat_id = "17495"
        severity = "Critical"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "18"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "00881939110" ascii //weight: 1
        $x_1_2 = "ssavers" ascii //weight: 1
        $x_1_3 = "staticusername:" ascii //weight: 1
        $x_1_4 = "vxd5" ascii //weight: 1
        $x_1_5 = "vxd4" ascii //weight: 1
        $x_1_6 = "vxd3" ascii //weight: 1
        $x_1_7 = "vxd2" ascii //weight: 1
        $x_1_8 = {49 53 44 4e 00 00 00 00 4d 4f 44 45 4d}  //weight: 1, accuracy: High
        $x_4_9 = {64 65 6c 20 22 25 73 22 0d 0a 69 66 20 65 78 69 73 74 20 22 25 73 22 20 67 6f 74 6f 20 52 65 70 65 61 74 0d 0a 64 65 6c 20 22 25 73 22 0d 0a 00 00 00 00 25 73 25 69 2e 62 61 74}  //weight: 4, accuracy: High
        $x_4_10 = {43 68 65 63 6b 20 25 69 00 00 00 00 6f 70 65 6e 00 00 00 00 25 69}  //weight: 4, accuracy: High
        $x_8_11 = {53 4f 46 54 57 41 52 45 5c 43 61 73 69 6f 70 00 6d 6f 64 65 6d}  //weight: 8, accuracy: High
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_8_*) and 1 of ($x_4_*) and 6 of ($x_1_*))) or
            ((1 of ($x_8_*) and 2 of ($x_4_*) and 2 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule Adialer_4
{
    meta:
        author = "defender2yara"
        detection_name = "Adialer"
        threat_id = "17495"
        severity = "Critical"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "30"
        strings_accuracy = "High"
    strings:
        $x_3_1 = "GenuineIp" ascii //weight: 3
        $x_1_2 = "RasGetEntryPropertiesA" ascii //weight: 1
        $x_1_3 = "RasDialA" ascii //weight: 1
        $x_1_4 = "trinidad & tobago" ascii //weight: 1
        $x_1_5 = "spanish-el salvador" ascii //weight: 1
        $x_1_6 = "spanish-argentina" ascii //weight: 1
        $x_1_7 = "portuguese-brazilian" ascii //weight: 1
        $x_1_8 = "norwegian-nynorsk" ascii //weight: 1
        $x_1_9 = "norwegian-bokmal" ascii //weight: 1
        $x_1_10 = "english-trinidad y tobago" ascii //weight: 1
        $x_2_11 = "Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\Zones" ascii //weight: 2
        $x_2_12 = "Software\\Microsoft\\SystemCertificates\\TrustedPublisher\\Certificates" ascii //weight: 2
        $x_2_13 = "Software\\Microsoft\\Windows\\CurrentVersion\\WinTrust\\Trust Providers\\Software Publishing\\Trust Database\\0" ascii //weight: 2
        $x_2_14 = "ProxyEnable" ascii //weight: 2
        $x_4_15 = "cmdline: %s, _ShowAgr=%d, _Autost=%d" ascii //weight: 4
        $x_4_16 = "Dentro RasDialFunc con RASCONNSTATE=%d" ascii //weight: 4
        $x_9_17 = "rtaYDjwLg#fCS4E9nqVkhscOHbvm3RJ56xpTZI7lXi+WGo2Mu8KQB1dPUANze0Fy" ascii //weight: 9
        $x_2_18 = "Mi sto disconnettendo..." ascii //weight: 2
        $x_4_19 = "4 ManageDialing frommenu=%d,skipAgreement=%d" ascii //weight: 4
        $x_4_20 = "Errore nella connessione:retvalue= %d (%x), GLE:%d (%x)" ascii //weight: 4
        $x_4_21 = "%s %d (%x - %s), GLE:%d (%x)" ascii //weight: 4
        $x_4_22 = "%s %s %d %s                 [T%dT].url" ascii //weight: 4
        $x_4_23 = "Impossibile creare la connection information  Error %ld" ascii //weight: 4
        $x_4_24 = "Non riesco a creare la phonebook entry. (modem:%s) Errore %ld" ascii //weight: 4
        $x_3_25 = "RDF-msg=%d rcs=%d, dwErr=%d" ascii //weight: 3
        $x_3_26 = "%s /astart" ascii //weight: 3
        $x_1_27 = "Impossibile connettersi. Assenza di linea. Controllare che il modem sia acceso e connesso." ascii //weight: 1
        $x_1_28 = "Nessun Modem Rilevato. Controllare e riprovare." ascii //weight: 1
        $x_1_29 = "Nessun Dispositivo Rilevato o Errore. Controllare e riprovare." ascii //weight: 1
        $x_3_30 = "Errore nel rilascio del certificato di attivazione. Transazione abortita. Nessun addebito verra' effettuato." ascii //weight: 3
        $x_1_31 = "Connesso" ascii //weight: 1
        $x_1_32 = "Vuoi riconnetterti?" ascii //weight: 1
        $x_1_33 = "Riconnessione" ascii //weight: 1
        $x_1_34 = "Disconnesso" ascii //weight: 1
        $x_3_35 = "TISCALI" ascii //weight: 3
        $x_3_36 = "LIBERO" ascii //weight: 3
        $x_3_37 = "VIRGILIO" ascii //weight: 3
        $x_3_38 = "CLARENCE" ascii //weight: 3
        $x_3_39 = "KATAWEB" ascii //weight: 3
        $x_3_40 = "JUMPY" ascii //weight: 3
        $x_3_41 = "VirgilioGoogle" ascii //weight: 3
        $x_5_42 = "LGsony-jRFC157YRFC493z" ascii //weight: 5
        $x_6_43 = "OvertureWwIiNnDdOoWwSs2Kk/rfc765wINDows2kRFC4931" ascii //weight: 6
        $x_2_44 = "%s\\ADDINS" ascii //weight: 2
        $x_1_45 = "/noinstall" ascii //weight: 1
        $x_2_46 = "%s_Connection" ascii //weight: 2
        $x_6_47 = "Area adulti" ascii //weight: 6
        $x_20_48 = "www.top69.org/index.php" ascii //weight: 20
        $x_20_49 = "www.webcont.net/CONTENTS" ascii //weight: 20
        $x_3_50 = "Thank you for using this Dialer." ascii //weight: 3
        $x_5_51 = "micio_bau" ascii //weight: 5
        $x_10_52 = "spares/code/get.php" ascii //weight: 10
        $x_10_53 = "GET /%s?iddl=%d&clid=%d&avr1=%d&avr2=%d&avr3=%d HTTP/1.0 " ascii //weight: 10
        $x_6_54 = "NTS/adultcont/index.php" ascii //weight: 6
        $x_20_55 = "http://www.nubileones.com/members/" ascii //weight: 20
        $x_20_56 = "BOOT-F37D28CE-CE37-4bc8-B128-EA27747BE5E7" ascii //weight: 20
        $x_5_57 = "err=exit from trybar" ascii //weight: 5
        $x_5_58 = "Connected: %02i:%02i:%02i" ascii //weight: 5
        $x_2_59 = "SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\ActiveX Cache" ascii //weight: 2
        $x_4_60 = "standalone=\"%s\" " ascii //weight: 4
        $x_10_61 = "{7521IT11-1111-1111-1111-111111111111}" ascii //weight: 10
        $x_2_62 = "\"%s\" PID:%d EXE:\"%s\"" ascii //weight: 2
        $x_4_63 = "The connection has been closed (externally)..." ascii //weight: 4
        $x_4_64 = "_foobar_.exe" ascii //weight: 4
        $x_4_65 = "disclaimer_ds" ascii //weight: 4
        $x_4_66 = "dial_generation" ascii //weight: 4
        $x_3_67 = "Registering computer on the network..." ascii //weight: 3
        $x_3_68 = "Logging on to the network..." ascii //weight: 3
        $x_3_69 = "Hai scelto di non attivare un nuovo abbonamento." ascii //weight: 3
        $x_2_70 = "BAK|%s|%04d|%d|%c|%s|EAK" ascii //weight: 2
        $x_3_71 = "precedentemente accettate." ascii //weight: 3
        $x_3_72 = "N.B.: i ticket acquistati con questo programma saranno validi fino al" ascii //weight: 3
        $x_20_73 = "TinyDialer+" ascii //weight: 20
        $x_5_74 = "upd.exe" ascii //weight: 5
        $x_1_75 = "UnNet" ascii //weight: 1
        $x_1_76 = "geferq" ascii //weight: 1
        $x_3_77 = "C:\\un.exe" ascii //weight: 3
    condition:
        (filesize < 20MB) and
        (
            ((6 of ($x_2_*) and 18 of ($x_1_*))) or
            ((7 of ($x_2_*) and 16 of ($x_1_*))) or
            ((8 of ($x_2_*) and 14 of ($x_1_*))) or
            ((9 of ($x_2_*) and 12 of ($x_1_*))) or
            ((10 of ($x_2_*) and 10 of ($x_1_*))) or
            ((1 of ($x_3_*) and 4 of ($x_2_*) and 19 of ($x_1_*))) or
            ((1 of ($x_3_*) and 5 of ($x_2_*) and 17 of ($x_1_*))) or
            ((1 of ($x_3_*) and 6 of ($x_2_*) and 15 of ($x_1_*))) or
            ((1 of ($x_3_*) and 7 of ($x_2_*) and 13 of ($x_1_*))) or
            ((1 of ($x_3_*) and 8 of ($x_2_*) and 11 of ($x_1_*))) or
            ((1 of ($x_3_*) and 9 of ($x_2_*) and 9 of ($x_1_*))) or
            ((1 of ($x_3_*) and 10 of ($x_2_*) and 7 of ($x_1_*))) or
            ((2 of ($x_3_*) and 3 of ($x_2_*) and 18 of ($x_1_*))) or
            ((2 of ($x_3_*) and 4 of ($x_2_*) and 16 of ($x_1_*))) or
            ((2 of ($x_3_*) and 5 of ($x_2_*) and 14 of ($x_1_*))) or
            ((2 of ($x_3_*) and 6 of ($x_2_*) and 12 of ($x_1_*))) or
            ((2 of ($x_3_*) and 7 of ($x_2_*) and 10 of ($x_1_*))) or
            ((2 of ($x_3_*) and 8 of ($x_2_*) and 8 of ($x_1_*))) or
            ((2 of ($x_3_*) and 9 of ($x_2_*) and 6 of ($x_1_*))) or
            ((2 of ($x_3_*) and 10 of ($x_2_*) and 4 of ($x_1_*))) or
            ((3 of ($x_3_*) and 1 of ($x_2_*) and 19 of ($x_1_*))) or
            ((3 of ($x_3_*) and 2 of ($x_2_*) and 17 of ($x_1_*))) or
            ((3 of ($x_3_*) and 3 of ($x_2_*) and 15 of ($x_1_*))) or
            ((3 of ($x_3_*) and 4 of ($x_2_*) and 13 of ($x_1_*))) or
            ((3 of ($x_3_*) and 5 of ($x_2_*) and 11 of ($x_1_*))) or
            ((3 of ($x_3_*) and 6 of ($x_2_*) and 9 of ($x_1_*))) or
            ((3 of ($x_3_*) and 7 of ($x_2_*) and 7 of ($x_1_*))) or
            ((3 of ($x_3_*) and 8 of ($x_2_*) and 5 of ($x_1_*))) or
            ((3 of ($x_3_*) and 9 of ($x_2_*) and 3 of ($x_1_*))) or
            ((3 of ($x_3_*) and 10 of ($x_2_*) and 1 of ($x_1_*))) or
            ((4 of ($x_3_*) and 18 of ($x_1_*))) or
            ((4 of ($x_3_*) and 1 of ($x_2_*) and 16 of ($x_1_*))) or
            ((4 of ($x_3_*) and 2 of ($x_2_*) and 14 of ($x_1_*))) or
            ((4 of ($x_3_*) and 3 of ($x_2_*) and 12 of ($x_1_*))) or
            ((4 of ($x_3_*) and 4 of ($x_2_*) and 10 of ($x_1_*))) or
            ((4 of ($x_3_*) and 5 of ($x_2_*) and 8 of ($x_1_*))) or
            ((4 of ($x_3_*) and 6 of ($x_2_*) and 6 of ($x_1_*))) or
            ((4 of ($x_3_*) and 7 of ($x_2_*) and 4 of ($x_1_*))) or
            ((4 of ($x_3_*) and 8 of ($x_2_*) and 2 of ($x_1_*))) or
            ((4 of ($x_3_*) and 9 of ($x_2_*))) or
            ((5 of ($x_3_*) and 15 of ($x_1_*))) or
            ((5 of ($x_3_*) and 1 of ($x_2_*) and 13 of ($x_1_*))) or
            ((5 of ($x_3_*) and 2 of ($x_2_*) and 11 of ($x_1_*))) or
            ((5 of ($x_3_*) and 3 of ($x_2_*) and 9 of ($x_1_*))) or
            ((5 of ($x_3_*) and 4 of ($x_2_*) and 7 of ($x_1_*))) or
            ((5 of ($x_3_*) and 5 of ($x_2_*) and 5 of ($x_1_*))) or
            ((5 of ($x_3_*) and 6 of ($x_2_*) and 3 of ($x_1_*))) or
            ((5 of ($x_3_*) and 7 of ($x_2_*) and 1 of ($x_1_*))) or
            ((5 of ($x_3_*) and 8 of ($x_2_*))) or
            ((6 of ($x_3_*) and 12 of ($x_1_*))) or
            ((6 of ($x_3_*) and 1 of ($x_2_*) and 10 of ($x_1_*))) or
            ((6 of ($x_3_*) and 2 of ($x_2_*) and 8 of ($x_1_*))) or
            ((6 of ($x_3_*) and 3 of ($x_2_*) and 6 of ($x_1_*))) or
            ((6 of ($x_3_*) and 4 of ($x_2_*) and 4 of ($x_1_*))) or
            ((6 of ($x_3_*) and 5 of ($x_2_*) and 2 of ($x_1_*))) or
            ((6 of ($x_3_*) and 6 of ($x_2_*))) or
            ((7 of ($x_3_*) and 9 of ($x_1_*))) or
            ((7 of ($x_3_*) and 1 of ($x_2_*) and 7 of ($x_1_*))) or
            ((7 of ($x_3_*) and 2 of ($x_2_*) and 5 of ($x_1_*))) or
            ((7 of ($x_3_*) and 3 of ($x_2_*) and 3 of ($x_1_*))) or
            ((7 of ($x_3_*) and 4 of ($x_2_*) and 1 of ($x_1_*))) or
            ((7 of ($x_3_*) and 5 of ($x_2_*))) or
            ((8 of ($x_3_*) and 6 of ($x_1_*))) or
            ((8 of ($x_3_*) and 1 of ($x_2_*) and 4 of ($x_1_*))) or
            ((8 of ($x_3_*) and 2 of ($x_2_*) and 2 of ($x_1_*))) or
            ((8 of ($x_3_*) and 3 of ($x_2_*))) or
            ((9 of ($x_3_*) and 3 of ($x_1_*))) or
            ((9 of ($x_3_*) and 1 of ($x_2_*) and 1 of ($x_1_*))) or
            ((9 of ($x_3_*) and 2 of ($x_2_*))) or
            ((10 of ($x_3_*))) or
            ((1 of ($x_4_*) and 4 of ($x_2_*) and 18 of ($x_1_*))) or
            ((1 of ($x_4_*) and 5 of ($x_2_*) and 16 of ($x_1_*))) or
            ((1 of ($x_4_*) and 6 of ($x_2_*) and 14 of ($x_1_*))) or
            ((1 of ($x_4_*) and 7 of ($x_2_*) and 12 of ($x_1_*))) or
            ((1 of ($x_4_*) and 8 of ($x_2_*) and 10 of ($x_1_*))) or
            ((1 of ($x_4_*) and 9 of ($x_2_*) and 8 of ($x_1_*))) or
            ((1 of ($x_4_*) and 10 of ($x_2_*) and 6 of ($x_1_*))) or
            ((1 of ($x_4_*) and 1 of ($x_3_*) and 2 of ($x_2_*) and 19 of ($x_1_*))) or
            ((1 of ($x_4_*) and 1 of ($x_3_*) and 3 of ($x_2_*) and 17 of ($x_1_*))) or
            ((1 of ($x_4_*) and 1 of ($x_3_*) and 4 of ($x_2_*) and 15 of ($x_1_*))) or
            ((1 of ($x_4_*) and 1 of ($x_3_*) and 5 of ($x_2_*) and 13 of ($x_1_*))) or
            ((1 of ($x_4_*) and 1 of ($x_3_*) and 6 of ($x_2_*) and 11 of ($x_1_*))) or
            ((1 of ($x_4_*) and 1 of ($x_3_*) and 7 of ($x_2_*) and 9 of ($x_1_*))) or
            ((1 of ($x_4_*) and 1 of ($x_3_*) and 8 of ($x_2_*) and 7 of ($x_1_*))) or
            ((1 of ($x_4_*) and 1 of ($x_3_*) and 9 of ($x_2_*) and 5 of ($x_1_*))) or
            ((1 of ($x_4_*) and 1 of ($x_3_*) and 10 of ($x_2_*) and 3 of ($x_1_*))) or
            ((1 of ($x_4_*) and 2 of ($x_3_*) and 1 of ($x_2_*) and 18 of ($x_1_*))) or
            ((1 of ($x_4_*) and 2 of ($x_3_*) and 2 of ($x_2_*) and 16 of ($x_1_*))) or
            ((1 of ($x_4_*) and 2 of ($x_3_*) and 3 of ($x_2_*) and 14 of ($x_1_*))) or
            ((1 of ($x_4_*) and 2 of ($x_3_*) and 4 of ($x_2_*) and 12 of ($x_1_*))) or
            ((1 of ($x_4_*) and 2 of ($x_3_*) and 5 of ($x_2_*) and 10 of ($x_1_*))) or
            ((1 of ($x_4_*) and 2 of ($x_3_*) and 6 of ($x_2_*) and 8 of ($x_1_*))) or
            ((1 of ($x_4_*) and 2 of ($x_3_*) and 7 of ($x_2_*) and 6 of ($x_1_*))) or
            ((1 of ($x_4_*) and 2 of ($x_3_*) and 8 of ($x_2_*) and 4 of ($x_1_*))) or
            ((1 of ($x_4_*) and 2 of ($x_3_*) and 9 of ($x_2_*) and 2 of ($x_1_*))) or
            ((1 of ($x_4_*) and 2 of ($x_3_*) and 10 of ($x_2_*))) or
            ((1 of ($x_4_*) and 3 of ($x_3_*) and 17 of ($x_1_*))) or
            ((1 of ($x_4_*) and 3 of ($x_3_*) and 1 of ($x_2_*) and 15 of ($x_1_*))) or
            ((1 of ($x_4_*) and 3 of ($x_3_*) and 2 of ($x_2_*) and 13 of ($x_1_*))) or
            ((1 of ($x_4_*) and 3 of ($x_3_*) and 3 of ($x_2_*) and 11 of ($x_1_*))) or
            ((1 of ($x_4_*) and 3 of ($x_3_*) and 4 of ($x_2_*) and 9 of ($x_1_*))) or
            ((1 of ($x_4_*) and 3 of ($x_3_*) and 5 of ($x_2_*) and 7 of ($x_1_*))) or
            ((1 of ($x_4_*) and 3 of ($x_3_*) and 6 of ($x_2_*) and 5 of ($x_1_*))) or
            ((1 of ($x_4_*) and 3 of ($x_3_*) and 7 of ($x_2_*) and 3 of ($x_1_*))) or
            ((1 of ($x_4_*) and 3 of ($x_3_*) and 8 of ($x_2_*) and 1 of ($x_1_*))) or
            ((1 of ($x_4_*) and 3 of ($x_3_*) and 9 of ($x_2_*))) or
            ((1 of ($x_4_*) and 4 of ($x_3_*) and 14 of ($x_1_*))) or
            ((1 of ($x_4_*) and 4 of ($x_3_*) and 1 of ($x_2_*) and 12 of ($x_1_*))) or
            ((1 of ($x_4_*) and 4 of ($x_3_*) and 2 of ($x_2_*) and 10 of ($x_1_*))) or
            ((1 of ($x_4_*) and 4 of ($x_3_*) and 3 of ($x_2_*) and 8 of ($x_1_*))) or
            ((1 of ($x_4_*) and 4 of ($x_3_*) and 4 of ($x_2_*) and 6 of ($x_1_*))) or
            ((1 of ($x_4_*) and 4 of ($x_3_*) and 5 of ($x_2_*) and 4 of ($x_1_*))) or
            ((1 of ($x_4_*) and 4 of ($x_3_*) and 6 of ($x_2_*) and 2 of ($x_1_*))) or
            ((1 of ($x_4_*) and 4 of ($x_3_*) and 7 of ($x_2_*))) or
            ((1 of ($x_4_*) and 5 of ($x_3_*) and 11 of ($x_1_*))) or
            ((1 of ($x_4_*) and 5 of ($x_3_*) and 1 of ($x_2_*) and 9 of ($x_1_*))) or
            ((1 of ($x_4_*) and 5 of ($x_3_*) and 2 of ($x_2_*) and 7 of ($x_1_*))) or
            ((1 of ($x_4_*) and 5 of ($x_3_*) and 3 of ($x_2_*) and 5 of ($x_1_*))) or
            ((1 of ($x_4_*) and 5 of ($x_3_*) and 4 of ($x_2_*) and 3 of ($x_1_*))) or
            ((1 of ($x_4_*) and 5 of ($x_3_*) and 5 of ($x_2_*) and 1 of ($x_1_*))) or
            ((1 of ($x_4_*) and 5 of ($x_3_*) and 6 of ($x_2_*))) or
            ((1 of ($x_4_*) and 6 of ($x_3_*) and 8 of ($x_1_*))) or
            ((1 of ($x_4_*) and 6 of ($x_3_*) and 1 of ($x_2_*) and 6 of ($x_1_*))) or
            ((1 of ($x_4_*) and 6 of ($x_3_*) and 2 of ($x_2_*) and 4 of ($x_1_*))) or
            ((1 of ($x_4_*) and 6 of ($x_3_*) and 3 of ($x_2_*) and 2 of ($x_1_*))) or
            ((1 of ($x_4_*) and 6 of ($x_3_*) and 4 of ($x_2_*))) or
            ((1 of ($x_4_*) and 7 of ($x_3_*) and 5 of ($x_1_*))) or
            ((1 of ($x_4_*) and 7 of ($x_3_*) and 1 of ($x_2_*) and 3 of ($x_1_*))) or
            ((1 of ($x_4_*) and 7 of ($x_3_*) and 2 of ($x_2_*) and 1 of ($x_1_*))) or
            ((1 of ($x_4_*) and 7 of ($x_3_*) and 3 of ($x_2_*))) or
            ((1 of ($x_4_*) and 8 of ($x_3_*) and 2 of ($x_1_*))) or
            ((1 of ($x_4_*) and 8 of ($x_3_*) and 1 of ($x_2_*))) or
            ((1 of ($x_4_*) and 9 of ($x_3_*))) or
            ((2 of ($x_4_*) and 2 of ($x_2_*) and 18 of ($x_1_*))) or
            ((2 of ($x_4_*) and 3 of ($x_2_*) and 16 of ($x_1_*))) or
            ((2 of ($x_4_*) and 4 of ($x_2_*) and 14 of ($x_1_*))) or
            ((2 of ($x_4_*) and 5 of ($x_2_*) and 12 of ($x_1_*))) or
            ((2 of ($x_4_*) and 6 of ($x_2_*) and 10 of ($x_1_*))) or
            ((2 of ($x_4_*) and 7 of ($x_2_*) and 8 of ($x_1_*))) or
            ((2 of ($x_4_*) and 8 of ($x_2_*) and 6 of ($x_1_*))) or
            ((2 of ($x_4_*) and 9 of ($x_2_*) and 4 of ($x_1_*))) or
            ((2 of ($x_4_*) and 10 of ($x_2_*) and 2 of ($x_1_*))) or
            ((2 of ($x_4_*) and 1 of ($x_3_*) and 19 of ($x_1_*))) or
            ((2 of ($x_4_*) and 1 of ($x_3_*) and 1 of ($x_2_*) and 17 of ($x_1_*))) or
            ((2 of ($x_4_*) and 1 of ($x_3_*) and 2 of ($x_2_*) and 15 of ($x_1_*))) or
            ((2 of ($x_4_*) and 1 of ($x_3_*) and 3 of ($x_2_*) and 13 of ($x_1_*))) or
            ((2 of ($x_4_*) and 1 of ($x_3_*) and 4 of ($x_2_*) and 11 of ($x_1_*))) or
            ((2 of ($x_4_*) and 1 of ($x_3_*) and 5 of ($x_2_*) and 9 of ($x_1_*))) or
            ((2 of ($x_4_*) and 1 of ($x_3_*) and 6 of ($x_2_*) and 7 of ($x_1_*))) or
            ((2 of ($x_4_*) and 1 of ($x_3_*) and 7 of ($x_2_*) and 5 of ($x_1_*))) or
            ((2 of ($x_4_*) and 1 of ($x_3_*) and 8 of ($x_2_*) and 3 of ($x_1_*))) or
            ((2 of ($x_4_*) and 1 of ($x_3_*) and 9 of ($x_2_*) and 1 of ($x_1_*))) or
            ((2 of ($x_4_*) and 1 of ($x_3_*) and 10 of ($x_2_*))) or
            ((2 of ($x_4_*) and 2 of ($x_3_*) and 16 of ($x_1_*))) or
            ((2 of ($x_4_*) and 2 of ($x_3_*) and 1 of ($x_2_*) and 14 of ($x_1_*))) or
            ((2 of ($x_4_*) and 2 of ($x_3_*) and 2 of ($x_2_*) and 12 of ($x_1_*))) or
            ((2 of ($x_4_*) and 2 of ($x_3_*) and 3 of ($x_2_*) and 10 of ($x_1_*))) or
            ((2 of ($x_4_*) and 2 of ($x_3_*) and 4 of ($x_2_*) and 8 of ($x_1_*))) or
            ((2 of ($x_4_*) and 2 of ($x_3_*) and 5 of ($x_2_*) and 6 of ($x_1_*))) or
            ((2 of ($x_4_*) and 2 of ($x_3_*) and 6 of ($x_2_*) and 4 of ($x_1_*))) or
            ((2 of ($x_4_*) and 2 of ($x_3_*) and 7 of ($x_2_*) and 2 of ($x_1_*))) or
            ((2 of ($x_4_*) and 2 of ($x_3_*) and 8 of ($x_2_*))) or
            ((2 of ($x_4_*) and 3 of ($x_3_*) and 13 of ($x_1_*))) or
            ((2 of ($x_4_*) and 3 of ($x_3_*) and 1 of ($x_2_*) and 11 of ($x_1_*))) or
            ((2 of ($x_4_*) and 3 of ($x_3_*) and 2 of ($x_2_*) and 9 of ($x_1_*))) or
            ((2 of ($x_4_*) and 3 of ($x_3_*) and 3 of ($x_2_*) and 7 of ($x_1_*))) or
            ((2 of ($x_4_*) and 3 of ($x_3_*) and 4 of ($x_2_*) and 5 of ($x_1_*))) or
            ((2 of ($x_4_*) and 3 of ($x_3_*) and 5 of ($x_2_*) and 3 of ($x_1_*))) or
            ((2 of ($x_4_*) and 3 of ($x_3_*) and 6 of ($x_2_*) and 1 of ($x_1_*))) or
            ((2 of ($x_4_*) and 3 of ($x_3_*) and 7 of ($x_2_*))) or
            ((2 of ($x_4_*) and 4 of ($x_3_*) and 10 of ($x_1_*))) or
            ((2 of ($x_4_*) and 4 of ($x_3_*) and 1 of ($x_2_*) and 8 of ($x_1_*))) or
            ((2 of ($x_4_*) and 4 of ($x_3_*) and 2 of ($x_2_*) and 6 of ($x_1_*))) or
            ((2 of ($x_4_*) and 4 of ($x_3_*) and 3 of ($x_2_*) and 4 of ($x_1_*))) or
            ((2 of ($x_4_*) and 4 of ($x_3_*) and 4 of ($x_2_*) and 2 of ($x_1_*))) or
            ((2 of ($x_4_*) and 4 of ($x_3_*) and 5 of ($x_2_*))) or
            ((2 of ($x_4_*) and 5 of ($x_3_*) and 7 of ($x_1_*))) or
            ((2 of ($x_4_*) and 5 of ($x_3_*) and 1 of ($x_2_*) and 5 of ($x_1_*))) or
            ((2 of ($x_4_*) and 5 of ($x_3_*) and 2 of ($x_2_*) and 3 of ($x_1_*))) or
            ((2 of ($x_4_*) and 5 of ($x_3_*) and 3 of ($x_2_*) and 1 of ($x_1_*))) or
            ((2 of ($x_4_*) and 5 of ($x_3_*) and 4 of ($x_2_*))) or
            ((2 of ($x_4_*) and 6 of ($x_3_*) and 4 of ($x_1_*))) or
            ((2 of ($x_4_*) and 6 of ($x_3_*) and 1 of ($x_2_*) and 2 of ($x_1_*))) or
            ((2 of ($x_4_*) and 6 of ($x_3_*) and 2 of ($x_2_*))) or
            ((2 of ($x_4_*) and 7 of ($x_3_*) and 1 of ($x_1_*))) or
            ((2 of ($x_4_*) and 7 of ($x_3_*) and 1 of ($x_2_*))) or
            ((2 of ($x_4_*) and 8 of ($x_3_*))) or
            ((3 of ($x_4_*) and 18 of ($x_1_*))) or
            ((3 of ($x_4_*) and 1 of ($x_2_*) and 16 of ($x_1_*))) or
            ((3 of ($x_4_*) and 2 of ($x_2_*) and 14 of ($x_1_*))) or
            ((3 of ($x_4_*) and 3 of ($x_2_*) and 12 of ($x_1_*))) or
            ((3 of ($x_4_*) and 4 of ($x_2_*) and 10 of ($x_1_*))) or
            ((3 of ($x_4_*) and 5 of ($x_2_*) and 8 of ($x_1_*))) or
            ((3 of ($x_4_*) and 6 of ($x_2_*) and 6 of ($x_1_*))) or
            ((3 of ($x_4_*) and 7 of ($x_2_*) and 4 of ($x_1_*))) or
            ((3 of ($x_4_*) and 8 of ($x_2_*) and 2 of ($x_1_*))) or
            ((3 of ($x_4_*) and 9 of ($x_2_*))) or
            ((3 of ($x_4_*) and 1 of ($x_3_*) and 15 of ($x_1_*))) or
            ((3 of ($x_4_*) and 1 of ($x_3_*) and 1 of ($x_2_*) and 13 of ($x_1_*))) or
            ((3 of ($x_4_*) and 1 of ($x_3_*) and 2 of ($x_2_*) and 11 of ($x_1_*))) or
            ((3 of ($x_4_*) and 1 of ($x_3_*) and 3 of ($x_2_*) and 9 of ($x_1_*))) or
            ((3 of ($x_4_*) and 1 of ($x_3_*) and 4 of ($x_2_*) and 7 of ($x_1_*))) or
            ((3 of ($x_4_*) and 1 of ($x_3_*) and 5 of ($x_2_*) and 5 of ($x_1_*))) or
            ((3 of ($x_4_*) and 1 of ($x_3_*) and 6 of ($x_2_*) and 3 of ($x_1_*))) or
            ((3 of ($x_4_*) and 1 of ($x_3_*) and 7 of ($x_2_*) and 1 of ($x_1_*))) or
            ((3 of ($x_4_*) and 1 of ($x_3_*) and 8 of ($x_2_*))) or
            ((3 of ($x_4_*) and 2 of ($x_3_*) and 12 of ($x_1_*))) or
            ((3 of ($x_4_*) and 2 of ($x_3_*) and 1 of ($x_2_*) and 10 of ($x_1_*))) or
            ((3 of ($x_4_*) and 2 of ($x_3_*) and 2 of ($x_2_*) and 8 of ($x_1_*))) or
            ((3 of ($x_4_*) and 2 of ($x_3_*) and 3 of ($x_2_*) and 6 of ($x_1_*))) or
            ((3 of ($x_4_*) and 2 of ($x_3_*) and 4 of ($x_2_*) and 4 of ($x_1_*))) or
            ((3 of ($x_4_*) and 2 of ($x_3_*) and 5 of ($x_2_*) and 2 of ($x_1_*))) or
            ((3 of ($x_4_*) and 2 of ($x_3_*) and 6 of ($x_2_*))) or
            ((3 of ($x_4_*) and 3 of ($x_3_*) and 9 of ($x_1_*))) or
            ((3 of ($x_4_*) and 3 of ($x_3_*) and 1 of ($x_2_*) and 7 of ($x_1_*))) or
            ((3 of ($x_4_*) and 3 of ($x_3_*) and 2 of ($x_2_*) and 5 of ($x_1_*))) or
            ((3 of ($x_4_*) and 3 of ($x_3_*) and 3 of ($x_2_*) and 3 of ($x_1_*))) or
            ((3 of ($x_4_*) and 3 of ($x_3_*) and 4 of ($x_2_*) and 1 of ($x_1_*))) or
            ((3 of ($x_4_*) and 3 of ($x_3_*) and 5 of ($x_2_*))) or
            ((3 of ($x_4_*) and 4 of ($x_3_*) and 6 of ($x_1_*))) or
            ((3 of ($x_4_*) and 4 of ($x_3_*) and 1 of ($x_2_*) and 4 of ($x_1_*))) or
            ((3 of ($x_4_*) and 4 of ($x_3_*) and 2 of ($x_2_*) and 2 of ($x_1_*))) or
            ((3 of ($x_4_*) and 4 of ($x_3_*) and 3 of ($x_2_*))) or
            ((3 of ($x_4_*) and 5 of ($x_3_*) and 3 of ($x_1_*))) or
            ((3 of ($x_4_*) and 5 of ($x_3_*) and 1 of ($x_2_*) and 1 of ($x_1_*))) or
            ((3 of ($x_4_*) and 5 of ($x_3_*) and 2 of ($x_2_*))) or
            ((3 of ($x_4_*) and 6 of ($x_3_*))) or
            ((4 of ($x_4_*) and 14 of ($x_1_*))) or
            ((4 of ($x_4_*) and 1 of ($x_2_*) and 12 of ($x_1_*))) or
            ((4 of ($x_4_*) and 2 of ($x_2_*) and 10 of ($x_1_*))) or
            ((4 of ($x_4_*) and 3 of ($x_2_*) and 8 of ($x_1_*))) or
            ((4 of ($x_4_*) and 4 of ($x_2_*) and 6 of ($x_1_*))) or
            ((4 of ($x_4_*) and 5 of ($x_2_*) and 4 of ($x_1_*))) or
            ((4 of ($x_4_*) and 6 of ($x_2_*) and 2 of ($x_1_*))) or
            ((4 of ($x_4_*) and 7 of ($x_2_*))) or
            ((4 of ($x_4_*) and 1 of ($x_3_*) and 11 of ($x_1_*))) or
            ((4 of ($x_4_*) and 1 of ($x_3_*) and 1 of ($x_2_*) and 9 of ($x_1_*))) or
            ((4 of ($x_4_*) and 1 of ($x_3_*) and 2 of ($x_2_*) and 7 of ($x_1_*))) or
            ((4 of ($x_4_*) and 1 of ($x_3_*) and 3 of ($x_2_*) and 5 of ($x_1_*))) or
            ((4 of ($x_4_*) and 1 of ($x_3_*) and 4 of ($x_2_*) and 3 of ($x_1_*))) or
            ((4 of ($x_4_*) and 1 of ($x_3_*) and 5 of ($x_2_*) and 1 of ($x_1_*))) or
            ((4 of ($x_4_*) and 1 of ($x_3_*) and 6 of ($x_2_*))) or
            ((4 of ($x_4_*) and 2 of ($x_3_*) and 8 of ($x_1_*))) or
            ((4 of ($x_4_*) and 2 of ($x_3_*) and 1 of ($x_2_*) and 6 of ($x_1_*))) or
            ((4 of ($x_4_*) and 2 of ($x_3_*) and 2 of ($x_2_*) and 4 of ($x_1_*))) or
            ((4 of ($x_4_*) and 2 of ($x_3_*) and 3 of ($x_2_*) and 2 of ($x_1_*))) or
            ((4 of ($x_4_*) and 2 of ($x_3_*) and 4 of ($x_2_*))) or
            ((4 of ($x_4_*) and 3 of ($x_3_*) and 5 of ($x_1_*))) or
            ((4 of ($x_4_*) and 3 of ($x_3_*) and 1 of ($x_2_*) and 3 of ($x_1_*))) or
            ((4 of ($x_4_*) and 3 of ($x_3_*) and 2 of ($x_2_*) and 1 of ($x_1_*))) or
            ((4 of ($x_4_*) and 3 of ($x_3_*) and 3 of ($x_2_*))) or
            ((4 of ($x_4_*) and 4 of ($x_3_*) and 2 of ($x_1_*))) or
            ((4 of ($x_4_*) and 4 of ($x_3_*) and 1 of ($x_2_*))) or
            ((4 of ($x_4_*) and 5 of ($x_3_*))) or
            ((5 of ($x_4_*) and 10 of ($x_1_*))) or
            ((5 of ($x_4_*) and 1 of ($x_2_*) and 8 of ($x_1_*))) or
            ((5 of ($x_4_*) and 2 of ($x_2_*) and 6 of ($x_1_*))) or
            ((5 of ($x_4_*) and 3 of ($x_2_*) and 4 of ($x_1_*))) or
            ((5 of ($x_4_*) and 4 of ($x_2_*) and 2 of ($x_1_*))) or
            ((5 of ($x_4_*) and 5 of ($x_2_*))) or
            ((5 of ($x_4_*) and 1 of ($x_3_*) and 7 of ($x_1_*))) or
            ((5 of ($x_4_*) and 1 of ($x_3_*) and 1 of ($x_2_*) and 5 of ($x_1_*))) or
            ((5 of ($x_4_*) and 1 of ($x_3_*) and 2 of ($x_2_*) and 3 of ($x_1_*))) or
            ((5 of ($x_4_*) and 1 of ($x_3_*) and 3 of ($x_2_*) and 1 of ($x_1_*))) or
            ((5 of ($x_4_*) and 1 of ($x_3_*) and 4 of ($x_2_*))) or
            ((5 of ($x_4_*) and 2 of ($x_3_*) and 4 of ($x_1_*))) or
            ((5 of ($x_4_*) and 2 of ($x_3_*) and 1 of ($x_2_*) and 2 of ($x_1_*))) or
            ((5 of ($x_4_*) and 2 of ($x_3_*) and 2 of ($x_2_*))) or
            ((5 of ($x_4_*) and 3 of ($x_3_*) and 1 of ($x_1_*))) or
            ((5 of ($x_4_*) and 3 of ($x_3_*) and 1 of ($x_2_*))) or
            ((5 of ($x_4_*) and 4 of ($x_3_*))) or
            ((6 of ($x_4_*) and 6 of ($x_1_*))) or
            ((6 of ($x_4_*) and 1 of ($x_2_*) and 4 of ($x_1_*))) or
            ((6 of ($x_4_*) and 2 of ($x_2_*) and 2 of ($x_1_*))) or
            ((6 of ($x_4_*) and 3 of ($x_2_*))) or
            ((6 of ($x_4_*) and 1 of ($x_3_*) and 3 of ($x_1_*))) or
            ((6 of ($x_4_*) and 1 of ($x_3_*) and 1 of ($x_2_*) and 1 of ($x_1_*))) or
            ((6 of ($x_4_*) and 1 of ($x_3_*) and 2 of ($x_2_*))) or
            ((6 of ($x_4_*) and 2 of ($x_3_*))) or
            ((7 of ($x_4_*) and 2 of ($x_1_*))) or
            ((7 of ($x_4_*) and 1 of ($x_2_*))) or
            ((7 of ($x_4_*) and 1 of ($x_3_*))) or
            ((8 of ($x_4_*))) or
            ((1 of ($x_5_*) and 3 of ($x_2_*) and 19 of ($x_1_*))) or
            ((1 of ($x_5_*) and 4 of ($x_2_*) and 17 of ($x_1_*))) or
            ((1 of ($x_5_*) and 5 of ($x_2_*) and 15 of ($x_1_*))) or
            ((1 of ($x_5_*) and 6 of ($x_2_*) and 13 of ($x_1_*))) or
            ((1 of ($x_5_*) and 7 of ($x_2_*) and 11 of ($x_1_*))) or
            ((1 of ($x_5_*) and 8 of ($x_2_*) and 9 of ($x_1_*))) or
            ((1 of ($x_5_*) and 9 of ($x_2_*) and 7 of ($x_1_*))) or
            ((1 of ($x_5_*) and 10 of ($x_2_*) and 5 of ($x_1_*))) or
            ((1 of ($x_5_*) and 1 of ($x_3_*) and 2 of ($x_2_*) and 18 of ($x_1_*))) or
            ((1 of ($x_5_*) and 1 of ($x_3_*) and 3 of ($x_2_*) and 16 of ($x_1_*))) or
            ((1 of ($x_5_*) and 1 of ($x_3_*) and 4 of ($x_2_*) and 14 of ($x_1_*))) or
            ((1 of ($x_5_*) and 1 of ($x_3_*) and 5 of ($x_2_*) and 12 of ($x_1_*))) or
            ((1 of ($x_5_*) and 1 of ($x_3_*) and 6 of ($x_2_*) and 10 of ($x_1_*))) or
            ((1 of ($x_5_*) and 1 of ($x_3_*) and 7 of ($x_2_*) and 8 of ($x_1_*))) or
            ((1 of ($x_5_*) and 1 of ($x_3_*) and 8 of ($x_2_*) and 6 of ($x_1_*))) or
            ((1 of ($x_5_*) and 1 of ($x_3_*) and 9 of ($x_2_*) and 4 of ($x_1_*))) or
            ((1 of ($x_5_*) and 1 of ($x_3_*) and 10 of ($x_2_*) and 2 of ($x_1_*))) or
            ((1 of ($x_5_*) and 2 of ($x_3_*) and 19 of ($x_1_*))) or
            ((1 of ($x_5_*) and 2 of ($x_3_*) and 1 of ($x_2_*) and 17 of ($x_1_*))) or
            ((1 of ($x_5_*) and 2 of ($x_3_*) and 2 of ($x_2_*) and 15 of ($x_1_*))) or
            ((1 of ($x_5_*) and 2 of ($x_3_*) and 3 of ($x_2_*) and 13 of ($x_1_*))) or
            ((1 of ($x_5_*) and 2 of ($x_3_*) and 4 of ($x_2_*) and 11 of ($x_1_*))) or
            ((1 of ($x_5_*) and 2 of ($x_3_*) and 5 of ($x_2_*) and 9 of ($x_1_*))) or
            ((1 of ($x_5_*) and 2 of ($x_3_*) and 6 of ($x_2_*) and 7 of ($x_1_*))) or
            ((1 of ($x_5_*) and 2 of ($x_3_*) and 7 of ($x_2_*) and 5 of ($x_1_*))) or
            ((1 of ($x_5_*) and 2 of ($x_3_*) and 8 of ($x_2_*) and 3 of ($x_1_*))) or
            ((1 of ($x_5_*) and 2 of ($x_3_*) and 9 of ($x_2_*) and 1 of ($x_1_*))) or
            ((1 of ($x_5_*) and 2 of ($x_3_*) and 10 of ($x_2_*))) or
            ((1 of ($x_5_*) and 3 of ($x_3_*) and 16 of ($x_1_*))) or
            ((1 of ($x_5_*) and 3 of ($x_3_*) and 1 of ($x_2_*) and 14 of ($x_1_*))) or
            ((1 of ($x_5_*) and 3 of ($x_3_*) and 2 of ($x_2_*) and 12 of ($x_1_*))) or
            ((1 of ($x_5_*) and 3 of ($x_3_*) and 3 of ($x_2_*) and 10 of ($x_1_*))) or
            ((1 of ($x_5_*) and 3 of ($x_3_*) and 4 of ($x_2_*) and 8 of ($x_1_*))) or
            ((1 of ($x_5_*) and 3 of ($x_3_*) and 5 of ($x_2_*) and 6 of ($x_1_*))) or
            ((1 of ($x_5_*) and 3 of ($x_3_*) and 6 of ($x_2_*) and 4 of ($x_1_*))) or
            ((1 of ($x_5_*) and 3 of ($x_3_*) and 7 of ($x_2_*) and 2 of ($x_1_*))) or
            ((1 of ($x_5_*) and 3 of ($x_3_*) and 8 of ($x_2_*))) or
            ((1 of ($x_5_*) and 4 of ($x_3_*) and 13 of ($x_1_*))) or
            ((1 of ($x_5_*) and 4 of ($x_3_*) and 1 of ($x_2_*) and 11 of ($x_1_*))) or
            ((1 of ($x_5_*) and 4 of ($x_3_*) and 2 of ($x_2_*) and 9 of ($x_1_*))) or
            ((1 of ($x_5_*) and 4 of ($x_3_*) and 3 of ($x_2_*) and 7 of ($x_1_*))) or
            ((1 of ($x_5_*) and 4 of ($x_3_*) and 4 of ($x_2_*) and 5 of ($x_1_*))) or
            ((1 of ($x_5_*) and 4 of ($x_3_*) and 5 of ($x_2_*) and 3 of ($x_1_*))) or
            ((1 of ($x_5_*) and 4 of ($x_3_*) and 6 of ($x_2_*) and 1 of ($x_1_*))) or
            ((1 of ($x_5_*) and 4 of ($x_3_*) and 7 of ($x_2_*))) or
            ((1 of ($x_5_*) and 5 of ($x_3_*) and 10 of ($x_1_*))) or
            ((1 of ($x_5_*) and 5 of ($x_3_*) and 1 of ($x_2_*) and 8 of ($x_1_*))) or
            ((1 of ($x_5_*) and 5 of ($x_3_*) and 2 of ($x_2_*) and 6 of ($x_1_*))) or
            ((1 of ($x_5_*) and 5 of ($x_3_*) and 3 of ($x_2_*) and 4 of ($x_1_*))) or
            ((1 of ($x_5_*) and 5 of ($x_3_*) and 4 of ($x_2_*) and 2 of ($x_1_*))) or
            ((1 of ($x_5_*) and 5 of ($x_3_*) and 5 of ($x_2_*))) or
            ((1 of ($x_5_*) and 6 of ($x_3_*) and 7 of ($x_1_*))) or
            ((1 of ($x_5_*) and 6 of ($x_3_*) and 1 of ($x_2_*) and 5 of ($x_1_*))) or
            ((1 of ($x_5_*) and 6 of ($x_3_*) and 2 of ($x_2_*) and 3 of ($x_1_*))) or
            ((1 of ($x_5_*) and 6 of ($x_3_*) and 3 of ($x_2_*) and 1 of ($x_1_*))) or
            ((1 of ($x_5_*) and 6 of ($x_3_*) and 4 of ($x_2_*))) or
            ((1 of ($x_5_*) and 7 of ($x_3_*) and 4 of ($x_1_*))) or
            ((1 of ($x_5_*) and 7 of ($x_3_*) and 1 of ($x_2_*) and 2 of ($x_1_*))) or
            ((1 of ($x_5_*) and 7 of ($x_3_*) and 2 of ($x_2_*))) or
            ((1 of ($x_5_*) and 8 of ($x_3_*) and 1 of ($x_1_*))) or
            ((1 of ($x_5_*) and 8 of ($x_3_*) and 1 of ($x_2_*))) or
            ((1 of ($x_5_*) and 9 of ($x_3_*))) or
            ((1 of ($x_5_*) and 1 of ($x_4_*) and 1 of ($x_2_*) and 19 of ($x_1_*))) or
            ((1 of ($x_5_*) and 1 of ($x_4_*) and 2 of ($x_2_*) and 17 of ($x_1_*))) or
            ((1 of ($x_5_*) and 1 of ($x_4_*) and 3 of ($x_2_*) and 15 of ($x_1_*))) or
            ((1 of ($x_5_*) and 1 of ($x_4_*) and 4 of ($x_2_*) and 13 of ($x_1_*))) or
            ((1 of ($x_5_*) and 1 of ($x_4_*) and 5 of ($x_2_*) and 11 of ($x_1_*))) or
            ((1 of ($x_5_*) and 1 of ($x_4_*) and 6 of ($x_2_*) and 9 of ($x_1_*))) or
            ((1 of ($x_5_*) and 1 of ($x_4_*) and 7 of ($x_2_*) and 7 of ($x_1_*))) or
            ((1 of ($x_5_*) and 1 of ($x_4_*) and 8 of ($x_2_*) and 5 of ($x_1_*))) or
            ((1 of ($x_5_*) and 1 of ($x_4_*) and 9 of ($x_2_*) and 3 of ($x_1_*))) or
            ((1 of ($x_5_*) and 1 of ($x_4_*) and 10 of ($x_2_*) and 1 of ($x_1_*))) or
            ((1 of ($x_5_*) and 1 of ($x_4_*) and 1 of ($x_3_*) and 18 of ($x_1_*))) or
            ((1 of ($x_5_*) and 1 of ($x_4_*) and 1 of ($x_3_*) and 1 of ($x_2_*) and 16 of ($x_1_*))) or
            ((1 of ($x_5_*) and 1 of ($x_4_*) and 1 of ($x_3_*) and 2 of ($x_2_*) and 14 of ($x_1_*))) or
            ((1 of ($x_5_*) and 1 of ($x_4_*) and 1 of ($x_3_*) and 3 of ($x_2_*) and 12 of ($x_1_*))) or
            ((1 of ($x_5_*) and 1 of ($x_4_*) and 1 of ($x_3_*) and 4 of ($x_2_*) and 10 of ($x_1_*))) or
            ((1 of ($x_5_*) and 1 of ($x_4_*) and 1 of ($x_3_*) and 5 of ($x_2_*) and 8 of ($x_1_*))) or
            ((1 of ($x_5_*) and 1 of ($x_4_*) and 1 of ($x_3_*) and 6 of ($x_2_*) and 6 of ($x_1_*))) or
            ((1 of ($x_5_*) and 1 of ($x_4_*) and 1 of ($x_3_*) and 7 of ($x_2_*) and 4 of ($x_1_*))) or
            ((1 of ($x_5_*) and 1 of ($x_4_*) and 1 of ($x_3_*) and 8 of ($x_2_*) and 2 of ($x_1_*))) or
            ((1 of ($x_5_*) and 1 of ($x_4_*) and 1 of ($x_3_*) and 9 of ($x_2_*))) or
            ((1 of ($x_5_*) and 1 of ($x_4_*) and 2 of ($x_3_*) and 15 of ($x_1_*))) or
            ((1 of ($x_5_*) and 1 of ($x_4_*) and 2 of ($x_3_*) and 1 of ($x_2_*) and 13 of ($x_1_*))) or
            ((1 of ($x_5_*) and 1 of ($x_4_*) and 2 of ($x_3_*) and 2 of ($x_2_*) and 11 of ($x_1_*))) or
            ((1 of ($x_5_*) and 1 of ($x_4_*) and 2 of ($x_3_*) and 3 of ($x_2_*) and 9 of ($x_1_*))) or
            ((1 of ($x_5_*) and 1 of ($x_4_*) and 2 of ($x_3_*) and 4 of ($x_2_*) and 7 of ($x_1_*))) or
            ((1 of ($x_5_*) and 1 of ($x_4_*) and 2 of ($x_3_*) and 5 of ($x_2_*) and 5 of ($x_1_*))) or
            ((1 of ($x_5_*) and 1 of ($x_4_*) and 2 of ($x_3_*) and 6 of ($x_2_*) and 3 of ($x_1_*))) or
            ((1 of ($x_5_*) and 1 of ($x_4_*) and 2 of ($x_3_*) and 7 of ($x_2_*) and 1 of ($x_1_*))) or
            ((1 of ($x_5_*) and 1 of ($x_4_*) and 2 of ($x_3_*) and 8 of ($x_2_*))) or
            ((1 of ($x_5_*) and 1 of ($x_4_*) and 3 of ($x_3_*) and 12 of ($x_1_*))) or
            ((1 of ($x_5_*) and 1 of ($x_4_*) and 3 of ($x_3_*) and 1 of ($x_2_*) and 10 of ($x_1_*))) or
            ((1 of ($x_5_*) and 1 of ($x_4_*) and 3 of ($x_3_*) and 2 of ($x_2_*) and 8 of ($x_1_*))) or
            ((1 of ($x_5_*) and 1 of ($x_4_*) and 3 of ($x_3_*) and 3 of ($x_2_*) and 6 of ($x_1_*))) or
            ((1 of ($x_5_*) and 1 of ($x_4_*) and 3 of ($x_3_*) and 4 of ($x_2_*) and 4 of ($x_1_*))) or
            ((1 of ($x_5_*) and 1 of ($x_4_*) and 3 of ($x_3_*) and 5 of ($x_2_*) and 2 of ($x_1_*))) or
            ((1 of ($x_5_*) and 1 of ($x_4_*) and 3 of ($x_3_*) and 6 of ($x_2_*))) or
            ((1 of ($x_5_*) and 1 of ($x_4_*) and 4 of ($x_3_*) and 9 of ($x_1_*))) or
            ((1 of ($x_5_*) and 1 of ($x_4_*) and 4 of ($x_3_*) and 1 of ($x_2_*) and 7 of ($x_1_*))) or
            ((1 of ($x_5_*) and 1 of ($x_4_*) and 4 of ($x_3_*) and 2 of ($x_2_*) and 5 of ($x_1_*))) or
            ((1 of ($x_5_*) and 1 of ($x_4_*) and 4 of ($x_3_*) and 3 of ($x_2_*) and 3 of ($x_1_*))) or
            ((1 of ($x_5_*) and 1 of ($x_4_*) and 4 of ($x_3_*) and 4 of ($x_2_*) and 1 of ($x_1_*))) or
            ((1 of ($x_5_*) and 1 of ($x_4_*) and 4 of ($x_3_*) and 5 of ($x_2_*))) or
            ((1 of ($x_5_*) and 1 of ($x_4_*) and 5 of ($x_3_*) and 6 of ($x_1_*))) or
            ((1 of ($x_5_*) and 1 of ($x_4_*) and 5 of ($x_3_*) and 1 of ($x_2_*) and 4 of ($x_1_*))) or
            ((1 of ($x_5_*) and 1 of ($x_4_*) and 5 of ($x_3_*) and 2 of ($x_2_*) and 2 of ($x_1_*))) or
            ((1 of ($x_5_*) and 1 of ($x_4_*) and 5 of ($x_3_*) and 3 of ($x_2_*))) or
            ((1 of ($x_5_*) and 1 of ($x_4_*) and 6 of ($x_3_*) and 3 of ($x_1_*))) or
            ((1 of ($x_5_*) and 1 of ($x_4_*) and 6 of ($x_3_*) and 1 of ($x_2_*) and 1 of ($x_1_*))) or
            ((1 of ($x_5_*) and 1 of ($x_4_*) and 6 of ($x_3_*) and 2 of ($x_2_*))) or
            ((1 of ($x_5_*) and 1 of ($x_4_*) and 7 of ($x_3_*))) or
            ((1 of ($x_5_*) and 2 of ($x_4_*) and 17 of ($x_1_*))) or
            ((1 of ($x_5_*) and 2 of ($x_4_*) and 1 of ($x_2_*) and 15 of ($x_1_*))) or
            ((1 of ($x_5_*) and 2 of ($x_4_*) and 2 of ($x_2_*) and 13 of ($x_1_*))) or
            ((1 of ($x_5_*) and 2 of ($x_4_*) and 3 of ($x_2_*) and 11 of ($x_1_*))) or
            ((1 of ($x_5_*) and 2 of ($x_4_*) and 4 of ($x_2_*) and 9 of ($x_1_*))) or
            ((1 of ($x_5_*) and 2 of ($x_4_*) and 5 of ($x_2_*) and 7 of ($x_1_*))) or
            ((1 of ($x_5_*) and 2 of ($x_4_*) and 6 of ($x_2_*) and 5 of ($x_1_*))) or
            ((1 of ($x_5_*) and 2 of ($x_4_*) and 7 of ($x_2_*) and 3 of ($x_1_*))) or
            ((1 of ($x_5_*) and 2 of ($x_4_*) and 8 of ($x_2_*) and 1 of ($x_1_*))) or
            ((1 of ($x_5_*) and 2 of ($x_4_*) and 9 of ($x_2_*))) or
            ((1 of ($x_5_*) and 2 of ($x_4_*) and 1 of ($x_3_*) and 14 of ($x_1_*))) or
            ((1 of ($x_5_*) and 2 of ($x_4_*) and 1 of ($x_3_*) and 1 of ($x_2_*) and 12 of ($x_1_*))) or
            ((1 of ($x_5_*) and 2 of ($x_4_*) and 1 of ($x_3_*) and 2 of ($x_2_*) and 10 of ($x_1_*))) or
            ((1 of ($x_5_*) and 2 of ($x_4_*) and 1 of ($x_3_*) and 3 of ($x_2_*) and 8 of ($x_1_*))) or
            ((1 of ($x_5_*) and 2 of ($x_4_*) and 1 of ($x_3_*) and 4 of ($x_2_*) and 6 of ($x_1_*))) or
            ((1 of ($x_5_*) and 2 of ($x_4_*) and 1 of ($x_3_*) and 5 of ($x_2_*) and 4 of ($x_1_*))) or
            ((1 of ($x_5_*) and 2 of ($x_4_*) and 1 of ($x_3_*) and 6 of ($x_2_*) and 2 of ($x_1_*))) or
            ((1 of ($x_5_*) and 2 of ($x_4_*) and 1 of ($x_3_*) and 7 of ($x_2_*))) or
            ((1 of ($x_5_*) and 2 of ($x_4_*) and 2 of ($x_3_*) and 11 of ($x_1_*))) or
            ((1 of ($x_5_*) and 2 of ($x_4_*) and 2 of ($x_3_*) and 1 of ($x_2_*) and 9 of ($x_1_*))) or
            ((1 of ($x_5_*) and 2 of ($x_4_*) and 2 of ($x_3_*) and 2 of ($x_2_*) and 7 of ($x_1_*))) or
            ((1 of ($x_5_*) and 2 of ($x_4_*) and 2 of ($x_3_*) and 3 of ($x_2_*) and 5 of ($x_1_*))) or
            ((1 of ($x_5_*) and 2 of ($x_4_*) and 2 of ($x_3_*) and 4 of ($x_2_*) and 3 of ($x_1_*))) or
            ((1 of ($x_5_*) and 2 of ($x_4_*) and 2 of ($x_3_*) and 5 of ($x_2_*) and 1 of ($x_1_*))) or
            ((1 of ($x_5_*) and 2 of ($x_4_*) and 2 of ($x_3_*) and 6 of ($x_2_*))) or
            ((1 of ($x_5_*) and 2 of ($x_4_*) and 3 of ($x_3_*) and 8 of ($x_1_*))) or
            ((1 of ($x_5_*) and 2 of ($x_4_*) and 3 of ($x_3_*) and 1 of ($x_2_*) and 6 of ($x_1_*))) or
            ((1 of ($x_5_*) and 2 of ($x_4_*) and 3 of ($x_3_*) and 2 of ($x_2_*) and 4 of ($x_1_*))) or
            ((1 of ($x_5_*) and 2 of ($x_4_*) and 3 of ($x_3_*) and 3 of ($x_2_*) and 2 of ($x_1_*))) or
            ((1 of ($x_5_*) and 2 of ($x_4_*) and 3 of ($x_3_*) and 4 of ($x_2_*))) or
            ((1 of ($x_5_*) and 2 of ($x_4_*) and 4 of ($x_3_*) and 5 of ($x_1_*))) or
            ((1 of ($x_5_*) and 2 of ($x_4_*) and 4 of ($x_3_*) and 1 of ($x_2_*) and 3 of ($x_1_*))) or
            ((1 of ($x_5_*) and 2 of ($x_4_*) and 4 of ($x_3_*) and 2 of ($x_2_*) and 1 of ($x_1_*))) or
            ((1 of ($x_5_*) and 2 of ($x_4_*) and 4 of ($x_3_*) and 3 of ($x_2_*))) or
            ((1 of ($x_5_*) and 2 of ($x_4_*) and 5 of ($x_3_*) and 2 of ($x_1_*))) or
            ((1 of ($x_5_*) and 2 of ($x_4_*) and 5 of ($x_3_*) and 1 of ($x_2_*))) or
            ((1 of ($x_5_*) and 2 of ($x_4_*) and 6 of ($x_3_*))) or
            ((1 of ($x_5_*) and 3 of ($x_4_*) and 13 of ($x_1_*))) or
            ((1 of ($x_5_*) and 3 of ($x_4_*) and 1 of ($x_2_*) and 11 of ($x_1_*))) or
            ((1 of ($x_5_*) and 3 of ($x_4_*) and 2 of ($x_2_*) and 9 of ($x_1_*))) or
            ((1 of ($x_5_*) and 3 of ($x_4_*) and 3 of ($x_2_*) and 7 of ($x_1_*))) or
            ((1 of ($x_5_*) and 3 of ($x_4_*) and 4 of ($x_2_*) and 5 of ($x_1_*))) or
            ((1 of ($x_5_*) and 3 of ($x_4_*) and 5 of ($x_2_*) and 3 of ($x_1_*))) or
            ((1 of ($x_5_*) and 3 of ($x_4_*) and 6 of ($x_2_*) and 1 of ($x_1_*))) or
            ((1 of ($x_5_*) and 3 of ($x_4_*) and 7 of ($x_2_*))) or
            ((1 of ($x_5_*) and 3 of ($x_4_*) and 1 of ($x_3_*) and 10 of ($x_1_*))) or
            ((1 of ($x_5_*) and 3 of ($x_4_*) and 1 of ($x_3_*) and 1 of ($x_2_*) and 8 of ($x_1_*))) or
            ((1 of ($x_5_*) and 3 of ($x_4_*) and 1 of ($x_3_*) and 2 of ($x_2_*) and 6 of ($x_1_*))) or
            ((1 of ($x_5_*) and 3 of ($x_4_*) and 1 of ($x_3_*) and 3 of ($x_2_*) and 4 of ($x_1_*))) or
            ((1 of ($x_5_*) and 3 of ($x_4_*) and 1 of ($x_3_*) and 4 of ($x_2_*) and 2 of ($x_1_*))) or
            ((1 of ($x_5_*) and 3 of ($x_4_*) and 1 of ($x_3_*) and 5 of ($x_2_*))) or
            ((1 of ($x_5_*) and 3 of ($x_4_*) and 2 of ($x_3_*) and 7 of ($x_1_*))) or
            ((1 of ($x_5_*) and 3 of ($x_4_*) and 2 of ($x_3_*) and 1 of ($x_2_*) and 5 of ($x_1_*))) or
            ((1 of ($x_5_*) and 3 of ($x_4_*) and 2 of ($x_3_*) and 2 of ($x_2_*) and 3 of ($x_1_*))) or
            ((1 of ($x_5_*) and 3 of ($x_4_*) and 2 of ($x_3_*) and 3 of ($x_2_*) and 1 of ($x_1_*))) or
            ((1 of ($x_5_*) and 3 of ($x_4_*) and 2 of ($x_3_*) and 4 of ($x_2_*))) or
            ((1 of ($x_5_*) and 3 of ($x_4_*) and 3 of ($x_3_*) and 4 of ($x_1_*))) or
            ((1 of ($x_5_*) and 3 of ($x_4_*) and 3 of ($x_3_*) and 1 of ($x_2_*) and 2 of ($x_1_*))) or
            ((1 of ($x_5_*) and 3 of ($x_4_*) and 3 of ($x_3_*) and 2 of ($x_2_*))) or
            ((1 of ($x_5_*) and 3 of ($x_4_*) and 4 of ($x_3_*) and 1 of ($x_1_*))) or
            ((1 of ($x_5_*) and 3 of ($x_4_*) and 4 of ($x_3_*) and 1 of ($x_2_*))) or
            ((1 of ($x_5_*) and 3 of ($x_4_*) and 5 of ($x_3_*))) or
            ((1 of ($x_5_*) and 4 of ($x_4_*) and 9 of ($x_1_*))) or
            ((1 of ($x_5_*) and 4 of ($x_4_*) and 1 of ($x_2_*) and 7 of ($x_1_*))) or
            ((1 of ($x_5_*) and 4 of ($x_4_*) and 2 of ($x_2_*) and 5 of ($x_1_*))) or
            ((1 of ($x_5_*) and 4 of ($x_4_*) and 3 of ($x_2_*) and 3 of ($x_1_*))) or
            ((1 of ($x_5_*) and 4 of ($x_4_*) and 4 of ($x_2_*) and 1 of ($x_1_*))) or
            ((1 of ($x_5_*) and 4 of ($x_4_*) and 5 of ($x_2_*))) or
            ((1 of ($x_5_*) and 4 of ($x_4_*) and 1 of ($x_3_*) and 6 of ($x_1_*))) or
            ((1 of ($x_5_*) and 4 of ($x_4_*) and 1 of ($x_3_*) and 1 of ($x_2_*) and 4 of ($x_1_*))) or
            ((1 of ($x_5_*) and 4 of ($x_4_*) and 1 of ($x_3_*) and 2 of ($x_2_*) and 2 of ($x_1_*))) or
            ((1 of ($x_5_*) and 4 of ($x_4_*) and 1 of ($x_3_*) and 3 of ($x_2_*))) or
            ((1 of ($x_5_*) and 4 of ($x_4_*) and 2 of ($x_3_*) and 3 of ($x_1_*))) or
            ((1 of ($x_5_*) and 4 of ($x_4_*) and 2 of ($x_3_*) and 1 of ($x_2_*) and 1 of ($x_1_*))) or
            ((1 of ($x_5_*) and 4 of ($x_4_*) and 2 of ($x_3_*) and 2 of ($x_2_*))) or
            ((1 of ($x_5_*) and 4 of ($x_4_*) and 3 of ($x_3_*))) or
            ((1 of ($x_5_*) and 5 of ($x_4_*) and 5 of ($x_1_*))) or
            ((1 of ($x_5_*) and 5 of ($x_4_*) and 1 of ($x_2_*) and 3 of ($x_1_*))) or
            ((1 of ($x_5_*) and 5 of ($x_4_*) and 2 of ($x_2_*) and 1 of ($x_1_*))) or
            ((1 of ($x_5_*) and 5 of ($x_4_*) and 3 of ($x_2_*))) or
            ((1 of ($x_5_*) and 5 of ($x_4_*) and 1 of ($x_3_*) and 2 of ($x_1_*))) or
            ((1 of ($x_5_*) and 5 of ($x_4_*) and 1 of ($x_3_*) and 1 of ($x_2_*))) or
            ((1 of ($x_5_*) and 5 of ($x_4_*) and 2 of ($x_3_*))) or
            ((1 of ($x_5_*) and 6 of ($x_4_*) and 1 of ($x_1_*))) or
            ((1 of ($x_5_*) and 6 of ($x_4_*) and 1 of ($x_2_*))) or
            ((1 of ($x_5_*) and 6 of ($x_4_*) and 1 of ($x_3_*))) or
            ((1 of ($x_5_*) and 7 of ($x_4_*))) or
            ((2 of ($x_5_*) and 1 of ($x_2_*) and 18 of ($x_1_*))) or
            ((2 of ($x_5_*) and 2 of ($x_2_*) and 16 of ($x_1_*))) or
            ((2 of ($x_5_*) and 3 of ($x_2_*) and 14 of ($x_1_*))) or
            ((2 of ($x_5_*) and 4 of ($x_2_*) and 12 of ($x_1_*))) or
            ((2 of ($x_5_*) and 5 of ($x_2_*) and 10 of ($x_1_*))) or
            ((2 of ($x_5_*) and 6 of ($x_2_*) and 8 of ($x_1_*))) or
            ((2 of ($x_5_*) and 7 of ($x_2_*) and 6 of ($x_1_*))) or
            ((2 of ($x_5_*) and 8 of ($x_2_*) and 4 of ($x_1_*))) or
            ((2 of ($x_5_*) and 9 of ($x_2_*) and 2 of ($x_1_*))) or
            ((2 of ($x_5_*) and 10 of ($x_2_*))) or
            ((2 of ($x_5_*) and 1 of ($x_3_*) and 17 of ($x_1_*))) or
            ((2 of ($x_5_*) and 1 of ($x_3_*) and 1 of ($x_2_*) and 15 of ($x_1_*))) or
            ((2 of ($x_5_*) and 1 of ($x_3_*) and 2 of ($x_2_*) and 13 of ($x_1_*))) or
            ((2 of ($x_5_*) and 1 of ($x_3_*) and 3 of ($x_2_*) and 11 of ($x_1_*))) or
            ((2 of ($x_5_*) and 1 of ($x_3_*) and 4 of ($x_2_*) and 9 of ($x_1_*))) or
            ((2 of ($x_5_*) and 1 of ($x_3_*) and 5 of ($x_2_*) and 7 of ($x_1_*))) or
            ((2 of ($x_5_*) and 1 of ($x_3_*) and 6 of ($x_2_*) and 5 of ($x_1_*))) or
            ((2 of ($x_5_*) and 1 of ($x_3_*) and 7 of ($x_2_*) and 3 of ($x_1_*))) or
            ((2 of ($x_5_*) and 1 of ($x_3_*) and 8 of ($x_2_*) and 1 of ($x_1_*))) or
            ((2 of ($x_5_*) and 1 of ($x_3_*) and 9 of ($x_2_*))) or
            ((2 of ($x_5_*) and 2 of ($x_3_*) and 14 of ($x_1_*))) or
            ((2 of ($x_5_*) and 2 of ($x_3_*) and 1 of ($x_2_*) and 12 of ($x_1_*))) or
            ((2 of ($x_5_*) and 2 of ($x_3_*) and 2 of ($x_2_*) and 10 of ($x_1_*))) or
            ((2 of ($x_5_*) and 2 of ($x_3_*) and 3 of ($x_2_*) and 8 of ($x_1_*))) or
            ((2 of ($x_5_*) and 2 of ($x_3_*) and 4 of ($x_2_*) and 6 of ($x_1_*))) or
            ((2 of ($x_5_*) and 2 of ($x_3_*) and 5 of ($x_2_*) and 4 of ($x_1_*))) or
            ((2 of ($x_5_*) and 2 of ($x_3_*) and 6 of ($x_2_*) and 2 of ($x_1_*))) or
            ((2 of ($x_5_*) and 2 of ($x_3_*) and 7 of ($x_2_*))) or
            ((2 of ($x_5_*) and 3 of ($x_3_*) and 11 of ($x_1_*))) or
            ((2 of ($x_5_*) and 3 of ($x_3_*) and 1 of ($x_2_*) and 9 of ($x_1_*))) or
            ((2 of ($x_5_*) and 3 of ($x_3_*) and 2 of ($x_2_*) and 7 of ($x_1_*))) or
            ((2 of ($x_5_*) and 3 of ($x_3_*) and 3 of ($x_2_*) and 5 of ($x_1_*))) or
            ((2 of ($x_5_*) and 3 of ($x_3_*) and 4 of ($x_2_*) and 3 of ($x_1_*))) or
            ((2 of ($x_5_*) and 3 of ($x_3_*) and 5 of ($x_2_*) and 1 of ($x_1_*))) or
            ((2 of ($x_5_*) and 3 of ($x_3_*) and 6 of ($x_2_*))) or
            ((2 of ($x_5_*) and 4 of ($x_3_*) and 8 of ($x_1_*))) or
            ((2 of ($x_5_*) and 4 of ($x_3_*) and 1 of ($x_2_*) and 6 of ($x_1_*))) or
            ((2 of ($x_5_*) and 4 of ($x_3_*) and 2 of ($x_2_*) and 4 of ($x_1_*))) or
            ((2 of ($x_5_*) and 4 of ($x_3_*) and 3 of ($x_2_*) and 2 of ($x_1_*))) or
            ((2 of ($x_5_*) and 4 of ($x_3_*) and 4 of ($x_2_*))) or
            ((2 of ($x_5_*) and 5 of ($x_3_*) and 5 of ($x_1_*))) or
            ((2 of ($x_5_*) and 5 of ($x_3_*) and 1 of ($x_2_*) and 3 of ($x_1_*))) or
            ((2 of ($x_5_*) and 5 of ($x_3_*) and 2 of ($x_2_*) and 1 of ($x_1_*))) or
            ((2 of ($x_5_*) and 5 of ($x_3_*) and 3 of ($x_2_*))) or
            ((2 of ($x_5_*) and 6 of ($x_3_*) and 2 of ($x_1_*))) or
            ((2 of ($x_5_*) and 6 of ($x_3_*) and 1 of ($x_2_*))) or
            ((2 of ($x_5_*) and 7 of ($x_3_*))) or
            ((2 of ($x_5_*) and 1 of ($x_4_*) and 16 of ($x_1_*))) or
            ((2 of ($x_5_*) and 1 of ($x_4_*) and 1 of ($x_2_*) and 14 of ($x_1_*))) or
            ((2 of ($x_5_*) and 1 of ($x_4_*) and 2 of ($x_2_*) and 12 of ($x_1_*))) or
            ((2 of ($x_5_*) and 1 of ($x_4_*) and 3 of ($x_2_*) and 10 of ($x_1_*))) or
            ((2 of ($x_5_*) and 1 of ($x_4_*) and 4 of ($x_2_*) and 8 of ($x_1_*))) or
            ((2 of ($x_5_*) and 1 of ($x_4_*) and 5 of ($x_2_*) and 6 of ($x_1_*))) or
            ((2 of ($x_5_*) and 1 of ($x_4_*) and 6 of ($x_2_*) and 4 of ($x_1_*))) or
            ((2 of ($x_5_*) and 1 of ($x_4_*) and 7 of ($x_2_*) and 2 of ($x_1_*))) or
            ((2 of ($x_5_*) and 1 of ($x_4_*) and 8 of ($x_2_*))) or
            ((2 of ($x_5_*) and 1 of ($x_4_*) and 1 of ($x_3_*) and 13 of ($x_1_*))) or
            ((2 of ($x_5_*) and 1 of ($x_4_*) and 1 of ($x_3_*) and 1 of ($x_2_*) and 11 of ($x_1_*))) or
            ((2 of ($x_5_*) and 1 of ($x_4_*) and 1 of ($x_3_*) and 2 of ($x_2_*) and 9 of ($x_1_*))) or
            ((2 of ($x_5_*) and 1 of ($x_4_*) and 1 of ($x_3_*) and 3 of ($x_2_*) and 7 of ($x_1_*))) or
            ((2 of ($x_5_*) and 1 of ($x_4_*) and 1 of ($x_3_*) and 4 of ($x_2_*) and 5 of ($x_1_*))) or
            ((2 of ($x_5_*) and 1 of ($x_4_*) and 1 of ($x_3_*) and 5 of ($x_2_*) and 3 of ($x_1_*))) or
            ((2 of ($x_5_*) and 1 of ($x_4_*) and 1 of ($x_3_*) and 6 of ($x_2_*) and 1 of ($x_1_*))) or
            ((2 of ($x_5_*) and 1 of ($x_4_*) and 1 of ($x_3_*) and 7 of ($x_2_*))) or
            ((2 of ($x_5_*) and 1 of ($x_4_*) and 2 of ($x_3_*) and 10 of ($x_1_*))) or
            ((2 of ($x_5_*) and 1 of ($x_4_*) and 2 of ($x_3_*) and 1 of ($x_2_*) and 8 of ($x_1_*))) or
            ((2 of ($x_5_*) and 1 of ($x_4_*) and 2 of ($x_3_*) and 2 of ($x_2_*) and 6 of ($x_1_*))) or
            ((2 of ($x_5_*) and 1 of ($x_4_*) and 2 of ($x_3_*) and 3 of ($x_2_*) and 4 of ($x_1_*))) or
            ((2 of ($x_5_*) and 1 of ($x_4_*) and 2 of ($x_3_*) and 4 of ($x_2_*) and 2 of ($x_1_*))) or
            ((2 of ($x_5_*) and 1 of ($x_4_*) and 2 of ($x_3_*) and 5 of ($x_2_*))) or
            ((2 of ($x_5_*) and 1 of ($x_4_*) and 3 of ($x_3_*) and 7 of ($x_1_*))) or
            ((2 of ($x_5_*) and 1 of ($x_4_*) and 3 of ($x_3_*) and 1 of ($x_2_*) and 5 of ($x_1_*))) or
            ((2 of ($x_5_*) and 1 of ($x_4_*) and 3 of ($x_3_*) and 2 of ($x_2_*) and 3 of ($x_1_*))) or
            ((2 of ($x_5_*) and 1 of ($x_4_*) and 3 of ($x_3_*) and 3 of ($x_2_*) and 1 of ($x_1_*))) or
            ((2 of ($x_5_*) and 1 of ($x_4_*) and 3 of ($x_3_*) and 4 of ($x_2_*))) or
            ((2 of ($x_5_*) and 1 of ($x_4_*) and 4 of ($x_3_*) and 4 of ($x_1_*))) or
            ((2 of ($x_5_*) and 1 of ($x_4_*) and 4 of ($x_3_*) and 1 of ($x_2_*) and 2 of ($x_1_*))) or
            ((2 of ($x_5_*) and 1 of ($x_4_*) and 4 of ($x_3_*) and 2 of ($x_2_*))) or
            ((2 of ($x_5_*) and 1 of ($x_4_*) and 5 of ($x_3_*) and 1 of ($x_1_*))) or
            ((2 of ($x_5_*) and 1 of ($x_4_*) and 5 of ($x_3_*) and 1 of ($x_2_*))) or
            ((2 of ($x_5_*) and 1 of ($x_4_*) and 6 of ($x_3_*))) or
            ((2 of ($x_5_*) and 2 of ($x_4_*) and 12 of ($x_1_*))) or
            ((2 of ($x_5_*) and 2 of ($x_4_*) and 1 of ($x_2_*) and 10 of ($x_1_*))) or
            ((2 of ($x_5_*) and 2 of ($x_4_*) and 2 of ($x_2_*) and 8 of ($x_1_*))) or
            ((2 of ($x_5_*) and 2 of ($x_4_*) and 3 of ($x_2_*) and 6 of ($x_1_*))) or
            ((2 of ($x_5_*) and 2 of ($x_4_*) and 4 of ($x_2_*) and 4 of ($x_1_*))) or
            ((2 of ($x_5_*) and 2 of ($x_4_*) and 5 of ($x_2_*) and 2 of ($x_1_*))) or
            ((2 of ($x_5_*) and 2 of ($x_4_*) and 6 of ($x_2_*))) or
            ((2 of ($x_5_*) and 2 of ($x_4_*) and 1 of ($x_3_*) and 9 of ($x_1_*))) or
            ((2 of ($x_5_*) and 2 of ($x_4_*) and 1 of ($x_3_*) and 1 of ($x_2_*) and 7 of ($x_1_*))) or
            ((2 of ($x_5_*) and 2 of ($x_4_*) and 1 of ($x_3_*) and 2 of ($x_2_*) and 5 of ($x_1_*))) or
            ((2 of ($x_5_*) and 2 of ($x_4_*) and 1 of ($x_3_*) and 3 of ($x_2_*) and 3 of ($x_1_*))) or
            ((2 of ($x_5_*) and 2 of ($x_4_*) and 1 of ($x_3_*) and 4 of ($x_2_*) and 1 of ($x_1_*))) or
            ((2 of ($x_5_*) and 2 of ($x_4_*) and 1 of ($x_3_*) and 5 of ($x_2_*))) or
            ((2 of ($x_5_*) and 2 of ($x_4_*) and 2 of ($x_3_*) and 6 of ($x_1_*))) or
            ((2 of ($x_5_*) and 2 of ($x_4_*) and 2 of ($x_3_*) and 1 of ($x_2_*) and 4 of ($x_1_*))) or
            ((2 of ($x_5_*) and 2 of ($x_4_*) and 2 of ($x_3_*) and 2 of ($x_2_*) and 2 of ($x_1_*))) or
            ((2 of ($x_5_*) and 2 of ($x_4_*) and 2 of ($x_3_*) and 3 of ($x_2_*))) or
            ((2 of ($x_5_*) and 2 of ($x_4_*) and 3 of ($x_3_*) and 3 of ($x_1_*))) or
            ((2 of ($x_5_*) and 2 of ($x_4_*) and 3 of ($x_3_*) and 1 of ($x_2_*) and 1 of ($x_1_*))) or
            ((2 of ($x_5_*) and 2 of ($x_4_*) and 3 of ($x_3_*) and 2 of ($x_2_*))) or
            ((2 of ($x_5_*) and 2 of ($x_4_*) and 4 of ($x_3_*))) or
            ((2 of ($x_5_*) and 3 of ($x_4_*) and 8 of ($x_1_*))) or
            ((2 of ($x_5_*) and 3 of ($x_4_*) and 1 of ($x_2_*) and 6 of ($x_1_*))) or
            ((2 of ($x_5_*) and 3 of ($x_4_*) and 2 of ($x_2_*) and 4 of ($x_1_*))) or
            ((2 of ($x_5_*) and 3 of ($x_4_*) and 3 of ($x_2_*) and 2 of ($x_1_*))) or
            ((2 of ($x_5_*) and 3 of ($x_4_*) and 4 of ($x_2_*))) or
            ((2 of ($x_5_*) and 3 of ($x_4_*) and 1 of ($x_3_*) and 5 of ($x_1_*))) or
            ((2 of ($x_5_*) and 3 of ($x_4_*) and 1 of ($x_3_*) and 1 of ($x_2_*) and 3 of ($x_1_*))) or
            ((2 of ($x_5_*) and 3 of ($x_4_*) and 1 of ($x_3_*) and 2 of ($x_2_*) and 1 of ($x_1_*))) or
            ((2 of ($x_5_*) and 3 of ($x_4_*) and 1 of ($x_3_*) and 3 of ($x_2_*))) or
            ((2 of ($x_5_*) and 3 of ($x_4_*) and 2 of ($x_3_*) and 2 of ($x_1_*))) or
            ((2 of ($x_5_*) and 3 of ($x_4_*) and 2 of ($x_3_*) and 1 of ($x_2_*))) or
            ((2 of ($x_5_*) and 3 of ($x_4_*) and 3 of ($x_3_*))) or
            ((2 of ($x_5_*) and 4 of ($x_4_*) and 4 of ($x_1_*))) or
            ((2 of ($x_5_*) and 4 of ($x_4_*) and 1 of ($x_2_*) and 2 of ($x_1_*))) or
            ((2 of ($x_5_*) and 4 of ($x_4_*) and 2 of ($x_2_*))) or
            ((2 of ($x_5_*) and 4 of ($x_4_*) and 1 of ($x_3_*) and 1 of ($x_1_*))) or
            ((2 of ($x_5_*) and 4 of ($x_4_*) and 1 of ($x_3_*) and 1 of ($x_2_*))) or
            ((2 of ($x_5_*) and 4 of ($x_4_*) and 2 of ($x_3_*))) or
            ((2 of ($x_5_*) and 5 of ($x_4_*))) or
            ((3 of ($x_5_*) and 15 of ($x_1_*))) or
            ((3 of ($x_5_*) and 1 of ($x_2_*) and 13 of ($x_1_*))) or
            ((3 of ($x_5_*) and 2 of ($x_2_*) and 11 of ($x_1_*))) or
            ((3 of ($x_5_*) and 3 of ($x_2_*) and 9 of ($x_1_*))) or
            ((3 of ($x_5_*) and 4 of ($x_2_*) and 7 of ($x_1_*))) or
            ((3 of ($x_5_*) and 5 of ($x_2_*) and 5 of ($x_1_*))) or
            ((3 of ($x_5_*) and 6 of ($x_2_*) and 3 of ($x_1_*))) or
            ((3 of ($x_5_*) and 7 of ($x_2_*) and 1 of ($x_1_*))) or
            ((3 of ($x_5_*) and 8 of ($x_2_*))) or
            ((3 of ($x_5_*) and 1 of ($x_3_*) and 12 of ($x_1_*))) or
            ((3 of ($x_5_*) and 1 of ($x_3_*) and 1 of ($x_2_*) and 10 of ($x_1_*))) or
            ((3 of ($x_5_*) and 1 of ($x_3_*) and 2 of ($x_2_*) and 8 of ($x_1_*))) or
            ((3 of ($x_5_*) and 1 of ($x_3_*) and 3 of ($x_2_*) and 6 of ($x_1_*))) or
            ((3 of ($x_5_*) and 1 of ($x_3_*) and 4 of ($x_2_*) and 4 of ($x_1_*))) or
            ((3 of ($x_5_*) and 1 of ($x_3_*) and 5 of ($x_2_*) and 2 of ($x_1_*))) or
            ((3 of ($x_5_*) and 1 of ($x_3_*) and 6 of ($x_2_*))) or
            ((3 of ($x_5_*) and 2 of ($x_3_*) and 9 of ($x_1_*))) or
            ((3 of ($x_5_*) and 2 of ($x_3_*) and 1 of ($x_2_*) and 7 of ($x_1_*))) or
            ((3 of ($x_5_*) and 2 of ($x_3_*) and 2 of ($x_2_*) and 5 of ($x_1_*))) or
            ((3 of ($x_5_*) and 2 of ($x_3_*) and 3 of ($x_2_*) and 3 of ($x_1_*))) or
            ((3 of ($x_5_*) and 2 of ($x_3_*) and 4 of ($x_2_*) and 1 of ($x_1_*))) or
            ((3 of ($x_5_*) and 2 of ($x_3_*) and 5 of ($x_2_*))) or
            ((3 of ($x_5_*) and 3 of ($x_3_*) and 6 of ($x_1_*))) or
            ((3 of ($x_5_*) and 3 of ($x_3_*) and 1 of ($x_2_*) and 4 of ($x_1_*))) or
            ((3 of ($x_5_*) and 3 of ($x_3_*) and 2 of ($x_2_*) and 2 of ($x_1_*))) or
            ((3 of ($x_5_*) and 3 of ($x_3_*) and 3 of ($x_2_*))) or
            ((3 of ($x_5_*) and 4 of ($x_3_*) and 3 of ($x_1_*))) or
            ((3 of ($x_5_*) and 4 of ($x_3_*) and 1 of ($x_2_*) and 1 of ($x_1_*))) or
            ((3 of ($x_5_*) and 4 of ($x_3_*) and 2 of ($x_2_*))) or
            ((3 of ($x_5_*) and 5 of ($x_3_*))) or
            ((3 of ($x_5_*) and 1 of ($x_4_*) and 11 of ($x_1_*))) or
            ((3 of ($x_5_*) and 1 of ($x_4_*) and 1 of ($x_2_*) and 9 of ($x_1_*))) or
            ((3 of ($x_5_*) and 1 of ($x_4_*) and 2 of ($x_2_*) and 7 of ($x_1_*))) or
            ((3 of ($x_5_*) and 1 of ($x_4_*) and 3 of ($x_2_*) and 5 of ($x_1_*))) or
            ((3 of ($x_5_*) and 1 of ($x_4_*) and 4 of ($x_2_*) and 3 of ($x_1_*))) or
            ((3 of ($x_5_*) and 1 of ($x_4_*) and 5 of ($x_2_*) and 1 of ($x_1_*))) or
            ((3 of ($x_5_*) and 1 of ($x_4_*) and 6 of ($x_2_*))) or
            ((3 of ($x_5_*) and 1 of ($x_4_*) and 1 of ($x_3_*) and 8 of ($x_1_*))) or
            ((3 of ($x_5_*) and 1 of ($x_4_*) and 1 of ($x_3_*) and 1 of ($x_2_*) and 6 of ($x_1_*))) or
            ((3 of ($x_5_*) and 1 of ($x_4_*) and 1 of ($x_3_*) and 2 of ($x_2_*) and 4 of ($x_1_*))) or
            ((3 of ($x_5_*) and 1 of ($x_4_*) and 1 of ($x_3_*) and 3 of ($x_2_*) and 2 of ($x_1_*))) or
            ((3 of ($x_5_*) and 1 of ($x_4_*) and 1 of ($x_3_*) and 4 of ($x_2_*))) or
            ((3 of ($x_5_*) and 1 of ($x_4_*) and 2 of ($x_3_*) and 5 of ($x_1_*))) or
            ((3 of ($x_5_*) and 1 of ($x_4_*) and 2 of ($x_3_*) and 1 of ($x_2_*) and 3 of ($x_1_*))) or
            ((3 of ($x_5_*) and 1 of ($x_4_*) and 2 of ($x_3_*) and 2 of ($x_2_*) and 1 of ($x_1_*))) or
            ((3 of ($x_5_*) and 1 of ($x_4_*) and 2 of ($x_3_*) and 3 of ($x_2_*))) or
            ((3 of ($x_5_*) and 1 of ($x_4_*) and 3 of ($x_3_*) and 2 of ($x_1_*))) or
            ((3 of ($x_5_*) and 1 of ($x_4_*) and 3 of ($x_3_*) and 1 of ($x_2_*))) or
            ((3 of ($x_5_*) and 1 of ($x_4_*) and 4 of ($x_3_*))) or
            ((3 of ($x_5_*) and 2 of ($x_4_*) and 7 of ($x_1_*))) or
            ((3 of ($x_5_*) and 2 of ($x_4_*) and 1 of ($x_2_*) and 5 of ($x_1_*))) or
            ((3 of ($x_5_*) and 2 of ($x_4_*) and 2 of ($x_2_*) and 3 of ($x_1_*))) or
            ((3 of ($x_5_*) and 2 of ($x_4_*) and 3 of ($x_2_*) and 1 of ($x_1_*))) or
            ((3 of ($x_5_*) and 2 of ($x_4_*) and 4 of ($x_2_*))) or
            ((3 of ($x_5_*) and 2 of ($x_4_*) and 1 of ($x_3_*) and 4 of ($x_1_*))) or
            ((3 of ($x_5_*) and 2 of ($x_4_*) and 1 of ($x_3_*) and 1 of ($x_2_*) and 2 of ($x_1_*))) or
            ((3 of ($x_5_*) and 2 of ($x_4_*) and 1 of ($x_3_*) and 2 of ($x_2_*))) or
            ((3 of ($x_5_*) and 2 of ($x_4_*) and 2 of ($x_3_*) and 1 of ($x_1_*))) or
            ((3 of ($x_5_*) and 2 of ($x_4_*) and 2 of ($x_3_*) and 1 of ($x_2_*))) or
            ((3 of ($x_5_*) and 2 of ($x_4_*) and 3 of ($x_3_*))) or
            ((3 of ($x_5_*) and 3 of ($x_4_*) and 3 of ($x_1_*))) or
            ((3 of ($x_5_*) and 3 of ($x_4_*) and 1 of ($x_2_*) and 1 of ($x_1_*))) or
            ((3 of ($x_5_*) and 3 of ($x_4_*) and 2 of ($x_2_*))) or
            ((3 of ($x_5_*) and 3 of ($x_4_*) and 1 of ($x_3_*))) or
            ((3 of ($x_5_*) and 4 of ($x_4_*))) or
            ((4 of ($x_5_*) and 10 of ($x_1_*))) or
            ((4 of ($x_5_*) and 1 of ($x_2_*) and 8 of ($x_1_*))) or
            ((4 of ($x_5_*) and 2 of ($x_2_*) and 6 of ($x_1_*))) or
            ((4 of ($x_5_*) and 3 of ($x_2_*) and 4 of ($x_1_*))) or
            ((4 of ($x_5_*) and 4 of ($x_2_*) and 2 of ($x_1_*))) or
            ((4 of ($x_5_*) and 5 of ($x_2_*))) or
            ((4 of ($x_5_*) and 1 of ($x_3_*) and 7 of ($x_1_*))) or
            ((4 of ($x_5_*) and 1 of ($x_3_*) and 1 of ($x_2_*) and 5 of ($x_1_*))) or
            ((4 of ($x_5_*) and 1 of ($x_3_*) and 2 of ($x_2_*) and 3 of ($x_1_*))) or
            ((4 of ($x_5_*) and 1 of ($x_3_*) and 3 of ($x_2_*) and 1 of ($x_1_*))) or
            ((4 of ($x_5_*) and 1 of ($x_3_*) and 4 of ($x_2_*))) or
            ((4 of ($x_5_*) and 2 of ($x_3_*) and 4 of ($x_1_*))) or
            ((4 of ($x_5_*) and 2 of ($x_3_*) and 1 of ($x_2_*) and 2 of ($x_1_*))) or
            ((4 of ($x_5_*) and 2 of ($x_3_*) and 2 of ($x_2_*))) or
            ((4 of ($x_5_*) and 3 of ($x_3_*) and 1 of ($x_1_*))) or
            ((4 of ($x_5_*) and 3 of ($x_3_*) and 1 of ($x_2_*))) or
            ((4 of ($x_5_*) and 4 of ($x_3_*))) or
            ((4 of ($x_5_*) and 1 of ($x_4_*) and 6 of ($x_1_*))) or
            ((4 of ($x_5_*) and 1 of ($x_4_*) and 1 of ($x_2_*) and 4 of ($x_1_*))) or
            ((4 of ($x_5_*) and 1 of ($x_4_*) and 2 of ($x_2_*) and 2 of ($x_1_*))) or
            ((4 of ($x_5_*) and 1 of ($x_4_*) and 3 of ($x_2_*))) or
            ((4 of ($x_5_*) and 1 of ($x_4_*) and 1 of ($x_3_*) and 3 of ($x_1_*))) or
            ((4 of ($x_5_*) and 1 of ($x_4_*) and 1 of ($x_3_*) and 1 of ($x_2_*) and 1 of ($x_1_*))) or
            ((4 of ($x_5_*) and 1 of ($x_4_*) and 1 of ($x_3_*) and 2 of ($x_2_*))) or
            ((4 of ($x_5_*) and 1 of ($x_4_*) and 2 of ($x_3_*))) or
            ((4 of ($x_5_*) and 2 of ($x_4_*) and 2 of ($x_1_*))) or
            ((4 of ($x_5_*) and 2 of ($x_4_*) and 1 of ($x_2_*))) or
            ((4 of ($x_5_*) and 2 of ($x_4_*) and 1 of ($x_3_*))) or
            ((4 of ($x_5_*) and 3 of ($x_4_*))) or
            ((5 of ($x_5_*) and 5 of ($x_1_*))) or
            ((5 of ($x_5_*) and 1 of ($x_2_*) and 3 of ($x_1_*))) or
            ((5 of ($x_5_*) and 2 of ($x_2_*) and 1 of ($x_1_*))) or
            ((5 of ($x_5_*) and 3 of ($x_2_*))) or
            ((5 of ($x_5_*) and 1 of ($x_3_*) and 2 of ($x_1_*))) or
            ((5 of ($x_5_*) and 1 of ($x_3_*) and 1 of ($x_2_*))) or
            ((5 of ($x_5_*) and 2 of ($x_3_*))) or
            ((5 of ($x_5_*) and 1 of ($x_4_*) and 1 of ($x_1_*))) or
            ((5 of ($x_5_*) and 1 of ($x_4_*) and 1 of ($x_2_*))) or
            ((5 of ($x_5_*) and 1 of ($x_4_*) and 1 of ($x_3_*))) or
            ((5 of ($x_5_*) and 2 of ($x_4_*))) or
            ((1 of ($x_6_*) and 3 of ($x_2_*) and 18 of ($x_1_*))) or
            ((1 of ($x_6_*) and 4 of ($x_2_*) and 16 of ($x_1_*))) or
            ((1 of ($x_6_*) and 5 of ($x_2_*) and 14 of ($x_1_*))) or
            ((1 of ($x_6_*) and 6 of ($x_2_*) and 12 of ($x_1_*))) or
            ((1 of ($x_6_*) and 7 of ($x_2_*) and 10 of ($x_1_*))) or
            ((1 of ($x_6_*) and 8 of ($x_2_*) and 8 of ($x_1_*))) or
            ((1 of ($x_6_*) and 9 of ($x_2_*) and 6 of ($x_1_*))) or
            ((1 of ($x_6_*) and 10 of ($x_2_*) and 4 of ($x_1_*))) or
            ((1 of ($x_6_*) and 1 of ($x_3_*) and 1 of ($x_2_*) and 19 of ($x_1_*))) or
            ((1 of ($x_6_*) and 1 of ($x_3_*) and 2 of ($x_2_*) and 17 of ($x_1_*))) or
            ((1 of ($x_6_*) and 1 of ($x_3_*) and 3 of ($x_2_*) and 15 of ($x_1_*))) or
            ((1 of ($x_6_*) and 1 of ($x_3_*) and 4 of ($x_2_*) and 13 of ($x_1_*))) or
            ((1 of ($x_6_*) and 1 of ($x_3_*) and 5 of ($x_2_*) and 11 of ($x_1_*))) or
            ((1 of ($x_6_*) and 1 of ($x_3_*) and 6 of ($x_2_*) and 9 of ($x_1_*))) or
            ((1 of ($x_6_*) and 1 of ($x_3_*) and 7 of ($x_2_*) and 7 of ($x_1_*))) or
            ((1 of ($x_6_*) and 1 of ($x_3_*) and 8 of ($x_2_*) and 5 of ($x_1_*))) or
            ((1 of ($x_6_*) and 1 of ($x_3_*) and 9 of ($x_2_*) and 3 of ($x_1_*))) or
            ((1 of ($x_6_*) and 1 of ($x_3_*) and 10 of ($x_2_*) and 1 of ($x_1_*))) or
            ((1 of ($x_6_*) and 2 of ($x_3_*) and 18 of ($x_1_*))) or
            ((1 of ($x_6_*) and 2 of ($x_3_*) and 1 of ($x_2_*) and 16 of ($x_1_*))) or
            ((1 of ($x_6_*) and 2 of ($x_3_*) and 2 of ($x_2_*) and 14 of ($x_1_*))) or
            ((1 of ($x_6_*) and 2 of ($x_3_*) and 3 of ($x_2_*) and 12 of ($x_1_*))) or
            ((1 of ($x_6_*) and 2 of ($x_3_*) and 4 of ($x_2_*) and 10 of ($x_1_*))) or
            ((1 of ($x_6_*) and 2 of ($x_3_*) and 5 of ($x_2_*) and 8 of ($x_1_*))) or
            ((1 of ($x_6_*) and 2 of ($x_3_*) and 6 of ($x_2_*) and 6 of ($x_1_*))) or
            ((1 of ($x_6_*) and 2 of ($x_3_*) and 7 of ($x_2_*) and 4 of ($x_1_*))) or
            ((1 of ($x_6_*) and 2 of ($x_3_*) and 8 of ($x_2_*) and 2 of ($x_1_*))) or
            ((1 of ($x_6_*) and 2 of ($x_3_*) and 9 of ($x_2_*))) or
            ((1 of ($x_6_*) and 3 of ($x_3_*) and 15 of ($x_1_*))) or
            ((1 of ($x_6_*) and 3 of ($x_3_*) and 1 of ($x_2_*) and 13 of ($x_1_*))) or
            ((1 of ($x_6_*) and 3 of ($x_3_*) and 2 of ($x_2_*) and 11 of ($x_1_*))) or
            ((1 of ($x_6_*) and 3 of ($x_3_*) and 3 of ($x_2_*) and 9 of ($x_1_*))) or
            ((1 of ($x_6_*) and 3 of ($x_3_*) and 4 of ($x_2_*) and 7 of ($x_1_*))) or
            ((1 of ($x_6_*) and 3 of ($x_3_*) and 5 of ($x_2_*) and 5 of ($x_1_*))) or
            ((1 of ($x_6_*) and 3 of ($x_3_*) and 6 of ($x_2_*) and 3 of ($x_1_*))) or
            ((1 of ($x_6_*) and 3 of ($x_3_*) and 7 of ($x_2_*) and 1 of ($x_1_*))) or
            ((1 of ($x_6_*) and 3 of ($x_3_*) and 8 of ($x_2_*))) or
            ((1 of ($x_6_*) and 4 of ($x_3_*) and 12 of ($x_1_*))) or
            ((1 of ($x_6_*) and 4 of ($x_3_*) and 1 of ($x_2_*) and 10 of ($x_1_*))) or
            ((1 of ($x_6_*) and 4 of ($x_3_*) and 2 of ($x_2_*) and 8 of ($x_1_*))) or
            ((1 of ($x_6_*) and 4 of ($x_3_*) and 3 of ($x_2_*) and 6 of ($x_1_*))) or
            ((1 of ($x_6_*) and 4 of ($x_3_*) and 4 of ($x_2_*) and 4 of ($x_1_*))) or
            ((1 of ($x_6_*) and 4 of ($x_3_*) and 5 of ($x_2_*) and 2 of ($x_1_*))) or
            ((1 of ($x_6_*) and 4 of ($x_3_*) and 6 of ($x_2_*))) or
            ((1 of ($x_6_*) and 5 of ($x_3_*) and 9 of ($x_1_*))) or
            ((1 of ($x_6_*) and 5 of ($x_3_*) and 1 of ($x_2_*) and 7 of ($x_1_*))) or
            ((1 of ($x_6_*) and 5 of ($x_3_*) and 2 of ($x_2_*) and 5 of ($x_1_*))) or
            ((1 of ($x_6_*) and 5 of ($x_3_*) and 3 of ($x_2_*) and 3 of ($x_1_*))) or
            ((1 of ($x_6_*) and 5 of ($x_3_*) and 4 of ($x_2_*) and 1 of ($x_1_*))) or
            ((1 of ($x_6_*) and 5 of ($x_3_*) and 5 of ($x_2_*))) or
            ((1 of ($x_6_*) and 6 of ($x_3_*) and 6 of ($x_1_*))) or
            ((1 of ($x_6_*) and 6 of ($x_3_*) and 1 of ($x_2_*) and 4 of ($x_1_*))) or
            ((1 of ($x_6_*) and 6 of ($x_3_*) and 2 of ($x_2_*) and 2 of ($x_1_*))) or
            ((1 of ($x_6_*) and 6 of ($x_3_*) and 3 of ($x_2_*))) or
            ((1 of ($x_6_*) and 7 of ($x_3_*) and 3 of ($x_1_*))) or
            ((1 of ($x_6_*) and 7 of ($x_3_*) and 1 of ($x_2_*) and 1 of ($x_1_*))) or
            ((1 of ($x_6_*) and 7 of ($x_3_*) and 2 of ($x_2_*))) or
            ((1 of ($x_6_*) and 8 of ($x_3_*))) or
            ((1 of ($x_6_*) and 1 of ($x_4_*) and 1 of ($x_2_*) and 18 of ($x_1_*))) or
            ((1 of ($x_6_*) and 1 of ($x_4_*) and 2 of ($x_2_*) and 16 of ($x_1_*))) or
            ((1 of ($x_6_*) and 1 of ($x_4_*) and 3 of ($x_2_*) and 14 of ($x_1_*))) or
            ((1 of ($x_6_*) and 1 of ($x_4_*) and 4 of ($x_2_*) and 12 of ($x_1_*))) or
            ((1 of ($x_6_*) and 1 of ($x_4_*) and 5 of ($x_2_*) and 10 of ($x_1_*))) or
            ((1 of ($x_6_*) and 1 of ($x_4_*) and 6 of ($x_2_*) and 8 of ($x_1_*))) or
            ((1 of ($x_6_*) and 1 of ($x_4_*) and 7 of ($x_2_*) and 6 of ($x_1_*))) or
            ((1 of ($x_6_*) and 1 of ($x_4_*) and 8 of ($x_2_*) and 4 of ($x_1_*))) or
            ((1 of ($x_6_*) and 1 of ($x_4_*) and 9 of ($x_2_*) and 2 of ($x_1_*))) or
            ((1 of ($x_6_*) and 1 of ($x_4_*) and 10 of ($x_2_*))) or
            ((1 of ($x_6_*) and 1 of ($x_4_*) and 1 of ($x_3_*) and 17 of ($x_1_*))) or
            ((1 of ($x_6_*) and 1 of ($x_4_*) and 1 of ($x_3_*) and 1 of ($x_2_*) and 15 of ($x_1_*))) or
            ((1 of ($x_6_*) and 1 of ($x_4_*) and 1 of ($x_3_*) and 2 of ($x_2_*) and 13 of ($x_1_*))) or
            ((1 of ($x_6_*) and 1 of ($x_4_*) and 1 of ($x_3_*) and 3 of ($x_2_*) and 11 of ($x_1_*))) or
            ((1 of ($x_6_*) and 1 of ($x_4_*) and 1 of ($x_3_*) and 4 of ($x_2_*) and 9 of ($x_1_*))) or
            ((1 of ($x_6_*) and 1 of ($x_4_*) and 1 of ($x_3_*) and 5 of ($x_2_*) and 7 of ($x_1_*))) or
            ((1 of ($x_6_*) and 1 of ($x_4_*) and 1 of ($x_3_*) and 6 of ($x_2_*) and 5 of ($x_1_*))) or
            ((1 of ($x_6_*) and 1 of ($x_4_*) and 1 of ($x_3_*) and 7 of ($x_2_*) and 3 of ($x_1_*))) or
            ((1 of ($x_6_*) and 1 of ($x_4_*) and 1 of ($x_3_*) and 8 of ($x_2_*) and 1 of ($x_1_*))) or
            ((1 of ($x_6_*) and 1 of ($x_4_*) and 1 of ($x_3_*) and 9 of ($x_2_*))) or
            ((1 of ($x_6_*) and 1 of ($x_4_*) and 2 of ($x_3_*) and 14 of ($x_1_*))) or
            ((1 of ($x_6_*) and 1 of ($x_4_*) and 2 of ($x_3_*) and 1 of ($x_2_*) and 12 of ($x_1_*))) or
            ((1 of ($x_6_*) and 1 of ($x_4_*) and 2 of ($x_3_*) and 2 of ($x_2_*) and 10 of ($x_1_*))) or
            ((1 of ($x_6_*) and 1 of ($x_4_*) and 2 of ($x_3_*) and 3 of ($x_2_*) and 8 of ($x_1_*))) or
            ((1 of ($x_6_*) and 1 of ($x_4_*) and 2 of ($x_3_*) and 4 of ($x_2_*) and 6 of ($x_1_*))) or
            ((1 of ($x_6_*) and 1 of ($x_4_*) and 2 of ($x_3_*) and 5 of ($x_2_*) and 4 of ($x_1_*))) or
            ((1 of ($x_6_*) and 1 of ($x_4_*) and 2 of ($x_3_*) and 6 of ($x_2_*) and 2 of ($x_1_*))) or
            ((1 of ($x_6_*) and 1 of ($x_4_*) and 2 of ($x_3_*) and 7 of ($x_2_*))) or
            ((1 of ($x_6_*) and 1 of ($x_4_*) and 3 of ($x_3_*) and 11 of ($x_1_*))) or
            ((1 of ($x_6_*) and 1 of ($x_4_*) and 3 of ($x_3_*) and 1 of ($x_2_*) and 9 of ($x_1_*))) or
            ((1 of ($x_6_*) and 1 of ($x_4_*) and 3 of ($x_3_*) and 2 of ($x_2_*) and 7 of ($x_1_*))) or
            ((1 of ($x_6_*) and 1 of ($x_4_*) and 3 of ($x_3_*) and 3 of ($x_2_*) and 5 of ($x_1_*))) or
            ((1 of ($x_6_*) and 1 of ($x_4_*) and 3 of ($x_3_*) and 4 of ($x_2_*) and 3 of ($x_1_*))) or
            ((1 of ($x_6_*) and 1 of ($x_4_*) and 3 of ($x_3_*) and 5 of ($x_2_*) and 1 of ($x_1_*))) or
            ((1 of ($x_6_*) and 1 of ($x_4_*) and 3 of ($x_3_*) and 6 of ($x_2_*))) or
            ((1 of ($x_6_*) and 1 of ($x_4_*) and 4 of ($x_3_*) and 8 of ($x_1_*))) or
            ((1 of ($x_6_*) and 1 of ($x_4_*) and 4 of ($x_3_*) and 1 of ($x_2_*) and 6 of ($x_1_*))) or
            ((1 of ($x_6_*) and 1 of ($x_4_*) and 4 of ($x_3_*) and 2 of ($x_2_*) and 4 of ($x_1_*))) or
            ((1 of ($x_6_*) and 1 of ($x_4_*) and 4 of ($x_3_*) and 3 of ($x_2_*) and 2 of ($x_1_*))) or
            ((1 of ($x_6_*) and 1 of ($x_4_*) and 4 of ($x_3_*) and 4 of ($x_2_*))) or
            ((1 of ($x_6_*) and 1 of ($x_4_*) and 5 of ($x_3_*) and 5 of ($x_1_*))) or
            ((1 of ($x_6_*) and 1 of ($x_4_*) and 5 of ($x_3_*) and 1 of ($x_2_*) and 3 of ($x_1_*))) or
            ((1 of ($x_6_*) and 1 of ($x_4_*) and 5 of ($x_3_*) and 2 of ($x_2_*) and 1 of ($x_1_*))) or
            ((1 of ($x_6_*) and 1 of ($x_4_*) and 5 of ($x_3_*) and 3 of ($x_2_*))) or
            ((1 of ($x_6_*) and 1 of ($x_4_*) and 6 of ($x_3_*) and 2 of ($x_1_*))) or
            ((1 of ($x_6_*) and 1 of ($x_4_*) and 6 of ($x_3_*) and 1 of ($x_2_*))) or
            ((1 of ($x_6_*) and 1 of ($x_4_*) and 7 of ($x_3_*))) or
            ((1 of ($x_6_*) and 2 of ($x_4_*) and 16 of ($x_1_*))) or
            ((1 of ($x_6_*) and 2 of ($x_4_*) and 1 of ($x_2_*) and 14 of ($x_1_*))) or
            ((1 of ($x_6_*) and 2 of ($x_4_*) and 2 of ($x_2_*) and 12 of ($x_1_*))) or
            ((1 of ($x_6_*) and 2 of ($x_4_*) and 3 of ($x_2_*) and 10 of ($x_1_*))) or
            ((1 of ($x_6_*) and 2 of ($x_4_*) and 4 of ($x_2_*) and 8 of ($x_1_*))) or
            ((1 of ($x_6_*) and 2 of ($x_4_*) and 5 of ($x_2_*) and 6 of ($x_1_*))) or
            ((1 of ($x_6_*) and 2 of ($x_4_*) and 6 of ($x_2_*) and 4 of ($x_1_*))) or
            ((1 of ($x_6_*) and 2 of ($x_4_*) and 7 of ($x_2_*) and 2 of ($x_1_*))) or
            ((1 of ($x_6_*) and 2 of ($x_4_*) and 8 of ($x_2_*))) or
            ((1 of ($x_6_*) and 2 of ($x_4_*) and 1 of ($x_3_*) and 13 of ($x_1_*))) or
            ((1 of ($x_6_*) and 2 of ($x_4_*) and 1 of ($x_3_*) and 1 of ($x_2_*) and 11 of ($x_1_*))) or
            ((1 of ($x_6_*) and 2 of ($x_4_*) and 1 of ($x_3_*) and 2 of ($x_2_*) and 9 of ($x_1_*))) or
            ((1 of ($x_6_*) and 2 of ($x_4_*) and 1 of ($x_3_*) and 3 of ($x_2_*) and 7 of ($x_1_*))) or
            ((1 of ($x_6_*) and 2 of ($x_4_*) and 1 of ($x_3_*) and 4 of ($x_2_*) and 5 of ($x_1_*))) or
            ((1 of ($x_6_*) and 2 of ($x_4_*) and 1 of ($x_3_*) and 5 of ($x_2_*) and 3 of ($x_1_*))) or
            ((1 of ($x_6_*) and 2 of ($x_4_*) and 1 of ($x_3_*) and 6 of ($x_2_*) and 1 of ($x_1_*))) or
            ((1 of ($x_6_*) and 2 of ($x_4_*) and 1 of ($x_3_*) and 7 of ($x_2_*))) or
            ((1 of ($x_6_*) and 2 of ($x_4_*) and 2 of ($x_3_*) and 10 of ($x_1_*))) or
            ((1 of ($x_6_*) and 2 of ($x_4_*) and 2 of ($x_3_*) and 1 of ($x_2_*) and 8 of ($x_1_*))) or
            ((1 of ($x_6_*) and 2 of ($x_4_*) and 2 of ($x_3_*) and 2 of ($x_2_*) and 6 of ($x_1_*))) or
            ((1 of ($x_6_*) and 2 of ($x_4_*) and 2 of ($x_3_*) and 3 of ($x_2_*) and 4 of ($x_1_*))) or
            ((1 of ($x_6_*) and 2 of ($x_4_*) and 2 of ($x_3_*) and 4 of ($x_2_*) and 2 of ($x_1_*))) or
            ((1 of ($x_6_*) and 2 of ($x_4_*) and 2 of ($x_3_*) and 5 of ($x_2_*))) or
            ((1 of ($x_6_*) and 2 of ($x_4_*) and 3 of ($x_3_*) and 7 of ($x_1_*))) or
            ((1 of ($x_6_*) and 2 of ($x_4_*) and 3 of ($x_3_*) and 1 of ($x_2_*) and 5 of ($x_1_*))) or
            ((1 of ($x_6_*) and 2 of ($x_4_*) and 3 of ($x_3_*) and 2 of ($x_2_*) and 3 of ($x_1_*))) or
            ((1 of ($x_6_*) and 2 of ($x_4_*) and 3 of ($x_3_*) and 3 of ($x_2_*) and 1 of ($x_1_*))) or
            ((1 of ($x_6_*) and 2 of ($x_4_*) and 3 of ($x_3_*) and 4 of ($x_2_*))) or
            ((1 of ($x_6_*) and 2 of ($x_4_*) and 4 of ($x_3_*) and 4 of ($x_1_*))) or
            ((1 of ($x_6_*) and 2 of ($x_4_*) and 4 of ($x_3_*) and 1 of ($x_2_*) and 2 of ($x_1_*))) or
            ((1 of ($x_6_*) and 2 of ($x_4_*) and 4 of ($x_3_*) and 2 of ($x_2_*))) or
            ((1 of ($x_6_*) and 2 of ($x_4_*) and 5 of ($x_3_*) and 1 of ($x_1_*))) or
            ((1 of ($x_6_*) and 2 of ($x_4_*) and 5 of ($x_3_*) and 1 of ($x_2_*))) or
            ((1 of ($x_6_*) and 2 of ($x_4_*) and 6 of ($x_3_*))) or
            ((1 of ($x_6_*) and 3 of ($x_4_*) and 12 of ($x_1_*))) or
            ((1 of ($x_6_*) and 3 of ($x_4_*) and 1 of ($x_2_*) and 10 of ($x_1_*))) or
            ((1 of ($x_6_*) and 3 of ($x_4_*) and 2 of ($x_2_*) and 8 of ($x_1_*))) or
            ((1 of ($x_6_*) and 3 of ($x_4_*) and 3 of ($x_2_*) and 6 of ($x_1_*))) or
            ((1 of ($x_6_*) and 3 of ($x_4_*) and 4 of ($x_2_*) and 4 of ($x_1_*))) or
            ((1 of ($x_6_*) and 3 of ($x_4_*) and 5 of ($x_2_*) and 2 of ($x_1_*))) or
            ((1 of ($x_6_*) and 3 of ($x_4_*) and 6 of ($x_2_*))) or
            ((1 of ($x_6_*) and 3 of ($x_4_*) and 1 of ($x_3_*) and 9 of ($x_1_*))) or
            ((1 of ($x_6_*) and 3 of ($x_4_*) and 1 of ($x_3_*) and 1 of ($x_2_*) and 7 of ($x_1_*))) or
            ((1 of ($x_6_*) and 3 of ($x_4_*) and 1 of ($x_3_*) and 2 of ($x_2_*) and 5 of ($x_1_*))) or
            ((1 of ($x_6_*) and 3 of ($x_4_*) and 1 of ($x_3_*) and 3 of ($x_2_*) and 3 of ($x_1_*))) or
            ((1 of ($x_6_*) and 3 of ($x_4_*) and 1 of ($x_3_*) and 4 of ($x_2_*) and 1 of ($x_1_*))) or
            ((1 of ($x_6_*) and 3 of ($x_4_*) and 1 of ($x_3_*) and 5 of ($x_2_*))) or
            ((1 of ($x_6_*) and 3 of ($x_4_*) and 2 of ($x_3_*) and 6 of ($x_1_*))) or
            ((1 of ($x_6_*) and 3 of ($x_4_*) and 2 of ($x_3_*) and 1 of ($x_2_*) and 4 of ($x_1_*))) or
            ((1 of ($x_6_*) and 3 of ($x_4_*) and 2 of ($x_3_*) and 2 of ($x_2_*) and 2 of ($x_1_*))) or
            ((1 of ($x_6_*) and 3 of ($x_4_*) and 2 of ($x_3_*) and 3 of ($x_2_*))) or
            ((1 of ($x_6_*) and 3 of ($x_4_*) and 3 of ($x_3_*) and 3 of ($x_1_*))) or
            ((1 of ($x_6_*) and 3 of ($x_4_*) and 3 of ($x_3_*) and 1 of ($x_2_*) and 1 of ($x_1_*))) or
            ((1 of ($x_6_*) and 3 of ($x_4_*) and 3 of ($x_3_*) and 2 of ($x_2_*))) or
            ((1 of ($x_6_*) and 3 of ($x_4_*) and 4 of ($x_3_*))) or
            ((1 of ($x_6_*) and 4 of ($x_4_*) and 8 of ($x_1_*))) or
            ((1 of ($x_6_*) and 4 of ($x_4_*) and 1 of ($x_2_*) and 6 of ($x_1_*))) or
            ((1 of ($x_6_*) and 4 of ($x_4_*) and 2 of ($x_2_*) and 4 of ($x_1_*))) or
            ((1 of ($x_6_*) and 4 of ($x_4_*) and 3 of ($x_2_*) and 2 of ($x_1_*))) or
            ((1 of ($x_6_*) and 4 of ($x_4_*) and 4 of ($x_2_*))) or
            ((1 of ($x_6_*) and 4 of ($x_4_*) and 1 of ($x_3_*) and 5 of ($x_1_*))) or
            ((1 of ($x_6_*) and 4 of ($x_4_*) and 1 of ($x_3_*) and 1 of ($x_2_*) and 3 of ($x_1_*))) or
            ((1 of ($x_6_*) and 4 of ($x_4_*) and 1 of ($x_3_*) and 2 of ($x_2_*) and 1 of ($x_1_*))) or
            ((1 of ($x_6_*) and 4 of ($x_4_*) and 1 of ($x_3_*) and 3 of ($x_2_*))) or
            ((1 of ($x_6_*) and 4 of ($x_4_*) and 2 of ($x_3_*) and 2 of ($x_1_*))) or
            ((1 of ($x_6_*) and 4 of ($x_4_*) and 2 of ($x_3_*) and 1 of ($x_2_*))) or
            ((1 of ($x_6_*) and 4 of ($x_4_*) and 3 of ($x_3_*))) or
            ((1 of ($x_6_*) and 5 of ($x_4_*) and 4 of ($x_1_*))) or
            ((1 of ($x_6_*) and 5 of ($x_4_*) and 1 of ($x_2_*) and 2 of ($x_1_*))) or
            ((1 of ($x_6_*) and 5 of ($x_4_*) and 2 of ($x_2_*))) or
            ((1 of ($x_6_*) and 5 of ($x_4_*) and 1 of ($x_3_*) and 1 of ($x_1_*))) or
            ((1 of ($x_6_*) and 5 of ($x_4_*) and 1 of ($x_3_*) and 1 of ($x_2_*))) or
            ((1 of ($x_6_*) and 5 of ($x_4_*) and 2 of ($x_3_*))) or
            ((1 of ($x_6_*) and 6 of ($x_4_*))) or
            ((1 of ($x_6_*) and 1 of ($x_5_*) and 19 of ($x_1_*))) or
            ((1 of ($x_6_*) and 1 of ($x_5_*) and 1 of ($x_2_*) and 17 of ($x_1_*))) or
            ((1 of ($x_6_*) and 1 of ($x_5_*) and 2 of ($x_2_*) and 15 of ($x_1_*))) or
            ((1 of ($x_6_*) and 1 of ($x_5_*) and 3 of ($x_2_*) and 13 of ($x_1_*))) or
            ((1 of ($x_6_*) and 1 of ($x_5_*) and 4 of ($x_2_*) and 11 of ($x_1_*))) or
            ((1 of ($x_6_*) and 1 of ($x_5_*) and 5 of ($x_2_*) and 9 of ($x_1_*))) or
            ((1 of ($x_6_*) and 1 of ($x_5_*) and 6 of ($x_2_*) and 7 of ($x_1_*))) or
            ((1 of ($x_6_*) and 1 of ($x_5_*) and 7 of ($x_2_*) and 5 of ($x_1_*))) or
            ((1 of ($x_6_*) and 1 of ($x_5_*) and 8 of ($x_2_*) and 3 of ($x_1_*))) or
            ((1 of ($x_6_*) and 1 of ($x_5_*) and 9 of ($x_2_*) and 1 of ($x_1_*))) or
            ((1 of ($x_6_*) and 1 of ($x_5_*) and 10 of ($x_2_*))) or
            ((1 of ($x_6_*) and 1 of ($x_5_*) and 1 of ($x_3_*) and 16 of ($x_1_*))) or
            ((1 of ($x_6_*) and 1 of ($x_5_*) and 1 of ($x_3_*) and 1 of ($x_2_*) and 14 of ($x_1_*))) or
            ((1 of ($x_6_*) and 1 of ($x_5_*) and 1 of ($x_3_*) and 2 of ($x_2_*) and 12 of ($x_1_*))) or
            ((1 of ($x_6_*) and 1 of ($x_5_*) and 1 of ($x_3_*) and 3 of ($x_2_*) and 10 of ($x_1_*))) or
            ((1 of ($x_6_*) and 1 of ($x_5_*) and 1 of ($x_3_*) and 4 of ($x_2_*) and 8 of ($x_1_*))) or
            ((1 of ($x_6_*) and 1 of ($x_5_*) and 1 of ($x_3_*) and 5 of ($x_2_*) and 6 of ($x_1_*))) or
            ((1 of ($x_6_*) and 1 of ($x_5_*) and 1 of ($x_3_*) and 6 of ($x_2_*) and 4 of ($x_1_*))) or
            ((1 of ($x_6_*) and 1 of ($x_5_*) and 1 of ($x_3_*) and 7 of ($x_2_*) and 2 of ($x_1_*))) or
            ((1 of ($x_6_*) and 1 of ($x_5_*) and 1 of ($x_3_*) and 8 of ($x_2_*))) or
            ((1 of ($x_6_*) and 1 of ($x_5_*) and 2 of ($x_3_*) and 13 of ($x_1_*))) or
            ((1 of ($x_6_*) and 1 of ($x_5_*) and 2 of ($x_3_*) and 1 of ($x_2_*) and 11 of ($x_1_*))) or
            ((1 of ($x_6_*) and 1 of ($x_5_*) and 2 of ($x_3_*) and 2 of ($x_2_*) and 9 of ($x_1_*))) or
            ((1 of ($x_6_*) and 1 of ($x_5_*) and 2 of ($x_3_*) and 3 of ($x_2_*) and 7 of ($x_1_*))) or
            ((1 of ($x_6_*) and 1 of ($x_5_*) and 2 of ($x_3_*) and 4 of ($x_2_*) and 5 of ($x_1_*))) or
            ((1 of ($x_6_*) and 1 of ($x_5_*) and 2 of ($x_3_*) and 5 of ($x_2_*) and 3 of ($x_1_*))) or
            ((1 of ($x_6_*) and 1 of ($x_5_*) and 2 of ($x_3_*) and 6 of ($x_2_*) and 1 of ($x_1_*))) or
            ((1 of ($x_6_*) and 1 of ($x_5_*) and 2 of ($x_3_*) and 7 of ($x_2_*))) or
            ((1 of ($x_6_*) and 1 of ($x_5_*) and 3 of ($x_3_*) and 10 of ($x_1_*))) or
            ((1 of ($x_6_*) and 1 of ($x_5_*) and 3 of ($x_3_*) and 1 of ($x_2_*) and 8 of ($x_1_*))) or
            ((1 of ($x_6_*) and 1 of ($x_5_*) and 3 of ($x_3_*) and 2 of ($x_2_*) and 6 of ($x_1_*))) or
            ((1 of ($x_6_*) and 1 of ($x_5_*) and 3 of ($x_3_*) and 3 of ($x_2_*) and 4 of ($x_1_*))) or
            ((1 of ($x_6_*) and 1 of ($x_5_*) and 3 of ($x_3_*) and 4 of ($x_2_*) and 2 of ($x_1_*))) or
            ((1 of ($x_6_*) and 1 of ($x_5_*) and 3 of ($x_3_*) and 5 of ($x_2_*))) or
            ((1 of ($x_6_*) and 1 of ($x_5_*) and 4 of ($x_3_*) and 7 of ($x_1_*))) or
            ((1 of ($x_6_*) and 1 of ($x_5_*) and 4 of ($x_3_*) and 1 of ($x_2_*) and 5 of ($x_1_*))) or
            ((1 of ($x_6_*) and 1 of ($x_5_*) and 4 of ($x_3_*) and 2 of ($x_2_*) and 3 of ($x_1_*))) or
            ((1 of ($x_6_*) and 1 of ($x_5_*) and 4 of ($x_3_*) and 3 of ($x_2_*) and 1 of ($x_1_*))) or
            ((1 of ($x_6_*) and 1 of ($x_5_*) and 4 of ($x_3_*) and 4 of ($x_2_*))) or
            ((1 of ($x_6_*) and 1 of ($x_5_*) and 5 of ($x_3_*) and 4 of ($x_1_*))) or
            ((1 of ($x_6_*) and 1 of ($x_5_*) and 5 of ($x_3_*) and 1 of ($x_2_*) and 2 of ($x_1_*))) or
            ((1 of ($x_6_*) and 1 of ($x_5_*) and 5 of ($x_3_*) and 2 of ($x_2_*))) or
            ((1 of ($x_6_*) and 1 of ($x_5_*) and 6 of ($x_3_*) and 1 of ($x_1_*))) or
            ((1 of ($x_6_*) and 1 of ($x_5_*) and 6 of ($x_3_*) and 1 of ($x_2_*))) or
            ((1 of ($x_6_*) and 1 of ($x_5_*) and 7 of ($x_3_*))) or
            ((1 of ($x_6_*) and 1 of ($x_5_*) and 1 of ($x_4_*) and 15 of ($x_1_*))) or
            ((1 of ($x_6_*) and 1 of ($x_5_*) and 1 of ($x_4_*) and 1 of ($x_2_*) and 13 of ($x_1_*))) or
            ((1 of ($x_6_*) and 1 of ($x_5_*) and 1 of ($x_4_*) and 2 of ($x_2_*) and 11 of ($x_1_*))) or
            ((1 of ($x_6_*) and 1 of ($x_5_*) and 1 of ($x_4_*) and 3 of ($x_2_*) and 9 of ($x_1_*))) or
            ((1 of ($x_6_*) and 1 of ($x_5_*) and 1 of ($x_4_*) and 4 of ($x_2_*) and 7 of ($x_1_*))) or
            ((1 of ($x_6_*) and 1 of ($x_5_*) and 1 of ($x_4_*) and 5 of ($x_2_*) and 5 of ($x_1_*))) or
            ((1 of ($x_6_*) and 1 of ($x_5_*) and 1 of ($x_4_*) and 6 of ($x_2_*) and 3 of ($x_1_*))) or
            ((1 of ($x_6_*) and 1 of ($x_5_*) and 1 of ($x_4_*) and 7 of ($x_2_*) and 1 of ($x_1_*))) or
            ((1 of ($x_6_*) and 1 of ($x_5_*) and 1 of ($x_4_*) and 8 of ($x_2_*))) or
            ((1 of ($x_6_*) and 1 of ($x_5_*) and 1 of ($x_4_*) and 1 of ($x_3_*) and 12 of ($x_1_*))) or
            ((1 of ($x_6_*) and 1 of ($x_5_*) and 1 of ($x_4_*) and 1 of ($x_3_*) and 1 of ($x_2_*) and 10 of ($x_1_*))) or
            ((1 of ($x_6_*) and 1 of ($x_5_*) and 1 of ($x_4_*) and 1 of ($x_3_*) and 2 of ($x_2_*) and 8 of ($x_1_*))) or
            ((1 of ($x_6_*) and 1 of ($x_5_*) and 1 of ($x_4_*) and 1 of ($x_3_*) and 3 of ($x_2_*) and 6 of ($x_1_*))) or
            ((1 of ($x_6_*) and 1 of ($x_5_*) and 1 of ($x_4_*) and 1 of ($x_3_*) and 4 of ($x_2_*) and 4 of ($x_1_*))) or
            ((1 of ($x_6_*) and 1 of ($x_5_*) and 1 of ($x_4_*) and 1 of ($x_3_*) and 5 of ($x_2_*) and 2 of ($x_1_*))) or
            ((1 of ($x_6_*) and 1 of ($x_5_*) and 1 of ($x_4_*) and 1 of ($x_3_*) and 6 of ($x_2_*))) or
            ((1 of ($x_6_*) and 1 of ($x_5_*) and 1 of ($x_4_*) and 2 of ($x_3_*) and 9 of ($x_1_*))) or
            ((1 of ($x_6_*) and 1 of ($x_5_*) and 1 of ($x_4_*) and 2 of ($x_3_*) and 1 of ($x_2_*) and 7 of ($x_1_*))) or
            ((1 of ($x_6_*) and 1 of ($x_5_*) and 1 of ($x_4_*) and 2 of ($x_3_*) and 2 of ($x_2_*) and 5 of ($x_1_*))) or
            ((1 of ($x_6_*) and 1 of ($x_5_*) and 1 of ($x_4_*) and 2 of ($x_3_*) and 3 of ($x_2_*) and 3 of ($x_1_*))) or
            ((1 of ($x_6_*) and 1 of ($x_5_*) and 1 of ($x_4_*) and 2 of ($x_3_*) and 4 of ($x_2_*) and 1 of ($x_1_*))) or
            ((1 of ($x_6_*) and 1 of ($x_5_*) and 1 of ($x_4_*) and 2 of ($x_3_*) and 5 of ($x_2_*))) or
            ((1 of ($x_6_*) and 1 of ($x_5_*) and 1 of ($x_4_*) and 3 of ($x_3_*) and 6 of ($x_1_*))) or
            ((1 of ($x_6_*) and 1 of ($x_5_*) and 1 of ($x_4_*) and 3 of ($x_3_*) and 1 of ($x_2_*) and 4 of ($x_1_*))) or
            ((1 of ($x_6_*) and 1 of ($x_5_*) and 1 of ($x_4_*) and 3 of ($x_3_*) and 2 of ($x_2_*) and 2 of ($x_1_*))) or
            ((1 of ($x_6_*) and 1 of ($x_5_*) and 1 of ($x_4_*) and 3 of ($x_3_*) and 3 of ($x_2_*))) or
            ((1 of ($x_6_*) and 1 of ($x_5_*) and 1 of ($x_4_*) and 4 of ($x_3_*) and 3 of ($x_1_*))) or
            ((1 of ($x_6_*) and 1 of ($x_5_*) and 1 of ($x_4_*) and 4 of ($x_3_*) and 1 of ($x_2_*) and 1 of ($x_1_*))) or
            ((1 of ($x_6_*) and 1 of ($x_5_*) and 1 of ($x_4_*) and 4 of ($x_3_*) and 2 of ($x_2_*))) or
            ((1 of ($x_6_*) and 1 of ($x_5_*) and 1 of ($x_4_*) and 5 of ($x_3_*))) or
            ((1 of ($x_6_*) and 1 of ($x_5_*) and 2 of ($x_4_*) and 11 of ($x_1_*))) or
            ((1 of ($x_6_*) and 1 of ($x_5_*) and 2 of ($x_4_*) and 1 of ($x_2_*) and 9 of ($x_1_*))) or
            ((1 of ($x_6_*) and 1 of ($x_5_*) and 2 of ($x_4_*) and 2 of ($x_2_*) and 7 of ($x_1_*))) or
            ((1 of ($x_6_*) and 1 of ($x_5_*) and 2 of ($x_4_*) and 3 of ($x_2_*) and 5 of ($x_1_*))) or
            ((1 of ($x_6_*) and 1 of ($x_5_*) and 2 of ($x_4_*) and 4 of ($x_2_*) and 3 of ($x_1_*))) or
            ((1 of ($x_6_*) and 1 of ($x_5_*) and 2 of ($x_4_*) and 5 of ($x_2_*) and 1 of ($x_1_*))) or
            ((1 of ($x_6_*) and 1 of ($x_5_*) and 2 of ($x_4_*) and 6 of ($x_2_*))) or
            ((1 of ($x_6_*) and 1 of ($x_5_*) and 2 of ($x_4_*) and 1 of ($x_3_*) and 8 of ($x_1_*))) or
            ((1 of ($x_6_*) and 1 of ($x_5_*) and 2 of ($x_4_*) and 1 of ($x_3_*) and 1 of ($x_2_*) and 6 of ($x_1_*))) or
            ((1 of ($x_6_*) and 1 of ($x_5_*) and 2 of ($x_4_*) and 1 of ($x_3_*) and 2 of ($x_2_*) and 4 of ($x_1_*))) or
            ((1 of ($x_6_*) and 1 of ($x_5_*) and 2 of ($x_4_*) and 1 of ($x_3_*) and 3 of ($x_2_*) and 2 of ($x_1_*))) or
            ((1 of ($x_6_*) and 1 of ($x_5_*) and 2 of ($x_4_*) and 1 of ($x_3_*) and 4 of ($x_2_*))) or
            ((1 of ($x_6_*) and 1 of ($x_5_*) and 2 of ($x_4_*) and 2 of ($x_3_*) and 5 of ($x_1_*))) or
            ((1 of ($x_6_*) and 1 of ($x_5_*) and 2 of ($x_4_*) and 2 of ($x_3_*) and 1 of ($x_2_*) and 3 of ($x_1_*))) or
            ((1 of ($x_6_*) and 1 of ($x_5_*) and 2 of ($x_4_*) and 2 of ($x_3_*) and 2 of ($x_2_*) and 1 of ($x_1_*))) or
            ((1 of ($x_6_*) and 1 of ($x_5_*) and 2 of ($x_4_*) and 2 of ($x_3_*) and 3 of ($x_2_*))) or
            ((1 of ($x_6_*) and 1 of ($x_5_*) and 2 of ($x_4_*) and 3 of ($x_3_*) and 2 of ($x_1_*))) or
            ((1 of ($x_6_*) and 1 of ($x_5_*) and 2 of ($x_4_*) and 3 of ($x_3_*) and 1 of ($x_2_*))) or
            ((1 of ($x_6_*) and 1 of ($x_5_*) and 2 of ($x_4_*) and 4 of ($x_3_*))) or
            ((1 of ($x_6_*) and 1 of ($x_5_*) and 3 of ($x_4_*) and 7 of ($x_1_*))) or
            ((1 of ($x_6_*) and 1 of ($x_5_*) and 3 of ($x_4_*) and 1 of ($x_2_*) and 5 of ($x_1_*))) or
            ((1 of ($x_6_*) and 1 of ($x_5_*) and 3 of ($x_4_*) and 2 of ($x_2_*) and 3 of ($x_1_*))) or
            ((1 of ($x_6_*) and 1 of ($x_5_*) and 3 of ($x_4_*) and 3 of ($x_2_*) and 1 of ($x_1_*))) or
            ((1 of ($x_6_*) and 1 of ($x_5_*) and 3 of ($x_4_*) and 4 of ($x_2_*))) or
            ((1 of ($x_6_*) and 1 of ($x_5_*) and 3 of ($x_4_*) and 1 of ($x_3_*) and 4 of ($x_1_*))) or
            ((1 of ($x_6_*) and 1 of ($x_5_*) and 3 of ($x_4_*) and 1 of ($x_3_*) and 1 of ($x_2_*) and 2 of ($x_1_*))) or
            ((1 of ($x_6_*) and 1 of ($x_5_*) and 3 of ($x_4_*) and 1 of ($x_3_*) and 2 of ($x_2_*))) or
            ((1 of ($x_6_*) and 1 of ($x_5_*) and 3 of ($x_4_*) and 2 of ($x_3_*) and 1 of ($x_1_*))) or
            ((1 of ($x_6_*) and 1 of ($x_5_*) and 3 of ($x_4_*) and 2 of ($x_3_*) and 1 of ($x_2_*))) or
            ((1 of ($x_6_*) and 1 of ($x_5_*) and 3 of ($x_4_*) and 3 of ($x_3_*))) or
            ((1 of ($x_6_*) and 1 of ($x_5_*) and 4 of ($x_4_*) and 3 of ($x_1_*))) or
            ((1 of ($x_6_*) and 1 of ($x_5_*) and 4 of ($x_4_*) and 1 of ($x_2_*) and 1 of ($x_1_*))) or
            ((1 of ($x_6_*) and 1 of ($x_5_*) and 4 of ($x_4_*) and 2 of ($x_2_*))) or
            ((1 of ($x_6_*) and 1 of ($x_5_*) and 4 of ($x_4_*) and 1 of ($x_3_*))) or
            ((1 of ($x_6_*) and 1 of ($x_5_*) and 5 of ($x_4_*))) or
            ((1 of ($x_6_*) and 2 of ($x_5_*) and 14 of ($x_1_*))) or
            ((1 of ($x_6_*) and 2 of ($x_5_*) and 1 of ($x_2_*) and 12 of ($x_1_*))) or
            ((1 of ($x_6_*) and 2 of ($x_5_*) and 2 of ($x_2_*) and 10 of ($x_1_*))) or
            ((1 of ($x_6_*) and 2 of ($x_5_*) and 3 of ($x_2_*) and 8 of ($x_1_*))) or
            ((1 of ($x_6_*) and 2 of ($x_5_*) and 4 of ($x_2_*) and 6 of ($x_1_*))) or
            ((1 of ($x_6_*) and 2 of ($x_5_*) and 5 of ($x_2_*) and 4 of ($x_1_*))) or
            ((1 of ($x_6_*) and 2 of ($x_5_*) and 6 of ($x_2_*) and 2 of ($x_1_*))) or
            ((1 of ($x_6_*) and 2 of ($x_5_*) and 7 of ($x_2_*))) or
            ((1 of ($x_6_*) and 2 of ($x_5_*) and 1 of ($x_3_*) and 11 of ($x_1_*))) or
            ((1 of ($x_6_*) and 2 of ($x_5_*) and 1 of ($x_3_*) and 1 of ($x_2_*) and 9 of ($x_1_*))) or
            ((1 of ($x_6_*) and 2 of ($x_5_*) and 1 of ($x_3_*) and 2 of ($x_2_*) and 7 of ($x_1_*))) or
            ((1 of ($x_6_*) and 2 of ($x_5_*) and 1 of ($x_3_*) and 3 of ($x_2_*) and 5 of ($x_1_*))) or
            ((1 of ($x_6_*) and 2 of ($x_5_*) and 1 of ($x_3_*) and 4 of ($x_2_*) and 3 of ($x_1_*))) or
            ((1 of ($x_6_*) and 2 of ($x_5_*) and 1 of ($x_3_*) and 5 of ($x_2_*) and 1 of ($x_1_*))) or
            ((1 of ($x_6_*) and 2 of ($x_5_*) and 1 of ($x_3_*) and 6 of ($x_2_*))) or
            ((1 of ($x_6_*) and 2 of ($x_5_*) and 2 of ($x_3_*) and 8 of ($x_1_*))) or
            ((1 of ($x_6_*) and 2 of ($x_5_*) and 2 of ($x_3_*) and 1 of ($x_2_*) and 6 of ($x_1_*))) or
            ((1 of ($x_6_*) and 2 of ($x_5_*) and 2 of ($x_3_*) and 2 of ($x_2_*) and 4 of ($x_1_*))) or
            ((1 of ($x_6_*) and 2 of ($x_5_*) and 2 of ($x_3_*) and 3 of ($x_2_*) and 2 of ($x_1_*))) or
            ((1 of ($x_6_*) and 2 of ($x_5_*) and 2 of ($x_3_*) and 4 of ($x_2_*))) or
            ((1 of ($x_6_*) and 2 of ($x_5_*) and 3 of ($x_3_*) and 5 of ($x_1_*))) or
            ((1 of ($x_6_*) and 2 of ($x_5_*) and 3 of ($x_3_*) and 1 of ($x_2_*) and 3 of ($x_1_*))) or
            ((1 of ($x_6_*) and 2 of ($x_5_*) and 3 of ($x_3_*) and 2 of ($x_2_*) and 1 of ($x_1_*))) or
            ((1 of ($x_6_*) and 2 of ($x_5_*) and 3 of ($x_3_*) and 3 of ($x_2_*))) or
            ((1 of ($x_6_*) and 2 of ($x_5_*) and 4 of ($x_3_*) and 2 of ($x_1_*))) or
            ((1 of ($x_6_*) and 2 of ($x_5_*) and 4 of ($x_3_*) and 1 of ($x_2_*))) or
            ((1 of ($x_6_*) and 2 of ($x_5_*) and 5 of ($x_3_*))) or
            ((1 of ($x_6_*) and 2 of ($x_5_*) and 1 of ($x_4_*) and 10 of ($x_1_*))) or
            ((1 of ($x_6_*) and 2 of ($x_5_*) and 1 of ($x_4_*) and 1 of ($x_2_*) and 8 of ($x_1_*))) or
            ((1 of ($x_6_*) and 2 of ($x_5_*) and 1 of ($x_4_*) and 2 of ($x_2_*) and 6 of ($x_1_*))) or
            ((1 of ($x_6_*) and 2 of ($x_5_*) and 1 of ($x_4_*) and 3 of ($x_2_*) and 4 of ($x_1_*))) or
            ((1 of ($x_6_*) and 2 of ($x_5_*) and 1 of ($x_4_*) and 4 of ($x_2_*) and 2 of ($x_1_*))) or
            ((1 of ($x_6_*) and 2 of ($x_5_*) and 1 of ($x_4_*) and 5 of ($x_2_*))) or
            ((1 of ($x_6_*) and 2 of ($x_5_*) and 1 of ($x_4_*) and 1 of ($x_3_*) and 7 of ($x_1_*))) or
            ((1 of ($x_6_*) and 2 of ($x_5_*) and 1 of ($x_4_*) and 1 of ($x_3_*) and 1 of ($x_2_*) and 5 of ($x_1_*))) or
            ((1 of ($x_6_*) and 2 of ($x_5_*) and 1 of ($x_4_*) and 1 of ($x_3_*) and 2 of ($x_2_*) and 3 of ($x_1_*))) or
            ((1 of ($x_6_*) and 2 of ($x_5_*) and 1 of ($x_4_*) and 1 of ($x_3_*) and 3 of ($x_2_*) and 1 of ($x_1_*))) or
            ((1 of ($x_6_*) and 2 of ($x_5_*) and 1 of ($x_4_*) and 1 of ($x_3_*) and 4 of ($x_2_*))) or
            ((1 of ($x_6_*) and 2 of ($x_5_*) and 1 of ($x_4_*) and 2 of ($x_3_*) and 4 of ($x_1_*))) or
            ((1 of ($x_6_*) and 2 of ($x_5_*) and 1 of ($x_4_*) and 2 of ($x_3_*) and 1 of ($x_2_*) and 2 of ($x_1_*))) or
            ((1 of ($x_6_*) and 2 of ($x_5_*) and 1 of ($x_4_*) and 2 of ($x_3_*) and 2 of ($x_2_*))) or
            ((1 of ($x_6_*) and 2 of ($x_5_*) and 1 of ($x_4_*) and 3 of ($x_3_*) and 1 of ($x_1_*))) or
            ((1 of ($x_6_*) and 2 of ($x_5_*) and 1 of ($x_4_*) and 3 of ($x_3_*) and 1 of ($x_2_*))) or
            ((1 of ($x_6_*) and 2 of ($x_5_*) and 1 of ($x_4_*) and 4 of ($x_3_*))) or
            ((1 of ($x_6_*) and 2 of ($x_5_*) and 2 of ($x_4_*) and 6 of ($x_1_*))) or
            ((1 of ($x_6_*) and 2 of ($x_5_*) and 2 of ($x_4_*) and 1 of ($x_2_*) and 4 of ($x_1_*))) or
            ((1 of ($x_6_*) and 2 of ($x_5_*) and 2 of ($x_4_*) and 2 of ($x_2_*) and 2 of ($x_1_*))) or
            ((1 of ($x_6_*) and 2 of ($x_5_*) and 2 of ($x_4_*) and 3 of ($x_2_*))) or
            ((1 of ($x_6_*) and 2 of ($x_5_*) and 2 of ($x_4_*) and 1 of ($x_3_*) and 3 of ($x_1_*))) or
            ((1 of ($x_6_*) and 2 of ($x_5_*) and 2 of ($x_4_*) and 1 of ($x_3_*) and 1 of ($x_2_*) and 1 of ($x_1_*))) or
            ((1 of ($x_6_*) and 2 of ($x_5_*) and 2 of ($x_4_*) and 1 of ($x_3_*) and 2 of ($x_2_*))) or
            ((1 of ($x_6_*) and 2 of ($x_5_*) and 2 of ($x_4_*) and 2 of ($x_3_*))) or
            ((1 of ($x_6_*) and 2 of ($x_5_*) and 3 of ($x_4_*) and 2 of ($x_1_*))) or
            ((1 of ($x_6_*) and 2 of ($x_5_*) and 3 of ($x_4_*) and 1 of ($x_2_*))) or
            ((1 of ($x_6_*) and 2 of ($x_5_*) and 3 of ($x_4_*) and 1 of ($x_3_*))) or
            ((1 of ($x_6_*) and 2 of ($x_5_*) and 4 of ($x_4_*))) or
            ((1 of ($x_6_*) and 3 of ($x_5_*) and 9 of ($x_1_*))) or
            ((1 of ($x_6_*) and 3 of ($x_5_*) and 1 of ($x_2_*) and 7 of ($x_1_*))) or
            ((1 of ($x_6_*) and 3 of ($x_5_*) and 2 of ($x_2_*) and 5 of ($x_1_*))) or
            ((1 of ($x_6_*) and 3 of ($x_5_*) and 3 of ($x_2_*) and 3 of ($x_1_*))) or
            ((1 of ($x_6_*) and 3 of ($x_5_*) and 4 of ($x_2_*) and 1 of ($x_1_*))) or
            ((1 of ($x_6_*) and 3 of ($x_5_*) and 5 of ($x_2_*))) or
            ((1 of ($x_6_*) and 3 of ($x_5_*) and 1 of ($x_3_*) and 6 of ($x_1_*))) or
            ((1 of ($x_6_*) and 3 of ($x_5_*) and 1 of ($x_3_*) and 1 of ($x_2_*) and 4 of ($x_1_*))) or
            ((1 of ($x_6_*) and 3 of ($x_5_*) and 1 of ($x_3_*) and 2 of ($x_2_*) and 2 of ($x_1_*))) or
            ((1 of ($x_6_*) and 3 of ($x_5_*) and 1 of ($x_3_*) and 3 of ($x_2_*))) or
            ((1 of ($x_6_*) and 3 of ($x_5_*) and 2 of ($x_3_*) and 3 of ($x_1_*))) or
            ((1 of ($x_6_*) and 3 of ($x_5_*) and 2 of ($x_3_*) and 1 of ($x_2_*) and 1 of ($x_1_*))) or
            ((1 of ($x_6_*) and 3 of ($x_5_*) and 2 of ($x_3_*) and 2 of ($x_2_*))) or
            ((1 of ($x_6_*) and 3 of ($x_5_*) and 3 of ($x_3_*))) or
            ((1 of ($x_6_*) and 3 of ($x_5_*) and 1 of ($x_4_*) and 5 of ($x_1_*))) or
            ((1 of ($x_6_*) and 3 of ($x_5_*) and 1 of ($x_4_*) and 1 of ($x_2_*) and 3 of ($x_1_*))) or
            ((1 of ($x_6_*) and 3 of ($x_5_*) and 1 of ($x_4_*) and 2 of ($x_2_*) and 1 of ($x_1_*))) or
            ((1 of ($x_6_*) and 3 of ($x_5_*) and 1 of ($x_4_*) and 3 of ($x_2_*))) or
            ((1 of ($x_6_*) and 3 of ($x_5_*) and 1 of ($x_4_*) and 1 of ($x_3_*) and 2 of ($x_1_*))) or
            ((1 of ($x_6_*) and 3 of ($x_5_*) and 1 of ($x_4_*) and 1 of ($x_3_*) and 1 of ($x_2_*))) or
            ((1 of ($x_6_*) and 3 of ($x_5_*) and 1 of ($x_4_*) and 2 of ($x_3_*))) or
            ((1 of ($x_6_*) and 3 of ($x_5_*) and 2 of ($x_4_*) and 1 of ($x_1_*))) or
            ((1 of ($x_6_*) and 3 of ($x_5_*) and 2 of ($x_4_*) and 1 of ($x_2_*))) or
            ((1 of ($x_6_*) and 3 of ($x_5_*) and 2 of ($x_4_*) and 1 of ($x_3_*))) or
            ((1 of ($x_6_*) and 3 of ($x_5_*) and 3 of ($x_4_*))) or
            ((1 of ($x_6_*) and 4 of ($x_5_*) and 4 of ($x_1_*))) or
            ((1 of ($x_6_*) and 4 of ($x_5_*) and 1 of ($x_2_*) and 2 of ($x_1_*))) or
            ((1 of ($x_6_*) and 4 of ($x_5_*) and 2 of ($x_2_*))) or
            ((1 of ($x_6_*) and 4 of ($x_5_*) and 1 of ($x_3_*) and 1 of ($x_1_*))) or
            ((1 of ($x_6_*) and 4 of ($x_5_*) and 1 of ($x_3_*) and 1 of ($x_2_*))) or
            ((1 of ($x_6_*) and 4 of ($x_5_*) and 2 of ($x_3_*))) or
            ((1 of ($x_6_*) and 4 of ($x_5_*) and 1 of ($x_4_*))) or
            ((1 of ($x_6_*) and 5 of ($x_5_*))) or
            ((2 of ($x_6_*) and 18 of ($x_1_*))) or
            ((2 of ($x_6_*) and 1 of ($x_2_*) and 16 of ($x_1_*))) or
            ((2 of ($x_6_*) and 2 of ($x_2_*) and 14 of ($x_1_*))) or
            ((2 of ($x_6_*) and 3 of ($x_2_*) and 12 of ($x_1_*))) or
            ((2 of ($x_6_*) and 4 of ($x_2_*) and 10 of ($x_1_*))) or
            ((2 of ($x_6_*) and 5 of ($x_2_*) and 8 of ($x_1_*))) or
            ((2 of ($x_6_*) and 6 of ($x_2_*) and 6 of ($x_1_*))) or
            ((2 of ($x_6_*) and 7 of ($x_2_*) and 4 of ($x_1_*))) or
            ((2 of ($x_6_*) and 8 of ($x_2_*) and 2 of ($x_1_*))) or
            ((2 of ($x_6_*) and 9 of ($x_2_*))) or
            ((2 of ($x_6_*) and 1 of ($x_3_*) and 15 of ($x_1_*))) or
            ((2 of ($x_6_*) and 1 of ($x_3_*) and 1 of ($x_2_*) and 13 of ($x_1_*))) or
            ((2 of ($x_6_*) and 1 of ($x_3_*) and 2 of ($x_2_*) and 11 of ($x_1_*))) or
            ((2 of ($x_6_*) and 1 of ($x_3_*) and 3 of ($x_2_*) and 9 of ($x_1_*))) or
            ((2 of ($x_6_*) and 1 of ($x_3_*) and 4 of ($x_2_*) and 7 of ($x_1_*))) or
            ((2 of ($x_6_*) and 1 of ($x_3_*) and 5 of ($x_2_*) and 5 of ($x_1_*))) or
            ((2 of ($x_6_*) and 1 of ($x_3_*) and 6 of ($x_2_*) and 3 of ($x_1_*))) or
            ((2 of ($x_6_*) and 1 of ($x_3_*) and 7 of ($x_2_*) and 1 of ($x_1_*))) or
            ((2 of ($x_6_*) and 1 of ($x_3_*) and 8 of ($x_2_*))) or
            ((2 of ($x_6_*) and 2 of ($x_3_*) and 12 of ($x_1_*))) or
            ((2 of ($x_6_*) and 2 of ($x_3_*) and 1 of ($x_2_*) and 10 of ($x_1_*))) or
            ((2 of ($x_6_*) and 2 of ($x_3_*) and 2 of ($x_2_*) and 8 of ($x_1_*))) or
            ((2 of ($x_6_*) and 2 of ($x_3_*) and 3 of ($x_2_*) and 6 of ($x_1_*))) or
            ((2 of ($x_6_*) and 2 of ($x_3_*) and 4 of ($x_2_*) and 4 of ($x_1_*))) or
            ((2 of ($x_6_*) and 2 of ($x_3_*) and 5 of ($x_2_*) and 2 of ($x_1_*))) or
            ((2 of ($x_6_*) and 2 of ($x_3_*) and 6 of ($x_2_*))) or
            ((2 of ($x_6_*) and 3 of ($x_3_*) and 9 of ($x_1_*))) or
            ((2 of ($x_6_*) and 3 of ($x_3_*) and 1 of ($x_2_*) and 7 of ($x_1_*))) or
            ((2 of ($x_6_*) and 3 of ($x_3_*) and 2 of ($x_2_*) and 5 of ($x_1_*))) or
            ((2 of ($x_6_*) and 3 of ($x_3_*) and 3 of ($x_2_*) and 3 of ($x_1_*))) or
            ((2 of ($x_6_*) and 3 of ($x_3_*) and 4 of ($x_2_*) and 1 of ($x_1_*))) or
            ((2 of ($x_6_*) and 3 of ($x_3_*) and 5 of ($x_2_*))) or
            ((2 of ($x_6_*) and 4 of ($x_3_*) and 6 of ($x_1_*))) or
            ((2 of ($x_6_*) and 4 of ($x_3_*) and 1 of ($x_2_*) and 4 of ($x_1_*))) or
            ((2 of ($x_6_*) and 4 of ($x_3_*) and 2 of ($x_2_*) and 2 of ($x_1_*))) or
            ((2 of ($x_6_*) and 4 of ($x_3_*) and 3 of ($x_2_*))) or
            ((2 of ($x_6_*) and 5 of ($x_3_*) and 3 of ($x_1_*))) or
            ((2 of ($x_6_*) and 5 of ($x_3_*) and 1 of ($x_2_*) and 1 of ($x_1_*))) or
            ((2 of ($x_6_*) and 5 of ($x_3_*) and 2 of ($x_2_*))) or
            ((2 of ($x_6_*) and 6 of ($x_3_*))) or
            ((2 of ($x_6_*) and 1 of ($x_4_*) and 14 of ($x_1_*))) or
            ((2 of ($x_6_*) and 1 of ($x_4_*) and 1 of ($x_2_*) and 12 of ($x_1_*))) or
            ((2 of ($x_6_*) and 1 of ($x_4_*) and 2 of ($x_2_*) and 10 of ($x_1_*))) or
            ((2 of ($x_6_*) and 1 of ($x_4_*) and 3 of ($x_2_*) and 8 of ($x_1_*))) or
            ((2 of ($x_6_*) and 1 of ($x_4_*) and 4 of ($x_2_*) and 6 of ($x_1_*))) or
            ((2 of ($x_6_*) and 1 of ($x_4_*) and 5 of ($x_2_*) and 4 of ($x_1_*))) or
            ((2 of ($x_6_*) and 1 of ($x_4_*) and 6 of ($x_2_*) and 2 of ($x_1_*))) or
            ((2 of ($x_6_*) and 1 of ($x_4_*) and 7 of ($x_2_*))) or
            ((2 of ($x_6_*) and 1 of ($x_4_*) and 1 of ($x_3_*) and 11 of ($x_1_*))) or
            ((2 of ($x_6_*) and 1 of ($x_4_*) and 1 of ($x_3_*) and 1 of ($x_2_*) and 9 of ($x_1_*))) or
            ((2 of ($x_6_*) and 1 of ($x_4_*) and 1 of ($x_3_*) and 2 of ($x_2_*) and 7 of ($x_1_*))) or
            ((2 of ($x_6_*) and 1 of ($x_4_*) and 1 of ($x_3_*) and 3 of ($x_2_*) and 5 of ($x_1_*))) or
            ((2 of ($x_6_*) and 1 of ($x_4_*) and 1 of ($x_3_*) and 4 of ($x_2_*) and 3 of ($x_1_*))) or
            ((2 of ($x_6_*) and 1 of ($x_4_*) and 1 of ($x_3_*) and 5 of ($x_2_*) and 1 of ($x_1_*))) or
            ((2 of ($x_6_*) and 1 of ($x_4_*) and 1 of ($x_3_*) and 6 of ($x_2_*))) or
            ((2 of ($x_6_*) and 1 of ($x_4_*) and 2 of ($x_3_*) and 8 of ($x_1_*))) or
            ((2 of ($x_6_*) and 1 of ($x_4_*) and 2 of ($x_3_*) and 1 of ($x_2_*) and 6 of ($x_1_*))) or
            ((2 of ($x_6_*) and 1 of ($x_4_*) and 2 of ($x_3_*) and 2 of ($x_2_*) and 4 of ($x_1_*))) or
            ((2 of ($x_6_*) and 1 of ($x_4_*) and 2 of ($x_3_*) and 3 of ($x_2_*) and 2 of ($x_1_*))) or
            ((2 of ($x_6_*) and 1 of ($x_4_*) and 2 of ($x_3_*) and 4 of ($x_2_*))) or
            ((2 of ($x_6_*) and 1 of ($x_4_*) and 3 of ($x_3_*) and 5 of ($x_1_*))) or
            ((2 of ($x_6_*) and 1 of ($x_4_*) and 3 of ($x_3_*) and 1 of ($x_2_*) and 3 of ($x_1_*))) or
            ((2 of ($x_6_*) and 1 of ($x_4_*) and 3 of ($x_3_*) and 2 of ($x_2_*) and 1 of ($x_1_*))) or
            ((2 of ($x_6_*) and 1 of ($x_4_*) and 3 of ($x_3_*) and 3 of ($x_2_*))) or
            ((2 of ($x_6_*) and 1 of ($x_4_*) and 4 of ($x_3_*) and 2 of ($x_1_*))) or
            ((2 of ($x_6_*) and 1 of ($x_4_*) and 4 of ($x_3_*) and 1 of ($x_2_*))) or
            ((2 of ($x_6_*) and 1 of ($x_4_*) and 5 of ($x_3_*))) or
            ((2 of ($x_6_*) and 2 of ($x_4_*) and 10 of ($x_1_*))) or
            ((2 of ($x_6_*) and 2 of ($x_4_*) and 1 of ($x_2_*) and 8 of ($x_1_*))) or
            ((2 of ($x_6_*) and 2 of ($x_4_*) and 2 of ($x_2_*) and 6 of ($x_1_*))) or
            ((2 of ($x_6_*) and 2 of ($x_4_*) and 3 of ($x_2_*) and 4 of ($x_1_*))) or
            ((2 of ($x_6_*) and 2 of ($x_4_*) and 4 of ($x_2_*) and 2 of ($x_1_*))) or
            ((2 of ($x_6_*) and 2 of ($x_4_*) and 5 of ($x_2_*))) or
            ((2 of ($x_6_*) and 2 of ($x_4_*) and 1 of ($x_3_*) and 7 of ($x_1_*))) or
            ((2 of ($x_6_*) and 2 of ($x_4_*) and 1 of ($x_3_*) and 1 of ($x_2_*) and 5 of ($x_1_*))) or
            ((2 of ($x_6_*) and 2 of ($x_4_*) and 1 of ($x_3_*) and 2 of ($x_2_*) and 3 of ($x_1_*))) or
            ((2 of ($x_6_*) and 2 of ($x_4_*) and 1 of ($x_3_*) and 3 of ($x_2_*) and 1 of ($x_1_*))) or
            ((2 of ($x_6_*) and 2 of ($x_4_*) and 1 of ($x_3_*) and 4 of ($x_2_*))) or
            ((2 of ($x_6_*) and 2 of ($x_4_*) and 2 of ($x_3_*) and 4 of ($x_1_*))) or
            ((2 of ($x_6_*) and 2 of ($x_4_*) and 2 of ($x_3_*) and 1 of ($x_2_*) and 2 of ($x_1_*))) or
            ((2 of ($x_6_*) and 2 of ($x_4_*) and 2 of ($x_3_*) and 2 of ($x_2_*))) or
            ((2 of ($x_6_*) and 2 of ($x_4_*) and 3 of ($x_3_*) and 1 of ($x_1_*))) or
            ((2 of ($x_6_*) and 2 of ($x_4_*) and 3 of ($x_3_*) and 1 of ($x_2_*))) or
            ((2 of ($x_6_*) and 2 of ($x_4_*) and 4 of ($x_3_*))) or
            ((2 of ($x_6_*) and 3 of ($x_4_*) and 6 of ($x_1_*))) or
            ((2 of ($x_6_*) and 3 of ($x_4_*) and 1 of ($x_2_*) and 4 of ($x_1_*))) or
            ((2 of ($x_6_*) and 3 of ($x_4_*) and 2 of ($x_2_*) and 2 of ($x_1_*))) or
            ((2 of ($x_6_*) and 3 of ($x_4_*) and 3 of ($x_2_*))) or
            ((2 of ($x_6_*) and 3 of ($x_4_*) and 1 of ($x_3_*) and 3 of ($x_1_*))) or
            ((2 of ($x_6_*) and 3 of ($x_4_*) and 1 of ($x_3_*) and 1 of ($x_2_*) and 1 of ($x_1_*))) or
            ((2 of ($x_6_*) and 3 of ($x_4_*) and 1 of ($x_3_*) and 2 of ($x_2_*))) or
            ((2 of ($x_6_*) and 3 of ($x_4_*) and 2 of ($x_3_*))) or
            ((2 of ($x_6_*) and 4 of ($x_4_*) and 2 of ($x_1_*))) or
            ((2 of ($x_6_*) and 4 of ($x_4_*) and 1 of ($x_2_*))) or
            ((2 of ($x_6_*) and 4 of ($x_4_*) and 1 of ($x_3_*))) or
            ((2 of ($x_6_*) and 5 of ($x_4_*))) or
            ((2 of ($x_6_*) and 1 of ($x_5_*) and 13 of ($x_1_*))) or
            ((2 of ($x_6_*) and 1 of ($x_5_*) and 1 of ($x_2_*) and 11 of ($x_1_*))) or
            ((2 of ($x_6_*) and 1 of ($x_5_*) and 2 of ($x_2_*) and 9 of ($x_1_*))) or
            ((2 of ($x_6_*) and 1 of ($x_5_*) and 3 of ($x_2_*) and 7 of ($x_1_*))) or
            ((2 of ($x_6_*) and 1 of ($x_5_*) and 4 of ($x_2_*) and 5 of ($x_1_*))) or
            ((2 of ($x_6_*) and 1 of ($x_5_*) and 5 of ($x_2_*) and 3 of ($x_1_*))) or
            ((2 of ($x_6_*) and 1 of ($x_5_*) and 6 of ($x_2_*) and 1 of ($x_1_*))) or
            ((2 of ($x_6_*) and 1 of ($x_5_*) and 7 of ($x_2_*))) or
            ((2 of ($x_6_*) and 1 of ($x_5_*) and 1 of ($x_3_*) and 10 of ($x_1_*))) or
            ((2 of ($x_6_*) and 1 of ($x_5_*) and 1 of ($x_3_*) and 1 of ($x_2_*) and 8 of ($x_1_*))) or
            ((2 of ($x_6_*) and 1 of ($x_5_*) and 1 of ($x_3_*) and 2 of ($x_2_*) and 6 of ($x_1_*))) or
            ((2 of ($x_6_*) and 1 of ($x_5_*) and 1 of ($x_3_*) and 3 of ($x_2_*) and 4 of ($x_1_*))) or
            ((2 of ($x_6_*) and 1 of ($x_5_*) and 1 of ($x_3_*) and 4 of ($x_2_*) and 2 of ($x_1_*))) or
            ((2 of ($x_6_*) and 1 of ($x_5_*) and 1 of ($x_3_*) and 5 of ($x_2_*))) or
            ((2 of ($x_6_*) and 1 of ($x_5_*) and 2 of ($x_3_*) and 7 of ($x_1_*))) or
            ((2 of ($x_6_*) and 1 of ($x_5_*) and 2 of ($x_3_*) and 1 of ($x_2_*) and 5 of ($x_1_*))) or
            ((2 of ($x_6_*) and 1 of ($x_5_*) and 2 of ($x_3_*) and 2 of ($x_2_*) and 3 of ($x_1_*))) or
            ((2 of ($x_6_*) and 1 of ($x_5_*) and 2 of ($x_3_*) and 3 of ($x_2_*) and 1 of ($x_1_*))) or
            ((2 of ($x_6_*) and 1 of ($x_5_*) and 2 of ($x_3_*) and 4 of ($x_2_*))) or
            ((2 of ($x_6_*) and 1 of ($x_5_*) and 3 of ($x_3_*) and 4 of ($x_1_*))) or
            ((2 of ($x_6_*) and 1 of ($x_5_*) and 3 of ($x_3_*) and 1 of ($x_2_*) and 2 of ($x_1_*))) or
            ((2 of ($x_6_*) and 1 of ($x_5_*) and 3 of ($x_3_*) and 2 of ($x_2_*))) or
            ((2 of ($x_6_*) and 1 of ($x_5_*) and 4 of ($x_3_*) and 1 of ($x_1_*))) or
            ((2 of ($x_6_*) and 1 of ($x_5_*) and 4 of ($x_3_*) and 1 of ($x_2_*))) or
            ((2 of ($x_6_*) and 1 of ($x_5_*) and 5 of ($x_3_*))) or
            ((2 of ($x_6_*) and 1 of ($x_5_*) and 1 of ($x_4_*) and 9 of ($x_1_*))) or
            ((2 of ($x_6_*) and 1 of ($x_5_*) and 1 of ($x_4_*) and 1 of ($x_2_*) and 7 of ($x_1_*))) or
            ((2 of ($x_6_*) and 1 of ($x_5_*) and 1 of ($x_4_*) and 2 of ($x_2_*) and 5 of ($x_1_*))) or
            ((2 of ($x_6_*) and 1 of ($x_5_*) and 1 of ($x_4_*) and 3 of ($x_2_*) and 3 of ($x_1_*))) or
            ((2 of ($x_6_*) and 1 of ($x_5_*) and 1 of ($x_4_*) and 4 of ($x_2_*) and 1 of ($x_1_*))) or
            ((2 of ($x_6_*) and 1 of ($x_5_*) and 1 of ($x_4_*) and 5 of ($x_2_*))) or
            ((2 of ($x_6_*) and 1 of ($x_5_*) and 1 of ($x_4_*) and 1 of ($x_3_*) and 6 of ($x_1_*))) or
            ((2 of ($x_6_*) and 1 of ($x_5_*) and 1 of ($x_4_*) and 1 of ($x_3_*) and 1 of ($x_2_*) and 4 of ($x_1_*))) or
            ((2 of ($x_6_*) and 1 of ($x_5_*) and 1 of ($x_4_*) and 1 of ($x_3_*) and 2 of ($x_2_*) and 2 of ($x_1_*))) or
            ((2 of ($x_6_*) and 1 of ($x_5_*) and 1 of ($x_4_*) and 1 of ($x_3_*) and 3 of ($x_2_*))) or
            ((2 of ($x_6_*) and 1 of ($x_5_*) and 1 of ($x_4_*) and 2 of ($x_3_*) and 3 of ($x_1_*))) or
            ((2 of ($x_6_*) and 1 of ($x_5_*) and 1 of ($x_4_*) and 2 of ($x_3_*) and 1 of ($x_2_*) and 1 of ($x_1_*))) or
            ((2 of ($x_6_*) and 1 of ($x_5_*) and 1 of ($x_4_*) and 2 of ($x_3_*) and 2 of ($x_2_*))) or
            ((2 of ($x_6_*) and 1 of ($x_5_*) and 1 of ($x_4_*) and 3 of ($x_3_*))) or
            ((2 of ($x_6_*) and 1 of ($x_5_*) and 2 of ($x_4_*) and 5 of ($x_1_*))) or
            ((2 of ($x_6_*) and 1 of ($x_5_*) and 2 of ($x_4_*) and 1 of ($x_2_*) and 3 of ($x_1_*))) or
            ((2 of ($x_6_*) and 1 of ($x_5_*) and 2 of ($x_4_*) and 2 of ($x_2_*) and 1 of ($x_1_*))) or
            ((2 of ($x_6_*) and 1 of ($x_5_*) and 2 of ($x_4_*) and 3 of ($x_2_*))) or
            ((2 of ($x_6_*) and 1 of ($x_5_*) and 2 of ($x_4_*) and 1 of ($x_3_*) and 2 of ($x_1_*))) or
            ((2 of ($x_6_*) and 1 of ($x_5_*) and 2 of ($x_4_*) and 1 of ($x_3_*) and 1 of ($x_2_*))) or
            ((2 of ($x_6_*) and 1 of ($x_5_*) and 2 of ($x_4_*) and 2 of ($x_3_*))) or
            ((2 of ($x_6_*) and 1 of ($x_5_*) and 3 of ($x_4_*) and 1 of ($x_1_*))) or
            ((2 of ($x_6_*) and 1 of ($x_5_*) and 3 of ($x_4_*) and 1 of ($x_2_*))) or
            ((2 of ($x_6_*) and 1 of ($x_5_*) and 3 of ($x_4_*) and 1 of ($x_3_*))) or
            ((2 of ($x_6_*) and 1 of ($x_5_*) and 4 of ($x_4_*))) or
            ((2 of ($x_6_*) and 2 of ($x_5_*) and 8 of ($x_1_*))) or
            ((2 of ($x_6_*) and 2 of ($x_5_*) and 1 of ($x_2_*) and 6 of ($x_1_*))) or
            ((2 of ($x_6_*) and 2 of ($x_5_*) and 2 of ($x_2_*) and 4 of ($x_1_*))) or
            ((2 of ($x_6_*) and 2 of ($x_5_*) and 3 of ($x_2_*) and 2 of ($x_1_*))) or
            ((2 of ($x_6_*) and 2 of ($x_5_*) and 4 of ($x_2_*))) or
            ((2 of ($x_6_*) and 2 of ($x_5_*) and 1 of ($x_3_*) and 5 of ($x_1_*))) or
            ((2 of ($x_6_*) and 2 of ($x_5_*) and 1 of ($x_3_*) and 1 of ($x_2_*) and 3 of ($x_1_*))) or
            ((2 of ($x_6_*) and 2 of ($x_5_*) and 1 of ($x_3_*) and 2 of ($x_2_*) and 1 of ($x_1_*))) or
            ((2 of ($x_6_*) and 2 of ($x_5_*) and 1 of ($x_3_*) and 3 of ($x_2_*))) or
            ((2 of ($x_6_*) and 2 of ($x_5_*) and 2 of ($x_3_*) and 2 of ($x_1_*))) or
            ((2 of ($x_6_*) and 2 of ($x_5_*) and 2 of ($x_3_*) and 1 of ($x_2_*))) or
            ((2 of ($x_6_*) and 2 of ($x_5_*) and 3 of ($x_3_*))) or
            ((2 of ($x_6_*) and 2 of ($x_5_*) and 1 of ($x_4_*) and 4 of ($x_1_*))) or
            ((2 of ($x_6_*) and 2 of ($x_5_*) and 1 of ($x_4_*) and 1 of ($x_2_*) and 2 of ($x_1_*))) or
            ((2 of ($x_6_*) and 2 of ($x_5_*) and 1 of ($x_4_*) and 2 of ($x_2_*))) or
            ((2 of ($x_6_*) and 2 of ($x_5_*) and 1 of ($x_4_*) and 1 of ($x_3_*) and 1 of ($x_1_*))) or
            ((2 of ($x_6_*) and 2 of ($x_5_*) and 1 of ($x_4_*) and 1 of ($x_3_*) and 1 of ($x_2_*))) or
            ((2 of ($x_6_*) and 2 of ($x_5_*) and 1 of ($x_4_*) and 2 of ($x_3_*))) or
            ((2 of ($x_6_*) and 2 of ($x_5_*) and 2 of ($x_4_*))) or
            ((2 of ($x_6_*) and 3 of ($x_5_*) and 3 of ($x_1_*))) or
            ((2 of ($x_6_*) and 3 of ($x_5_*) and 1 of ($x_2_*) and 1 of ($x_1_*))) or
            ((2 of ($x_6_*) and 3 of ($x_5_*) and 2 of ($x_2_*))) or
            ((2 of ($x_6_*) and 3 of ($x_5_*) and 1 of ($x_3_*))) or
            ((2 of ($x_6_*) and 3 of ($x_5_*) and 1 of ($x_4_*))) or
            ((2 of ($x_6_*) and 4 of ($x_5_*))) or
            ((3 of ($x_6_*) and 12 of ($x_1_*))) or
            ((3 of ($x_6_*) and 1 of ($x_2_*) and 10 of ($x_1_*))) or
            ((3 of ($x_6_*) and 2 of ($x_2_*) and 8 of ($x_1_*))) or
            ((3 of ($x_6_*) and 3 of ($x_2_*) and 6 of ($x_1_*))) or
            ((3 of ($x_6_*) and 4 of ($x_2_*) and 4 of ($x_1_*))) or
            ((3 of ($x_6_*) and 5 of ($x_2_*) and 2 of ($x_1_*))) or
            ((3 of ($x_6_*) and 6 of ($x_2_*))) or
            ((3 of ($x_6_*) and 1 of ($x_3_*) and 9 of ($x_1_*))) or
            ((3 of ($x_6_*) and 1 of ($x_3_*) and 1 of ($x_2_*) and 7 of ($x_1_*))) or
            ((3 of ($x_6_*) and 1 of ($x_3_*) and 2 of ($x_2_*) and 5 of ($x_1_*))) or
            ((3 of ($x_6_*) and 1 of ($x_3_*) and 3 of ($x_2_*) and 3 of ($x_1_*))) or
            ((3 of ($x_6_*) and 1 of ($x_3_*) and 4 of ($x_2_*) and 1 of ($x_1_*))) or
            ((3 of ($x_6_*) and 1 of ($x_3_*) and 5 of ($x_2_*))) or
            ((3 of ($x_6_*) and 2 of ($x_3_*) and 6 of ($x_1_*))) or
            ((3 of ($x_6_*) and 2 of ($x_3_*) and 1 of ($x_2_*) and 4 of ($x_1_*))) or
            ((3 of ($x_6_*) and 2 of ($x_3_*) and 2 of ($x_2_*) and 2 of ($x_1_*))) or
            ((3 of ($x_6_*) and 2 of ($x_3_*) and 3 of ($x_2_*))) or
            ((3 of ($x_6_*) and 3 of ($x_3_*) and 3 of ($x_1_*))) or
            ((3 of ($x_6_*) and 3 of ($x_3_*) and 1 of ($x_2_*) and 1 of ($x_1_*))) or
            ((3 of ($x_6_*) and 3 of ($x_3_*) and 2 of ($x_2_*))) or
            ((3 of ($x_6_*) and 4 of ($x_3_*))) or
            ((3 of ($x_6_*) and 1 of ($x_4_*) and 8 of ($x_1_*))) or
            ((3 of ($x_6_*) and 1 of ($x_4_*) and 1 of ($x_2_*) and 6 of ($x_1_*))) or
            ((3 of ($x_6_*) and 1 of ($x_4_*) and 2 of ($x_2_*) and 4 of ($x_1_*))) or
            ((3 of ($x_6_*) and 1 of ($x_4_*) and 3 of ($x_2_*) and 2 of ($x_1_*))) or
            ((3 of ($x_6_*) and 1 of ($x_4_*) and 4 of ($x_2_*))) or
            ((3 of ($x_6_*) and 1 of ($x_4_*) and 1 of ($x_3_*) and 5 of ($x_1_*))) or
            ((3 of ($x_6_*) and 1 of ($x_4_*) and 1 of ($x_3_*) and 1 of ($x_2_*) and 3 of ($x_1_*))) or
            ((3 of ($x_6_*) and 1 of ($x_4_*) and 1 of ($x_3_*) and 2 of ($x_2_*) and 1 of ($x_1_*))) or
            ((3 of ($x_6_*) and 1 of ($x_4_*) and 1 of ($x_3_*) and 3 of ($x_2_*))) or
            ((3 of ($x_6_*) and 1 of ($x_4_*) and 2 of ($x_3_*) and 2 of ($x_1_*))) or
            ((3 of ($x_6_*) and 1 of ($x_4_*) and 2 of ($x_3_*) and 1 of ($x_2_*))) or
            ((3 of ($x_6_*) and 1 of ($x_4_*) and 3 of ($x_3_*))) or
            ((3 of ($x_6_*) and 2 of ($x_4_*) and 4 of ($x_1_*))) or
            ((3 of ($x_6_*) and 2 of ($x_4_*) and 1 of ($x_2_*) and 2 of ($x_1_*))) or
            ((3 of ($x_6_*) and 2 of ($x_4_*) and 2 of ($x_2_*))) or
            ((3 of ($x_6_*) and 2 of ($x_4_*) and 1 of ($x_3_*) and 1 of ($x_1_*))) or
            ((3 of ($x_6_*) and 2 of ($x_4_*) and 1 of ($x_3_*) and 1 of ($x_2_*))) or
            ((3 of ($x_6_*) and 2 of ($x_4_*) and 2 of ($x_3_*))) or
            ((3 of ($x_6_*) and 3 of ($x_4_*))) or
            ((3 of ($x_6_*) and 1 of ($x_5_*) and 7 of ($x_1_*))) or
            ((3 of ($x_6_*) and 1 of ($x_5_*) and 1 of ($x_2_*) and 5 of ($x_1_*))) or
            ((3 of ($x_6_*) and 1 of ($x_5_*) and 2 of ($x_2_*) and 3 of ($x_1_*))) or
            ((3 of ($x_6_*) and 1 of ($x_5_*) and 3 of ($x_2_*) and 1 of ($x_1_*))) or
            ((3 of ($x_6_*) and 1 of ($x_5_*) and 4 of ($x_2_*))) or
            ((3 of ($x_6_*) and 1 of ($x_5_*) and 1 of ($x_3_*) and 4 of ($x_1_*))) or
            ((3 of ($x_6_*) and 1 of ($x_5_*) and 1 of ($x_3_*) and 1 of ($x_2_*) and 2 of ($x_1_*))) or
            ((3 of ($x_6_*) and 1 of ($x_5_*) and 1 of ($x_3_*) and 2 of ($x_2_*))) or
            ((3 of ($x_6_*) and 1 of ($x_5_*) and 2 of ($x_3_*) and 1 of ($x_1_*))) or
            ((3 of ($x_6_*) and 1 of ($x_5_*) and 2 of ($x_3_*) and 1 of ($x_2_*))) or
            ((3 of ($x_6_*) and 1 of ($x_5_*) and 3 of ($x_3_*))) or
            ((3 of ($x_6_*) and 1 of ($x_5_*) and 1 of ($x_4_*) and 3 of ($x_1_*))) or
            ((3 of ($x_6_*) and 1 of ($x_5_*) and 1 of ($x_4_*) and 1 of ($x_2_*) and 1 of ($x_1_*))) or
            ((3 of ($x_6_*) and 1 of ($x_5_*) and 1 of ($x_4_*) and 2 of ($x_2_*))) or
            ((3 of ($x_6_*) and 1 of ($x_5_*) and 1 of ($x_4_*) and 1 of ($x_3_*))) or
            ((3 of ($x_6_*) and 1 of ($x_5_*) and 2 of ($x_4_*))) or
            ((3 of ($x_6_*) and 2 of ($x_5_*) and 2 of ($x_1_*))) or
            ((3 of ($x_6_*) and 2 of ($x_5_*) and 1 of ($x_2_*))) or
            ((3 of ($x_6_*) and 2 of ($x_5_*) and 1 of ($x_3_*))) or
            ((3 of ($x_6_*) and 2 of ($x_5_*) and 1 of ($x_4_*))) or
            ((3 of ($x_6_*) and 3 of ($x_5_*))) or
            ((1 of ($x_9_*) and 1 of ($x_2_*) and 19 of ($x_1_*))) or
            ((1 of ($x_9_*) and 2 of ($x_2_*) and 17 of ($x_1_*))) or
            ((1 of ($x_9_*) and 3 of ($x_2_*) and 15 of ($x_1_*))) or
            ((1 of ($x_9_*) and 4 of ($x_2_*) and 13 of ($x_1_*))) or
            ((1 of ($x_9_*) and 5 of ($x_2_*) and 11 of ($x_1_*))) or
            ((1 of ($x_9_*) and 6 of ($x_2_*) and 9 of ($x_1_*))) or
            ((1 of ($x_9_*) and 7 of ($x_2_*) and 7 of ($x_1_*))) or
            ((1 of ($x_9_*) and 8 of ($x_2_*) and 5 of ($x_1_*))) or
            ((1 of ($x_9_*) and 9 of ($x_2_*) and 3 of ($x_1_*))) or
            ((1 of ($x_9_*) and 10 of ($x_2_*) and 1 of ($x_1_*))) or
            ((1 of ($x_9_*) and 1 of ($x_3_*) and 18 of ($x_1_*))) or
            ((1 of ($x_9_*) and 1 of ($x_3_*) and 1 of ($x_2_*) and 16 of ($x_1_*))) or
            ((1 of ($x_9_*) and 1 of ($x_3_*) and 2 of ($x_2_*) and 14 of ($x_1_*))) or
            ((1 of ($x_9_*) and 1 of ($x_3_*) and 3 of ($x_2_*) and 12 of ($x_1_*))) or
            ((1 of ($x_9_*) and 1 of ($x_3_*) and 4 of ($x_2_*) and 10 of ($x_1_*))) or
            ((1 of ($x_9_*) and 1 of ($x_3_*) and 5 of ($x_2_*) and 8 of ($x_1_*))) or
            ((1 of ($x_9_*) and 1 of ($x_3_*) and 6 of ($x_2_*) and 6 of ($x_1_*))) or
            ((1 of ($x_9_*) and 1 of ($x_3_*) and 7 of ($x_2_*) and 4 of ($x_1_*))) or
            ((1 of ($x_9_*) and 1 of ($x_3_*) and 8 of ($x_2_*) and 2 of ($x_1_*))) or
            ((1 of ($x_9_*) and 1 of ($x_3_*) and 9 of ($x_2_*))) or
            ((1 of ($x_9_*) and 2 of ($x_3_*) and 15 of ($x_1_*))) or
            ((1 of ($x_9_*) and 2 of ($x_3_*) and 1 of ($x_2_*) and 13 of ($x_1_*))) or
            ((1 of ($x_9_*) and 2 of ($x_3_*) and 2 of ($x_2_*) and 11 of ($x_1_*))) or
            ((1 of ($x_9_*) and 2 of ($x_3_*) and 3 of ($x_2_*) and 9 of ($x_1_*))) or
            ((1 of ($x_9_*) and 2 of ($x_3_*) and 4 of ($x_2_*) and 7 of ($x_1_*))) or
            ((1 of ($x_9_*) and 2 of ($x_3_*) and 5 of ($x_2_*) and 5 of ($x_1_*))) or
            ((1 of ($x_9_*) and 2 of ($x_3_*) and 6 of ($x_2_*) and 3 of ($x_1_*))) or
            ((1 of ($x_9_*) and 2 of ($x_3_*) and 7 of ($x_2_*) and 1 of ($x_1_*))) or
            ((1 of ($x_9_*) and 2 of ($x_3_*) and 8 of ($x_2_*))) or
            ((1 of ($x_9_*) and 3 of ($x_3_*) and 12 of ($x_1_*))) or
            ((1 of ($x_9_*) and 3 of ($x_3_*) and 1 of ($x_2_*) and 10 of ($x_1_*))) or
            ((1 of ($x_9_*) and 3 of ($x_3_*) and 2 of ($x_2_*) and 8 of ($x_1_*))) or
            ((1 of ($x_9_*) and 3 of ($x_3_*) and 3 of ($x_2_*) and 6 of ($x_1_*))) or
            ((1 of ($x_9_*) and 3 of ($x_3_*) and 4 of ($x_2_*) and 4 of ($x_1_*))) or
            ((1 of ($x_9_*) and 3 of ($x_3_*) and 5 of ($x_2_*) and 2 of ($x_1_*))) or
            ((1 of ($x_9_*) and 3 of ($x_3_*) and 6 of ($x_2_*))) or
            ((1 of ($x_9_*) and 4 of ($x_3_*) and 9 of ($x_1_*))) or
            ((1 of ($x_9_*) and 4 of ($x_3_*) and 1 of ($x_2_*) and 7 of ($x_1_*))) or
            ((1 of ($x_9_*) and 4 of ($x_3_*) and 2 of ($x_2_*) and 5 of ($x_1_*))) or
            ((1 of ($x_9_*) and 4 of ($x_3_*) and 3 of ($x_2_*) and 3 of ($x_1_*))) or
            ((1 of ($x_9_*) and 4 of ($x_3_*) and 4 of ($x_2_*) and 1 of ($x_1_*))) or
            ((1 of ($x_9_*) and 4 of ($x_3_*) and 5 of ($x_2_*))) or
            ((1 of ($x_9_*) and 5 of ($x_3_*) and 6 of ($x_1_*))) or
            ((1 of ($x_9_*) and 5 of ($x_3_*) and 1 of ($x_2_*) and 4 of ($x_1_*))) or
            ((1 of ($x_9_*) and 5 of ($x_3_*) and 2 of ($x_2_*) and 2 of ($x_1_*))) or
            ((1 of ($x_9_*) and 5 of ($x_3_*) and 3 of ($x_2_*))) or
            ((1 of ($x_9_*) and 6 of ($x_3_*) and 3 of ($x_1_*))) or
            ((1 of ($x_9_*) and 6 of ($x_3_*) and 1 of ($x_2_*) and 1 of ($x_1_*))) or
            ((1 of ($x_9_*) and 6 of ($x_3_*) and 2 of ($x_2_*))) or
            ((1 of ($x_9_*) and 7 of ($x_3_*))) or
            ((1 of ($x_9_*) and 1 of ($x_4_*) and 17 of ($x_1_*))) or
            ((1 of ($x_9_*) and 1 of ($x_4_*) and 1 of ($x_2_*) and 15 of ($x_1_*))) or
            ((1 of ($x_9_*) and 1 of ($x_4_*) and 2 of ($x_2_*) and 13 of ($x_1_*))) or
            ((1 of ($x_9_*) and 1 of ($x_4_*) and 3 of ($x_2_*) and 11 of ($x_1_*))) or
            ((1 of ($x_9_*) and 1 of ($x_4_*) and 4 of ($x_2_*) and 9 of ($x_1_*))) or
            ((1 of ($x_9_*) and 1 of ($x_4_*) and 5 of ($x_2_*) and 7 of ($x_1_*))) or
            ((1 of ($x_9_*) and 1 of ($x_4_*) and 6 of ($x_2_*) and 5 of ($x_1_*))) or
            ((1 of ($x_9_*) and 1 of ($x_4_*) and 7 of ($x_2_*) and 3 of ($x_1_*))) or
            ((1 of ($x_9_*) and 1 of ($x_4_*) and 8 of ($x_2_*) and 1 of ($x_1_*))) or
            ((1 of ($x_9_*) and 1 of ($x_4_*) and 9 of ($x_2_*))) or
            ((1 of ($x_9_*) and 1 of ($x_4_*) and 1 of ($x_3_*) and 14 of ($x_1_*))) or
            ((1 of ($x_9_*) and 1 of ($x_4_*) and 1 of ($x_3_*) and 1 of ($x_2_*) and 12 of ($x_1_*))) or
            ((1 of ($x_9_*) and 1 of ($x_4_*) and 1 of ($x_3_*) and 2 of ($x_2_*) and 10 of ($x_1_*))) or
            ((1 of ($x_9_*) and 1 of ($x_4_*) and 1 of ($x_3_*) and 3 of ($x_2_*) and 8 of ($x_1_*))) or
            ((1 of ($x_9_*) and 1 of ($x_4_*) and 1 of ($x_3_*) and 4 of ($x_2_*) and 6 of ($x_1_*))) or
            ((1 of ($x_9_*) and 1 of ($x_4_*) and 1 of ($x_3_*) and 5 of ($x_2_*) and 4 of ($x_1_*))) or
            ((1 of ($x_9_*) and 1 of ($x_4_*) and 1 of ($x_3_*) and 6 of ($x_2_*) and 2 of ($x_1_*))) or
            ((1 of ($x_9_*) and 1 of ($x_4_*) and 1 of ($x_3_*) and 7 of ($x_2_*))) or
            ((1 of ($x_9_*) and 1 of ($x_4_*) and 2 of ($x_3_*) and 11 of ($x_1_*))) or
            ((1 of ($x_9_*) and 1 of ($x_4_*) and 2 of ($x_3_*) and 1 of ($x_2_*) and 9 of ($x_1_*))) or
            ((1 of ($x_9_*) and 1 of ($x_4_*) and 2 of ($x_3_*) and 2 of ($x_2_*) and 7 of ($x_1_*))) or
            ((1 of ($x_9_*) and 1 of ($x_4_*) and 2 of ($x_3_*) and 3 of ($x_2_*) and 5 of ($x_1_*))) or
            ((1 of ($x_9_*) and 1 of ($x_4_*) and 2 of ($x_3_*) and 4 of ($x_2_*) and 3 of ($x_1_*))) or
            ((1 of ($x_9_*) and 1 of ($x_4_*) and 2 of ($x_3_*) and 5 of ($x_2_*) and 1 of ($x_1_*))) or
            ((1 of ($x_9_*) and 1 of ($x_4_*) and 2 of ($x_3_*) and 6 of ($x_2_*))) or
            ((1 of ($x_9_*) and 1 of ($x_4_*) and 3 of ($x_3_*) and 8 of ($x_1_*))) or
            ((1 of ($x_9_*) and 1 of ($x_4_*) and 3 of ($x_3_*) and 1 of ($x_2_*) and 6 of ($x_1_*))) or
            ((1 of ($x_9_*) and 1 of ($x_4_*) and 3 of ($x_3_*) and 2 of ($x_2_*) and 4 of ($x_1_*))) or
            ((1 of ($x_9_*) and 1 of ($x_4_*) and 3 of ($x_3_*) and 3 of ($x_2_*) and 2 of ($x_1_*))) or
            ((1 of ($x_9_*) and 1 of ($x_4_*) and 3 of ($x_3_*) and 4 of ($x_2_*))) or
            ((1 of ($x_9_*) and 1 of ($x_4_*) and 4 of ($x_3_*) and 5 of ($x_1_*))) or
            ((1 of ($x_9_*) and 1 of ($x_4_*) and 4 of ($x_3_*) and 1 of ($x_2_*) and 3 of ($x_1_*))) or
            ((1 of ($x_9_*) and 1 of ($x_4_*) and 4 of ($x_3_*) and 2 of ($x_2_*) and 1 of ($x_1_*))) or
            ((1 of ($x_9_*) and 1 of ($x_4_*) and 4 of ($x_3_*) and 3 of ($x_2_*))) or
            ((1 of ($x_9_*) and 1 of ($x_4_*) and 5 of ($x_3_*) and 2 of ($x_1_*))) or
            ((1 of ($x_9_*) and 1 of ($x_4_*) and 5 of ($x_3_*) and 1 of ($x_2_*))) or
            ((1 of ($x_9_*) and 1 of ($x_4_*) and 6 of ($x_3_*))) or
            ((1 of ($x_9_*) and 2 of ($x_4_*) and 13 of ($x_1_*))) or
            ((1 of ($x_9_*) and 2 of ($x_4_*) and 1 of ($x_2_*) and 11 of ($x_1_*))) or
            ((1 of ($x_9_*) and 2 of ($x_4_*) and 2 of ($x_2_*) and 9 of ($x_1_*))) or
            ((1 of ($x_9_*) and 2 of ($x_4_*) and 3 of ($x_2_*) and 7 of ($x_1_*))) or
            ((1 of ($x_9_*) and 2 of ($x_4_*) and 4 of ($x_2_*) and 5 of ($x_1_*))) or
            ((1 of ($x_9_*) and 2 of ($x_4_*) and 5 of ($x_2_*) and 3 of ($x_1_*))) or
            ((1 of ($x_9_*) and 2 of ($x_4_*) and 6 of ($x_2_*) and 1 of ($x_1_*))) or
            ((1 of ($x_9_*) and 2 of ($x_4_*) and 7 of ($x_2_*))) or
            ((1 of ($x_9_*) and 2 of ($x_4_*) and 1 of ($x_3_*) and 10 of ($x_1_*))) or
            ((1 of ($x_9_*) and 2 of ($x_4_*) and 1 of ($x_3_*) and 1 of ($x_2_*) and 8 of ($x_1_*))) or
            ((1 of ($x_9_*) and 2 of ($x_4_*) and 1 of ($x_3_*) and 2 of ($x_2_*) and 6 of ($x_1_*))) or
            ((1 of ($x_9_*) and 2 of ($x_4_*) and 1 of ($x_3_*) and 3 of ($x_2_*) and 4 of ($x_1_*))) or
            ((1 of ($x_9_*) and 2 of ($x_4_*) and 1 of ($x_3_*) and 4 of ($x_2_*) and 2 of ($x_1_*))) or
            ((1 of ($x_9_*) and 2 of ($x_4_*) and 1 of ($x_3_*) and 5 of ($x_2_*))) or
            ((1 of ($x_9_*) and 2 of ($x_4_*) and 2 of ($x_3_*) and 7 of ($x_1_*))) or
            ((1 of ($x_9_*) and 2 of ($x_4_*) and 2 of ($x_3_*) and 1 of ($x_2_*) and 5 of ($x_1_*))) or
            ((1 of ($x_9_*) and 2 of ($x_4_*) and 2 of ($x_3_*) and 2 of ($x_2_*) and 3 of ($x_1_*))) or
            ((1 of ($x_9_*) and 2 of ($x_4_*) and 2 of ($x_3_*) and 3 of ($x_2_*) and 1 of ($x_1_*))) or
            ((1 of ($x_9_*) and 2 of ($x_4_*) and 2 of ($x_3_*) and 4 of ($x_2_*))) or
            ((1 of ($x_9_*) and 2 of ($x_4_*) and 3 of ($x_3_*) and 4 of ($x_1_*))) or
            ((1 of ($x_9_*) and 2 of ($x_4_*) and 3 of ($x_3_*) and 1 of ($x_2_*) and 2 of ($x_1_*))) or
            ((1 of ($x_9_*) and 2 of ($x_4_*) and 3 of ($x_3_*) and 2 of ($x_2_*))) or
            ((1 of ($x_9_*) and 2 of ($x_4_*) and 4 of ($x_3_*) and 1 of ($x_1_*))) or
            ((1 of ($x_9_*) and 2 of ($x_4_*) and 4 of ($x_3_*) and 1 of ($x_2_*))) or
            ((1 of ($x_9_*) and 2 of ($x_4_*) and 5 of ($x_3_*))) or
            ((1 of ($x_9_*) and 3 of ($x_4_*) and 9 of ($x_1_*))) or
            ((1 of ($x_9_*) and 3 of ($x_4_*) and 1 of ($x_2_*) and 7 of ($x_1_*))) or
            ((1 of ($x_9_*) and 3 of ($x_4_*) and 2 of ($x_2_*) and 5 of ($x_1_*))) or
            ((1 of ($x_9_*) and 3 of ($x_4_*) and 3 of ($x_2_*) and 3 of ($x_1_*))) or
            ((1 of ($x_9_*) and 3 of ($x_4_*) and 4 of ($x_2_*) and 1 of ($x_1_*))) or
            ((1 of ($x_9_*) and 3 of ($x_4_*) and 5 of ($x_2_*))) or
            ((1 of ($x_9_*) and 3 of ($x_4_*) and 1 of ($x_3_*) and 6 of ($x_1_*))) or
            ((1 of ($x_9_*) and 3 of ($x_4_*) and 1 of ($x_3_*) and 1 of ($x_2_*) and 4 of ($x_1_*))) or
            ((1 of ($x_9_*) and 3 of ($x_4_*) and 1 of ($x_3_*) and 2 of ($x_2_*) and 2 of ($x_1_*))) or
            ((1 of ($x_9_*) and 3 of ($x_4_*) and 1 of ($x_3_*) and 3 of ($x_2_*))) or
            ((1 of ($x_9_*) and 3 of ($x_4_*) and 2 of ($x_3_*) and 3 of ($x_1_*))) or
            ((1 of ($x_9_*) and 3 of ($x_4_*) and 2 of ($x_3_*) and 1 of ($x_2_*) and 1 of ($x_1_*))) or
            ((1 of ($x_9_*) and 3 of ($x_4_*) and 2 of ($x_3_*) and 2 of ($x_2_*))) or
            ((1 of ($x_9_*) and 3 of ($x_4_*) and 3 of ($x_3_*))) or
            ((1 of ($x_9_*) and 4 of ($x_4_*) and 5 of ($x_1_*))) or
            ((1 of ($x_9_*) and 4 of ($x_4_*) and 1 of ($x_2_*) and 3 of ($x_1_*))) or
            ((1 of ($x_9_*) and 4 of ($x_4_*) and 2 of ($x_2_*) and 1 of ($x_1_*))) or
            ((1 of ($x_9_*) and 4 of ($x_4_*) and 3 of ($x_2_*))) or
            ((1 of ($x_9_*) and 4 of ($x_4_*) and 1 of ($x_3_*) and 2 of ($x_1_*))) or
            ((1 of ($x_9_*) and 4 of ($x_4_*) and 1 of ($x_3_*) and 1 of ($x_2_*))) or
            ((1 of ($x_9_*) and 4 of ($x_4_*) and 2 of ($x_3_*))) or
            ((1 of ($x_9_*) and 5 of ($x_4_*) and 1 of ($x_1_*))) or
            ((1 of ($x_9_*) and 5 of ($x_4_*) and 1 of ($x_2_*))) or
            ((1 of ($x_9_*) and 5 of ($x_4_*) and 1 of ($x_3_*))) or
            ((1 of ($x_9_*) and 6 of ($x_4_*))) or
            ((1 of ($x_9_*) and 1 of ($x_5_*) and 16 of ($x_1_*))) or
            ((1 of ($x_9_*) and 1 of ($x_5_*) and 1 of ($x_2_*) and 14 of ($x_1_*))) or
            ((1 of ($x_9_*) and 1 of ($x_5_*) and 2 of ($x_2_*) and 12 of ($x_1_*))) or
            ((1 of ($x_9_*) and 1 of ($x_5_*) and 3 of ($x_2_*) and 10 of ($x_1_*))) or
            ((1 of ($x_9_*) and 1 of ($x_5_*) and 4 of ($x_2_*) and 8 of ($x_1_*))) or
            ((1 of ($x_9_*) and 1 of ($x_5_*) and 5 of ($x_2_*) and 6 of ($x_1_*))) or
            ((1 of ($x_9_*) and 1 of ($x_5_*) and 6 of ($x_2_*) and 4 of ($x_1_*))) or
            ((1 of ($x_9_*) and 1 of ($x_5_*) and 7 of ($x_2_*) and 2 of ($x_1_*))) or
            ((1 of ($x_9_*) and 1 of ($x_5_*) and 8 of ($x_2_*))) or
            ((1 of ($x_9_*) and 1 of ($x_5_*) and 1 of ($x_3_*) and 13 of ($x_1_*))) or
            ((1 of ($x_9_*) and 1 of ($x_5_*) and 1 of ($x_3_*) and 1 of ($x_2_*) and 11 of ($x_1_*))) or
            ((1 of ($x_9_*) and 1 of ($x_5_*) and 1 of ($x_3_*) and 2 of ($x_2_*) and 9 of ($x_1_*))) or
            ((1 of ($x_9_*) and 1 of ($x_5_*) and 1 of ($x_3_*) and 3 of ($x_2_*) and 7 of ($x_1_*))) or
            ((1 of ($x_9_*) and 1 of ($x_5_*) and 1 of ($x_3_*) and 4 of ($x_2_*) and 5 of ($x_1_*))) or
            ((1 of ($x_9_*) and 1 of ($x_5_*) and 1 of ($x_3_*) and 5 of ($x_2_*) and 3 of ($x_1_*))) or
            ((1 of ($x_9_*) and 1 of ($x_5_*) and 1 of ($x_3_*) and 6 of ($x_2_*) and 1 of ($x_1_*))) or
            ((1 of ($x_9_*) and 1 of ($x_5_*) and 1 of ($x_3_*) and 7 of ($x_2_*))) or
            ((1 of ($x_9_*) and 1 of ($x_5_*) and 2 of ($x_3_*) and 10 of ($x_1_*))) or
            ((1 of ($x_9_*) and 1 of ($x_5_*) and 2 of ($x_3_*) and 1 of ($x_2_*) and 8 of ($x_1_*))) or
            ((1 of ($x_9_*) and 1 of ($x_5_*) and 2 of ($x_3_*) and 2 of ($x_2_*) and 6 of ($x_1_*))) or
            ((1 of ($x_9_*) and 1 of ($x_5_*) and 2 of ($x_3_*) and 3 of ($x_2_*) and 4 of ($x_1_*))) or
            ((1 of ($x_9_*) and 1 of ($x_5_*) and 2 of ($x_3_*) and 4 of ($x_2_*) and 2 of ($x_1_*))) or
            ((1 of ($x_9_*) and 1 of ($x_5_*) and 2 of ($x_3_*) and 5 of ($x_2_*))) or
            ((1 of ($x_9_*) and 1 of ($x_5_*) and 3 of ($x_3_*) and 7 of ($x_1_*))) or
            ((1 of ($x_9_*) and 1 of ($x_5_*) and 3 of ($x_3_*) and 1 of ($x_2_*) and 5 of ($x_1_*))) or
            ((1 of ($x_9_*) and 1 of ($x_5_*) and 3 of ($x_3_*) and 2 of ($x_2_*) and 3 of ($x_1_*))) or
            ((1 of ($x_9_*) and 1 of ($x_5_*) and 3 of ($x_3_*) and 3 of ($x_2_*) and 1 of ($x_1_*))) or
            ((1 of ($x_9_*) and 1 of ($x_5_*) and 3 of ($x_3_*) and 4 of ($x_2_*))) or
            ((1 of ($x_9_*) and 1 of ($x_5_*) and 4 of ($x_3_*) and 4 of ($x_1_*))) or
            ((1 of ($x_9_*) and 1 of ($x_5_*) and 4 of ($x_3_*) and 1 of ($x_2_*) and 2 of ($x_1_*))) or
            ((1 of ($x_9_*) and 1 of ($x_5_*) and 4 of ($x_3_*) and 2 of ($x_2_*))) or
            ((1 of ($x_9_*) and 1 of ($x_5_*) and 5 of ($x_3_*) and 1 of ($x_1_*))) or
            ((1 of ($x_9_*) and 1 of ($x_5_*) and 5 of ($x_3_*) and 1 of ($x_2_*))) or
            ((1 of ($x_9_*) and 1 of ($x_5_*) and 6 of ($x_3_*))) or
            ((1 of ($x_9_*) and 1 of ($x_5_*) and 1 of ($x_4_*) and 12 of ($x_1_*))) or
            ((1 of ($x_9_*) and 1 of ($x_5_*) and 1 of ($x_4_*) and 1 of ($x_2_*) and 10 of ($x_1_*))) or
            ((1 of ($x_9_*) and 1 of ($x_5_*) and 1 of ($x_4_*) and 2 of ($x_2_*) and 8 of ($x_1_*))) or
            ((1 of ($x_9_*) and 1 of ($x_5_*) and 1 of ($x_4_*) and 3 of ($x_2_*) and 6 of ($x_1_*))) or
            ((1 of ($x_9_*) and 1 of ($x_5_*) and 1 of ($x_4_*) and 4 of ($x_2_*) and 4 of ($x_1_*))) or
            ((1 of ($x_9_*) and 1 of ($x_5_*) and 1 of ($x_4_*) and 5 of ($x_2_*) and 2 of ($x_1_*))) or
            ((1 of ($x_9_*) and 1 of ($x_5_*) and 1 of ($x_4_*) and 6 of ($x_2_*))) or
            ((1 of ($x_9_*) and 1 of ($x_5_*) and 1 of ($x_4_*) and 1 of ($x_3_*) and 9 of ($x_1_*))) or
            ((1 of ($x_9_*) and 1 of ($x_5_*) and 1 of ($x_4_*) and 1 of ($x_3_*) and 1 of ($x_2_*) and 7 of ($x_1_*))) or
            ((1 of ($x_9_*) and 1 of ($x_5_*) and 1 of ($x_4_*) and 1 of ($x_3_*) and 2 of ($x_2_*) and 5 of ($x_1_*))) or
            ((1 of ($x_9_*) and 1 of ($x_5_*) and 1 of ($x_4_*) and 1 of ($x_3_*) and 3 of ($x_2_*) and 3 of ($x_1_*))) or
            ((1 of ($x_9_*) and 1 of ($x_5_*) and 1 of ($x_4_*) and 1 of ($x_3_*) and 4 of ($x_2_*) and 1 of ($x_1_*))) or
            ((1 of ($x_9_*) and 1 of ($x_5_*) and 1 of ($x_4_*) and 1 of ($x_3_*) and 5 of ($x_2_*))) or
            ((1 of ($x_9_*) and 1 of ($x_5_*) and 1 of ($x_4_*) and 2 of ($x_3_*) and 6 of ($x_1_*))) or
            ((1 of ($x_9_*) and 1 of ($x_5_*) and 1 of ($x_4_*) and 2 of ($x_3_*) and 1 of ($x_2_*) and 4 of ($x_1_*))) or
            ((1 of ($x_9_*) and 1 of ($x_5_*) and 1 of ($x_4_*) and 2 of ($x_3_*) and 2 of ($x_2_*) and 2 of ($x_1_*))) or
            ((1 of ($x_9_*) and 1 of ($x_5_*) and 1 of ($x_4_*) and 2 of ($x_3_*) and 3 of ($x_2_*))) or
            ((1 of ($x_9_*) and 1 of ($x_5_*) and 1 of ($x_4_*) and 3 of ($x_3_*) and 3 of ($x_1_*))) or
            ((1 of ($x_9_*) and 1 of ($x_5_*) and 1 of ($x_4_*) and 3 of ($x_3_*) and 1 of ($x_2_*) and 1 of ($x_1_*))) or
            ((1 of ($x_9_*) and 1 of ($x_5_*) and 1 of ($x_4_*) and 3 of ($x_3_*) and 2 of ($x_2_*))) or
            ((1 of ($x_9_*) and 1 of ($x_5_*) and 1 of ($x_4_*) and 4 of ($x_3_*))) or
            ((1 of ($x_9_*) and 1 of ($x_5_*) and 2 of ($x_4_*) and 8 of ($x_1_*))) or
            ((1 of ($x_9_*) and 1 of ($x_5_*) and 2 of ($x_4_*) and 1 of ($x_2_*) and 6 of ($x_1_*))) or
            ((1 of ($x_9_*) and 1 of ($x_5_*) and 2 of ($x_4_*) and 2 of ($x_2_*) and 4 of ($x_1_*))) or
            ((1 of ($x_9_*) and 1 of ($x_5_*) and 2 of ($x_4_*) and 3 of ($x_2_*) and 2 of ($x_1_*))) or
            ((1 of ($x_9_*) and 1 of ($x_5_*) and 2 of ($x_4_*) and 4 of ($x_2_*))) or
            ((1 of ($x_9_*) and 1 of ($x_5_*) and 2 of ($x_4_*) and 1 of ($x_3_*) and 5 of ($x_1_*))) or
            ((1 of ($x_9_*) and 1 of ($x_5_*) and 2 of ($x_4_*) and 1 of ($x_3_*) and 1 of ($x_2_*) and 3 of ($x_1_*))) or
            ((1 of ($x_9_*) and 1 of ($x_5_*) and 2 of ($x_4_*) and 1 of ($x_3_*) and 2 of ($x_2_*) and 1 of ($x_1_*))) or
            ((1 of ($x_9_*) and 1 of ($x_5_*) and 2 of ($x_4_*) and 1 of ($x_3_*) and 3 of ($x_2_*))) or
            ((1 of ($x_9_*) and 1 of ($x_5_*) and 2 of ($x_4_*) and 2 of ($x_3_*) and 2 of ($x_1_*))) or
            ((1 of ($x_9_*) and 1 of ($x_5_*) and 2 of ($x_4_*) and 2 of ($x_3_*) and 1 of ($x_2_*))) or
            ((1 of ($x_9_*) and 1 of ($x_5_*) and 2 of ($x_4_*) and 3 of ($x_3_*))) or
            ((1 of ($x_9_*) and 1 of ($x_5_*) and 3 of ($x_4_*) and 4 of ($x_1_*))) or
            ((1 of ($x_9_*) and 1 of ($x_5_*) and 3 of ($x_4_*) and 1 of ($x_2_*) and 2 of ($x_1_*))) or
            ((1 of ($x_9_*) and 1 of ($x_5_*) and 3 of ($x_4_*) and 2 of ($x_2_*))) or
            ((1 of ($x_9_*) and 1 of ($x_5_*) and 3 of ($x_4_*) and 1 of ($x_3_*) and 1 of ($x_1_*))) or
            ((1 of ($x_9_*) and 1 of ($x_5_*) and 3 of ($x_4_*) and 1 of ($x_3_*) and 1 of ($x_2_*))) or
            ((1 of ($x_9_*) and 1 of ($x_5_*) and 3 of ($x_4_*) and 2 of ($x_3_*))) or
            ((1 of ($x_9_*) and 1 of ($x_5_*) and 4 of ($x_4_*))) or
            ((1 of ($x_9_*) and 2 of ($x_5_*) and 11 of ($x_1_*))) or
            ((1 of ($x_9_*) and 2 of ($x_5_*) and 1 of ($x_2_*) and 9 of ($x_1_*))) or
            ((1 of ($x_9_*) and 2 of ($x_5_*) and 2 of ($x_2_*) and 7 of ($x_1_*))) or
            ((1 of ($x_9_*) and 2 of ($x_5_*) and 3 of ($x_2_*) and 5 of ($x_1_*))) or
            ((1 of ($x_9_*) and 2 of ($x_5_*) and 4 of ($x_2_*) and 3 of ($x_1_*))) or
            ((1 of ($x_9_*) and 2 of ($x_5_*) and 5 of ($x_2_*) and 1 of ($x_1_*))) or
            ((1 of ($x_9_*) and 2 of ($x_5_*) and 6 of ($x_2_*))) or
            ((1 of ($x_9_*) and 2 of ($x_5_*) and 1 of ($x_3_*) and 8 of ($x_1_*))) or
            ((1 of ($x_9_*) and 2 of ($x_5_*) and 1 of ($x_3_*) and 1 of ($x_2_*) and 6 of ($x_1_*))) or
            ((1 of ($x_9_*) and 2 of ($x_5_*) and 1 of ($x_3_*) and 2 of ($x_2_*) and 4 of ($x_1_*))) or
            ((1 of ($x_9_*) and 2 of ($x_5_*) and 1 of ($x_3_*) and 3 of ($x_2_*) and 2 of ($x_1_*))) or
            ((1 of ($x_9_*) and 2 of ($x_5_*) and 1 of ($x_3_*) and 4 of ($x_2_*))) or
            ((1 of ($x_9_*) and 2 of ($x_5_*) and 2 of ($x_3_*) and 5 of ($x_1_*))) or
            ((1 of ($x_9_*) and 2 of ($x_5_*) and 2 of ($x_3_*) and 1 of ($x_2_*) and 3 of ($x_1_*))) or
            ((1 of ($x_9_*) and 2 of ($x_5_*) and 2 of ($x_3_*) and 2 of ($x_2_*) and 1 of ($x_1_*))) or
            ((1 of ($x_9_*) and 2 of ($x_5_*) and 2 of ($x_3_*) and 3 of ($x_2_*))) or
            ((1 of ($x_9_*) and 2 of ($x_5_*) and 3 of ($x_3_*) and 2 of ($x_1_*))) or
            ((1 of ($x_9_*) and 2 of ($x_5_*) and 3 of ($x_3_*) and 1 of ($x_2_*))) or
            ((1 of ($x_9_*) and 2 of ($x_5_*) and 4 of ($x_3_*))) or
            ((1 of ($x_9_*) and 2 of ($x_5_*) and 1 of ($x_4_*) and 7 of ($x_1_*))) or
            ((1 of ($x_9_*) and 2 of ($x_5_*) and 1 of ($x_4_*) and 1 of ($x_2_*) and 5 of ($x_1_*))) or
            ((1 of ($x_9_*) and 2 of ($x_5_*) and 1 of ($x_4_*) and 2 of ($x_2_*) and 3 of ($x_1_*))) or
            ((1 of ($x_9_*) and 2 of ($x_5_*) and 1 of ($x_4_*) and 3 of ($x_2_*) and 1 of ($x_1_*))) or
            ((1 of ($x_9_*) and 2 of ($x_5_*) and 1 of ($x_4_*) and 4 of ($x_2_*))) or
            ((1 of ($x_9_*) and 2 of ($x_5_*) and 1 of ($x_4_*) and 1 of ($x_3_*) and 4 of ($x_1_*))) or
            ((1 of ($x_9_*) and 2 of ($x_5_*) and 1 of ($x_4_*) and 1 of ($x_3_*) and 1 of ($x_2_*) and 2 of ($x_1_*))) or
            ((1 of ($x_9_*) and 2 of ($x_5_*) and 1 of ($x_4_*) and 1 of ($x_3_*) and 2 of ($x_2_*))) or
            ((1 of ($x_9_*) and 2 of ($x_5_*) and 1 of ($x_4_*) and 2 of ($x_3_*) and 1 of ($x_1_*))) or
            ((1 of ($x_9_*) and 2 of ($x_5_*) and 1 of ($x_4_*) and 2 of ($x_3_*) and 1 of ($x_2_*))) or
            ((1 of ($x_9_*) and 2 of ($x_5_*) and 1 of ($x_4_*) and 3 of ($x_3_*))) or
            ((1 of ($x_9_*) and 2 of ($x_5_*) and 2 of ($x_4_*) and 3 of ($x_1_*))) or
            ((1 of ($x_9_*) and 2 of ($x_5_*) and 2 of ($x_4_*) and 1 of ($x_2_*) and 1 of ($x_1_*))) or
            ((1 of ($x_9_*) and 2 of ($x_5_*) and 2 of ($x_4_*) and 2 of ($x_2_*))) or
            ((1 of ($x_9_*) and 2 of ($x_5_*) and 2 of ($x_4_*) and 1 of ($x_3_*))) or
            ((1 of ($x_9_*) and 2 of ($x_5_*) and 3 of ($x_4_*))) or
            ((1 of ($x_9_*) and 3 of ($x_5_*) and 6 of ($x_1_*))) or
            ((1 of ($x_9_*) and 3 of ($x_5_*) and 1 of ($x_2_*) and 4 of ($x_1_*))) or
            ((1 of ($x_9_*) and 3 of ($x_5_*) and 2 of ($x_2_*) and 2 of ($x_1_*))) or
            ((1 of ($x_9_*) and 3 of ($x_5_*) and 3 of ($x_2_*))) or
            ((1 of ($x_9_*) and 3 of ($x_5_*) and 1 of ($x_3_*) and 3 of ($x_1_*))) or
            ((1 of ($x_9_*) and 3 of ($x_5_*) and 1 of ($x_3_*) and 1 of ($x_2_*) and 1 of ($x_1_*))) or
            ((1 of ($x_9_*) and 3 of ($x_5_*) and 1 of ($x_3_*) and 2 of ($x_2_*))) or
            ((1 of ($x_9_*) and 3 of ($x_5_*) and 2 of ($x_3_*))) or
            ((1 of ($x_9_*) and 3 of ($x_5_*) and 1 of ($x_4_*) and 2 of ($x_1_*))) or
            ((1 of ($x_9_*) and 3 of ($x_5_*) and 1 of ($x_4_*) and 1 of ($x_2_*))) or
            ((1 of ($x_9_*) and 3 of ($x_5_*) and 1 of ($x_4_*) and 1 of ($x_3_*))) or
            ((1 of ($x_9_*) and 3 of ($x_5_*) and 2 of ($x_4_*))) or
            ((1 of ($x_9_*) and 4 of ($x_5_*) and 1 of ($x_1_*))) or
            ((1 of ($x_9_*) and 4 of ($x_5_*) and 1 of ($x_2_*))) or
            ((1 of ($x_9_*) and 4 of ($x_5_*) and 1 of ($x_3_*))) or
            ((1 of ($x_9_*) and 4 of ($x_5_*) and 1 of ($x_4_*))) or
            ((1 of ($x_9_*) and 5 of ($x_5_*))) or
            ((1 of ($x_9_*) and 1 of ($x_6_*) and 15 of ($x_1_*))) or
            ((1 of ($x_9_*) and 1 of ($x_6_*) and 1 of ($x_2_*) and 13 of ($x_1_*))) or
            ((1 of ($x_9_*) and 1 of ($x_6_*) and 2 of ($x_2_*) and 11 of ($x_1_*))) or
            ((1 of ($x_9_*) and 1 of ($x_6_*) and 3 of ($x_2_*) and 9 of ($x_1_*))) or
            ((1 of ($x_9_*) and 1 of ($x_6_*) and 4 of ($x_2_*) and 7 of ($x_1_*))) or
            ((1 of ($x_9_*) and 1 of ($x_6_*) and 5 of ($x_2_*) and 5 of ($x_1_*))) or
            ((1 of ($x_9_*) and 1 of ($x_6_*) and 6 of ($x_2_*) and 3 of ($x_1_*))) or
            ((1 of ($x_9_*) and 1 of ($x_6_*) and 7 of ($x_2_*) and 1 of ($x_1_*))) or
            ((1 of ($x_9_*) and 1 of ($x_6_*) and 8 of ($x_2_*))) or
            ((1 of ($x_9_*) and 1 of ($x_6_*) and 1 of ($x_3_*) and 12 of ($x_1_*))) or
            ((1 of ($x_9_*) and 1 of ($x_6_*) and 1 of ($x_3_*) and 1 of ($x_2_*) and 10 of ($x_1_*))) or
            ((1 of ($x_9_*) and 1 of ($x_6_*) and 1 of ($x_3_*) and 2 of ($x_2_*) and 8 of ($x_1_*))) or
            ((1 of ($x_9_*) and 1 of ($x_6_*) and 1 of ($x_3_*) and 3 of ($x_2_*) and 6 of ($x_1_*))) or
            ((1 of ($x_9_*) and 1 of ($x_6_*) and 1 of ($x_3_*) and 4 of ($x_2_*) and 4 of ($x_1_*))) or
            ((1 of ($x_9_*) and 1 of ($x_6_*) and 1 of ($x_3_*) and 5 of ($x_2_*) and 2 of ($x_1_*))) or
            ((1 of ($x_9_*) and 1 of ($x_6_*) and 1 of ($x_3_*) and 6 of ($x_2_*))) or
            ((1 of ($x_9_*) and 1 of ($x_6_*) and 2 of ($x_3_*) and 9 of ($x_1_*))) or
            ((1 of ($x_9_*) and 1 of ($x_6_*) and 2 of ($x_3_*) and 1 of ($x_2_*) and 7 of ($x_1_*))) or
            ((1 of ($x_9_*) and 1 of ($x_6_*) and 2 of ($x_3_*) and 2 of ($x_2_*) and 5 of ($x_1_*))) or
            ((1 of ($x_9_*) and 1 of ($x_6_*) and 2 of ($x_3_*) and 3 of ($x_2_*) and 3 of ($x_1_*))) or
            ((1 of ($x_9_*) and 1 of ($x_6_*) and 2 of ($x_3_*) and 4 of ($x_2_*) and 1 of ($x_1_*))) or
            ((1 of ($x_9_*) and 1 of ($x_6_*) and 2 of ($x_3_*) and 5 of ($x_2_*))) or
            ((1 of ($x_9_*) and 1 of ($x_6_*) and 3 of ($x_3_*) and 6 of ($x_1_*))) or
            ((1 of ($x_9_*) and 1 of ($x_6_*) and 3 of ($x_3_*) and 1 of ($x_2_*) and 4 of ($x_1_*))) or
            ((1 of ($x_9_*) and 1 of ($x_6_*) and 3 of ($x_3_*) and 2 of ($x_2_*) and 2 of ($x_1_*))) or
            ((1 of ($x_9_*) and 1 of ($x_6_*) and 3 of ($x_3_*) and 3 of ($x_2_*))) or
            ((1 of ($x_9_*) and 1 of ($x_6_*) and 4 of ($x_3_*) and 3 of ($x_1_*))) or
            ((1 of ($x_9_*) and 1 of ($x_6_*) and 4 of ($x_3_*) and 1 of ($x_2_*) and 1 of ($x_1_*))) or
            ((1 of ($x_9_*) and 1 of ($x_6_*) and 4 of ($x_3_*) and 2 of ($x_2_*))) or
            ((1 of ($x_9_*) and 1 of ($x_6_*) and 5 of ($x_3_*))) or
            ((1 of ($x_9_*) and 1 of ($x_6_*) and 1 of ($x_4_*) and 11 of ($x_1_*))) or
            ((1 of ($x_9_*) and 1 of ($x_6_*) and 1 of ($x_4_*) and 1 of ($x_2_*) and 9 of ($x_1_*))) or
            ((1 of ($x_9_*) and 1 of ($x_6_*) and 1 of ($x_4_*) and 2 of ($x_2_*) and 7 of ($x_1_*))) or
            ((1 of ($x_9_*) and 1 of ($x_6_*) and 1 of ($x_4_*) and 3 of ($x_2_*) and 5 of ($x_1_*))) or
            ((1 of ($x_9_*) and 1 of ($x_6_*) and 1 of ($x_4_*) and 4 of ($x_2_*) and 3 of ($x_1_*))) or
            ((1 of ($x_9_*) and 1 of ($x_6_*) and 1 of ($x_4_*) and 5 of ($x_2_*) and 1 of ($x_1_*))) or
            ((1 of ($x_9_*) and 1 of ($x_6_*) and 1 of ($x_4_*) and 6 of ($x_2_*))) or
            ((1 of ($x_9_*) and 1 of ($x_6_*) and 1 of ($x_4_*) and 1 of ($x_3_*) and 8 of ($x_1_*))) or
            ((1 of ($x_9_*) and 1 of ($x_6_*) and 1 of ($x_4_*) and 1 of ($x_3_*) and 1 of ($x_2_*) and 6 of ($x_1_*))) or
            ((1 of ($x_9_*) and 1 of ($x_6_*) and 1 of ($x_4_*) and 1 of ($x_3_*) and 2 of ($x_2_*) and 4 of ($x_1_*))) or
            ((1 of ($x_9_*) and 1 of ($x_6_*) and 1 of ($x_4_*) and 1 of ($x_3_*) and 3 of ($x_2_*) and 2 of ($x_1_*))) or
            ((1 of ($x_9_*) and 1 of ($x_6_*) and 1 of ($x_4_*) and 1 of ($x_3_*) and 4 of ($x_2_*))) or
            ((1 of ($x_9_*) and 1 of ($x_6_*) and 1 of ($x_4_*) and 2 of ($x_3_*) and 5 of ($x_1_*))) or
            ((1 of ($x_9_*) and 1 of ($x_6_*) and 1 of ($x_4_*) and 2 of ($x_3_*) and 1 of ($x_2_*) and 3 of ($x_1_*))) or
            ((1 of ($x_9_*) and 1 of ($x_6_*) and 1 of ($x_4_*) and 2 of ($x_3_*) and 2 of ($x_2_*) and 1 of ($x_1_*))) or
            ((1 of ($x_9_*) and 1 of ($x_6_*) and 1 of ($x_4_*) and 2 of ($x_3_*) and 3 of ($x_2_*))) or
            ((1 of ($x_9_*) and 1 of ($x_6_*) and 1 of ($x_4_*) and 3 of ($x_3_*) and 2 of ($x_1_*))) or
            ((1 of ($x_9_*) and 1 of ($x_6_*) and 1 of ($x_4_*) and 3 of ($x_3_*) and 1 of ($x_2_*))) or
            ((1 of ($x_9_*) and 1 of ($x_6_*) and 1 of ($x_4_*) and 4 of ($x_3_*))) or
            ((1 of ($x_9_*) and 1 of ($x_6_*) and 2 of ($x_4_*) and 7 of ($x_1_*))) or
            ((1 of ($x_9_*) and 1 of ($x_6_*) and 2 of ($x_4_*) and 1 of ($x_2_*) and 5 of ($x_1_*))) or
            ((1 of ($x_9_*) and 1 of ($x_6_*) and 2 of ($x_4_*) and 2 of ($x_2_*) and 3 of ($x_1_*))) or
            ((1 of ($x_9_*) and 1 of ($x_6_*) and 2 of ($x_4_*) and 3 of ($x_2_*) and 1 of ($x_1_*))) or
            ((1 of ($x_9_*) and 1 of ($x_6_*) and 2 of ($x_4_*) and 4 of ($x_2_*))) or
            ((1 of ($x_9_*) and 1 of ($x_6_*) and 2 of ($x_4_*) and 1 of ($x_3_*) and 4 of ($x_1_*))) or
            ((1 of ($x_9_*) and 1 of ($x_6_*) and 2 of ($x_4_*) and 1 of ($x_3_*) and 1 of ($x_2_*) and 2 of ($x_1_*))) or
            ((1 of ($x_9_*) and 1 of ($x_6_*) and 2 of ($x_4_*) and 1 of ($x_3_*) and 2 of ($x_2_*))) or
            ((1 of ($x_9_*) and 1 of ($x_6_*) and 2 of ($x_4_*) and 2 of ($x_3_*) and 1 of ($x_1_*))) or
            ((1 of ($x_9_*) and 1 of ($x_6_*) and 2 of ($x_4_*) and 2 of ($x_3_*) and 1 of ($x_2_*))) or
            ((1 of ($x_9_*) and 1 of ($x_6_*) and 2 of ($x_4_*) and 3 of ($x_3_*))) or
            ((1 of ($x_9_*) and 1 of ($x_6_*) and 3 of ($x_4_*) and 3 of ($x_1_*))) or
            ((1 of ($x_9_*) and 1 of ($x_6_*) and 3 of ($x_4_*) and 1 of ($x_2_*) and 1 of ($x_1_*))) or
            ((1 of ($x_9_*) and 1 of ($x_6_*) and 3 of ($x_4_*) and 2 of ($x_2_*))) or
            ((1 of ($x_9_*) and 1 of ($x_6_*) and 3 of ($x_4_*) and 1 of ($x_3_*))) or
            ((1 of ($x_9_*) and 1 of ($x_6_*) and 4 of ($x_4_*))) or
            ((1 of ($x_9_*) and 1 of ($x_6_*) and 1 of ($x_5_*) and 10 of ($x_1_*))) or
            ((1 of ($x_9_*) and 1 of ($x_6_*) and 1 of ($x_5_*) and 1 of ($x_2_*) and 8 of ($x_1_*))) or
            ((1 of ($x_9_*) and 1 of ($x_6_*) and 1 of ($x_5_*) and 2 of ($x_2_*) and 6 of ($x_1_*))) or
            ((1 of ($x_9_*) and 1 of ($x_6_*) and 1 of ($x_5_*) and 3 of ($x_2_*) and 4 of ($x_1_*))) or
            ((1 of ($x_9_*) and 1 of ($x_6_*) and 1 of ($x_5_*) and 4 of ($x_2_*) and 2 of ($x_1_*))) or
            ((1 of ($x_9_*) and 1 of ($x_6_*) and 1 of ($x_5_*) and 5 of ($x_2_*))) or
            ((1 of ($x_9_*) and 1 of ($x_6_*) and 1 of ($x_5_*) and 1 of ($x_3_*) and 7 of ($x_1_*))) or
            ((1 of ($x_9_*) and 1 of ($x_6_*) and 1 of ($x_5_*) and 1 of ($x_3_*) and 1 of ($x_2_*) and 5 of ($x_1_*))) or
            ((1 of ($x_9_*) and 1 of ($x_6_*) and 1 of ($x_5_*) and 1 of ($x_3_*) and 2 of ($x_2_*) and 3 of ($x_1_*))) or
            ((1 of ($x_9_*) and 1 of ($x_6_*) and 1 of ($x_5_*) and 1 of ($x_3_*) and 3 of ($x_2_*) and 1 of ($x_1_*))) or
            ((1 of ($x_9_*) and 1 of ($x_6_*) and 1 of ($x_5_*) and 1 of ($x_3_*) and 4 of ($x_2_*))) or
            ((1 of ($x_9_*) and 1 of ($x_6_*) and 1 of ($x_5_*) and 2 of ($x_3_*) and 4 of ($x_1_*))) or
            ((1 of ($x_9_*) and 1 of ($x_6_*) and 1 of ($x_5_*) and 2 of ($x_3_*) and 1 of ($x_2_*) and 2 of ($x_1_*))) or
            ((1 of ($x_9_*) and 1 of ($x_6_*) and 1 of ($x_5_*) and 2 of ($x_3_*) and 2 of ($x_2_*))) or
            ((1 of ($x_9_*) and 1 of ($x_6_*) and 1 of ($x_5_*) and 3 of ($x_3_*) and 1 of ($x_1_*))) or
            ((1 of ($x_9_*) and 1 of ($x_6_*) and 1 of ($x_5_*) and 3 of ($x_3_*) and 1 of ($x_2_*))) or
            ((1 of ($x_9_*) and 1 of ($x_6_*) and 1 of ($x_5_*) and 4 of ($x_3_*))) or
            ((1 of ($x_9_*) and 1 of ($x_6_*) and 1 of ($x_5_*) and 1 of ($x_4_*) and 6 of ($x_1_*))) or
            ((1 of ($x_9_*) and 1 of ($x_6_*) and 1 of ($x_5_*) and 1 of ($x_4_*) and 1 of ($x_2_*) and 4 of ($x_1_*))) or
            ((1 of ($x_9_*) and 1 of ($x_6_*) and 1 of ($x_5_*) and 1 of ($x_4_*) and 2 of ($x_2_*) and 2 of ($x_1_*))) or
            ((1 of ($x_9_*) and 1 of ($x_6_*) and 1 of ($x_5_*) and 1 of ($x_4_*) and 3 of ($x_2_*))) or
            ((1 of ($x_9_*) and 1 of ($x_6_*) and 1 of ($x_5_*) and 1 of ($x_4_*) and 1 of ($x_3_*) and 3 of ($x_1_*))) or
            ((1 of ($x_9_*) and 1 of ($x_6_*) and 1 of ($x_5_*) and 1 of ($x_4_*) and 1 of ($x_3_*) and 1 of ($x_2_*) and 1 of ($x_1_*))) or
            ((1 of ($x_9_*) and 1 of ($x_6_*) and 1 of ($x_5_*) and 1 of ($x_4_*) and 1 of ($x_3_*) and 2 of ($x_2_*))) or
            ((1 of ($x_9_*) and 1 of ($x_6_*) and 1 of ($x_5_*) and 1 of ($x_4_*) and 2 of ($x_3_*))) or
            ((1 of ($x_9_*) and 1 of ($x_6_*) and 1 of ($x_5_*) and 2 of ($x_4_*) and 2 of ($x_1_*))) or
            ((1 of ($x_9_*) and 1 of ($x_6_*) and 1 of ($x_5_*) and 2 of ($x_4_*) and 1 of ($x_2_*))) or
            ((1 of ($x_9_*) and 1 of ($x_6_*) and 1 of ($x_5_*) and 2 of ($x_4_*) and 1 of ($x_3_*))) or
            ((1 of ($x_9_*) and 1 of ($x_6_*) and 1 of ($x_5_*) and 3 of ($x_4_*))) or
            ((1 of ($x_9_*) and 1 of ($x_6_*) and 2 of ($x_5_*) and 5 of ($x_1_*))) or
            ((1 of ($x_9_*) and 1 of ($x_6_*) and 2 of ($x_5_*) and 1 of ($x_2_*) and 3 of ($x_1_*))) or
            ((1 of ($x_9_*) and 1 of ($x_6_*) and 2 of ($x_5_*) and 2 of ($x_2_*) and 1 of ($x_1_*))) or
            ((1 of ($x_9_*) and 1 of ($x_6_*) and 2 of ($x_5_*) and 3 of ($x_2_*))) or
            ((1 of ($x_9_*) and 1 of ($x_6_*) and 2 of ($x_5_*) and 1 of ($x_3_*) and 2 of ($x_1_*))) or
            ((1 of ($x_9_*) and 1 of ($x_6_*) and 2 of ($x_5_*) and 1 of ($x_3_*) and 1 of ($x_2_*))) or
            ((1 of ($x_9_*) and 1 of ($x_6_*) and 2 of ($x_5_*) and 2 of ($x_3_*))) or
            ((1 of ($x_9_*) and 1 of ($x_6_*) and 2 of ($x_5_*) and 1 of ($x_4_*) and 1 of ($x_1_*))) or
            ((1 of ($x_9_*) and 1 of ($x_6_*) and 2 of ($x_5_*) and 1 of ($x_4_*) and 1 of ($x_2_*))) or
            ((1 of ($x_9_*) and 1 of ($x_6_*) and 2 of ($x_5_*) and 1 of ($x_4_*) and 1 of ($x_3_*))) or
            ((1 of ($x_9_*) and 1 of ($x_6_*) and 2 of ($x_5_*) and 2 of ($x_4_*))) or
            ((1 of ($x_9_*) and 1 of ($x_6_*) and 3 of ($x_5_*))) or
            ((1 of ($x_9_*) and 2 of ($x_6_*) and 9 of ($x_1_*))) or
            ((1 of ($x_9_*) and 2 of ($x_6_*) and 1 of ($x_2_*) and 7 of ($x_1_*))) or
            ((1 of ($x_9_*) and 2 of ($x_6_*) and 2 of ($x_2_*) and 5 of ($x_1_*))) or
            ((1 of ($x_9_*) and 2 of ($x_6_*) and 3 of ($x_2_*) and 3 of ($x_1_*))) or
            ((1 of ($x_9_*) and 2 of ($x_6_*) and 4 of ($x_2_*) and 1 of ($x_1_*))) or
            ((1 of ($x_9_*) and 2 of ($x_6_*) and 5 of ($x_2_*))) or
            ((1 of ($x_9_*) and 2 of ($x_6_*) and 1 of ($x_3_*) and 6 of ($x_1_*))) or
            ((1 of ($x_9_*) and 2 of ($x_6_*) and 1 of ($x_3_*) and 1 of ($x_2_*) and 4 of ($x_1_*))) or
            ((1 of ($x_9_*) and 2 of ($x_6_*) and 1 of ($x_3_*) and 2 of ($x_2_*) and 2 of ($x_1_*))) or
            ((1 of ($x_9_*) and 2 of ($x_6_*) and 1 of ($x_3_*) and 3 of ($x_2_*))) or
            ((1 of ($x_9_*) and 2 of ($x_6_*) and 2 of ($x_3_*) and 3 of ($x_1_*))) or
            ((1 of ($x_9_*) and 2 of ($x_6_*) and 2 of ($x_3_*) and 1 of ($x_2_*) and 1 of ($x_1_*))) or
            ((1 of ($x_9_*) and 2 of ($x_6_*) and 2 of ($x_3_*) and 2 of ($x_2_*))) or
            ((1 of ($x_9_*) and 2 of ($x_6_*) and 3 of ($x_3_*))) or
            ((1 of ($x_9_*) and 2 of ($x_6_*) and 1 of ($x_4_*) and 5 of ($x_1_*))) or
            ((1 of ($x_9_*) and 2 of ($x_6_*) and 1 of ($x_4_*) and 1 of ($x_2_*) and 3 of ($x_1_*))) or
            ((1 of ($x_9_*) and 2 of ($x_6_*) and 1 of ($x_4_*) and 2 of ($x_2_*) and 1 of ($x_1_*))) or
            ((1 of ($x_9_*) and 2 of ($x_6_*) and 1 of ($x_4_*) and 3 of ($x_2_*))) or
            ((1 of ($x_9_*) and 2 of ($x_6_*) and 1 of ($x_4_*) and 1 of ($x_3_*) and 2 of ($x_1_*))) or
            ((1 of ($x_9_*) and 2 of ($x_6_*) and 1 of ($x_4_*) and 1 of ($x_3_*) and 1 of ($x_2_*))) or
            ((1 of ($x_9_*) and 2 of ($x_6_*) and 1 of ($x_4_*) and 2 of ($x_3_*))) or
            ((1 of ($x_9_*) and 2 of ($x_6_*) and 2 of ($x_4_*) and 1 of ($x_1_*))) or
            ((1 of ($x_9_*) and 2 of ($x_6_*) and 2 of ($x_4_*) and 1 of ($x_2_*))) or
            ((1 of ($x_9_*) and 2 of ($x_6_*) and 2 of ($x_4_*) and 1 of ($x_3_*))) or
            ((1 of ($x_9_*) and 2 of ($x_6_*) and 3 of ($x_4_*))) or
            ((1 of ($x_9_*) and 2 of ($x_6_*) and 1 of ($x_5_*) and 4 of ($x_1_*))) or
            ((1 of ($x_9_*) and 2 of ($x_6_*) and 1 of ($x_5_*) and 1 of ($x_2_*) and 2 of ($x_1_*))) or
            ((1 of ($x_9_*) and 2 of ($x_6_*) and 1 of ($x_5_*) and 2 of ($x_2_*))) or
            ((1 of ($x_9_*) and 2 of ($x_6_*) and 1 of ($x_5_*) and 1 of ($x_3_*) and 1 of ($x_1_*))) or
            ((1 of ($x_9_*) and 2 of ($x_6_*) and 1 of ($x_5_*) and 1 of ($x_3_*) and 1 of ($x_2_*))) or
            ((1 of ($x_9_*) and 2 of ($x_6_*) and 1 of ($x_5_*) and 2 of ($x_3_*))) or
            ((1 of ($x_9_*) and 2 of ($x_6_*) and 1 of ($x_5_*) and 1 of ($x_4_*))) or
            ((1 of ($x_9_*) and 2 of ($x_6_*) and 2 of ($x_5_*))) or
            ((1 of ($x_9_*) and 3 of ($x_6_*) and 3 of ($x_1_*))) or
            ((1 of ($x_9_*) and 3 of ($x_6_*) and 1 of ($x_2_*) and 1 of ($x_1_*))) or
            ((1 of ($x_9_*) and 3 of ($x_6_*) and 2 of ($x_2_*))) or
            ((1 of ($x_9_*) and 3 of ($x_6_*) and 1 of ($x_3_*))) or
            ((1 of ($x_9_*) and 3 of ($x_6_*) and 1 of ($x_4_*))) or
            ((1 of ($x_9_*) and 3 of ($x_6_*) and 1 of ($x_5_*))) or
            ((1 of ($x_10_*) and 1 of ($x_2_*) and 18 of ($x_1_*))) or
            ((1 of ($x_10_*) and 2 of ($x_2_*) and 16 of ($x_1_*))) or
            ((1 of ($x_10_*) and 3 of ($x_2_*) and 14 of ($x_1_*))) or
            ((1 of ($x_10_*) and 4 of ($x_2_*) and 12 of ($x_1_*))) or
            ((1 of ($x_10_*) and 5 of ($x_2_*) and 10 of ($x_1_*))) or
            ((1 of ($x_10_*) and 6 of ($x_2_*) and 8 of ($x_1_*))) or
            ((1 of ($x_10_*) and 7 of ($x_2_*) and 6 of ($x_1_*))) or
            ((1 of ($x_10_*) and 8 of ($x_2_*) and 4 of ($x_1_*))) or
            ((1 of ($x_10_*) and 9 of ($x_2_*) and 2 of ($x_1_*))) or
            ((1 of ($x_10_*) and 10 of ($x_2_*))) or
            ((1 of ($x_10_*) and 1 of ($x_3_*) and 17 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_3_*) and 1 of ($x_2_*) and 15 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_3_*) and 2 of ($x_2_*) and 13 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_3_*) and 3 of ($x_2_*) and 11 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_3_*) and 4 of ($x_2_*) and 9 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_3_*) and 5 of ($x_2_*) and 7 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_3_*) and 6 of ($x_2_*) and 5 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_3_*) and 7 of ($x_2_*) and 3 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_3_*) and 8 of ($x_2_*) and 1 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_3_*) and 9 of ($x_2_*))) or
            ((1 of ($x_10_*) and 2 of ($x_3_*) and 14 of ($x_1_*))) or
            ((1 of ($x_10_*) and 2 of ($x_3_*) and 1 of ($x_2_*) and 12 of ($x_1_*))) or
            ((1 of ($x_10_*) and 2 of ($x_3_*) and 2 of ($x_2_*) and 10 of ($x_1_*))) or
            ((1 of ($x_10_*) and 2 of ($x_3_*) and 3 of ($x_2_*) and 8 of ($x_1_*))) or
            ((1 of ($x_10_*) and 2 of ($x_3_*) and 4 of ($x_2_*) and 6 of ($x_1_*))) or
            ((1 of ($x_10_*) and 2 of ($x_3_*) and 5 of ($x_2_*) and 4 of ($x_1_*))) or
            ((1 of ($x_10_*) and 2 of ($x_3_*) and 6 of ($x_2_*) and 2 of ($x_1_*))) or
            ((1 of ($x_10_*) and 2 of ($x_3_*) and 7 of ($x_2_*))) or
            ((1 of ($x_10_*) and 3 of ($x_3_*) and 11 of ($x_1_*))) or
            ((1 of ($x_10_*) and 3 of ($x_3_*) and 1 of ($x_2_*) and 9 of ($x_1_*))) or
            ((1 of ($x_10_*) and 3 of ($x_3_*) and 2 of ($x_2_*) and 7 of ($x_1_*))) or
            ((1 of ($x_10_*) and 3 of ($x_3_*) and 3 of ($x_2_*) and 5 of ($x_1_*))) or
            ((1 of ($x_10_*) and 3 of ($x_3_*) and 4 of ($x_2_*) and 3 of ($x_1_*))) or
            ((1 of ($x_10_*) and 3 of ($x_3_*) and 5 of ($x_2_*) and 1 of ($x_1_*))) or
            ((1 of ($x_10_*) and 3 of ($x_3_*) and 6 of ($x_2_*))) or
            ((1 of ($x_10_*) and 4 of ($x_3_*) and 8 of ($x_1_*))) or
            ((1 of ($x_10_*) and 4 of ($x_3_*) and 1 of ($x_2_*) and 6 of ($x_1_*))) or
            ((1 of ($x_10_*) and 4 of ($x_3_*) and 2 of ($x_2_*) and 4 of ($x_1_*))) or
            ((1 of ($x_10_*) and 4 of ($x_3_*) and 3 of ($x_2_*) and 2 of ($x_1_*))) or
            ((1 of ($x_10_*) and 4 of ($x_3_*) and 4 of ($x_2_*))) or
            ((1 of ($x_10_*) and 5 of ($x_3_*) and 5 of ($x_1_*))) or
            ((1 of ($x_10_*) and 5 of ($x_3_*) and 1 of ($x_2_*) and 3 of ($x_1_*))) or
            ((1 of ($x_10_*) and 5 of ($x_3_*) and 2 of ($x_2_*) and 1 of ($x_1_*))) or
            ((1 of ($x_10_*) and 5 of ($x_3_*) and 3 of ($x_2_*))) or
            ((1 of ($x_10_*) and 6 of ($x_3_*) and 2 of ($x_1_*))) or
            ((1 of ($x_10_*) and 6 of ($x_3_*) and 1 of ($x_2_*))) or
            ((1 of ($x_10_*) and 7 of ($x_3_*))) or
            ((1 of ($x_10_*) and 1 of ($x_4_*) and 16 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_4_*) and 1 of ($x_2_*) and 14 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_4_*) and 2 of ($x_2_*) and 12 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_4_*) and 3 of ($x_2_*) and 10 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_4_*) and 4 of ($x_2_*) and 8 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_4_*) and 5 of ($x_2_*) and 6 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_4_*) and 6 of ($x_2_*) and 4 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_4_*) and 7 of ($x_2_*) and 2 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_4_*) and 8 of ($x_2_*))) or
            ((1 of ($x_10_*) and 1 of ($x_4_*) and 1 of ($x_3_*) and 13 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_4_*) and 1 of ($x_3_*) and 1 of ($x_2_*) and 11 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_4_*) and 1 of ($x_3_*) and 2 of ($x_2_*) and 9 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_4_*) and 1 of ($x_3_*) and 3 of ($x_2_*) and 7 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_4_*) and 1 of ($x_3_*) and 4 of ($x_2_*) and 5 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_4_*) and 1 of ($x_3_*) and 5 of ($x_2_*) and 3 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_4_*) and 1 of ($x_3_*) and 6 of ($x_2_*) and 1 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_4_*) and 1 of ($x_3_*) and 7 of ($x_2_*))) or
            ((1 of ($x_10_*) and 1 of ($x_4_*) and 2 of ($x_3_*) and 10 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_4_*) and 2 of ($x_3_*) and 1 of ($x_2_*) and 8 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_4_*) and 2 of ($x_3_*) and 2 of ($x_2_*) and 6 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_4_*) and 2 of ($x_3_*) and 3 of ($x_2_*) and 4 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_4_*) and 2 of ($x_3_*) and 4 of ($x_2_*) and 2 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_4_*) and 2 of ($x_3_*) and 5 of ($x_2_*))) or
            ((1 of ($x_10_*) and 1 of ($x_4_*) and 3 of ($x_3_*) and 7 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_4_*) and 3 of ($x_3_*) and 1 of ($x_2_*) and 5 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_4_*) and 3 of ($x_3_*) and 2 of ($x_2_*) and 3 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_4_*) and 3 of ($x_3_*) and 3 of ($x_2_*) and 1 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_4_*) and 3 of ($x_3_*) and 4 of ($x_2_*))) or
            ((1 of ($x_10_*) and 1 of ($x_4_*) and 4 of ($x_3_*) and 4 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_4_*) and 4 of ($x_3_*) and 1 of ($x_2_*) and 2 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_4_*) and 4 of ($x_3_*) and 2 of ($x_2_*))) or
            ((1 of ($x_10_*) and 1 of ($x_4_*) and 5 of ($x_3_*) and 1 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_4_*) and 5 of ($x_3_*) and 1 of ($x_2_*))) or
            ((1 of ($x_10_*) and 1 of ($x_4_*) and 6 of ($x_3_*))) or
            ((1 of ($x_10_*) and 2 of ($x_4_*) and 12 of ($x_1_*))) or
            ((1 of ($x_10_*) and 2 of ($x_4_*) and 1 of ($x_2_*) and 10 of ($x_1_*))) or
            ((1 of ($x_10_*) and 2 of ($x_4_*) and 2 of ($x_2_*) and 8 of ($x_1_*))) or
            ((1 of ($x_10_*) and 2 of ($x_4_*) and 3 of ($x_2_*) and 6 of ($x_1_*))) or
            ((1 of ($x_10_*) and 2 of ($x_4_*) and 4 of ($x_2_*) and 4 of ($x_1_*))) or
            ((1 of ($x_10_*) and 2 of ($x_4_*) and 5 of ($x_2_*) and 2 of ($x_1_*))) or
            ((1 of ($x_10_*) and 2 of ($x_4_*) and 6 of ($x_2_*))) or
            ((1 of ($x_10_*) and 2 of ($x_4_*) and 1 of ($x_3_*) and 9 of ($x_1_*))) or
            ((1 of ($x_10_*) and 2 of ($x_4_*) and 1 of ($x_3_*) and 1 of ($x_2_*) and 7 of ($x_1_*))) or
            ((1 of ($x_10_*) and 2 of ($x_4_*) and 1 of ($x_3_*) and 2 of ($x_2_*) and 5 of ($x_1_*))) or
            ((1 of ($x_10_*) and 2 of ($x_4_*) and 1 of ($x_3_*) and 3 of ($x_2_*) and 3 of ($x_1_*))) or
            ((1 of ($x_10_*) and 2 of ($x_4_*) and 1 of ($x_3_*) and 4 of ($x_2_*) and 1 of ($x_1_*))) or
            ((1 of ($x_10_*) and 2 of ($x_4_*) and 1 of ($x_3_*) and 5 of ($x_2_*))) or
            ((1 of ($x_10_*) and 2 of ($x_4_*) and 2 of ($x_3_*) and 6 of ($x_1_*))) or
            ((1 of ($x_10_*) and 2 of ($x_4_*) and 2 of ($x_3_*) and 1 of ($x_2_*) and 4 of ($x_1_*))) or
            ((1 of ($x_10_*) and 2 of ($x_4_*) and 2 of ($x_3_*) and 2 of ($x_2_*) and 2 of ($x_1_*))) or
            ((1 of ($x_10_*) and 2 of ($x_4_*) and 2 of ($x_3_*) and 3 of ($x_2_*))) or
            ((1 of ($x_10_*) and 2 of ($x_4_*) and 3 of ($x_3_*) and 3 of ($x_1_*))) or
            ((1 of ($x_10_*) and 2 of ($x_4_*) and 3 of ($x_3_*) and 1 of ($x_2_*) and 1 of ($x_1_*))) or
            ((1 of ($x_10_*) and 2 of ($x_4_*) and 3 of ($x_3_*) and 2 of ($x_2_*))) or
            ((1 of ($x_10_*) and 2 of ($x_4_*) and 4 of ($x_3_*))) or
            ((1 of ($x_10_*) and 3 of ($x_4_*) and 8 of ($x_1_*))) or
            ((1 of ($x_10_*) and 3 of ($x_4_*) and 1 of ($x_2_*) and 6 of ($x_1_*))) or
            ((1 of ($x_10_*) and 3 of ($x_4_*) and 2 of ($x_2_*) and 4 of ($x_1_*))) or
            ((1 of ($x_10_*) and 3 of ($x_4_*) and 3 of ($x_2_*) and 2 of ($x_1_*))) or
            ((1 of ($x_10_*) and 3 of ($x_4_*) and 4 of ($x_2_*))) or
            ((1 of ($x_10_*) and 3 of ($x_4_*) and 1 of ($x_3_*) and 5 of ($x_1_*))) or
            ((1 of ($x_10_*) and 3 of ($x_4_*) and 1 of ($x_3_*) and 1 of ($x_2_*) and 3 of ($x_1_*))) or
            ((1 of ($x_10_*) and 3 of ($x_4_*) and 1 of ($x_3_*) and 2 of ($x_2_*) and 1 of ($x_1_*))) or
            ((1 of ($x_10_*) and 3 of ($x_4_*) and 1 of ($x_3_*) and 3 of ($x_2_*))) or
            ((1 of ($x_10_*) and 3 of ($x_4_*) and 2 of ($x_3_*) and 2 of ($x_1_*))) or
            ((1 of ($x_10_*) and 3 of ($x_4_*) and 2 of ($x_3_*) and 1 of ($x_2_*))) or
            ((1 of ($x_10_*) and 3 of ($x_4_*) and 3 of ($x_3_*))) or
            ((1 of ($x_10_*) and 4 of ($x_4_*) and 4 of ($x_1_*))) or
            ((1 of ($x_10_*) and 4 of ($x_4_*) and 1 of ($x_2_*) and 2 of ($x_1_*))) or
            ((1 of ($x_10_*) and 4 of ($x_4_*) and 2 of ($x_2_*))) or
            ((1 of ($x_10_*) and 4 of ($x_4_*) and 1 of ($x_3_*) and 1 of ($x_1_*))) or
            ((1 of ($x_10_*) and 4 of ($x_4_*) and 1 of ($x_3_*) and 1 of ($x_2_*))) or
            ((1 of ($x_10_*) and 4 of ($x_4_*) and 2 of ($x_3_*))) or
            ((1 of ($x_10_*) and 5 of ($x_4_*))) or
            ((1 of ($x_10_*) and 1 of ($x_5_*) and 15 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_5_*) and 1 of ($x_2_*) and 13 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_5_*) and 2 of ($x_2_*) and 11 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_5_*) and 3 of ($x_2_*) and 9 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_5_*) and 4 of ($x_2_*) and 7 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_5_*) and 5 of ($x_2_*) and 5 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_5_*) and 6 of ($x_2_*) and 3 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_5_*) and 7 of ($x_2_*) and 1 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_5_*) and 8 of ($x_2_*))) or
            ((1 of ($x_10_*) and 1 of ($x_5_*) and 1 of ($x_3_*) and 12 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_5_*) and 1 of ($x_3_*) and 1 of ($x_2_*) and 10 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_5_*) and 1 of ($x_3_*) and 2 of ($x_2_*) and 8 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_5_*) and 1 of ($x_3_*) and 3 of ($x_2_*) and 6 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_5_*) and 1 of ($x_3_*) and 4 of ($x_2_*) and 4 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_5_*) and 1 of ($x_3_*) and 5 of ($x_2_*) and 2 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_5_*) and 1 of ($x_3_*) and 6 of ($x_2_*))) or
            ((1 of ($x_10_*) and 1 of ($x_5_*) and 2 of ($x_3_*) and 9 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_5_*) and 2 of ($x_3_*) and 1 of ($x_2_*) and 7 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_5_*) and 2 of ($x_3_*) and 2 of ($x_2_*) and 5 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_5_*) and 2 of ($x_3_*) and 3 of ($x_2_*) and 3 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_5_*) and 2 of ($x_3_*) and 4 of ($x_2_*) and 1 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_5_*) and 2 of ($x_3_*) and 5 of ($x_2_*))) or
            ((1 of ($x_10_*) and 1 of ($x_5_*) and 3 of ($x_3_*) and 6 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_5_*) and 3 of ($x_3_*) and 1 of ($x_2_*) and 4 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_5_*) and 3 of ($x_3_*) and 2 of ($x_2_*) and 2 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_5_*) and 3 of ($x_3_*) and 3 of ($x_2_*))) or
            ((1 of ($x_10_*) and 1 of ($x_5_*) and 4 of ($x_3_*) and 3 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_5_*) and 4 of ($x_3_*) and 1 of ($x_2_*) and 1 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_5_*) and 4 of ($x_3_*) and 2 of ($x_2_*))) or
            ((1 of ($x_10_*) and 1 of ($x_5_*) and 5 of ($x_3_*))) or
            ((1 of ($x_10_*) and 1 of ($x_5_*) and 1 of ($x_4_*) and 11 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_5_*) and 1 of ($x_4_*) and 1 of ($x_2_*) and 9 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_5_*) and 1 of ($x_4_*) and 2 of ($x_2_*) and 7 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_5_*) and 1 of ($x_4_*) and 3 of ($x_2_*) and 5 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_5_*) and 1 of ($x_4_*) and 4 of ($x_2_*) and 3 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_5_*) and 1 of ($x_4_*) and 5 of ($x_2_*) and 1 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_5_*) and 1 of ($x_4_*) and 6 of ($x_2_*))) or
            ((1 of ($x_10_*) and 1 of ($x_5_*) and 1 of ($x_4_*) and 1 of ($x_3_*) and 8 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_5_*) and 1 of ($x_4_*) and 1 of ($x_3_*) and 1 of ($x_2_*) and 6 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_5_*) and 1 of ($x_4_*) and 1 of ($x_3_*) and 2 of ($x_2_*) and 4 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_5_*) and 1 of ($x_4_*) and 1 of ($x_3_*) and 3 of ($x_2_*) and 2 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_5_*) and 1 of ($x_4_*) and 1 of ($x_3_*) and 4 of ($x_2_*))) or
            ((1 of ($x_10_*) and 1 of ($x_5_*) and 1 of ($x_4_*) and 2 of ($x_3_*) and 5 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_5_*) and 1 of ($x_4_*) and 2 of ($x_3_*) and 1 of ($x_2_*) and 3 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_5_*) and 1 of ($x_4_*) and 2 of ($x_3_*) and 2 of ($x_2_*) and 1 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_5_*) and 1 of ($x_4_*) and 2 of ($x_3_*) and 3 of ($x_2_*))) or
            ((1 of ($x_10_*) and 1 of ($x_5_*) and 1 of ($x_4_*) and 3 of ($x_3_*) and 2 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_5_*) and 1 of ($x_4_*) and 3 of ($x_3_*) and 1 of ($x_2_*))) or
            ((1 of ($x_10_*) and 1 of ($x_5_*) and 1 of ($x_4_*) and 4 of ($x_3_*))) or
            ((1 of ($x_10_*) and 1 of ($x_5_*) and 2 of ($x_4_*) and 7 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_5_*) and 2 of ($x_4_*) and 1 of ($x_2_*) and 5 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_5_*) and 2 of ($x_4_*) and 2 of ($x_2_*) and 3 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_5_*) and 2 of ($x_4_*) and 3 of ($x_2_*) and 1 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_5_*) and 2 of ($x_4_*) and 4 of ($x_2_*))) or
            ((1 of ($x_10_*) and 1 of ($x_5_*) and 2 of ($x_4_*) and 1 of ($x_3_*) and 4 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_5_*) and 2 of ($x_4_*) and 1 of ($x_3_*) and 1 of ($x_2_*) and 2 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_5_*) and 2 of ($x_4_*) and 1 of ($x_3_*) and 2 of ($x_2_*))) or
            ((1 of ($x_10_*) and 1 of ($x_5_*) and 2 of ($x_4_*) and 2 of ($x_3_*) and 1 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_5_*) and 2 of ($x_4_*) and 2 of ($x_3_*) and 1 of ($x_2_*))) or
            ((1 of ($x_10_*) and 1 of ($x_5_*) and 2 of ($x_4_*) and 3 of ($x_3_*))) or
            ((1 of ($x_10_*) and 1 of ($x_5_*) and 3 of ($x_4_*) and 3 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_5_*) and 3 of ($x_4_*) and 1 of ($x_2_*) and 1 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_5_*) and 3 of ($x_4_*) and 2 of ($x_2_*))) or
            ((1 of ($x_10_*) and 1 of ($x_5_*) and 3 of ($x_4_*) and 1 of ($x_3_*))) or
            ((1 of ($x_10_*) and 1 of ($x_5_*) and 4 of ($x_4_*))) or
            ((1 of ($x_10_*) and 2 of ($x_5_*) and 10 of ($x_1_*))) or
            ((1 of ($x_10_*) and 2 of ($x_5_*) and 1 of ($x_2_*) and 8 of ($x_1_*))) or
            ((1 of ($x_10_*) and 2 of ($x_5_*) and 2 of ($x_2_*) and 6 of ($x_1_*))) or
            ((1 of ($x_10_*) and 2 of ($x_5_*) and 3 of ($x_2_*) and 4 of ($x_1_*))) or
            ((1 of ($x_10_*) and 2 of ($x_5_*) and 4 of ($x_2_*) and 2 of ($x_1_*))) or
            ((1 of ($x_10_*) and 2 of ($x_5_*) and 5 of ($x_2_*))) or
            ((1 of ($x_10_*) and 2 of ($x_5_*) and 1 of ($x_3_*) and 7 of ($x_1_*))) or
            ((1 of ($x_10_*) and 2 of ($x_5_*) and 1 of ($x_3_*) and 1 of ($x_2_*) and 5 of ($x_1_*))) or
            ((1 of ($x_10_*) and 2 of ($x_5_*) and 1 of ($x_3_*) and 2 of ($x_2_*) and 3 of ($x_1_*))) or
            ((1 of ($x_10_*) and 2 of ($x_5_*) and 1 of ($x_3_*) and 3 of ($x_2_*) and 1 of ($x_1_*))) or
            ((1 of ($x_10_*) and 2 of ($x_5_*) and 1 of ($x_3_*) and 4 of ($x_2_*))) or
            ((1 of ($x_10_*) and 2 of ($x_5_*) and 2 of ($x_3_*) and 4 of ($x_1_*))) or
            ((1 of ($x_10_*) and 2 of ($x_5_*) and 2 of ($x_3_*) and 1 of ($x_2_*) and 2 of ($x_1_*))) or
            ((1 of ($x_10_*) and 2 of ($x_5_*) and 2 of ($x_3_*) and 2 of ($x_2_*))) or
            ((1 of ($x_10_*) and 2 of ($x_5_*) and 3 of ($x_3_*) and 1 of ($x_1_*))) or
            ((1 of ($x_10_*) and 2 of ($x_5_*) and 3 of ($x_3_*) and 1 of ($x_2_*))) or
            ((1 of ($x_10_*) and 2 of ($x_5_*) and 4 of ($x_3_*))) or
            ((1 of ($x_10_*) and 2 of ($x_5_*) and 1 of ($x_4_*) and 6 of ($x_1_*))) or
            ((1 of ($x_10_*) and 2 of ($x_5_*) and 1 of ($x_4_*) and 1 of ($x_2_*) and 4 of ($x_1_*))) or
            ((1 of ($x_10_*) and 2 of ($x_5_*) and 1 of ($x_4_*) and 2 of ($x_2_*) and 2 of ($x_1_*))) or
            ((1 of ($x_10_*) and 2 of ($x_5_*) and 1 of ($x_4_*) and 3 of ($x_2_*))) or
            ((1 of ($x_10_*) and 2 of ($x_5_*) and 1 of ($x_4_*) and 1 of ($x_3_*) and 3 of ($x_1_*))) or
            ((1 of ($x_10_*) and 2 of ($x_5_*) and 1 of ($x_4_*) and 1 of ($x_3_*) and 1 of ($x_2_*) and 1 of ($x_1_*))) or
            ((1 of ($x_10_*) and 2 of ($x_5_*) and 1 of ($x_4_*) and 1 of ($x_3_*) and 2 of ($x_2_*))) or
            ((1 of ($x_10_*) and 2 of ($x_5_*) and 1 of ($x_4_*) and 2 of ($x_3_*))) or
            ((1 of ($x_10_*) and 2 of ($x_5_*) and 2 of ($x_4_*) and 2 of ($x_1_*))) or
            ((1 of ($x_10_*) and 2 of ($x_5_*) and 2 of ($x_4_*) and 1 of ($x_2_*))) or
            ((1 of ($x_10_*) and 2 of ($x_5_*) and 2 of ($x_4_*) and 1 of ($x_3_*))) or
            ((1 of ($x_10_*) and 2 of ($x_5_*) and 3 of ($x_4_*))) or
            ((1 of ($x_10_*) and 3 of ($x_5_*) and 5 of ($x_1_*))) or
            ((1 of ($x_10_*) and 3 of ($x_5_*) and 1 of ($x_2_*) and 3 of ($x_1_*))) or
            ((1 of ($x_10_*) and 3 of ($x_5_*) and 2 of ($x_2_*) and 1 of ($x_1_*))) or
            ((1 of ($x_10_*) and 3 of ($x_5_*) and 3 of ($x_2_*))) or
            ((1 of ($x_10_*) and 3 of ($x_5_*) and 1 of ($x_3_*) and 2 of ($x_1_*))) or
            ((1 of ($x_10_*) and 3 of ($x_5_*) and 1 of ($x_3_*) and 1 of ($x_2_*))) or
            ((1 of ($x_10_*) and 3 of ($x_5_*) and 2 of ($x_3_*))) or
            ((1 of ($x_10_*) and 3 of ($x_5_*) and 1 of ($x_4_*) and 1 of ($x_1_*))) or
            ((1 of ($x_10_*) and 3 of ($x_5_*) and 1 of ($x_4_*) and 1 of ($x_2_*))) or
            ((1 of ($x_10_*) and 3 of ($x_5_*) and 1 of ($x_4_*) and 1 of ($x_3_*))) or
            ((1 of ($x_10_*) and 3 of ($x_5_*) and 2 of ($x_4_*))) or
            ((1 of ($x_10_*) and 4 of ($x_5_*))) or
            ((1 of ($x_10_*) and 1 of ($x_6_*) and 14 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_6_*) and 1 of ($x_2_*) and 12 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_6_*) and 2 of ($x_2_*) and 10 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_6_*) and 3 of ($x_2_*) and 8 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_6_*) and 4 of ($x_2_*) and 6 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_6_*) and 5 of ($x_2_*) and 4 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_6_*) and 6 of ($x_2_*) and 2 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_6_*) and 7 of ($x_2_*))) or
            ((1 of ($x_10_*) and 1 of ($x_6_*) and 1 of ($x_3_*) and 11 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_6_*) and 1 of ($x_3_*) and 1 of ($x_2_*) and 9 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_6_*) and 1 of ($x_3_*) and 2 of ($x_2_*) and 7 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_6_*) and 1 of ($x_3_*) and 3 of ($x_2_*) and 5 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_6_*) and 1 of ($x_3_*) and 4 of ($x_2_*) and 3 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_6_*) and 1 of ($x_3_*) and 5 of ($x_2_*) and 1 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_6_*) and 1 of ($x_3_*) and 6 of ($x_2_*))) or
            ((1 of ($x_10_*) and 1 of ($x_6_*) and 2 of ($x_3_*) and 8 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_6_*) and 2 of ($x_3_*) and 1 of ($x_2_*) and 6 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_6_*) and 2 of ($x_3_*) and 2 of ($x_2_*) and 4 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_6_*) and 2 of ($x_3_*) and 3 of ($x_2_*) and 2 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_6_*) and 2 of ($x_3_*) and 4 of ($x_2_*))) or
            ((1 of ($x_10_*) and 1 of ($x_6_*) and 3 of ($x_3_*) and 5 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_6_*) and 3 of ($x_3_*) and 1 of ($x_2_*) and 3 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_6_*) and 3 of ($x_3_*) and 2 of ($x_2_*) and 1 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_6_*) and 3 of ($x_3_*) and 3 of ($x_2_*))) or
            ((1 of ($x_10_*) and 1 of ($x_6_*) and 4 of ($x_3_*) and 2 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_6_*) and 4 of ($x_3_*) and 1 of ($x_2_*))) or
            ((1 of ($x_10_*) and 1 of ($x_6_*) and 5 of ($x_3_*))) or
            ((1 of ($x_10_*) and 1 of ($x_6_*) and 1 of ($x_4_*) and 10 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_6_*) and 1 of ($x_4_*) and 1 of ($x_2_*) and 8 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_6_*) and 1 of ($x_4_*) and 2 of ($x_2_*) and 6 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_6_*) and 1 of ($x_4_*) and 3 of ($x_2_*) and 4 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_6_*) and 1 of ($x_4_*) and 4 of ($x_2_*) and 2 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_6_*) and 1 of ($x_4_*) and 5 of ($x_2_*))) or
            ((1 of ($x_10_*) and 1 of ($x_6_*) and 1 of ($x_4_*) and 1 of ($x_3_*) and 7 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_6_*) and 1 of ($x_4_*) and 1 of ($x_3_*) and 1 of ($x_2_*) and 5 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_6_*) and 1 of ($x_4_*) and 1 of ($x_3_*) and 2 of ($x_2_*) and 3 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_6_*) and 1 of ($x_4_*) and 1 of ($x_3_*) and 3 of ($x_2_*) and 1 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_6_*) and 1 of ($x_4_*) and 1 of ($x_3_*) and 4 of ($x_2_*))) or
            ((1 of ($x_10_*) and 1 of ($x_6_*) and 1 of ($x_4_*) and 2 of ($x_3_*) and 4 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_6_*) and 1 of ($x_4_*) and 2 of ($x_3_*) and 1 of ($x_2_*) and 2 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_6_*) and 1 of ($x_4_*) and 2 of ($x_3_*) and 2 of ($x_2_*))) or
            ((1 of ($x_10_*) and 1 of ($x_6_*) and 1 of ($x_4_*) and 3 of ($x_3_*) and 1 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_6_*) and 1 of ($x_4_*) and 3 of ($x_3_*) and 1 of ($x_2_*))) or
            ((1 of ($x_10_*) and 1 of ($x_6_*) and 1 of ($x_4_*) and 4 of ($x_3_*))) or
            ((1 of ($x_10_*) and 1 of ($x_6_*) and 2 of ($x_4_*) and 6 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_6_*) and 2 of ($x_4_*) and 1 of ($x_2_*) and 4 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_6_*) and 2 of ($x_4_*) and 2 of ($x_2_*) and 2 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_6_*) and 2 of ($x_4_*) and 3 of ($x_2_*))) or
            ((1 of ($x_10_*) and 1 of ($x_6_*) and 2 of ($x_4_*) and 1 of ($x_3_*) and 3 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_6_*) and 2 of ($x_4_*) and 1 of ($x_3_*) and 1 of ($x_2_*) and 1 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_6_*) and 2 of ($x_4_*) and 1 of ($x_3_*) and 2 of ($x_2_*))) or
            ((1 of ($x_10_*) and 1 of ($x_6_*) and 2 of ($x_4_*) and 2 of ($x_3_*))) or
            ((1 of ($x_10_*) and 1 of ($x_6_*) and 3 of ($x_4_*) and 2 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_6_*) and 3 of ($x_4_*) and 1 of ($x_2_*))) or
            ((1 of ($x_10_*) and 1 of ($x_6_*) and 3 of ($x_4_*) and 1 of ($x_3_*))) or
            ((1 of ($x_10_*) and 1 of ($x_6_*) and 4 of ($x_4_*))) or
            ((1 of ($x_10_*) and 1 of ($x_6_*) and 1 of ($x_5_*) and 9 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_6_*) and 1 of ($x_5_*) and 1 of ($x_2_*) and 7 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_6_*) and 1 of ($x_5_*) and 2 of ($x_2_*) and 5 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_6_*) and 1 of ($x_5_*) and 3 of ($x_2_*) and 3 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_6_*) and 1 of ($x_5_*) and 4 of ($x_2_*) and 1 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_6_*) and 1 of ($x_5_*) and 5 of ($x_2_*))) or
            ((1 of ($x_10_*) and 1 of ($x_6_*) and 1 of ($x_5_*) and 1 of ($x_3_*) and 6 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_6_*) and 1 of ($x_5_*) and 1 of ($x_3_*) and 1 of ($x_2_*) and 4 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_6_*) and 1 of ($x_5_*) and 1 of ($x_3_*) and 2 of ($x_2_*) and 2 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_6_*) and 1 of ($x_5_*) and 1 of ($x_3_*) and 3 of ($x_2_*))) or
            ((1 of ($x_10_*) and 1 of ($x_6_*) and 1 of ($x_5_*) and 2 of ($x_3_*) and 3 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_6_*) and 1 of ($x_5_*) and 2 of ($x_3_*) and 1 of ($x_2_*) and 1 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_6_*) and 1 of ($x_5_*) and 2 of ($x_3_*) and 2 of ($x_2_*))) or
            ((1 of ($x_10_*) and 1 of ($x_6_*) and 1 of ($x_5_*) and 3 of ($x_3_*))) or
            ((1 of ($x_10_*) and 1 of ($x_6_*) and 1 of ($x_5_*) and 1 of ($x_4_*) and 5 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_6_*) and 1 of ($x_5_*) and 1 of ($x_4_*) and 1 of ($x_2_*) and 3 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_6_*) and 1 of ($x_5_*) and 1 of ($x_4_*) and 2 of ($x_2_*) and 1 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_6_*) and 1 of ($x_5_*) and 1 of ($x_4_*) and 3 of ($x_2_*))) or
            ((1 of ($x_10_*) and 1 of ($x_6_*) and 1 of ($x_5_*) and 1 of ($x_4_*) and 1 of ($x_3_*) and 2 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_6_*) and 1 of ($x_5_*) and 1 of ($x_4_*) and 1 of ($x_3_*) and 1 of ($x_2_*))) or
            ((1 of ($x_10_*) and 1 of ($x_6_*) and 1 of ($x_5_*) and 1 of ($x_4_*) and 2 of ($x_3_*))) or
            ((1 of ($x_10_*) and 1 of ($x_6_*) and 1 of ($x_5_*) and 2 of ($x_4_*) and 1 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_6_*) and 1 of ($x_5_*) and 2 of ($x_4_*) and 1 of ($x_2_*))) or
            ((1 of ($x_10_*) and 1 of ($x_6_*) and 1 of ($x_5_*) and 2 of ($x_4_*) and 1 of ($x_3_*))) or
            ((1 of ($x_10_*) and 1 of ($x_6_*) and 1 of ($x_5_*) and 3 of ($x_4_*))) or
            ((1 of ($x_10_*) and 1 of ($x_6_*) and 2 of ($x_5_*) and 4 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_6_*) and 2 of ($x_5_*) and 1 of ($x_2_*) and 2 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_6_*) and 2 of ($x_5_*) and 2 of ($x_2_*))) or
            ((1 of ($x_10_*) and 1 of ($x_6_*) and 2 of ($x_5_*) and 1 of ($x_3_*) and 1 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_6_*) and 2 of ($x_5_*) and 1 of ($x_3_*) and 1 of ($x_2_*))) or
            ((1 of ($x_10_*) and 1 of ($x_6_*) and 2 of ($x_5_*) and 2 of ($x_3_*))) or
            ((1 of ($x_10_*) and 1 of ($x_6_*) and 2 of ($x_5_*) and 1 of ($x_4_*))) or
            ((1 of ($x_10_*) and 1 of ($x_6_*) and 3 of ($x_5_*))) or
            ((1 of ($x_10_*) and 2 of ($x_6_*) and 8 of ($x_1_*))) or
            ((1 of ($x_10_*) and 2 of ($x_6_*) and 1 of ($x_2_*) and 6 of ($x_1_*))) or
            ((1 of ($x_10_*) and 2 of ($x_6_*) and 2 of ($x_2_*) and 4 of ($x_1_*))) or
            ((1 of ($x_10_*) and 2 of ($x_6_*) and 3 of ($x_2_*) and 2 of ($x_1_*))) or
            ((1 of ($x_10_*) and 2 of ($x_6_*) and 4 of ($x_2_*))) or
            ((1 of ($x_10_*) and 2 of ($x_6_*) and 1 of ($x_3_*) and 5 of ($x_1_*))) or
            ((1 of ($x_10_*) and 2 of ($x_6_*) and 1 of ($x_3_*) and 1 of ($x_2_*) and 3 of ($x_1_*))) or
            ((1 of ($x_10_*) and 2 of ($x_6_*) and 1 of ($x_3_*) and 2 of ($x_2_*) and 1 of ($x_1_*))) or
            ((1 of ($x_10_*) and 2 of ($x_6_*) and 1 of ($x_3_*) and 3 of ($x_2_*))) or
            ((1 of ($x_10_*) and 2 of ($x_6_*) and 2 of ($x_3_*) and 2 of ($x_1_*))) or
            ((1 of ($x_10_*) and 2 of ($x_6_*) and 2 of ($x_3_*) and 1 of ($x_2_*))) or
            ((1 of ($x_10_*) and 2 of ($x_6_*) and 3 of ($x_3_*))) or
            ((1 of ($x_10_*) and 2 of ($x_6_*) and 1 of ($x_4_*) and 4 of ($x_1_*))) or
            ((1 of ($x_10_*) and 2 of ($x_6_*) and 1 of ($x_4_*) and 1 of ($x_2_*) and 2 of ($x_1_*))) or
            ((1 of ($x_10_*) and 2 of ($x_6_*) and 1 of ($x_4_*) and 2 of ($x_2_*))) or
            ((1 of ($x_10_*) and 2 of ($x_6_*) and 1 of ($x_4_*) and 1 of ($x_3_*) and 1 of ($x_1_*))) or
            ((1 of ($x_10_*) and 2 of ($x_6_*) and 1 of ($x_4_*) and 1 of ($x_3_*) and 1 of ($x_2_*))) or
            ((1 of ($x_10_*) and 2 of ($x_6_*) and 1 of ($x_4_*) and 2 of ($x_3_*))) or
            ((1 of ($x_10_*) and 2 of ($x_6_*) and 2 of ($x_4_*))) or
            ((1 of ($x_10_*) and 2 of ($x_6_*) and 1 of ($x_5_*) and 3 of ($x_1_*))) or
            ((1 of ($x_10_*) and 2 of ($x_6_*) and 1 of ($x_5_*) and 1 of ($x_2_*) and 1 of ($x_1_*))) or
            ((1 of ($x_10_*) and 2 of ($x_6_*) and 1 of ($x_5_*) and 2 of ($x_2_*))) or
            ((1 of ($x_10_*) and 2 of ($x_6_*) and 1 of ($x_5_*) and 1 of ($x_3_*))) or
            ((1 of ($x_10_*) and 2 of ($x_6_*) and 1 of ($x_5_*) and 1 of ($x_4_*))) or
            ((1 of ($x_10_*) and 2 of ($x_6_*) and 2 of ($x_5_*))) or
            ((1 of ($x_10_*) and 3 of ($x_6_*) and 2 of ($x_1_*))) or
            ((1 of ($x_10_*) and 3 of ($x_6_*) and 1 of ($x_2_*))) or
            ((1 of ($x_10_*) and 3 of ($x_6_*) and 1 of ($x_3_*))) or
            ((1 of ($x_10_*) and 3 of ($x_6_*) and 1 of ($x_4_*))) or
            ((1 of ($x_10_*) and 3 of ($x_6_*) and 1 of ($x_5_*))) or
            ((1 of ($x_10_*) and 1 of ($x_9_*) and 11 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_9_*) and 1 of ($x_2_*) and 9 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_9_*) and 2 of ($x_2_*) and 7 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_9_*) and 3 of ($x_2_*) and 5 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_9_*) and 4 of ($x_2_*) and 3 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_9_*) and 5 of ($x_2_*) and 1 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_9_*) and 6 of ($x_2_*))) or
            ((1 of ($x_10_*) and 1 of ($x_9_*) and 1 of ($x_3_*) and 8 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_9_*) and 1 of ($x_3_*) and 1 of ($x_2_*) and 6 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_9_*) and 1 of ($x_3_*) and 2 of ($x_2_*) and 4 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_9_*) and 1 of ($x_3_*) and 3 of ($x_2_*) and 2 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_9_*) and 1 of ($x_3_*) and 4 of ($x_2_*))) or
            ((1 of ($x_10_*) and 1 of ($x_9_*) and 2 of ($x_3_*) and 5 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_9_*) and 2 of ($x_3_*) and 1 of ($x_2_*) and 3 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_9_*) and 2 of ($x_3_*) and 2 of ($x_2_*) and 1 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_9_*) and 2 of ($x_3_*) and 3 of ($x_2_*))) or
            ((1 of ($x_10_*) and 1 of ($x_9_*) and 3 of ($x_3_*) and 2 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_9_*) and 3 of ($x_3_*) and 1 of ($x_2_*))) or
            ((1 of ($x_10_*) and 1 of ($x_9_*) and 4 of ($x_3_*))) or
            ((1 of ($x_10_*) and 1 of ($x_9_*) and 1 of ($x_4_*) and 7 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_9_*) and 1 of ($x_4_*) and 1 of ($x_2_*) and 5 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_9_*) and 1 of ($x_4_*) and 2 of ($x_2_*) and 3 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_9_*) and 1 of ($x_4_*) and 3 of ($x_2_*) and 1 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_9_*) and 1 of ($x_4_*) and 4 of ($x_2_*))) or
            ((1 of ($x_10_*) and 1 of ($x_9_*) and 1 of ($x_4_*) and 1 of ($x_3_*) and 4 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_9_*) and 1 of ($x_4_*) and 1 of ($x_3_*) and 1 of ($x_2_*) and 2 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_9_*) and 1 of ($x_4_*) and 1 of ($x_3_*) and 2 of ($x_2_*))) or
            ((1 of ($x_10_*) and 1 of ($x_9_*) and 1 of ($x_4_*) and 2 of ($x_3_*) and 1 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_9_*) and 1 of ($x_4_*) and 2 of ($x_3_*) and 1 of ($x_2_*))) or
            ((1 of ($x_10_*) and 1 of ($x_9_*) and 1 of ($x_4_*) and 3 of ($x_3_*))) or
            ((1 of ($x_10_*) and 1 of ($x_9_*) and 2 of ($x_4_*) and 3 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_9_*) and 2 of ($x_4_*) and 1 of ($x_2_*) and 1 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_9_*) and 2 of ($x_4_*) and 2 of ($x_2_*))) or
            ((1 of ($x_10_*) and 1 of ($x_9_*) and 2 of ($x_4_*) and 1 of ($x_3_*))) or
            ((1 of ($x_10_*) and 1 of ($x_9_*) and 3 of ($x_4_*))) or
            ((1 of ($x_10_*) and 1 of ($x_9_*) and 1 of ($x_5_*) and 6 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_9_*) and 1 of ($x_5_*) and 1 of ($x_2_*) and 4 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_9_*) and 1 of ($x_5_*) and 2 of ($x_2_*) and 2 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_9_*) and 1 of ($x_5_*) and 3 of ($x_2_*))) or
            ((1 of ($x_10_*) and 1 of ($x_9_*) and 1 of ($x_5_*) and 1 of ($x_3_*) and 3 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_9_*) and 1 of ($x_5_*) and 1 of ($x_3_*) and 1 of ($x_2_*) and 1 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_9_*) and 1 of ($x_5_*) and 1 of ($x_3_*) and 2 of ($x_2_*))) or
            ((1 of ($x_10_*) and 1 of ($x_9_*) and 1 of ($x_5_*) and 2 of ($x_3_*))) or
            ((1 of ($x_10_*) and 1 of ($x_9_*) and 1 of ($x_5_*) and 1 of ($x_4_*) and 2 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_9_*) and 1 of ($x_5_*) and 1 of ($x_4_*) and 1 of ($x_2_*))) or
            ((1 of ($x_10_*) and 1 of ($x_9_*) and 1 of ($x_5_*) and 1 of ($x_4_*) and 1 of ($x_3_*))) or
            ((1 of ($x_10_*) and 1 of ($x_9_*) and 1 of ($x_5_*) and 2 of ($x_4_*))) or
            ((1 of ($x_10_*) and 1 of ($x_9_*) and 2 of ($x_5_*) and 1 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_9_*) and 2 of ($x_5_*) and 1 of ($x_2_*))) or
            ((1 of ($x_10_*) and 1 of ($x_9_*) and 2 of ($x_5_*) and 1 of ($x_3_*))) or
            ((1 of ($x_10_*) and 1 of ($x_9_*) and 2 of ($x_5_*) and 1 of ($x_4_*))) or
            ((1 of ($x_10_*) and 1 of ($x_9_*) and 3 of ($x_5_*))) or
            ((1 of ($x_10_*) and 1 of ($x_9_*) and 1 of ($x_6_*) and 5 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_9_*) and 1 of ($x_6_*) and 1 of ($x_2_*) and 3 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_9_*) and 1 of ($x_6_*) and 2 of ($x_2_*) and 1 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_9_*) and 1 of ($x_6_*) and 3 of ($x_2_*))) or
            ((1 of ($x_10_*) and 1 of ($x_9_*) and 1 of ($x_6_*) and 1 of ($x_3_*) and 2 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_9_*) and 1 of ($x_6_*) and 1 of ($x_3_*) and 1 of ($x_2_*))) or
            ((1 of ($x_10_*) and 1 of ($x_9_*) and 1 of ($x_6_*) and 2 of ($x_3_*))) or
            ((1 of ($x_10_*) and 1 of ($x_9_*) and 1 of ($x_6_*) and 1 of ($x_4_*) and 1 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_9_*) and 1 of ($x_6_*) and 1 of ($x_4_*) and 1 of ($x_2_*))) or
            ((1 of ($x_10_*) and 1 of ($x_9_*) and 1 of ($x_6_*) and 1 of ($x_4_*) and 1 of ($x_3_*))) or
            ((1 of ($x_10_*) and 1 of ($x_9_*) and 1 of ($x_6_*) and 2 of ($x_4_*))) or
            ((1 of ($x_10_*) and 1 of ($x_9_*) and 1 of ($x_6_*) and 1 of ($x_5_*))) or
            ((1 of ($x_10_*) and 1 of ($x_9_*) and 2 of ($x_6_*))) or
            ((2 of ($x_10_*) and 10 of ($x_1_*))) or
            ((2 of ($x_10_*) and 1 of ($x_2_*) and 8 of ($x_1_*))) or
            ((2 of ($x_10_*) and 2 of ($x_2_*) and 6 of ($x_1_*))) or
            ((2 of ($x_10_*) and 3 of ($x_2_*) and 4 of ($x_1_*))) or
            ((2 of ($x_10_*) and 4 of ($x_2_*) and 2 of ($x_1_*))) or
            ((2 of ($x_10_*) and 5 of ($x_2_*))) or
            ((2 of ($x_10_*) and 1 of ($x_3_*) and 7 of ($x_1_*))) or
            ((2 of ($x_10_*) and 1 of ($x_3_*) and 1 of ($x_2_*) and 5 of ($x_1_*))) or
            ((2 of ($x_10_*) and 1 of ($x_3_*) and 2 of ($x_2_*) and 3 of ($x_1_*))) or
            ((2 of ($x_10_*) and 1 of ($x_3_*) and 3 of ($x_2_*) and 1 of ($x_1_*))) or
            ((2 of ($x_10_*) and 1 of ($x_3_*) and 4 of ($x_2_*))) or
            ((2 of ($x_10_*) and 2 of ($x_3_*) and 4 of ($x_1_*))) or
            ((2 of ($x_10_*) and 2 of ($x_3_*) and 1 of ($x_2_*) and 2 of ($x_1_*))) or
            ((2 of ($x_10_*) and 2 of ($x_3_*) and 2 of ($x_2_*))) or
            ((2 of ($x_10_*) and 3 of ($x_3_*) and 1 of ($x_1_*))) or
            ((2 of ($x_10_*) and 3 of ($x_3_*) and 1 of ($x_2_*))) or
            ((2 of ($x_10_*) and 4 of ($x_3_*))) or
            ((2 of ($x_10_*) and 1 of ($x_4_*) and 6 of ($x_1_*))) or
            ((2 of ($x_10_*) and 1 of ($x_4_*) and 1 of ($x_2_*) and 4 of ($x_1_*))) or
            ((2 of ($x_10_*) and 1 of ($x_4_*) and 2 of ($x_2_*) and 2 of ($x_1_*))) or
            ((2 of ($x_10_*) and 1 of ($x_4_*) and 3 of ($x_2_*))) or
            ((2 of ($x_10_*) and 1 of ($x_4_*) and 1 of ($x_3_*) and 3 of ($x_1_*))) or
            ((2 of ($x_10_*) and 1 of ($x_4_*) and 1 of ($x_3_*) and 1 of ($x_2_*) and 1 of ($x_1_*))) or
            ((2 of ($x_10_*) and 1 of ($x_4_*) and 1 of ($x_3_*) and 2 of ($x_2_*))) or
            ((2 of ($x_10_*) and 1 of ($x_4_*) and 2 of ($x_3_*))) or
            ((2 of ($x_10_*) and 2 of ($x_4_*) and 2 of ($x_1_*))) or
            ((2 of ($x_10_*) and 2 of ($x_4_*) and 1 of ($x_2_*))) or
            ((2 of ($x_10_*) and 2 of ($x_4_*) and 1 of ($x_3_*))) or
            ((2 of ($x_10_*) and 3 of ($x_4_*))) or
            ((2 of ($x_10_*) and 1 of ($x_5_*) and 5 of ($x_1_*))) or
            ((2 of ($x_10_*) and 1 of ($x_5_*) and 1 of ($x_2_*) and 3 of ($x_1_*))) or
            ((2 of ($x_10_*) and 1 of ($x_5_*) and 2 of ($x_2_*) and 1 of ($x_1_*))) or
            ((2 of ($x_10_*) and 1 of ($x_5_*) and 3 of ($x_2_*))) or
            ((2 of ($x_10_*) and 1 of ($x_5_*) and 1 of ($x_3_*) and 2 of ($x_1_*))) or
            ((2 of ($x_10_*) and 1 of ($x_5_*) and 1 of ($x_3_*) and 1 of ($x_2_*))) or
            ((2 of ($x_10_*) and 1 of ($x_5_*) and 2 of ($x_3_*))) or
            ((2 of ($x_10_*) and 1 of ($x_5_*) and 1 of ($x_4_*) and 1 of ($x_1_*))) or
            ((2 of ($x_10_*) and 1 of ($x_5_*) and 1 of ($x_4_*) and 1 of ($x_2_*))) or
            ((2 of ($x_10_*) and 1 of ($x_5_*) and 1 of ($x_4_*) and 1 of ($x_3_*))) or
            ((2 of ($x_10_*) and 1 of ($x_5_*) and 2 of ($x_4_*))) or
            ((2 of ($x_10_*) and 2 of ($x_5_*))) or
            ((2 of ($x_10_*) and 1 of ($x_6_*) and 4 of ($x_1_*))) or
            ((2 of ($x_10_*) and 1 of ($x_6_*) and 1 of ($x_2_*) and 2 of ($x_1_*))) or
            ((2 of ($x_10_*) and 1 of ($x_6_*) and 2 of ($x_2_*))) or
            ((2 of ($x_10_*) and 1 of ($x_6_*) and 1 of ($x_3_*) and 1 of ($x_1_*))) or
            ((2 of ($x_10_*) and 1 of ($x_6_*) and 1 of ($x_3_*) and 1 of ($x_2_*))) or
            ((2 of ($x_10_*) and 1 of ($x_6_*) and 2 of ($x_3_*))) or
            ((2 of ($x_10_*) and 1 of ($x_6_*) and 1 of ($x_4_*))) or
            ((2 of ($x_10_*) and 1 of ($x_6_*) and 1 of ($x_5_*))) or
            ((2 of ($x_10_*) and 2 of ($x_6_*))) or
            ((2 of ($x_10_*) and 1 of ($x_9_*) and 1 of ($x_1_*))) or
            ((2 of ($x_10_*) and 1 of ($x_9_*) and 1 of ($x_2_*))) or
            ((2 of ($x_10_*) and 1 of ($x_9_*) and 1 of ($x_3_*))) or
            ((2 of ($x_10_*) and 1 of ($x_9_*) and 1 of ($x_4_*))) or
            ((2 of ($x_10_*) and 1 of ($x_9_*) and 1 of ($x_5_*))) or
            ((2 of ($x_10_*) and 1 of ($x_9_*) and 1 of ($x_6_*))) or
            ((3 of ($x_10_*))) or
            ((1 of ($x_20_*) and 10 of ($x_1_*))) or
            ((1 of ($x_20_*) and 1 of ($x_2_*) and 8 of ($x_1_*))) or
            ((1 of ($x_20_*) and 2 of ($x_2_*) and 6 of ($x_1_*))) or
            ((1 of ($x_20_*) and 3 of ($x_2_*) and 4 of ($x_1_*))) or
            ((1 of ($x_20_*) and 4 of ($x_2_*) and 2 of ($x_1_*))) or
            ((1 of ($x_20_*) and 5 of ($x_2_*))) or
            ((1 of ($x_20_*) and 1 of ($x_3_*) and 7 of ($x_1_*))) or
            ((1 of ($x_20_*) and 1 of ($x_3_*) and 1 of ($x_2_*) and 5 of ($x_1_*))) or
            ((1 of ($x_20_*) and 1 of ($x_3_*) and 2 of ($x_2_*) and 3 of ($x_1_*))) or
            ((1 of ($x_20_*) and 1 of ($x_3_*) and 3 of ($x_2_*) and 1 of ($x_1_*))) or
            ((1 of ($x_20_*) and 1 of ($x_3_*) and 4 of ($x_2_*))) or
            ((1 of ($x_20_*) and 2 of ($x_3_*) and 4 of ($x_1_*))) or
            ((1 of ($x_20_*) and 2 of ($x_3_*) and 1 of ($x_2_*) and 2 of ($x_1_*))) or
            ((1 of ($x_20_*) and 2 of ($x_3_*) and 2 of ($x_2_*))) or
            ((1 of ($x_20_*) and 3 of ($x_3_*) and 1 of ($x_1_*))) or
            ((1 of ($x_20_*) and 3 of ($x_3_*) and 1 of ($x_2_*))) or
            ((1 of ($x_20_*) and 4 of ($x_3_*))) or
            ((1 of ($x_20_*) and 1 of ($x_4_*) and 6 of ($x_1_*))) or
            ((1 of ($x_20_*) and 1 of ($x_4_*) and 1 of ($x_2_*) and 4 of ($x_1_*))) or
            ((1 of ($x_20_*) and 1 of ($x_4_*) and 2 of ($x_2_*) and 2 of ($x_1_*))) or
            ((1 of ($x_20_*) and 1 of ($x_4_*) and 3 of ($x_2_*))) or
            ((1 of ($x_20_*) and 1 of ($x_4_*) and 1 of ($x_3_*) and 3 of ($x_1_*))) or
            ((1 of ($x_20_*) and 1 of ($x_4_*) and 1 of ($x_3_*) and 1 of ($x_2_*) and 1 of ($x_1_*))) or
            ((1 of ($x_20_*) and 1 of ($x_4_*) and 1 of ($x_3_*) and 2 of ($x_2_*))) or
            ((1 of ($x_20_*) and 1 of ($x_4_*) and 2 of ($x_3_*))) or
            ((1 of ($x_20_*) and 2 of ($x_4_*) and 2 of ($x_1_*))) or
            ((1 of ($x_20_*) and 2 of ($x_4_*) and 1 of ($x_2_*))) or
            ((1 of ($x_20_*) and 2 of ($x_4_*) and 1 of ($x_3_*))) or
            ((1 of ($x_20_*) and 3 of ($x_4_*))) or
            ((1 of ($x_20_*) and 1 of ($x_5_*) and 5 of ($x_1_*))) or
            ((1 of ($x_20_*) and 1 of ($x_5_*) and 1 of ($x_2_*) and 3 of ($x_1_*))) or
            ((1 of ($x_20_*) and 1 of ($x_5_*) and 2 of ($x_2_*) and 1 of ($x_1_*))) or
            ((1 of ($x_20_*) and 1 of ($x_5_*) and 3 of ($x_2_*))) or
            ((1 of ($x_20_*) and 1 of ($x_5_*) and 1 of ($x_3_*) and 2 of ($x_1_*))) or
            ((1 of ($x_20_*) and 1 of ($x_5_*) and 1 of ($x_3_*) and 1 of ($x_2_*))) or
            ((1 of ($x_20_*) and 1 of ($x_5_*) and 2 of ($x_3_*))) or
            ((1 of ($x_20_*) and 1 of ($x_5_*) and 1 of ($x_4_*) and 1 of ($x_1_*))) or
            ((1 of ($x_20_*) and 1 of ($x_5_*) and 1 of ($x_4_*) and 1 of ($x_2_*))) or
            ((1 of ($x_20_*) and 1 of ($x_5_*) and 1 of ($x_4_*) and 1 of ($x_3_*))) or
            ((1 of ($x_20_*) and 1 of ($x_5_*) and 2 of ($x_4_*))) or
            ((1 of ($x_20_*) and 2 of ($x_5_*))) or
            ((1 of ($x_20_*) and 1 of ($x_6_*) and 4 of ($x_1_*))) or
            ((1 of ($x_20_*) and 1 of ($x_6_*) and 1 of ($x_2_*) and 2 of ($x_1_*))) or
            ((1 of ($x_20_*) and 1 of ($x_6_*) and 2 of ($x_2_*))) or
            ((1 of ($x_20_*) and 1 of ($x_6_*) and 1 of ($x_3_*) and 1 of ($x_1_*))) or
            ((1 of ($x_20_*) and 1 of ($x_6_*) and 1 of ($x_3_*) and 1 of ($x_2_*))) or
            ((1 of ($x_20_*) and 1 of ($x_6_*) and 2 of ($x_3_*))) or
            ((1 of ($x_20_*) and 1 of ($x_6_*) and 1 of ($x_4_*))) or
            ((1 of ($x_20_*) and 1 of ($x_6_*) and 1 of ($x_5_*))) or
            ((1 of ($x_20_*) and 2 of ($x_6_*))) or
            ((1 of ($x_20_*) and 1 of ($x_9_*) and 1 of ($x_1_*))) or
            ((1 of ($x_20_*) and 1 of ($x_9_*) and 1 of ($x_2_*))) or
            ((1 of ($x_20_*) and 1 of ($x_9_*) and 1 of ($x_3_*))) or
            ((1 of ($x_20_*) and 1 of ($x_9_*) and 1 of ($x_4_*))) or
            ((1 of ($x_20_*) and 1 of ($x_9_*) and 1 of ($x_5_*))) or
            ((1 of ($x_20_*) and 1 of ($x_9_*) and 1 of ($x_6_*))) or
            ((1 of ($x_20_*) and 1 of ($x_10_*))) or
            ((2 of ($x_20_*))) or
            (all of ($x*))
        )
}

rule DialXLite_0
{
    meta:
        author = "defender2yara"
        detection_name = "DialXLite"
        threat_id = "17496"
        severity = "Critical"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "10"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\RecentDocs" ascii //weight: 1
        $x_1_2 = "Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\RunMRU" ascii //weight: 1
        $x_1_3 = "Software\\Microsoft\\Internet Explorer\\TypedURLs" ascii //weight: 1
        $x_5_4 = "DIALXLITE-" ascii //weight: 5
        $x_3_5 = {63 61 70 69 00 00 00 00 69 6e 74 65 72 6e 65 74 00 00 00 00 70 70 70 00 45 74 68 65 72 6e 65 74 00 00 00 00 44 53 4c 00 69 73 64 6e 00 00 00 00 6d 6f 64 65 6d}  //weight: 3, accuracy: High
        $x_2_6 = "bersenter.cgi" ascii //weight: 2
        $x_2_7 = "/c C:\\exe.exe" ascii //weight: 2
        $x_3_8 = "http://www.dialerclub.com" ascii //weight: 3
        $x_3_9 = "09090240094" ascii //weight: 3
        $x_3_10 = "09099653121" ascii //weight: 3
        $x_3_11 = "1-2-3-COOK" ascii //weight: 3
        $x_6_12 = "Best Porno Netzwerk" ascii //weight: 6
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_3_*) and 2 of ($x_2_*) and 3 of ($x_1_*))) or
            ((2 of ($x_3_*) and 1 of ($x_2_*) and 2 of ($x_1_*))) or
            ((2 of ($x_3_*) and 2 of ($x_2_*))) or
            ((3 of ($x_3_*) and 1 of ($x_1_*))) or
            ((3 of ($x_3_*) and 1 of ($x_2_*))) or
            ((4 of ($x_3_*))) or
            ((1 of ($x_5_*) and 1 of ($x_2_*) and 3 of ($x_1_*))) or
            ((1 of ($x_5_*) and 2 of ($x_2_*) and 1 of ($x_1_*))) or
            ((1 of ($x_5_*) and 1 of ($x_3_*) and 2 of ($x_1_*))) or
            ((1 of ($x_5_*) and 1 of ($x_3_*) and 1 of ($x_2_*))) or
            ((1 of ($x_5_*) and 2 of ($x_3_*))) or
            ((1 of ($x_6_*) and 1 of ($x_2_*) and 2 of ($x_1_*))) or
            ((1 of ($x_6_*) and 2 of ($x_2_*))) or
            ((1 of ($x_6_*) and 1 of ($x_3_*) and 1 of ($x_1_*))) or
            ((1 of ($x_6_*) and 1 of ($x_3_*) and 1 of ($x_2_*))) or
            ((1 of ($x_6_*) and 2 of ($x_3_*))) or
            ((1 of ($x_6_*) and 1 of ($x_5_*))) or
            (all of ($x*))
        )
}

rule Riprova_0
{
    meta:
        author = "defender2yara"
        detection_name = "Riprova"
        threat_id = "17497"
        severity = "Critical"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "13"
        strings_accuracy = "High"
    strings:
        $x_5_1 = {52 69 70 72 6f 76 61 2e 2e 2e 00 25 64 00}  //weight: 5, accuracy: High
        $x_4_2 = "C:\\\\sgrunt" ascii //weight: 4
        $x_4_3 = "disinstalla.htm" ascii //weight: 4
        $x_3_4 = "IE4321.exe" ascii //weight: 3
        $x_4_5 = "www.sgrunt.biz/" ascii //weight: 4
    condition:
        (filesize < 20MB) and
        (
            ((3 of ($x_4_*) and 1 of ($x_3_*))) or
            ((1 of ($x_5_*) and 2 of ($x_4_*))) or
            (all of ($x*))
        )
}

rule Riprova_1
{
    meta:
        author = "defender2yara"
        detection_name = "Riprova"
        threat_id = "17497"
        severity = "Critical"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "11"
        strings_accuracy = "High"
    strings:
        $x_5_1 = {52 69 70 72 6f 76 61 2e 2e 2e 00 25 64 00}  //weight: 5, accuracy: High
        $x_4_2 = "\\version\\NvsvSys.exe" ascii //weight: 4
        $x_4_3 = {52 45 53 4f 55 52 00 6f 70 65 6e 00}  //weight: 4, accuracy: High
        $x_3_4 = {54 6f 20 75 6e 69 6e 73 74 61 6c 6c 20 70 6c 65 61 73 65 20 73 65 6e 64 20 61 6e 20 65 6d 61 69 6c 20 61 74 20 74 68 69 73 20 61 64 64 72 65 73 73 3a 0a 0d 00}  //weight: 3, accuracy: High
        $x_5_5 = "uninstall@securize.biz" ascii //weight: 5
    condition:
        (filesize < 20MB) and
        (
            ((2 of ($x_4_*) and 1 of ($x_3_*))) or
            ((1 of ($x_5_*) and 1 of ($x_4_*) and 1 of ($x_3_*))) or
            ((1 of ($x_5_*) and 2 of ($x_4_*))) or
            ((2 of ($x_5_*) and 1 of ($x_3_*))) or
            ((2 of ($x_5_*) and 1 of ($x_4_*))) or
            (all of ($x*))
        )
}

rule Riprova_2
{
    meta:
        author = "defender2yara"
        detection_name = "Riprova"
        threat_id = "17497"
        severity = "Critical"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "10"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\User Agent\\Post Platform" ascii //weight: 2
        $x_2_2 = {64 69 61 6c 6e 6f 00}  //weight: 2, accuracy: High
        $x_2_3 = {7c 64 69 61 6c 00}  //weight: 2, accuracy: High
        $x_6_4 = {52 69 70 72 6f 76 61 2e 2e 2e 00 25 64 00}  //weight: 6, accuracy: High
        $x_1_5 = "Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\ZoneMap\\Domains\\" ascii //weight: 1
        $x_2_6 = "Sgrunt|V" ascii //weight: 2
        $x_4_7 = "SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\TTunim" ascii //weight: 4
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_4_*) and 3 of ($x_2_*))) or
            ((1 of ($x_6_*) and 2 of ($x_2_*))) or
            ((1 of ($x_6_*) and 1 of ($x_4_*))) or
            (all of ($x*))
        )
}

rule Riprova_3
{
    meta:
        author = "defender2yara"
        detection_name = "Riprova"
        threat_id = "17497"
        severity = "Critical"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "16"
        strings_accuracy = "High"
    strings:
        $x_4_1 = "C&lose Help and Internet" ascii //weight: 4
        $x_4_2 = ".com/index2.php" ascii //weight: 4
        $x_2_3 = "archiviosex.com" ascii //weight: 2
        $x_2_4 = "archiviohard.com" ascii //weight: 2
        $x_4_5 = "Password di Accesso Contenuti Privati" ascii //weight: 4
        $x_4_6 = "Ti sei disconnesso, vuoi ricollegarti ?" ascii //weight: 4
        $x_3_7 = "c:\\pass" ascii //weight: 3
        $x_5_8 = {52 69 70 72 6f 76 61 2e 2e 2e 00 25 64 00}  //weight: 5, accuracy: High
        $x_3_9 = {69 73 64 6e 00 00 00 00 6d 6f 64 65 6d 00 00}  //weight: 3, accuracy: High
        $x_1_10 = "RasHangUpA" ascii //weight: 1
        $x_1_11 = "RasDialA" ascii //weight: 1
        $x_1_12 = "RasGetConnectStatusA" ascii //weight: 1
        $x_4_13 = {64 69 61 6c 6e 6f 00}  //weight: 4, accuracy: High
        $x_4_14 = "snprtz|" ascii //weight: 4
        $x_3_15 = "You have been disconnected, do you want to reconnect?" ascii //weight: 3
    condition:
        (filesize < 20MB) and
        (
            ((3 of ($x_3_*) and 2 of ($x_2_*) and 3 of ($x_1_*))) or
            ((1 of ($x_4_*) and 2 of ($x_3_*) and 2 of ($x_2_*) and 2 of ($x_1_*))) or
            ((1 of ($x_4_*) and 3 of ($x_3_*) and 3 of ($x_1_*))) or
            ((1 of ($x_4_*) and 3 of ($x_3_*) and 1 of ($x_2_*) and 1 of ($x_1_*))) or
            ((1 of ($x_4_*) and 3 of ($x_3_*) and 2 of ($x_2_*))) or
            ((2 of ($x_4_*) and 1 of ($x_3_*) and 1 of ($x_2_*) and 3 of ($x_1_*))) or
            ((2 of ($x_4_*) and 1 of ($x_3_*) and 2 of ($x_2_*) and 1 of ($x_1_*))) or
            ((2 of ($x_4_*) and 2 of ($x_3_*) and 2 of ($x_1_*))) or
            ((2 of ($x_4_*) and 2 of ($x_3_*) and 1 of ($x_2_*))) or
            ((2 of ($x_4_*) and 3 of ($x_3_*))) or
            ((3 of ($x_4_*) and 1 of ($x_2_*) and 2 of ($x_1_*))) or
            ((3 of ($x_4_*) and 2 of ($x_2_*))) or
            ((3 of ($x_4_*) and 1 of ($x_3_*) and 1 of ($x_1_*))) or
            ((3 of ($x_4_*) and 1 of ($x_3_*) and 1 of ($x_2_*))) or
            ((3 of ($x_4_*) and 2 of ($x_3_*))) or
            ((4 of ($x_4_*))) or
            ((1 of ($x_5_*) and 2 of ($x_3_*) and 1 of ($x_2_*) and 3 of ($x_1_*))) or
            ((1 of ($x_5_*) and 2 of ($x_3_*) and 2 of ($x_2_*) and 1 of ($x_1_*))) or
            ((1 of ($x_5_*) and 3 of ($x_3_*) and 2 of ($x_1_*))) or
            ((1 of ($x_5_*) and 3 of ($x_3_*) and 1 of ($x_2_*))) or
            ((1 of ($x_5_*) and 1 of ($x_4_*) and 2 of ($x_2_*) and 3 of ($x_1_*))) or
            ((1 of ($x_5_*) and 1 of ($x_4_*) and 1 of ($x_3_*) and 1 of ($x_2_*) and 2 of ($x_1_*))) or
            ((1 of ($x_5_*) and 1 of ($x_4_*) and 1 of ($x_3_*) and 2 of ($x_2_*))) or
            ((1 of ($x_5_*) and 1 of ($x_4_*) and 2 of ($x_3_*) and 1 of ($x_1_*))) or
            ((1 of ($x_5_*) and 1 of ($x_4_*) and 2 of ($x_3_*) and 1 of ($x_2_*))) or
            ((1 of ($x_5_*) and 1 of ($x_4_*) and 3 of ($x_3_*))) or
            ((1 of ($x_5_*) and 2 of ($x_4_*) and 3 of ($x_1_*))) or
            ((1 of ($x_5_*) and 2 of ($x_4_*) and 1 of ($x_2_*) and 1 of ($x_1_*))) or
            ((1 of ($x_5_*) and 2 of ($x_4_*) and 2 of ($x_2_*))) or
            ((1 of ($x_5_*) and 2 of ($x_4_*) and 1 of ($x_3_*))) or
            ((1 of ($x_5_*) and 3 of ($x_4_*))) or
            (all of ($x*))
        )
}

rule Riprova_4
{
    meta:
        author = "defender2yara"
        detection_name = "Riprova"
        threat_id = "17497"
        severity = "Critical"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "21"
        strings_accuracy = "Low"
    strings:
        $x_4_1 = "Connessione Predefinita" ascii //weight: 4
        $x_4_2 = "Cliccando SI sarai collegato a trecento" ascii //weight: 4
        $x_4_3 = "eurocent al minuto e navigherai all'interno dei contenuti" ascii //weight: 4
        $x_3_4 = "Ti sei disconnesso, vuoi ricollegarti ?" ascii //weight: 3
        $x_1_5 = "Non e' possibile procedere" ascii //weight: 1
        $x_5_6 = {6f 77 73 5c 43 75 72 72 65 6e 74 56 65 72 73 69 6f 6e 5c 49 6e 74 65 72 6e 65 74 20 53 65 74 74 69 6e 67 73 5c 5a 6f 6e 65 4d 61 70 5c 44 6f 6d 61 69 6e 73 5c [0-24] 5c 77 77 77 00}  //weight: 5, accuracy: Low
        $x_3_7 = "archiviosex.net" ascii //weight: 3
        $x_3_8 = "sexvideopro.com" ascii //weight: 3
        $x_3_9 = "snprtz" ascii //weight: 3
        $x_10_10 = {52 69 70 72 6f 76 61 2e 2e 2e 00 25 64 00}  //weight: 10, accuracy: High
        $x_2_11 = {64 69 61 6c 6e 6f 00}  //weight: 2, accuracy: High
        $x_4_12 = "/ccRandom/?" ascii //weight: 4
        $x_4_13 = "/members/index2.php?" ascii //weight: 4
        $x_4_14 = {2e 6c 6e 6b 00 [0-48] 5c 4d 69 63 72 6f 73 6f 66 74 5c 49 6e 74 65 72 6e 65 74 20 45 78 70 6c 6f 72 65 72 5c 51 75 69 63 6b 20 4c 61 75 6e 63 68 5c 00}  //weight: 4, accuracy: Low
        $x_2_15 = {62 75 74 74 6f 6e 00 53 49 00 4e 4f 00 54 61 68 6f 6d 61 00}  //weight: 2, accuracy: High
        $x_3_16 = {69 73 64 6e 00 00 00 00 6d 6f 64 65 6d 00 00}  //weight: 3, accuracy: High
        $x_1_17 = "RasHangUpA" ascii //weight: 1
        $x_1_18 = "RasDialA" ascii //weight: 1
        $x_1_19 = "RasGetConnectStatusA" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((5 of ($x_3_*) and 1 of ($x_2_*) and 4 of ($x_1_*))) or
            ((5 of ($x_3_*) and 2 of ($x_2_*) and 2 of ($x_1_*))) or
            ((1 of ($x_4_*) and 3 of ($x_3_*) and 2 of ($x_2_*) and 4 of ($x_1_*))) or
            ((1 of ($x_4_*) and 4 of ($x_3_*) and 1 of ($x_2_*) and 3 of ($x_1_*))) or
            ((1 of ($x_4_*) and 4 of ($x_3_*) and 2 of ($x_2_*) and 1 of ($x_1_*))) or
            ((1 of ($x_4_*) and 5 of ($x_3_*) and 2 of ($x_1_*))) or
            ((1 of ($x_4_*) and 5 of ($x_3_*) and 1 of ($x_2_*))) or
            ((2 of ($x_4_*) and 2 of ($x_3_*) and 2 of ($x_2_*) and 3 of ($x_1_*))) or
            ((2 of ($x_4_*) and 3 of ($x_3_*) and 4 of ($x_1_*))) or
            ((2 of ($x_4_*) and 3 of ($x_3_*) and 1 of ($x_2_*) and 2 of ($x_1_*))) or
            ((2 of ($x_4_*) and 3 of ($x_3_*) and 2 of ($x_2_*))) or
            ((2 of ($x_4_*) and 4 of ($x_3_*) and 1 of ($x_1_*))) or
            ((2 of ($x_4_*) and 4 of ($x_3_*) and 1 of ($x_2_*))) or
            ((2 of ($x_4_*) and 5 of ($x_3_*))) or
            ((3 of ($x_4_*) and 1 of ($x_3_*) and 1 of ($x_2_*) and 4 of ($x_1_*))) or
            ((3 of ($x_4_*) and 1 of ($x_3_*) and 2 of ($x_2_*) and 2 of ($x_1_*))) or
            ((3 of ($x_4_*) and 2 of ($x_3_*) and 3 of ($x_1_*))) or
            ((3 of ($x_4_*) and 2 of ($x_3_*) and 1 of ($x_2_*) and 1 of ($x_1_*))) or
            ((3 of ($x_4_*) and 2 of ($x_3_*) and 2 of ($x_2_*))) or
            ((3 of ($x_4_*) and 3 of ($x_3_*))) or
            ((4 of ($x_4_*) and 1 of ($x_2_*) and 3 of ($x_1_*))) or
            ((4 of ($x_4_*) and 2 of ($x_2_*) and 1 of ($x_1_*))) or
            ((4 of ($x_4_*) and 1 of ($x_3_*) and 2 of ($x_1_*))) or
            ((4 of ($x_4_*) and 1 of ($x_3_*) and 1 of ($x_2_*))) or
            ((4 of ($x_4_*) and 2 of ($x_3_*))) or
            ((5 of ($x_4_*) and 1 of ($x_1_*))) or
            ((5 of ($x_4_*) and 1 of ($x_2_*))) or
            ((5 of ($x_4_*) and 1 of ($x_3_*))) or
            ((6 of ($x_4_*))) or
            ((1 of ($x_5_*) and 3 of ($x_3_*) and 2 of ($x_2_*) and 3 of ($x_1_*))) or
            ((1 of ($x_5_*) and 4 of ($x_3_*) and 4 of ($x_1_*))) or
            ((1 of ($x_5_*) and 4 of ($x_3_*) and 1 of ($x_2_*) and 2 of ($x_1_*))) or
            ((1 of ($x_5_*) and 4 of ($x_3_*) and 2 of ($x_2_*))) or
            ((1 of ($x_5_*) and 5 of ($x_3_*) and 1 of ($x_1_*))) or
            ((1 of ($x_5_*) and 5 of ($x_3_*) and 1 of ($x_2_*))) or
            ((1 of ($x_5_*) and 1 of ($x_4_*) and 2 of ($x_3_*) and 1 of ($x_2_*) and 4 of ($x_1_*))) or
            ((1 of ($x_5_*) and 1 of ($x_4_*) and 2 of ($x_3_*) and 2 of ($x_2_*) and 2 of ($x_1_*))) or
            ((1 of ($x_5_*) and 1 of ($x_4_*) and 3 of ($x_3_*) and 3 of ($x_1_*))) or
            ((1 of ($x_5_*) and 1 of ($x_4_*) and 3 of ($x_3_*) and 1 of ($x_2_*) and 1 of ($x_1_*))) or
            ((1 of ($x_5_*) and 1 of ($x_4_*) and 3 of ($x_3_*) and 2 of ($x_2_*))) or
            ((1 of ($x_5_*) and 1 of ($x_4_*) and 4 of ($x_3_*))) or
            ((1 of ($x_5_*) and 2 of ($x_4_*) and 2 of ($x_2_*) and 4 of ($x_1_*))) or
            ((1 of ($x_5_*) and 2 of ($x_4_*) and 1 of ($x_3_*) and 1 of ($x_2_*) and 3 of ($x_1_*))) or
            ((1 of ($x_5_*) and 2 of ($x_4_*) and 1 of ($x_3_*) and 2 of ($x_2_*) and 1 of ($x_1_*))) or
            ((1 of ($x_5_*) and 2 of ($x_4_*) and 2 of ($x_3_*) and 2 of ($x_1_*))) or
            ((1 of ($x_5_*) and 2 of ($x_4_*) and 2 of ($x_3_*) and 1 of ($x_2_*))) or
            ((1 of ($x_5_*) and 2 of ($x_4_*) and 3 of ($x_3_*))) or
            ((1 of ($x_5_*) and 3 of ($x_4_*) and 4 of ($x_1_*))) or
            ((1 of ($x_5_*) and 3 of ($x_4_*) and 1 of ($x_2_*) and 2 of ($x_1_*))) or
            ((1 of ($x_5_*) and 3 of ($x_4_*) and 2 of ($x_2_*))) or
            ((1 of ($x_5_*) and 3 of ($x_4_*) and 1 of ($x_3_*) and 1 of ($x_1_*))) or
            ((1 of ($x_5_*) and 3 of ($x_4_*) and 1 of ($x_3_*) and 1 of ($x_2_*))) or
            ((1 of ($x_5_*) and 3 of ($x_4_*) and 2 of ($x_3_*))) or
            ((1 of ($x_5_*) and 4 of ($x_4_*))) or
            ((1 of ($x_10_*) and 1 of ($x_3_*) and 2 of ($x_2_*) and 4 of ($x_1_*))) or
            ((1 of ($x_10_*) and 2 of ($x_3_*) and 1 of ($x_2_*) and 3 of ($x_1_*))) or
            ((1 of ($x_10_*) and 2 of ($x_3_*) and 2 of ($x_2_*) and 1 of ($x_1_*))) or
            ((1 of ($x_10_*) and 3 of ($x_3_*) and 2 of ($x_1_*))) or
            ((1 of ($x_10_*) and 3 of ($x_3_*) and 1 of ($x_2_*))) or
            ((1 of ($x_10_*) and 4 of ($x_3_*))) or
            ((1 of ($x_10_*) and 1 of ($x_4_*) and 2 of ($x_2_*) and 3 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_4_*) and 1 of ($x_3_*) and 4 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_4_*) and 1 of ($x_3_*) and 1 of ($x_2_*) and 2 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_4_*) and 1 of ($x_3_*) and 2 of ($x_2_*))) or
            ((1 of ($x_10_*) and 1 of ($x_4_*) and 2 of ($x_3_*) and 1 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_4_*) and 2 of ($x_3_*) and 1 of ($x_2_*))) or
            ((1 of ($x_10_*) and 1 of ($x_4_*) and 3 of ($x_3_*))) or
            ((1 of ($x_10_*) and 2 of ($x_4_*) and 3 of ($x_1_*))) or
            ((1 of ($x_10_*) and 2 of ($x_4_*) and 1 of ($x_2_*) and 1 of ($x_1_*))) or
            ((1 of ($x_10_*) and 2 of ($x_4_*) and 2 of ($x_2_*))) or
            ((1 of ($x_10_*) and 2 of ($x_4_*) and 1 of ($x_3_*))) or
            ((1 of ($x_10_*) and 3 of ($x_4_*))) or
            ((1 of ($x_10_*) and 1 of ($x_5_*) and 1 of ($x_2_*) and 4 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_5_*) and 2 of ($x_2_*) and 2 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_5_*) and 1 of ($x_3_*) and 3 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_5_*) and 1 of ($x_3_*) and 1 of ($x_2_*) and 1 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_5_*) and 1 of ($x_3_*) and 2 of ($x_2_*))) or
            ((1 of ($x_10_*) and 1 of ($x_5_*) and 2 of ($x_3_*))) or
            ((1 of ($x_10_*) and 1 of ($x_5_*) and 1 of ($x_4_*) and 2 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_5_*) and 1 of ($x_4_*) and 1 of ($x_2_*))) or
            ((1 of ($x_10_*) and 1 of ($x_5_*) and 1 of ($x_4_*) and 1 of ($x_3_*))) or
            ((1 of ($x_10_*) and 1 of ($x_5_*) and 2 of ($x_4_*))) or
            (all of ($x*))
        )
}

rule Acceccor_0
{
    meta:
        author = "defender2yara"
        detection_name = "Acceccor"
        threat_id = "17498"
        severity = "Critical"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "7"
        strings_accuracy = "High"
    strings:
        $x_4_1 = {69 6f 6e 5c 52 75 6e 00 00 00 50 72 6f 78 79 45 6e 61 62 6c 65 00 53 6f 66 74 77 61 72 65 5c 4d 69 63 72 6f 73 6f 66 74 5c 57 69 6e 64 6f 77 73 5c 43 75 72 72 65 6e 74 56 65 72 73 69 6f 6e 5c 49 6e 74 65 72 6e 65 74 20 53 65 74 74 69 6e 67 73 00 39 44 4c 52 2d 4a 53 4d 44 55 43 39 34 2d 50 45 38 44 2d 34 62 63 38 2d 41 39 44 33 2d 4d 43 33 4a 4b 34 35 4b 4d 46 39 31 00}  //weight: 4, accuracy: High
        $x_2_2 = "ProxyEnable" ascii //weight: 2
        $x_1_3 = {69 73 64 6e 00 00 00 00 6d 6f 64 65 6d 00 00}  //weight: 1, accuracy: High
        $x_2_4 = "Content connect" ascii //weight: 2
        $x_2_5 = "acceccor" ascii //weight: 2
        $x_2_6 = {61 63 63 65 63 00 00 00}  //weight: 2, accuracy: High
    condition:
        (filesize < 20MB) and
        (
            ((3 of ($x_2_*) and 1 of ($x_1_*))) or
            ((4 of ($x_2_*))) or
            ((1 of ($x_4_*) and 1 of ($x_2_*) and 1 of ($x_1_*))) or
            ((1 of ($x_4_*) and 2 of ($x_2_*))) or
            (all of ($x*))
        )
}

rule NetCollex_0
{
    meta:
        author = "defender2yara"
        detection_name = "NetCollex"
        threat_id = "17499"
        severity = "Critical"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "8"
        strings_accuracy = "High"
    strings:
        $x_4_1 = "http://dialers.netcollex.net/" ascii //weight: 4
        $x_2_2 = "Please wait.. installing: 00%" ascii //weight: 2
        $x_2_3 = "REFID                          " ascii //weight: 2
        $x_2_4 = "Dialler" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_4_*) and 2 of ($x_2_*))) or
            (all of ($x*))
        )
}

rule NetCollex_1
{
    meta:
        author = "defender2yara"
        detection_name = "NetCollex"
        threat_id = "17499"
        severity = "Critical"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "12"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "GET /exit HTTP/1.0" ascii //weight: 1
        $x_1_2 = "Wanadoo" ascii //weight: 1
        $x_1_3 = "T-Online StartCenter" ascii //weight: 1
        $x_1_4 = "AOL Frame25" ascii //weight: 1
        $x_5_5 = "Netcollex Ltd," ascii //weight: 5
        $x_1_6 = "netdialers" ascii //weight: 1
        $x_3_7 = "Sorry, your time limit has been exceeded for this call" ascii //weight: 3
        $x_3_8 = "You can access this site using the following details:" ascii //weight: 3
        $x_1_9 = "ccard.ipbill.com" ascii //weight: 1
        $x_2_10 = "New entry: dial %s device %s type %s" ascii //weight: 2
        $x_2_11 = "HangupAll: fnRasEnumConnections=%d" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_3_*) and 2 of ($x_2_*) and 5 of ($x_1_*))) or
            ((2 of ($x_3_*) and 6 of ($x_1_*))) or
            ((2 of ($x_3_*) and 1 of ($x_2_*) and 4 of ($x_1_*))) or
            ((2 of ($x_3_*) and 2 of ($x_2_*) and 2 of ($x_1_*))) or
            ((1 of ($x_5_*) and 1 of ($x_2_*) and 5 of ($x_1_*))) or
            ((1 of ($x_5_*) and 2 of ($x_2_*) and 3 of ($x_1_*))) or
            ((1 of ($x_5_*) and 1 of ($x_3_*) and 4 of ($x_1_*))) or
            ((1 of ($x_5_*) and 1 of ($x_3_*) and 1 of ($x_2_*) and 2 of ($x_1_*))) or
            ((1 of ($x_5_*) and 1 of ($x_3_*) and 2 of ($x_2_*))) or
            ((1 of ($x_5_*) and 2 of ($x_3_*) and 1 of ($x_1_*))) or
            ((1 of ($x_5_*) and 2 of ($x_3_*) and 1 of ($x_2_*))) or
            (all of ($x*))
        )
}

rule IPRS_0
{
    meta:
        author = "defender2yara"
        detection_name = "IPRS"
        threat_id = "17500"
        severity = "Critical"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "10"
        strings_accuracy = "Low"
    strings:
        $x_3_1 = "c:\\progra~1\\intern~1\\iexplore.exe " ascii //weight: 3
        $x_3_2 = {6f 70 65 6e 00 68 74 74 70 3a 2f 2f 36 34 2e 31 35 36 2e 33 31 2e}  //weight: 3, accuracy: High
        $x_2_3 = {6f 70 65 6e 00 68 74 74 70 3a 2f 2f 77 77 77}  //weight: 2, accuracy: High
        $x_4_4 = {45 4e 54 45 52 00 70 72 65 6d 69 75 6d}  //weight: 4, accuracy: High
        $x_4_5 = {70 72 65 6d 69 75 6d ?? 47 44 ?? 00 40 49 50 52 53 31 30 31 00}  //weight: 4, accuracy: Low
        $x_2_6 = "This call is not free, this call involves dialing" ascii //weight: 2
        $x_2_7 = "a premium rate number, " ascii //weight: 2
        $x_3_8 = "RasEnumConnectionsA" ascii //weight: 3
        $x_2_9 = ".com/members" ascii //weight: 2
        $x_2_10 = ".net/members" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (
            ((5 of ($x_2_*))) or
            ((1 of ($x_3_*) and 4 of ($x_2_*))) or
            ((2 of ($x_3_*) and 2 of ($x_2_*))) or
            ((3 of ($x_3_*) and 1 of ($x_2_*))) or
            ((1 of ($x_4_*) and 3 of ($x_2_*))) or
            ((1 of ($x_4_*) and 1 of ($x_3_*) and 2 of ($x_2_*))) or
            ((1 of ($x_4_*) and 2 of ($x_3_*))) or
            ((2 of ($x_4_*) and 1 of ($x_2_*))) or
            ((2 of ($x_4_*) and 1 of ($x_3_*))) or
            (all of ($x*))
        )
}

rule GBDial_0
{
    meta:
        author = "defender2yara"
        detection_name = "GBDial"
        threat_id = "17532"
        severity = "Critical"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "25"
        strings_accuracy = "High"
    strings:
        $x_10_1 = "RasDial" ascii //weight: 10
        $x_6_2 = "juicyteenporn.com" ascii //weight: 6
        $x_1_3 = "@ninoga" ascii //weight: 1
        $x_3_4 = "GBDialer" ascii //weight: 3
        $x_3_5 = "GBDIALLER1" ascii //weight: 3
        $x_3_6 = "CZDIALLER" ascii //weight: 3
        $x_2_7 = "support@global-acces.com" ascii //weight: 2
        $x_2_8 = "La Cortinada, AD300 Ordino, Andorra Phone: 07044500679, Fax: 376-849103" ascii //weight: 2
        $x_2_9 = "premium-se" ascii //weight: 2
        $x_2_10 = "\\Access Members Area.exe" ascii //weight: 2
        $x_2_11 = "Global Acces" ascii //weight: 2
        $x_1_12 = "ADULTADULT" ascii //weight: 1
        $x_1_13 = "IsDebuggerPresent" ascii //weight: 1
        $x_1_14 = "YOU WILL BE CHARGED" ascii //weight: 1
        $x_1_15 = "SSWORDPASSWORD" ascii //weight: 1
        $x_1_16 = "XXXXX-1" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((3 of ($x_3_*) and 5 of ($x_2_*) and 6 of ($x_1_*))) or
            ((1 of ($x_6_*) and 1 of ($x_3_*) and 5 of ($x_2_*) and 6 of ($x_1_*))) or
            ((1 of ($x_6_*) and 2 of ($x_3_*) and 4 of ($x_2_*) and 5 of ($x_1_*))) or
            ((1 of ($x_6_*) and 2 of ($x_3_*) and 5 of ($x_2_*) and 3 of ($x_1_*))) or
            ((1 of ($x_6_*) and 3 of ($x_3_*) and 2 of ($x_2_*) and 6 of ($x_1_*))) or
            ((1 of ($x_6_*) and 3 of ($x_3_*) and 3 of ($x_2_*) and 4 of ($x_1_*))) or
            ((1 of ($x_6_*) and 3 of ($x_3_*) and 4 of ($x_2_*) and 2 of ($x_1_*))) or
            ((1 of ($x_6_*) and 3 of ($x_3_*) and 5 of ($x_2_*))) or
            ((1 of ($x_10_*) and 5 of ($x_2_*) and 5 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_3_*) and 3 of ($x_2_*) and 6 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_3_*) and 4 of ($x_2_*) and 4 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_3_*) and 5 of ($x_2_*) and 2 of ($x_1_*))) or
            ((1 of ($x_10_*) and 2 of ($x_3_*) and 2 of ($x_2_*) and 5 of ($x_1_*))) or
            ((1 of ($x_10_*) and 2 of ($x_3_*) and 3 of ($x_2_*) and 3 of ($x_1_*))) or
            ((1 of ($x_10_*) and 2 of ($x_3_*) and 4 of ($x_2_*) and 1 of ($x_1_*))) or
            ((1 of ($x_10_*) and 2 of ($x_3_*) and 5 of ($x_2_*))) or
            ((1 of ($x_10_*) and 3 of ($x_3_*) and 6 of ($x_1_*))) or
            ((1 of ($x_10_*) and 3 of ($x_3_*) and 1 of ($x_2_*) and 4 of ($x_1_*))) or
            ((1 of ($x_10_*) and 3 of ($x_3_*) and 2 of ($x_2_*) and 2 of ($x_1_*))) or
            ((1 of ($x_10_*) and 3 of ($x_3_*) and 3 of ($x_2_*))) or
            ((1 of ($x_10_*) and 1 of ($x_6_*) and 2 of ($x_2_*) and 5 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_6_*) and 3 of ($x_2_*) and 3 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_6_*) and 4 of ($x_2_*) and 1 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_6_*) and 5 of ($x_2_*))) or
            ((1 of ($x_10_*) and 1 of ($x_6_*) and 1 of ($x_3_*) and 6 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_6_*) and 1 of ($x_3_*) and 1 of ($x_2_*) and 4 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_6_*) and 1 of ($x_3_*) and 2 of ($x_2_*) and 2 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_6_*) and 1 of ($x_3_*) and 3 of ($x_2_*))) or
            ((1 of ($x_10_*) and 1 of ($x_6_*) and 2 of ($x_3_*) and 3 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_6_*) and 2 of ($x_3_*) and 1 of ($x_2_*) and 1 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_6_*) and 2 of ($x_3_*) and 2 of ($x_2_*))) or
            ((1 of ($x_10_*) and 1 of ($x_6_*) and 3 of ($x_3_*))) or
            (all of ($x*))
        )
}

rule Ulubione_0
{
    meta:
        author = "defender2yara"
        detection_name = "Ulubione"
        threat_id = "17533"
        severity = "Critical"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "18"
        strings_accuracy = "High"
    strings:
        $x_8_1 = "RasDial" ascii //weight: 8
        $x_3_2 = "glowneoknodialeraofpl" ascii //weight: 3
        $x_1_3 = "ponownie ?" ascii //weight: 1
        $x_1_4 = "Czy chcesz si" ascii //weight: 1
        $x_1_5 = "Czy chcesz przerwa" ascii //weight: 1
        $x_5_6 = "192.168.10.252" ascii //weight: 5
        $x_5_7 = "Ulubione strony.exe" ascii //weight: 5
        $x_3_8 = "F.P.H.U. OF.PL" ascii //weight: 3
        $x_2_9 = "adowanie strony" ascii //weight: 2
        $x_2_10 = "Amatorski hardcore - ostre zdj" ascii //weight: 2
        $x_2_11 = "Polki amatorki" ascii //weight: 2
        $x_2_12 = "Wamp - najlepszy pornomagazyn w Polsce" ascii //weight: 2
        $x_2_13 = "puje po akceptacji regulaminu dost" ascii //weight: 2
        $x_2_14 = "do odpowiedniego operatora telekomunikacyjnego. Tryb post" ascii //weight: 2
        $x_2_15 = "owo skonfigurowanego i uruchomionego modemu telefonicznego. Program nie zmienia" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_3_*) and 6 of ($x_2_*) and 3 of ($x_1_*))) or
            ((1 of ($x_3_*) and 7 of ($x_2_*) and 1 of ($x_1_*))) or
            ((2 of ($x_3_*) and 5 of ($x_2_*) and 2 of ($x_1_*))) or
            ((2 of ($x_3_*) and 6 of ($x_2_*))) or
            ((1 of ($x_5_*) and 5 of ($x_2_*) and 3 of ($x_1_*))) or
            ((1 of ($x_5_*) and 6 of ($x_2_*) and 1 of ($x_1_*))) or
            ((1 of ($x_5_*) and 7 of ($x_2_*))) or
            ((1 of ($x_5_*) and 1 of ($x_3_*) and 4 of ($x_2_*) and 2 of ($x_1_*))) or
            ((1 of ($x_5_*) and 1 of ($x_3_*) and 5 of ($x_2_*))) or
            ((1 of ($x_5_*) and 2 of ($x_3_*) and 2 of ($x_2_*) and 3 of ($x_1_*))) or
            ((1 of ($x_5_*) and 2 of ($x_3_*) and 3 of ($x_2_*) and 1 of ($x_1_*))) or
            ((1 of ($x_5_*) and 2 of ($x_3_*) and 4 of ($x_2_*))) or
            ((2 of ($x_5_*) and 3 of ($x_2_*) and 2 of ($x_1_*))) or
            ((2 of ($x_5_*) and 4 of ($x_2_*))) or
            ((2 of ($x_5_*) and 1 of ($x_3_*) and 1 of ($x_2_*) and 3 of ($x_1_*))) or
            ((2 of ($x_5_*) and 1 of ($x_3_*) and 2 of ($x_2_*) and 1 of ($x_1_*))) or
            ((2 of ($x_5_*) and 1 of ($x_3_*) and 3 of ($x_2_*))) or
            ((2 of ($x_5_*) and 2 of ($x_3_*) and 2 of ($x_1_*))) or
            ((2 of ($x_5_*) and 2 of ($x_3_*) and 1 of ($x_2_*))) or
            ((1 of ($x_8_*) and 4 of ($x_2_*) and 2 of ($x_1_*))) or
            ((1 of ($x_8_*) and 5 of ($x_2_*))) or
            ((1 of ($x_8_*) and 1 of ($x_3_*) and 2 of ($x_2_*) and 3 of ($x_1_*))) or
            ((1 of ($x_8_*) and 1 of ($x_3_*) and 3 of ($x_2_*) and 1 of ($x_1_*))) or
            ((1 of ($x_8_*) and 1 of ($x_3_*) and 4 of ($x_2_*))) or
            ((1 of ($x_8_*) and 2 of ($x_3_*) and 1 of ($x_2_*) and 2 of ($x_1_*))) or
            ((1 of ($x_8_*) and 2 of ($x_3_*) and 2 of ($x_2_*))) or
            ((1 of ($x_8_*) and 1 of ($x_5_*) and 1 of ($x_2_*) and 3 of ($x_1_*))) or
            ((1 of ($x_8_*) and 1 of ($x_5_*) and 2 of ($x_2_*) and 1 of ($x_1_*))) or
            ((1 of ($x_8_*) and 1 of ($x_5_*) and 3 of ($x_2_*))) or
            ((1 of ($x_8_*) and 1 of ($x_5_*) and 1 of ($x_3_*) and 2 of ($x_1_*))) or
            ((1 of ($x_8_*) and 1 of ($x_5_*) and 1 of ($x_3_*) and 1 of ($x_2_*))) or
            ((1 of ($x_8_*) and 1 of ($x_5_*) and 2 of ($x_3_*))) or
            ((1 of ($x_8_*) and 2 of ($x_5_*))) or
            (all of ($x*))
        )
}

rule Holistyc_0
{
    meta:
        author = "defender2yara"
        detection_name = "Holistyc"
        threat_id = "17534"
        severity = "Critical"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "24"
        strings_accuracy = "High"
    strings:
        $x_10_1 = "RasDial" ascii //weight: 10
        $x_3_2 = "HolistycDll.dll" ascii //weight: 3
        $x_3_3 = "thepaymentcentre" ascii //weight: 3
        $x_4_4 = "%s\\HolMkt\\%d.ico" ascii //weight: 4
        $x_3_5 = "Enter Password" ascii //weight: 3
        $x_3_6 = "HolistycCallStats.aspx" ascii //weight: 3
        $x_1_7 = "Do you want to enter the competition again?" ascii //weight: 1
        $x_1_8 = "MaxPayment" ascii //weight: 1
        $x_3_9 = "?holistycNodial=y&" ascii //weight: 3
        $x_3_10 = "Downloading Holistyc..." ascii //weight: 3
        $x_1_11 = "Jamaica" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_4_*) and 6 of ($x_3_*) and 2 of ($x_1_*))) or
            ((1 of ($x_10_*) and 4 of ($x_3_*) and 2 of ($x_1_*))) or
            ((1 of ($x_10_*) and 5 of ($x_3_*))) or
            ((1 of ($x_10_*) and 1 of ($x_4_*) and 3 of ($x_3_*) and 1 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_4_*) and 4 of ($x_3_*))) or
            (all of ($x*))
        )
}

rule AsianRaw_0
{
    meta:
        author = "defender2yara"
        detection_name = "AsianRaw"
        threat_id = "17536"
        severity = "Critical"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "14"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "http://www.asianraw.com/members/vs.html" ascii //weight: 1
        $x_1_2 = "http://www.britishtotty.com/content/homepage.html" ascii //weight: 1
        $x_3_3 = "TEXT_ENGLISH" ascii //weight: 3
        $x_10_4 = "RasHangUpA" ascii //weight: 10
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_10_*) and 1 of ($x_3_*) and 1 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule Kotu_0
{
    meta:
        author = "defender2yara"
        detection_name = "Kotu"
        threat_id = "17623"
        severity = "Critical"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "159"
        strings_accuracy = "High"
    strings:
        $x_100_1 = "KOTUDIALER_INSTANCE" ascii //weight: 100
        $x_1_2 = "RasGetEntryDialParamsA" ascii //weight: 1
        $x_1_3 = "RasSetEntryDialParamsA" ascii //weight: 1
        $x_1_4 = "RasSetEntryPropertiesA" ascii //weight: 1
        $x_1_5 = "RasHangUpA" ascii //weight: 1
        $x_1_6 = "RasGetConnectStatusA" ascii //weight: 1
        $x_1_7 = "RasEnumDevicesA" ascii //weight: 1
        $x_1_8 = "RasGetEntryPropertiesA" ascii //weight: 1
        $x_1_9 = "RasEnumConnectionsA" ascii //weight: 1
        $x_1_10 = "RasDialA" ascii //weight: 1
        $x_50_11 = "ShellExecuteA" ascii //weight: 50
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Kotu_1
{
    meta:
        author = "defender2yara"
        detection_name = "Kotu"
        threat_id = "17623"
        severity = "Critical"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "Low"
    strings:
        $x_3_1 = {be 22 00 00 00 f7 f6 0f be 92 ?? ?? ?? ?? 33 ca 8b 85 d0 fc ff ff 88 8c 05 e0 fd ff ff eb af}  //weight: 3, accuracy: Low
        $x_1_2 = {68 64 66 6b 6a 67 68 66 64 73 67 73 75 65 72 79 69 00}  //weight: 1, accuracy: High
        $x_1_3 = {71 71 61 00 25 75 00}  //weight: 1, accuracy: High
        $x_1_4 = {52 61 73 44 69 61 6c 45 76 65 6e 74 [0-7] 4e 65 77 [0-7] 6d 6f 64 65 6d [0-16] 63 61 62 6c 65}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_3_*) and 2 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule UDIS_0
{
    meta:
        author = "defender2yara"
        detection_name = "UDIS"
        threat_id = "17626"
        severity = "Critical"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "31"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "RunDll32 UDConn.dll,RunAsIcon " ascii //weight: 1
        $x_1_2 = {54 72 69 61 63 6f 6d 55 44 2e 44 4c 4c 00}  //weight: 1, accuracy: High
        $x_10_3 = "Software\\CheckDialer" ascii //weight: 10
        $x_10_4 = "DeInstallation" ascii //weight: 10
        $x_10_5 = "Software\\Microsoft\\Windows\\CurrentVersion\\Run" ascii //weight: 10
    condition:
        (filesize < 20MB) and
        (
            ((3 of ($x_10_*) and 1 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule UDIS_1
{
    meta:
        author = "defender2yara"
        detection_name = "UDIS"
        threat_id = "17626"
        severity = "Critical"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "UDIS-HTML - Microsoft Internet Explorer" ascii //weight: 1
        $x_1_2 = "RunDll32 UDConn.dll,RunAsIcon %s" ascii //weight: 1
        $x_1_3 = "UDConnect Interface" ascii //weight: 1
        $x_1_4 = "UDConn.UDConnect" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule AYOSpy_A_0
{
    meta:
        author = "defender2yara"
        detection_name = "AYOSpy.A"
        threat_id = "17633"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "25"
        strings_accuracy = "High"
    strings:
        $x_5_1 = "\\AYO.vbp" wide //weight: 5
        $x_5_2 = "D:\\AYO X Logger\\" wide //weight: 5
        $x_2_3 = "Fuck the one who is trying to Crack this Application" ascii //weight: 2
        $x_1_4 = "tmrSendMail" ascii //weight: 1
        $x_1_5 = "Data2Log" ascii //weight: 1
        $x_1_6 = "SYSCHOST" ascii //weight: 1
        $x_5_7 = "B56mx@yahoo.Com" wide //weight: 5
        $x_5_8 = "http://www.boukan.8m.net/AYO_Soft/Index.html" wide //weight: 5
        $x_1_9 = "MainF" ascii //weight: 1
        $x_3_10 = "syschost.exe" wide //weight: 3
        $x_1_11 = "Sign In;*Connect*;*Internet Explorer*" wide //weight: 1
        $x_3_12 = "[Pasted->" wide //weight: 3
    condition:
        (filesize < 20MB) and
        (
            ((3 of ($x_5_*) and 1 of ($x_3_*) and 1 of ($x_2_*) and 5 of ($x_1_*))) or
            ((3 of ($x_5_*) and 2 of ($x_3_*) and 4 of ($x_1_*))) or
            ((3 of ($x_5_*) and 2 of ($x_3_*) and 1 of ($x_2_*) and 2 of ($x_1_*))) or
            ((4 of ($x_5_*) and 5 of ($x_1_*))) or
            ((4 of ($x_5_*) and 1 of ($x_2_*) and 3 of ($x_1_*))) or
            ((4 of ($x_5_*) and 1 of ($x_3_*) and 2 of ($x_1_*))) or
            ((4 of ($x_5_*) and 1 of ($x_3_*) and 1 of ($x_2_*))) or
            ((4 of ($x_5_*) and 2 of ($x_3_*))) or
            (all of ($x*))
        )
}

rule AYOSpy_A_1
{
    meta:
        author = "defender2yara"
        detection_name = "AYOSpy.A"
        threat_id = "17633"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "26"
        strings_accuracy = "High"
    strings:
        $x_5_1 = "\\AYO.vbp" wide //weight: 5
        $x_5_2 = "D:\\AYO X Logger\\" wide //weight: 5
        $x_2_3 = "Fuck the one who is trying to Crack this Application" ascii //weight: 2
        $x_5_4 = "-FuckYaBitch!" wide //weight: 5
        $x_1_5 = "<Right Click>" wide //weight: 1
        $x_1_6 = "<Left Click>" wide //weight: 1
        $x_5_7 = "sysver.exe;sysinfo.exe;syslnfo.exe;syschost.exe;netcmd .exe;netconfig .exe;netcmd.exe;netconfig.exe" wide //weight: 5
        $x_1_8 = "Password :" wide //weight: 1
        $x_1_9 = "DisableTaskMgr" wide //weight: 1
        $x_1_10 = "DisableRegistryTools" wide //weight: 1
        $x_1_11 = "winver.exe" wide //weight: 1
        $x_1_12 = "MpfTray.exe" wide //weight: 1
        $x_1_13 = "SwapIcon.bas" wide //weight: 1
        $x_1_14 = "tmrSendMail" ascii //weight: 1
        $x_1_15 = "Data2Log" ascii //weight: 1
        $x_5_16 = "SYSCHOST" ascii //weight: 5
        $x_1_17 = "MainF" ascii //weight: 1
        $x_3_18 = "[Pasted->" wide //weight: 3
    condition:
        (filesize < 20MB) and
        (
            ((2 of ($x_5_*) and 1 of ($x_3_*) and 1 of ($x_2_*) and 11 of ($x_1_*))) or
            ((3 of ($x_5_*) and 11 of ($x_1_*))) or
            ((3 of ($x_5_*) and 1 of ($x_2_*) and 9 of ($x_1_*))) or
            ((3 of ($x_5_*) and 1 of ($x_3_*) and 8 of ($x_1_*))) or
            ((3 of ($x_5_*) and 1 of ($x_3_*) and 1 of ($x_2_*) and 6 of ($x_1_*))) or
            ((4 of ($x_5_*) and 6 of ($x_1_*))) or
            ((4 of ($x_5_*) and 1 of ($x_2_*) and 4 of ($x_1_*))) or
            ((4 of ($x_5_*) and 1 of ($x_3_*) and 3 of ($x_1_*))) or
            ((4 of ($x_5_*) and 1 of ($x_3_*) and 1 of ($x_2_*) and 1 of ($x_1_*))) or
            ((5 of ($x_5_*) and 1 of ($x_1_*))) or
            ((5 of ($x_5_*) and 1 of ($x_2_*))) or
            ((5 of ($x_5_*) and 1 of ($x_3_*))) or
            (all of ($x*))
        )
}

rule RewardNetwork_0
{
    meta:
        author = "defender2yara"
        detection_name = "RewardNetwork"
        threat_id = "18019"
        severity = "33"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "SOFTWARE\\WebGuide" ascii //weight: 1
        $x_1_2 = "SOFTWARE\\AppDataLow" ascii //weight: 1
        $x_1_3 = ".web-guide.co.kr" ascii //weight: 1
        $x_1_4 = "RewardNetwork." ascii //weight: 1
        $x_1_5 = "RewardNetwork." wide //weight: 1
        $x_1_6 = "Datawave" wide //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule RewardNetwork_1
{
    meta:
        author = "defender2yara"
        detection_name = "RewardNetwork"
        threat_id = "18019"
        severity = "33"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "SOFTWARE\\WebGuide" ascii //weight: 1
        $x_1_2 = "SOFTWARE\\AppDataLow" ascii //weight: 1
        $x_1_3 = ".web-guide.co.kr" ascii //weight: 1
        $x_1_4 = "{DF301EBA-70DE-376D-A3CE-877429C9D703}" ascii //weight: 1
        $x_1_5 = "Web-Guide Updater Service" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule RewardNetwork_2
{
    meta:
        author = "defender2yara"
        detection_name = "RewardNetwork"
        threat_id = "18019"
        severity = "33"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Software\\RewardNet" ascii //weight: 1
        $x_1_2 = "SOFTWARE\\AppDataLow" ascii //weight: 1
        $x_1_3 = ".rewardnetwork.net" ascii //weight: 1
        $x_1_4 = "RewardNetwork." ascii //weight: 1
        $x_1_5 = "RewardNetwork." wide //weight: 1
        $x_1_6 = "Datawave" wide //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule RewardNetwork_3
{
    meta:
        author = "defender2yara"
        detection_name = "RewardNetwork"
        threat_id = "18019"
        severity = "33"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "SOFTWARE\\ShopGuide\\" ascii //weight: 1
        $x_1_2 = "SOFTWARE\\AppDataLow" ascii //weight: 1
        $x_1_3 = ".shop-guide.co.kr" ascii //weight: 1
        $x_1_4 = "RewardNetwork." ascii //weight: 1
        $x_1_5 = "RewardNetwork." wide //weight: 1
        $x_1_6 = "Datawave" wide //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule RewardNetwork_4
{
    meta:
        author = "defender2yara"
        detection_name = "RewardNetwork"
        threat_id = "18019"
        severity = "33"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "http://script.shop-guide.co.kr/script/shopguide.php" ascii //weight: 1
        $x_1_2 = "http://www.shop-guide.co.kr/cs/help.php?type=sg_notice" ascii //weight: 1
        $x_1_3 = "http://update.shop-guide.co.kr/update/" ascii //weight: 1
        $x_1_4 = {53 4f 46 54 57 41 52 45 5c 53 68 6f 70 47 75 69 64 65 00 00 53 4f 46 54 57 41 52 45 5c 53 68 6f 70 47 75 69 64 65 5c 00 77 77 77 2e 73 68 6f 70 2d 67 75 69 64 65 2e 63 6f 2e 6b 72 00 00 00 00 7b 30 30 30 30 30 30 30 30 2d 30 30 30 30 2d 30 30 30 30 2d 30 30 30 30 2d 30 30 30 30 30 30 30 30 30 30 30 33 7d}  //weight: 1, accuracy: High
        $x_1_5 = "RewardNetwork.ShopGuide.1 = s 'RewardNetwork ShopGuide Class'" ascii //weight: 1
        $x_1_6 = "CLSID = s '{3CB0CF42-DA54-47d2-8999-23928A2DEA42}'" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Dapsol_0
{
    meta:
        author = "defender2yara"
        detection_name = "Dapsol"
        threat_id = "18034"
        severity = "Critical"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "8"
        strings_accuracy = "Low"
    strings:
        $x_2_1 = {4d 61 69 6e 00 63 6f 6e 63 00 [0-4] 2d 70 61 72 74 6e 65 72 [0-4] 2d ?? ?? 40 63 6f 6e 63 65 61 6c 61 72 65 61}  //weight: 2, accuracy: Low
        $x_1_2 = "http://members.concealarea.com/" ascii //weight: 1
        $x_1_3 = "Host: concealarea.com" ascii //weight: 1
        $x_1_4 = "PHONENUMBER" ascii //weight: 1
        $x_1_5 = "MBERSMEMBERSMEMBERS" ascii //weight: 1
        $x_1_6 = "RasGetEntryDialParamsA" ascii //weight: 1
        $x_1_7 = "DIAL_ER" ascii //weight: 1
        $x_1_8 = "modem" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_2_*) and 6 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule Dapsol_1
{
    meta:
        author = "defender2yara"
        detection_name = "Dapsol"
        threat_id = "18034"
        severity = "Critical"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "11"
        strings_accuracy = "Low"
    strings:
        $x_2_1 = {4d 61 69 6e 00 63 6f 6e 63 00 [0-4] 2d 70 61 72 74 6e 65 72 [0-4] 2d ?? ?? 40 64 61 70 73 6f 6c}  //weight: 2, accuracy: Low
        $x_2_2 = "http://www.thehun.com/" ascii //weight: 2
        $x_2_3 = "http://madthumbs.com/archive/" ascii //weight: 2
        $x_2_4 = "http://www.hustler-exclusive.com/" ascii //weight: 2
        $x_2_5 = "http://galleries.payserve.com/1/31952/1" ascii //weight: 2
        $x_2_6 = "RasGetEntryDialParamsA" ascii //weight: 2
        $x_2_7 = "DIAL_ER" ascii //weight: 2
        $x_2_8 = "modem" ascii //weight: 2
        $x_1_9 = "PHONENUMBER" ascii //weight: 1
        $x_1_10 = "MBERSMEMBERSMEMBERS" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((5 of ($x_2_*) and 1 of ($x_1_*))) or
            ((6 of ($x_2_*))) or
            (all of ($x*))
        )
}

rule MastaCash_0
{
    meta:
        author = "defender2yara"
        detection_name = "MastaCash"
        threat_id = "18085"
        severity = "Critical"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "20"
        strings_accuracy = "High"
    strings:
        $x_5_1 = "<DialerH>" ascii //weight: 5
        $x_5_2 = "LoaderXWaitWindow" ascii //weight: 5
        $x_5_3 = {50 72 65 66 69 78 00}  //weight: 5, accuracy: High
        $x_3_4 = "\"%s\" -DX%u -immediate" ascii //weight: 3
        $x_1_5 = "Software\\Masta\\Dialer" ascii //weight: 1
        $x_1_6 = "http://kit.mastacash.com/" ascii //weight: 1
        $x_1_7 = "http://dx.mastacash.com" ascii //weight: 1
        $x_1_8 = "dialx.exe" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((3 of ($x_5_*) and 1 of ($x_3_*) and 2 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule Adialer_A_0
{
    meta:
        author = "defender2yara"
        detection_name = "Adialer.A"
        threat_id = "99310"
        severity = "Critical"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "12"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = "Snmp" ascii //weight: 1
        $x_1_2 = "<sd>" ascii //weight: 1
        $x_1_3 = "</sd>" ascii //weight: 1
        $x_1_4 = "<dp>" ascii //weight: 1
        $x_1_5 = "00</dp>" ascii //weight: 1
        $x_1_6 = "<rp>3</rp>" ascii //weight: 1
        $x_1_7 = "<sp>900</sp>" ascii //weight: 1
        $x_1_8 = "<db>" ascii //weight: 1
        $x_1_9 = "</db>" ascii //weight: 1
        $x_1_10 = {3c 6e 75 6d 62 65 72 3e 74 [0-36] 3c 2f 6e 75 6d 62 65 72 3e}  //weight: 1, accuracy: Low
        $x_1_11 = {3c 70 61 73 73 77 6f 72 64 3e [0-24] 3c 2f 70 61 73 73 77 6f 72 64 3e}  //weight: 1, accuracy: Low
        $x_1_12 = {3c 75 72 6c 3e 68 74 74 70 3a 2f 2f [0-40] 3c 2f 75}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Adialer_B_0
{
    meta:
        author = "defender2yara"
        detection_name = "Adialer.B"
        threat_id = "100055"
        severity = "Critical"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "210"
        strings_accuracy = "Low"
    strings:
        $x_100_1 = {ff d6 6a 00 ff 75 10 53 ff 15 ?? ?? ?? ?? 53 ff d6 53 8b f0 e8 2e 00 00 00 8b 45 0c 59 89 38}  //weight: 100, accuracy: Low
        $x_100_2 = {8d 87 00 00 40 00 8d 8e 98 00 00 00 89 46 14 8d 46 18 89 4e 0c 89 7e 10 89 46 08 33 ed b9 f1 00 00 00 33 d2 83 fd 10 0f 9d c2 4a}  //weight: 100, accuracy: High
        $x_5_3 = "ShellExecuteA" ascii //weight: 5
        $x_5_4 = "Erreur the Appl Buffer" ascii //weight: 5
        $x_5_5 = "Erreur de lecture du fichier" ascii //weight: 5
    condition:
        (filesize < 20MB) and
        (
            ((2 of ($x_100_*) and 2 of ($x_5_*))) or
            (all of ($x*))
        )
}

rule Adialer_C_0
{
    meta:
        author = "defender2yara"
        detection_name = "Adialer.C"
        threat_id = "100056"
        severity = "Critical"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "220"
        strings_accuracy = "Low"
    strings:
        $x_100_1 = {46 83 fe 03 7e 12 8a 15 ?? ?? ?? ?? be 01 00 00 00 02 d1 88 14 28 eb}  //weight: 100, accuracy: Low
        $x_100_2 = {80 3c 28 5c 75 16 80 7c 28 01 0d 75 0f 80 7c 28 02 0a 75 08 83 c0 02 e9}  //weight: 100, accuracy: High
        $x_5_3 = "InternetOpen" ascii //weight: 5
        $x_5_4 = "InternetRead" ascii //weight: 5
        $x_5_5 = "Montorgueil" ascii //weight: 5
        $x_5_6 = "RasGetConnectStatusA" ascii //weight: 5
        $x_5_7 = "RasEnumConnectionsA" ascii //weight: 5
        $x_5_8 = "RasHangUpA" ascii //weight: 5
    condition:
        (filesize < 20MB) and
        (
            ((2 of ($x_100_*) and 4 of ($x_5_*))) or
            (all of ($x*))
        )
}

rule Adialer_E_0
{
    meta:
        author = "defender2yara"
        detection_name = "Adialer.E"
        threat_id = "112117"
        severity = "Critical"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "7"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {45 76 74 53 68 75 74 64 6f 77 6e 00 45 76 74 53 74 61 72 74 75 70 00 69 6e 73 74 00 72 75 6e 00 74 65 73}  //weight: 1, accuracy: High
        $x_1_2 = "if exist \"%s\" goto Retry" ascii //weight: 1
        $x_1_3 = "cmd /c start /min" ascii //weight: 1
        $x_1_4 = "RasEnumDevicesA" ascii //weight: 1
        $x_1_5 = "del \"%s\"" ascii //weight: 1
        $x_1_6 = "GetAdaptersInfo" ascii //weight: 1
        $x_1_7 = "GetThreadDesktop" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Intexus_A_0
{
    meta:
        author = "defender2yara"
        detection_name = "Intexus.A"
        threat_id = "113409"
        severity = "Critical"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "10"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "%WinDir%\\hosts" ascii //weight: 1
        $x_1_2 = "SYSTEM\\CurrentControlSet\\Services\\Tcpip\\Parameters" ascii //weight: 1
        $x_1_3 = "hostlist" ascii //weight: 1
        $x_1_4 = "Software\\Microsoft\\RAS AutoDial\\Control" ascii //weight: 1
        $x_1_5 = "EnableAutodial" ascii //weight: 1
        $x_1_6 = "NoNewAutodial" ascii //weight: 1
        $x_1_7 = "CoopIntexDial" ascii //weight: 1
        $x_1_8 = "InternetOpenUrlA" ascii //weight: 1
        $x_1_9 = "InternetReadFile" ascii //weight: 1
        $x_1_10 = "IntexDial" wide //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Obfp_A_0
{
    meta:
        author = "defender2yara"
        detection_name = "Obfp.A"
        threat_id = "116130"
        severity = "Critical"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4120"
        strings_accuracy = "Low"
    strings:
        $x_1000_1 = "CryptAcquireContextA" ascii //weight: 1000
        $x_1000_2 = "CryptCreateHash" ascii //weight: 1000
        $x_1000_3 = "CryptDeriveKey" ascii //weight: 1000
        $x_1000_4 = "ClientToScreen" ascii //weight: 1000
        $x_1_5 = {00 33 c0 89 08 50 45 43 32 00}  //weight: 1, accuracy: High
        $x_1_6 = "PEC2DbgMsg:" ascii //weight: 1
        $x_70_7 = {55 8b ec 81 ec ?? ?? 00 00 56 83 a5 58 fd ff ff 00 83 a5 88 fd ff ff 00 83 a5 5c fd ff ff 00 83 a5 ?? ?? ff ff 00 83 65 bc 00 c6 45 d4 75 c6 45 d5 73 c6 45 d6 65 c6 45 d7 72 c6 45 d8 33 c6 45 d9 32 c6 45 da 2e c6 45 db 64 c6 45 dc 6c c6 45 dd 6c c6 45 de 00 c6 85 ?? ?? ff ff 4d c6 85 ?? ?? ff ff 65 c6 85 ?? ?? ff ff 73 c6 85 ?? ?? ff ff 73 c6 85 ?? ?? ff ff 61 c6 85 ?? ?? ff ff 67 c6 85 ?? ?? ff ff 65 c6 85 ?? ?? ff ff 42 c6 85 ?? ?? ff ff 6f c6 85 ?? ?? ff ff 78 c6 85 ?? ?? ff ff 41 c6 85 ?? ?? ff ff 00}  //weight: 70, accuracy: Low
        $x_30_8 = {c6 85 60 fd ff ff 6b c6 85 61 fd ff ff 65 c6 85 62 fd ff ff 72 c6 85 63 fd ff ff 6e c6 85 64 fd ff ff 65 c6 85 65 fd ff ff 6c c6 85 66 fd ff ff 33 c6 85 67 fd ff ff 32 c6 85 68 fd ff ff 2e c6 85 69 fd ff ff 64 c6 85 6a fd ff ff 6c c6 85 6b fd ff ff 6c c6 85 6c fd ff ff 00}  //weight: 30, accuracy: High
        $x_100_9 = {53 33 db 56 57 89 5c 24 ?? 89 5c 24 ?? 89 5c 24 ?? 89 5c 24 ?? c6 44 24 ?? 75 c6 44 24 ?? 73 c6 44 24 ?? 65 c6 44 24 ?? 72 c6 44 24 ?? 33 c6 44 24 ?? 32 c6 44 24 ?? 2e c6 44 24 ?? 64 c6 44 24 ?? 6c c6 44 24 ?? 6c 88 5c 24 ?? c6 84 24 ?? 00 00 00 6b c6 84 24 ?? 00 00 00 65 c6 84 24 ?? 00 00 00 72 c6 84 24 ?? 00 00 00 6e c6 84 24 ?? 00 00 00 65 c6 84 24 ?? 00 00 00 6c c6 84 24 ?? 00 00 00 33 c6 84 24 ?? 00 00 00 32 c6 84 24 ?? 00 00 00 2e c6 84 24 ?? 00 00 00 64 c6 84 24 ?? 00 00 00 6c c6 84 24 ?? 00 00 00 6c 88 9c 24 ?? 00 00 00}  //weight: 100, accuracy: Low
        $x_100_10 = {53 33 db 56 57 89 5d ?? 89 5d ?? 89 5d ?? 89 5d ?? c6 45 ?? 75 c6 45 ?? 73 c6 45 ?? 65 c6 45 ?? 72 c6 45 ?? 33 c6 45 ?? 32 c6 45 ?? 2e c6 45 ?? 64 c6 45 ?? 6c c6 45 ?? 6c 88 5d ?? c6 45 ?? 6b c6 45 ?? 65 c6 45 ?? 72 c6 45 ?? 6e c6 45 ?? 65 c6 45 ?? 6c c6 45 ?? 33 c6 45 ?? 32 c6 45 ?? 2e c6 45 ?? 64 c6 45 ?? 6c c6 45 ?? 6c 88 5d}  //weight: 100, accuracy: Low
        $x_20_11 = {50 6a 01 ff b5 5c fd ff ff 68 01 66 00 00 ff b5 58 fd ff ff ff 95 ?? ?? ff ff 85 c0 75 0a e9 ?? ?? 00 00}  //weight: 20, accuracy: Low
        $x_20_12 = {50 6a 01 ff 74 24 ?? 68 01 66 00 00 ff 74 24 ?? ff 94 ?? ?? ?? 00 00 85 c0 0f 84 ?? ?? 00 00}  //weight: 20, accuracy: Low
        $x_20_13 = {50 6a 01 ff 75 ?? 68 01 66 00 00 ff 75 ?? ff 95 ?? ?? ff ff 85 c0 0f 84 ?? ?? 00 00}  //weight: 20, accuracy: Low
    condition:
        (filesize < 20MB) and
        (
            ((4 of ($x_1000_*) and 1 of ($x_70_*) and 3 of ($x_20_*))) or
            ((4 of ($x_1000_*) and 1 of ($x_70_*) and 1 of ($x_30_*) and 1 of ($x_20_*))) or
            ((4 of ($x_1000_*) and 1 of ($x_100_*) and 1 of ($x_20_*))) or
            ((4 of ($x_1000_*) and 1 of ($x_100_*) and 1 of ($x_30_*))) or
            ((4 of ($x_1000_*) and 1 of ($x_100_*) and 1 of ($x_70_*))) or
            ((4 of ($x_1000_*) and 2 of ($x_100_*))) or
            (all of ($x*))
        )
}

rule AdultChat_A_0
{
    meta:
        author = "defender2yara"
        detection_name = "AdultChat.A"
        threat_id = "117323"
        severity = "Critical"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "3"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {8b f0 46 8d 04 36 83 c0 03 24 fc e8 ?? ?? ff ff 8b fc 56 57 6a ff ff 75 08 66 83 27 00 6a 00 6a 00 ff 15 ?? ?? ?? ?? 85 c0 75 22 8b 35 ?? ?? ?? ?? ff d6 85 c0 74 0e ff d6 25 ff ff 00 00 0d 00 00 07 80 eb 02 33 c0 50}  //weight: 1, accuracy: Low
        $x_1_2 = {55 8b ec 83 3d ?? ?? ?? ?? 00 75 1c 68 ?? ?? ?? ?? 68 ?? ?? ?? ?? e8 ?? ?? ff ff 85 c0 74 09 83 0d ?? ?? ?? ?? ff eb 22 a1 ?? ?? ?? ?? 83 f8 ff 75 07 b8 49 00 00 80 eb 11 ff 75 18 ff 75 14 ff 75 10 ff 75 0c ff 75 08 ff d0 5d c2 14 00 83 3d ?? ?? ?? ?? 00 75 1c 68 ?? ?? ?? ?? 68 ?? ?? ?? ?? e8 ?? ?? ff ff 85 c0 74 09 83 0d ?? ?? ?? ?? ff eb 17 a1 ?? ?? ?? ?? 83 f8 ff 75 07 b8 49 00 00 80 eb 06 ff 74 24 04 ff d0 c2 04 00}  //weight: 1, accuracy: Low
        $x_1_3 = {3c 4d 45 52 43 48 3e 00 3c 50 48 4f 4e 45 3e 00 3c 4c 49 4d 49 54 3e 00 3c 50 52 49 43 45 3e 00 3c 70 3e}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule AdultChat_B_0
{
    meta:
        author = "defender2yara"
        detection_name = "AdultChat.B"
        threat_id = "121294"
        severity = "Critical"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "14"
        strings_accuracy = "Low"
    strings:
        $x_4_1 = {83 7d 0c 01 75 1f ff 75 18 ff 75 14 ff 75 10 ff 15 ?? ?? ?? ?? 8b 4d 20 f7 d8 1b c0 83 e0 03 89 01 33 c0 eb 05 b8 05 40 00 80}  //weight: 4, accuracy: Low
        $x_2_2 = "%s://%s:%s@%s:%d%s%s" ascii //weight: 2
        $x_2_3 = "\\%s\\dialers\\%s\\%s.exe" ascii //weight: 2
        $x_2_4 = "{B5DD9A64-5C4B-4a48-BE56-97C1A8F85708}" ascii //weight: 2
        $x_2_5 = "www.kjdhendieldiouyu.com" ascii //weight: 2
        $x_2_6 = "fastvideoplayerliteCtrl Class" ascii //weight: 2
        $x_1_7 = ":Zone.Identifier" ascii //weight: 1
        $x_1_8 = "/usednsupdate" ascii //weight: 1
        $x_1_9 = "/password:" ascii //weight: 1
        $x_1_10 = "/username:%s" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((5 of ($x_2_*) and 4 of ($x_1_*))) or
            ((1 of ($x_4_*) and 3 of ($x_2_*) and 4 of ($x_1_*))) or
            ((1 of ($x_4_*) and 4 of ($x_2_*) and 2 of ($x_1_*))) or
            ((1 of ($x_4_*) and 5 of ($x_2_*))) or
            (all of ($x*))
        )
}

rule Coulomb_A_0
{
    meta:
        author = "defender2yara"
        detection_name = "Coulomb.A"
        threat_id = "121631"
        severity = "Critical"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "12"
        strings_accuracy = "High"
    strings:
        $x_5_1 = {64 2e 65 78 65 00 00 00 53 6f 66 74 77 61 72 65 5c 43 6f 75 6c 6f 6d 62 5c 46 50 61 72 61 6d 00 6f 70 65 6e 00 00 00 00 41 58 4c 6f 61 64 65 72 00 00 00 00 5c 00 00 00 78 7c 63 6f 6d 6c 6f 61 64 7c 25 73}  //weight: 5, accuracy: High
        $x_5_2 = {27 6c 6f 61 64 65 72 32 20 43 6c 61 73 73 27 0d 0a 09 09 7b 0d 0a 09 09 09 50 72 6f 67 49 44 20 3d 20 73 20 27 43 6f 6d 6c 6f 61 64 2e 6c 6f 61 64 65 72 32 2e 31 27 0d 0a 09 09 09 56 65 72 73 69 6f 6e 49 6e 64 65 70 65 6e 64 65 6e 74 50 72 6f 67 49 44 20 3d 20 73 20 27 43 6f 6d 6c 6f 61 64 2e 6c 6f 61 64 65 72 32 27 27}  //weight: 5, accuracy: High
        $x_3_3 = {43 00 6f 00 6d 00 70 00 61 00 6e 00 79 00 4e 00 61 00 6d 00 65 00 00 00 00 00 43 00 6f 00 75 00 6c 00 6f 00 6d 00 62 00 20 00 4c 00 74 00 64 00 00 00 54 00 16 00 01 00 46 00 69 00 6c 00 65 00 44 00 65 00 73 00 63 00 72 00 69 00 70 00 74 00 69 00 6f 00 6e 00 00 00 00 00 43 00 6f 00 6e 00 74 00 65 00 6e 00 74 00 20 00 41 00 63 00 63 00 65 00 73 00 73 00 20 00 50 00 6c 00 75 00 67 00 69 00 6e 00 00 00 38 00 0c 00 01 00 46 00 69 00 6c 00 65 00 56 00 65 00 72 00 73 00 69 00 6f 00 6e 00 00 00 00 00 31 00 2c 00 20 00 30 00 2c 00 20 00 30 00 2c 00 20 00 31 00 30 00 00 00 30 00 08 00 01 00 49 00 6e 00 74 00 65 00 72 00 6e 00 61 00 6c 00 4e 00 61 00 6d 00 65 00 00 00 43 00 4f 00 4d 00 4c 00 4f 00 41 00 44 00 00}  //weight: 3, accuracy: High
        $x_2_4 = ".ipbill.com/" ascii //weight: 2
        $x_2_5 = "http://217.73.6" ascii //weight: 2
        $x_1_6 = "266F948A-3DEE-4270-8F55-E79ACCD569FA" ascii //weight: 1
        $x_1_7 = "AD7FAFB0-16D6-40C3-AF27-585D6E6453FD" ascii //weight: 1
        $x_1_8 = "9E1089BC-1AE8-4685-8D77-6721E5C318A8" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_5_*) and 2 of ($x_2_*) and 3 of ($x_1_*))) or
            ((1 of ($x_5_*) and 1 of ($x_3_*) and 1 of ($x_2_*) and 2 of ($x_1_*))) or
            ((1 of ($x_5_*) and 1 of ($x_3_*) and 2 of ($x_2_*))) or
            ((2 of ($x_5_*) and 2 of ($x_1_*))) or
            ((2 of ($x_5_*) and 1 of ($x_2_*))) or
            ((2 of ($x_5_*) and 1 of ($x_3_*))) or
            (all of ($x*))
        )
}

rule CyberBill_A_0
{
    meta:
        author = "defender2yara"
        detection_name = "CyberBill.A"
        threat_id = "121815"
        severity = "Critical"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "10"
        strings_accuracy = "High"
    strings:
        $x_3_1 = "http://www.hotdutchporn.net/cb/scripts/getAddressFromIP.php?wmid=" ascii //weight: 3
        $x_3_2 = "CyberbillDialer" ascii //weight: 3
        $x_3_3 = "URL:Cyberbill Protocol" ascii //weight: 3
        $x_3_4 = "~~~~~~~~.htm" ascii //weight: 3
        $x_2_5 = "CyberbillNG" ascii //weight: 2
        $x_2_6 = "dialtone" ascii //weight: 2
        $x_2_7 = "%country,ErrorUrl," ascii //weight: 2
        $x_1_8 = "http://dialin.bunm.de/" ascii //weight: 1
        $x_1_9 = "http://www.i-cash.de/" ascii //weight: 1
        $x_1_10 = "http://www.netfe.org/" ascii //weight: 1
        $x_1_11 = "http://dialin.comonline.net/" ascii //weight: 1
        $x_1_12 = "http://dialin.dnibv.com/" ascii //weight: 1
        $x_1_13 = "mozillawindowclass" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((2 of ($x_2_*) and 6 of ($x_1_*))) or
            ((3 of ($x_2_*) and 4 of ($x_1_*))) or
            ((1 of ($x_3_*) and 1 of ($x_2_*) and 5 of ($x_1_*))) or
            ((1 of ($x_3_*) and 2 of ($x_2_*) and 3 of ($x_1_*))) or
            ((1 of ($x_3_*) and 3 of ($x_2_*) and 1 of ($x_1_*))) or
            ((2 of ($x_3_*) and 4 of ($x_1_*))) or
            ((2 of ($x_3_*) and 1 of ($x_2_*) and 2 of ($x_1_*))) or
            ((2 of ($x_3_*) and 2 of ($x_2_*))) or
            ((3 of ($x_3_*) and 1 of ($x_1_*))) or
            ((3 of ($x_3_*) and 1 of ($x_2_*))) or
            ((4 of ($x_3_*))) or
            (all of ($x*))
        )
}

rule Webcont_A_0
{
    meta:
        author = "defender2yara"
        detection_name = "Webcont.A"
        threat_id = "121818"
        severity = "Critical"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {83 7c b5 c4 00 75 ?? 46 83 fe 0f 7c f3 8a 07 3c 65 74 0c 3c 70 74 08 3c 45 74 04 3c 50 75 01 47 8a 07}  //weight: 1, accuracy: Low
        $x_1_2 = {80 3f 30 75 15 8a 47 01 3c 78 74 04 3c 58 75 0a c7 45 ?? 10 00 00 00 83 c7 02 83 8d ?? ff ff ff ff 8a 07 3c 30 7c 12 3c 39 7f 0e 0f be 07 83 e8 30}  //weight: 1, accuracy: Low
        $x_1_3 = "CodeBoxDialer" ascii //weight: 1
        $x_1_4 = "WEBCONT" ascii //weight: 1
        $x_1_5 = "%02i:%02i:%02i" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule PornDialer_JF_0
{
    meta:
        author = "defender2yara"
        detection_name = "PornDialer.JF"
        threat_id = "121825"
        severity = "Critical"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "21"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = "User-Agent: ITDialer" ascii //weight: 1
        $x_1_2 = "username=%s&number=%s&dialerid=%s&maxtime=%d" ascii //weight: 1
        $x_1_3 = "www.sexelly.com" wide //weight: 1
        $x_10_4 = {8b 8d 28 fe ff ff 6b c9 68 83 b9 ?? ?? ?? ?? 00 75 16 68 ?? ?? ?? ?? 8d 95 54 fc ff ff 52 e8 ?? ?? ?? ?? 83 c4 08 eb 2a 8b 85 28 fe ff ff 6b c0 68 83 b8 ?? ?? ?? ?? 01 75 16 68 ?? ?? ?? ?? 8d 8d 54 fc ff ff 51 e8 ?? ?? ?? ?? 83 c4 08 eb 02 eb 8d 68 c8 00 00 00}  //weight: 10, accuracy: Low
        $x_10_5 = {83 c4 08 85 c0 74 44 8d 95 30 f7 ff ff 52 8d 85 28 f5 ff ff 50 68 ?? ?? ?? ?? 68 08 02 00 00 8d 8d 28 f5 ff ff 51 e8 ?? ?? ?? ?? 83 c4 14 6a 00 8d 95 30 f7 ff ff 52 8d 85 28 f5 ff ff 50 68 ?? ?? ?? ?? e8 ?? ?? ?? ?? 83 c4 10 6a 10 68 ?? ?? ?? ?? 68 ?? ?? ?? ?? e8 ?? ?? ?? ?? 83 c4 0c b9 ?? ?? ?? ?? e8 ?? ?? ?? ?? 6a 00 8b 0d ?? ?? ?? ?? 51 ff 15 ?? ?? ?? ?? 6a 00 6a 00 6a 12 8b 15 ?? ?? ?? ?? 52 ff 15 ?? ?? ?? ?? e9 ba 00 00 00 81 7d 10 eb 03 00 00}  //weight: 10, accuracy: Low
    condition:
        (filesize < 20MB) and
        (
            ((2 of ($x_10_*) and 1 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule InstantAccess_0
{
    meta:
        author = "defender2yara"
        detection_name = "InstantAccess"
        threat_id = "121982"
        severity = "Critical"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = "Port has been opened successfully." ascii //weight: 1
        $x_1_2 = "<html><iframe src=\"" ascii //weight: 1
        $x_1_3 = {65 67 61 63 63 65 73 73 [0-3] 2e 44 4c 4c}  //weight: 1, accuracy: Low
        $x_1_4 = {49 6e 73 74 61 6e 74 41 63 63 65 73 73 00 4f 70 65 6e 41 63 63 65 73 73 00 65 63 6e 68 65 00 65 73 77 68 65 00 65 75 68 77 65 00 69 65 64 69 73 63 6f}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule InstantAccess_1
{
    meta:
        author = "defender2yara"
        detection_name = "InstantAccess"
        threat_id = "121982"
        severity = "Critical"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "11"
        strings_accuracy = "Low"
    strings:
        $x_10_1 = {59 85 c0 59 0f 85 ?? ?? 00 00 8d 85 ?? ?? ff ff 68 ?? ?? ?? ?? 50 ff 15 ?? ?? 40 00 59 85 c0 59 0f 85 ?? ?? 00 00 ?? 8d 85 ?? ?? ff ff 56 50 e8 ?? ?? 00 00 83 c4 0c 8d 85 ?? ?? ff ff ?? 50 ff 15 ?? ?? 40 00 8d 85 ?? ?? ff ff 68 ?? ?? ?? ?? 50 ff 15 ?? ?? 40 00}  //weight: 10, accuracy: Low
        $x_1_2 = {5c 45 78 65 44 69 61 6c 65 72 2e 65 78 65 [0-16] 65 78 65 64 69 61 6c 65 72 [0-16] 69 6e 73 74 61 6e 74 20 61 63 63 65 73 73 2e 65 78 65}  //weight: 1, accuracy: Low
        $x_1_3 = {5c 49 6e 73 74 61 6e 74 20 41 63 63 65 73 73 5c 43 65 6e 74 65 72 5c [0-16] 43 44 69 61 6c 65 72 45 58 45 44 6c 67 3a 3a 43 72 65 61 74 65 53 68 6f 72 74 43 75 74 28 29}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_10_*) and 1 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule InstantAccess_2
{
    meta:
        author = "defender2yara"
        detection_name = "InstantAccess"
        threat_id = "121982"
        severity = "Critical"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = "<description>instant-acess</description>" ascii //weight: 1
        $x_1_2 = "<requestedExecutionLevel level=\"requireAdministrator\"" ascii //weight: 1
        $x_1_3 = "ShellExecuteA" ascii //weight: 1
        $x_1_4 = {65 67 61 63 63 65 73 73 [0-3] 2e 44 4c 4c}  //weight: 1, accuracy: Low
        $x_1_5 = {49 6e 73 74 61 6e 74 41 63 63 65 73 73 [0-5] 4f 70 65 6e 41 63 63 65 73 73 [0-5] 52 65 67 69 73 74 65 72 45 58 45 [0-5] 65 63 6e 68 65 [0-5] 65 73 77 68 65 [0-5] 65 75 68 77 65 [0-5] 69 65 64 69 73 63 6f [0-5] 73 64 73}  //weight: 1, accuracy: Low
        $x_5_6 = {4f 00 72 00 69 00 67 00 69 00 6e 00 61 00 6c 00 46 00 69 00 6c 00 65 00 6e 00 61 00 6d 00 65 00 [0-6] 49 00 6e 00 73 00 74 00 61 00 6e 00 74 00 20 00 41 00 63 00 63 00 65 00 73 00 73 00 2e 00 65 00 78 00 65 00 [0-16] 50 00 72 00 69 00 76 00 61 00 74 00 65 00 42 00 75 00 69 00 6c 00 64 00 [0-9] 50 00 72 00 6f 00 64 00 75 00 63 00 74 00 4e 00 61 00 6d 00 65 00 [0-6] 41 00 70 00 70 00 6c 00 69 00 63 00 61 00 74 00 69 00 6f 00 6e 00 [0-6] 49 00 6e 00 73 00 74 00 61 00 6e 00 74 00 20 00 41 00 63 00 63 00 65 00 73 00 73 00}  //weight: 5, accuracy: Low
    condition:
        (filesize < 20MB) and
        (
            ((5 of ($x_1_*))) or
            ((1 of ($x_5_*))) or
            (all of ($x*))
        )
}

rule WebDial_A_0
{
    meta:
        author = "defender2yara"
        detection_name = "WebDial.A"
        threat_id = "122058"
        severity = "Critical"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Software\\Webdialer\\" ascii //weight: 1
        $x_1_2 = "Software\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\Webdialer -  Reg.N" ascii //weight: 1
        $x_1_3 = "RasDialA" ascii //weight: 1
        $x_1_4 = "Software\\Microsoft\\Windows\\CurrentVersion\\Run" ascii //weight: 1
        $x_1_5 = "You must be eighteen (18) years of age or older to use this service." ascii //weight: 1
        $x_1_6 = "ShellExecuteA" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (5 of ($x*))
}

rule WebDial_B_0
{
    meta:
        author = "defender2yara"
        detection_name = "WebDial.B"
        threat_id = "123167"
        severity = "Critical"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Software\\Webdialer\\" ascii //weight: 1
        $x_1_2 = {52 65 67 2e 4e 3a 00 53 6f 66 74 77 61 72 65 5c 4d 69 63 72 6f 73 6f 66 74 5c 57 69 6e 64 6f 77 73 5c 43 75 72 72 65 6e 74 56 65 72 73 69 6f 6e 5c 55 6e 69 6e 73 74 61 6c 6c 5c 57 65 62 64 69 61 6c 65 72 20 2d}  //weight: 1, accuracy: High
        $x_1_3 = {52 61 73 44 69 61 6c 45 76 65 6e 74 00 00 00 00 2d 75 00 00 2d 64 00 00 53 74 61 72 74 20 50 61 67 65}  //weight: 1, accuracy: High
        $x_1_4 = "Software\\Microsoft\\Windows\\CurrentVersion\\Run" ascii //weight: 1
        $x_1_5 = "If you are under 18 years of age" ascii //weight: 1
        $x_1_6 = "ShellExecuteA" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Hebogo_0
{
    meta:
        author = "defender2yara"
        detection_name = "Hebogo"
        threat_id = "125525"
        severity = "Critical"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Multi Language Convert Service" ascii //weight: 1
        $x_1_2 = "MicroLabCon" ascii //weight: 1
        $x_1_3 = "Setup has finished installing Micronames" ascii //weight: 1
        $x_1_4 = "C:\\Program Files\\MicroLab" ascii //weight: 1
        $x_1_5 = "Uninstall\\Micronames" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Hebogo_1
{
    meta:
        author = "defender2yara"
        detection_name = "Hebogo"
        threat_id = "125525"
        severity = "Critical"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "http://www.microname.co.kr" wide //weight: 1
        $x_1_2 = "cMicroLab.vbp" wide //weight: 1
        $x_1_3 = "_IID_ACMICROLAB" wide //weight: 1
        $x_1_4 = "_SRCIID_ACMICROLAB" wide //weight: 1
        $x_1_5 = "MicroNames Corp." wide //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Hebogo_2
{
    meta:
        author = "defender2yara"
        detection_name = "Hebogo"
        threat_id = "125525"
        severity = "Critical"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "32"
        strings_accuracy = "High"
    strings:
        $x_10_1 = "Multi Language Convert Service" wide //weight: 10
        $x_10_2 = "MicroLabCon" wide //weight: 10
        $x_10_3 = "MicroNames Corp." wide //weight: 10
        $x_1_4 = "C:\\Program Files\\MicroLab" wide //weight: 1
        $x_1_5 = "\\SuperPopup(" wide //weight: 1
        $x_1_6 = "Pop_Key_Main" wide //weight: 1
        $x_1_7 = "Uninstall\\Micronames" wide //weight: 1
        $x_1_8 = "HKnamemom.vbp" wide //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((3 of ($x_10_*) and 2 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule Hebogo_3
{
    meta:
        author = "defender2yara"
        detection_name = "Hebogo"
        threat_id = "125525"
        severity = "Critical"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "\\SuperPopup(" wide //weight: 1
        $x_1_2 = "/Config/ServerList.asp?" wide //weight: 1
        $x_1_3 = "/Config/FormCheckTimeMicroLab.asp" wide //weight: 1
        $x_1_4 = "/Config/FormActive.asp?uno=" wide //weight: 1
        $x_1_5 = "/Config/UrlEncodeDecode.asp?q=" wide //weight: 1
        $x_1_6 = "Multi Language Convert Service" wide //weight: 1
        $x_1_7 = "MicroLabCon" wide //weight: 1
        $x_1_8 = "MicroLabProc.exe" wide //weight: 1
        $x_1_9 = "SOFTWARE\\MicroNames" wide //weight: 1
        $x_1_10 = "SOFTWARE\\MicroLab" wide //weight: 1
    condition:
        (filesize < 20MB) and
        (4 of ($x*))
}

rule Hebogo_4
{
    meta:
        author = "defender2yara"
        detection_name = "Hebogo"
        threat_id = "125525"
        severity = "Critical"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "2"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = "hebogo.co" wide //weight: 1
        $x_1_2 = {44 00 3a 00 5c 00 74 d5 f4 bc e0 ac 04 d5 5c b8 f8 ad a8 b7 5c 00 53 00 75 00 70 00 65 00 72 00 50 00 6f 00 70 00 75 00 70 00 28 00 ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? 29 00 5c 00 4d 00 69 00 63 00 72 00 6f 00 [0-6] 43 00 6f 00 6e 00 5c 00 [0-64] 2e 00 76 00 62 00 70 00}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Hebogo_5
{
    meta:
        author = "defender2yara"
        detection_name = "Hebogo"
        threat_id = "125525"
        severity = "Critical"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {4d 00 69 00 63 00 72 00 6f 00 4c 00 61 00 62 00 [0-8] 43 00 6f 00 6e 00}  //weight: 1, accuracy: Low
        $x_1_2 = "\\SuperPopup(" wide //weight: 1
        $x_1_3 = "/Config/ServerList.asp?n=" wide //weight: 1
        $x_1_4 = "co.kr/Download,http://" wide //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Hebogo_6
{
    meta:
        author = "defender2yara"
        detection_name = "Hebogo"
        threat_id = "125525"
        severity = "Critical"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {68 00 74 00 74 00 70 00 3a 00 2f 00 2f 00 6b 00 6f 00 72 00 73 00 65 00 72 00 76 00 65 00 72 00 2e 00 63 00 6f 00 6d 00 00 00}  //weight: 1, accuracy: High
        $x_1_2 = {68 00 74 00 74 00 70 00 3a 00 2f 00 2f 00 69 00 74 00 65 00 6d 00 70 00 72 00 69 00 63 00 65 00 2e 00 6b 00 72 00 00 00}  //weight: 1, accuracy: High
        $x_1_3 = "MicroLabProc" wide //weight: 1
        $x_3_4 = {8b d0 8d 8d ?? ?? ff ff ff 15 ?? ?? ?? ?? 50 6a 00 6a ff 6a 01 68 ?? ?? ?? ?? 68 ?? ?? ?? ?? 68 ?? ?? ?? ?? ff 15 ?? ?? ?? ?? 8b d0 8d 8d ?? ?? ff ff ff 15 ?? ?? ?? ?? 50 ff 15 ?? ?? ?? ?? 8b d0 8d 8d ?? ?? ff ff ff 15 ?? ?? ?? ?? 50 68 ?? ?? ?? ?? ff 15}  //weight: 3, accuracy: Low
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_3_*) and 1 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule Hebogo_7
{
    meta:
        author = "defender2yara"
        detection_name = "Hebogo"
        threat_id = "125525"
        severity = "Critical"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = "&gubun=" wide //weight: 1
        $x_1_2 = "hebogo.com" wide //weight: 1
        $x_1_3 = "microname.co.kr/download" wide //weight: 1
        $x_1_4 = "cMicroNames.acMicroNames" wide //weight: 1
        $x_1_5 = {4d 00 69 00 63 00 72 00 6f 00 4c 00 61 00 62 00 [0-8] 43 00 6f 00 6e 00}  //weight: 1, accuracy: Low
        $x_1_6 = "FileNameDataMicro.asp" wide //weight: 1
        $x_1_7 = {6b 00 69 00 6e 00 64 00 3d 00 [0-15] 26 00 75 00 5f 00 69 00 64 00 3d 00}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (5 of ($x*))
}

rule Hebogo_8
{
    meta:
        author = "defender2yara"
        detection_name = "Hebogo"
        threat_id = "125525"
        severity = "Critical"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "micronames.co.kr/Download,http:" wide //weight: 1
        $x_1_2 = "d.asp?kd=first&ugsd=" wide //weight: 1
        $x_1_3 = "#so|nb|msv|rw|ty" wide //weight: 1
        $x_1_4 = "sm|nei|nvo|pk|vr@" wide //weight: 1
        $x_1_5 = "itemprice.kr" wide //weight: 1
        $x_1_6 = "/Config/ServerList.asp?" wide //weight: 1
    condition:
        (filesize < 20MB) and
        (4 of ($x*))
}

rule Hebogo_9
{
    meta:
        author = "defender2yara"
        detection_name = "Hebogo"
        threat_id = "125525"
        severity = "Critical"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {4d 00 69 00 63 00 72 00 6f 00 4c 00 61 00 62 00 [0-8] 43 00 6f 00 6e 00}  //weight: 1, accuracy: Low
        $x_1_2 = {5c 00 53 00 75 00 70 00 65 00 72 00 50 00 6f 00 70 00 75 00 70 00 28 00 [0-16] 29 00 5c 00 50 00 72 00 6f 00 63 00 65 00 73 00 73 00 44 00 65 00 66 00 65 00 6e 00 64 00 5c 00 [0-32] 2e 00 76 00 62 00 70 00}  //weight: 1, accuracy: Low
        $x_1_3 = "/Config/ServerList.asp?uno=" wide //weight: 1
        $x_1_4 = "\\SuperPopup(" wide //weight: 1
        $x_1_5 = "&gubun=" wide //weight: 1
        $x_1_6 = {6b 00 69 00 6e 00 64 00 3d 00 [0-15] 26 00 75 00 [0-4] 64 00 3d 00}  //weight: 1, accuracy: Low
        $x_1_7 = {44 00 3a 00 5c 00 74 d5 f4 bc e0 ac 04 d5 5c b8 f8 ad a8 b7 5c 00 53 00 75 00 70 00 65 00 72 00 50 00 6f 00 70 00 75 00 70 00 28 00 ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? 29 00 5c 00 4d 00 69 00 63 00 72 00 6f 00 [0-6] 43 00 6f 00 6e 00 5c 00 [0-64] 2e 00 76 00 62 00 70 00}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (4 of ($x*))
}

rule Hebogo_10
{
    meta:
        author = "defender2yara"
        detection_name = "Hebogo"
        threat_id = "125525"
        severity = "Critical"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = "\\WinCtrCon\\WinBhoConvert" wide //weight: 1
        $x_1_2 = {5c 00 72 00 75 00 6e 00 ?? ?? ?? ?? ?? ?? 4d 00 69 00 63 00 72 00 6f 00 50 00 72 00 6f 00 43 00 6f 00 6e 00 ?? ?? ?? ?? ?? ?? 4d 00 69 00 63 00 72 00 6f 00 50 00 72 00 6f 00 50 00 72 00 6f 00 63 00}  //weight: 1, accuracy: Low
        $x_1_3 = "/Config/AdNw/FcTimeLab.asp" wide //weight: 1
        $x_1_4 = {2f 00 43 00 6f 00 6e 00 66 00 69 00 67 00 2f 00 6e 00 65 00 [0-8] 77 00 63 00 [0-8] 6f 00 6e 00 66 00 2f 00 44 00 63 00 70 00 67 00 72 00 61 00 6d 00 2e 00 61 00 73 00 70 00 3f 00 6e 00 3d 00}  //weight: 1, accuracy: Low
        $x_1_5 = {5c 00 52 00 65 00 74 00 61 00 69 00 6e 00 47 00 61 00 72 00 64 00 ?? ?? ?? ?? ?? ?? 41 00 63 00 74 00 44 00 61 00 74 00 65 00 ?? ?? ?? ?? ?? ?? 2f 00 66 00}  //weight: 1, accuracy: Low
        $x_1_6 = {6b 00 6f 00 72 00 65 00 61 00 73 00 65 00 72 00 76 00 65 00 72 00 2e 00 6b 00 72 00 00 00 32 00}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (5 of ($x*))
}

rule Hebogo_11
{
    meta:
        author = "defender2yara"
        detection_name = "Hebogo"
        threat_id = "125525"
        severity = "Critical"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "8"
        strings_accuracy = "Low"
    strings:
        $x_2_1 = {6d 64 6c 52 65 67 00 00 63 41 70 70 48 69 64 65}  //weight: 2, accuracy: High
        $x_2_2 = "MicroLab" wide //weight: 2
        $x_2_3 = "itemprice.kr" wide //weight: 2
        $x_1_4 = {41 00 63 00 74 00 44 00 61 00 74 00 65 00 [0-16] 2f 00 43 00 6f 00 6e 00 66 00 69 00 67 00 2f 00 50 00 72 00}  //weight: 1, accuracy: Low
        $x_1_5 = "/Config/ServerList.asp?" wide //weight: 1
        $x_1_6 = {5c 00 4d 00 69 00 63 00 72 00 6f 00 50 00 72 00 6f 00 43 00 6f 00 6e 00 5c 00 46 00 69 00 6c 00 65 00 43 00 6f 00 6e 00 66 00 69 00 67 00 2e 00 76 00 62 00 70 00 00 00}  //weight: 1, accuracy: High
        $x_1_7 = {5c 00 4d 00 69 00 63 00 72 00 6f 00 50 00 72 00 6f 00 43 00 6f 00 6e 00 [0-2] 5c 00 4d 00 69 00 63 00 72 00 6f 00 43 00 6f 00 6e 00 [0-8] 2e 00 76 00 62 00 70 00}  //weight: 1, accuracy: Low
        $x_1_8 = "ConvertCon" ascii //weight: 1
        $x_1_9 = "MicroProCon\\MicroCon.vbp" wide //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_2_*) and 6 of ($x_1_*))) or
            ((2 of ($x_2_*) and 4 of ($x_1_*))) or
            ((3 of ($x_2_*) and 2 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule Hebogo_12
{
    meta:
        author = "defender2yara"
        detection_name = "Hebogo"
        threat_id = "125525"
        severity = "Critical"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "8"
        strings_accuracy = "Low"
    strings:
        $x_2_1 = "Config/AdNw/Pr" wide //weight: 2
        $x_2_2 = {0c 00 4d 69 63 72 6f 46 69 6c 65 43 6f 6e 00 0d 01 0f 00 4d 69 63 72 6f 4c 61 62 43 6f 6e 46 6f 72 6d 00}  //weight: 2, accuracy: High
        $x_2_3 = {6d 64 6c 52 65 67 00 00 63 41 70 70 48 69 64 65}  //weight: 2, accuracy: High
        $x_2_4 = "MicroLab" wide //weight: 2
        $x_2_5 = {43 00 6f 00 76 00 6e 00 66 00 69 00 67 00 [0-6] 76 00 6e 00 66 00}  //weight: 2, accuracy: Low
        $x_2_6 = "ConvertCon" ascii //weight: 2
        $x_2_7 = {47 75 61 72 64 43 6f 6e 76 65 72 74 00 00 00}  //weight: 2, accuracy: High
        $x_1_8 = "itemprice.kr" wide //weight: 1
        $x_1_9 = "koreaserver.kr" wide //weight: 1
        $x_1_10 = "\\MicroProCon\\SeconFile.vbp" wide //weight: 1
        $x_1_11 = {5c 00 47 00 75 00 61 00 72 00 64 00 43 00 6f 00 6e 00 76 00 65 00 72 00 74 00 73 00 5c 00 [0-32] 2e 00 76 00 62 00 70 00}  //weight: 1, accuracy: Low
        $x_1_12 = {5c 00 47 00 75 00 61 00 72 00 64 00 43 00 6f 00 6e 00 76 00 5c 00 [0-32] 2e 00 76 00 62 00 70 00}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (
            ((2 of ($x_2_*) and 4 of ($x_1_*))) or
            ((3 of ($x_2_*) and 2 of ($x_1_*))) or
            ((4 of ($x_2_*))) or
            (all of ($x*))
        )
}

rule Hebogo_13
{
    meta:
        author = "defender2yara"
        detection_name = "Hebogo"
        threat_id = "125525"
        severity = "Critical"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "6"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {5c 00 4d 00 69 00 63 00 72 00 6f 00 50 00 72 00 6f 00 43 00 6f 00 6e 00 5c 00 46 00 69 00 6c 00 65 00 43 00 6f 00 6e 00 66 00 69 00 67 00 2e 00 76 00 62 00 70 00 00 00}  //weight: 1, accuracy: High
        $x_1_2 = {2e 00 61 00 73 00 70 00 3f 00 76 00 65 00 72 00 73 00 69 00 6f 00 6e 00 3d 00 00 00 10 00 00 00 21 00 44 00 4f 00 43 00 54 00 59 00 50 00 45 00 00 00}  //weight: 1, accuracy: High
        $x_1_3 = "Config/ServerList.asp?n=" wide //weight: 1
        $x_1_4 = "MicroLab" wide //weight: 1
        $x_1_5 = "itemprice.kr" wide //weight: 1
        $x_1_6 = "frmVRsite" wide //weight: 1
        $x_1_7 = "#so|nb|msv|rw|ty" wide //weight: 1
        $x_1_8 = "sm|nei|nvo|pk|vr@" wide //weight: 1
        $x_1_9 = {5c 00 72 00 75 00 6e 00 00 00 0e 00 00 00 43 00 6f 00 6e 00 76 00 65 00 72 00 74 00 00 00}  //weight: 1, accuracy: High
        $x_1_10 = {41 00 63 00 74 00 44 00 61 00 74 00 65 00 [0-16] 2f 00 43 00 6f 00 6e 00 66 00 69 00 67 00 2f 00 50 00 72 00 6f 00 67 00 72 00}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (6 of ($x*))
}

rule Hebogo_14
{
    meta:
        author = "defender2yara"
        detection_name = "Hebogo"
        threat_id = "125525"
        severity = "Critical"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "11"
        strings_accuracy = "Low"
    strings:
        $x_4_1 = "loadform.co.kr/Download,http://220.73.162.2/Download" wide //weight: 4
        $x_4_2 = "/220.73.162.3/Download,http://220.73.162.4/Download" wide //weight: 4
        $x_2_3 = "\\MicroLab\\SearchEngin\\LanguageConvert" wide //weight: 2
        $x_2_4 = {73 00 4d 00 69 00 63 00 72 00 6f 00 [0-2] 50 00 72 00 6f 00 43 00 6f 00 6e 00}  //weight: 2, accuracy: Low
        $x_2_5 = "[/adminkeywordpop]" wide //weight: 2
        $x_2_6 = "micronames.co.kr/Download" wide //weight: 2
        $x_2_7 = "les\\micrOLAb\\SearchEngin" wide //weight: 2
        $x_2_8 = "/Config/ConvertLanguageMicroLab.asp" wide //weight: 2
        $x_1_9 = "tp://azgogo.net/download" wide //weight: 1
        $x_1_10 = "/advertisedistinct/alrim/" wide //weight: 1
        $x_1_11 = "/korserver.com" wide //weight: 1
        $x_1_12 = "/Config/Pop_Key_MainDistinct.asp" wide //weight: 1
        $x_1_13 = "/FormActive.asp?uno=" wide //weight: 1
        $x_1_14 = "keyword_platinum.asp?user_no=" wide //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((3 of ($x_2_*) and 5 of ($x_1_*))) or
            ((4 of ($x_2_*) and 3 of ($x_1_*))) or
            ((5 of ($x_2_*) and 1 of ($x_1_*))) or
            ((6 of ($x_2_*))) or
            ((1 of ($x_4_*) and 1 of ($x_2_*) and 5 of ($x_1_*))) or
            ((1 of ($x_4_*) and 2 of ($x_2_*) and 3 of ($x_1_*))) or
            ((1 of ($x_4_*) and 3 of ($x_2_*) and 1 of ($x_1_*))) or
            ((1 of ($x_4_*) and 4 of ($x_2_*))) or
            ((2 of ($x_4_*) and 3 of ($x_1_*))) or
            ((2 of ($x_4_*) and 1 of ($x_2_*) and 1 of ($x_1_*))) or
            ((2 of ($x_4_*) and 2 of ($x_2_*))) or
            (all of ($x*))
        )
}

rule Scom_0
{
    meta:
        author = "defender2yara"
        detection_name = "Scom"
        threat_id = "126315"
        severity = "Critical"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "33"
        strings_accuracy = "High"
    strings:
        $x_10_1 = "Software\\SCom" ascii //weight: 10
        $x_10_2 = "phoneGetHookSwitch" ascii //weight: 10
        $x_10_3 = "lineUncompleteCall" ascii //weight: 10
        $x_1_4 = "/dontdial /noconnect" ascii //weight: 1
        $x_1_5 = "windows\\%s.exe /dontdial /delayload /install" ascii //weight: 1
        $x_1_6 = {2f 64 70 6e 32 20 00 00 00 00 00 00 55 44 50 4e 5f 4e 4f 55 49 00 00 00 2f 64 69 61 6c 6e 64 73}  //weight: 1, accuracy: High
        $x_1_7 = {2f 63 6e 74 6e 6f 77 20 00 00 00 00 2f 68 61 6e 67 75 70 20 00 00 00 00 56 45 4e 44 4f 52 49 44 3a}  //weight: 1, accuracy: High
        $x_1_8 = "displaydialup.jhtml" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((3 of ($x_10_*) and 3 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule Look2Me_B_0
{
    meta:
        author = "defender2yara"
        detection_name = "Look2Me.B"
        threat_id = "126354"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "ZEROTRACE Installer" ascii //weight: 1
        $x_1_2 = "http://www.look2me.com/cgi" ascii //weight: 1
        $x_1_3 = "method=POST" ascii //weight: 1
        $x_1_4 = "Software\\Look2Me" ascii //weight: 1
        $x_1_5 = "CreateToolhelp32Snapshot" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Look2Me_D_0
{
    meta:
        author = "defender2yara"
        detection_name = "Look2Me.D"
        threat_id = "126864"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Installer<b>" ascii //weight: 1
        $x_1_2 = "http://www.look2me.com" ascii //weight: 1
        $x_1_3 = "</form></div><script language='javascript'>" ascii //weight: 1
        $x_1_4 = "Software\\Look2Me" ascii //weight: 1
        $x_1_5 = "OnToolBar" ascii //weight: 1
        $x_1_6 = "method=POST><input type='hidden' name='id'" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Look2Me_E_0
{
    meta:
        author = "defender2yara"
        detection_name = "Look2Me.E"
        threat_id = "126865"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "16"
        strings_accuracy = "High"
    strings:
        $x_5_1 = "CLSID\\%s\\InprocServer32" ascii //weight: 5
        $x_5_2 = "SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\Notify\\Guardian" ascii //weight: 5
        $x_5_3 = "Application Install" ascii //weight: 5
        $x_5_4 = "{DDFFA75A" ascii //weight: 5
        $x_1_5 = "ZEROTRACE" wide //weight: 1
        $x_1_6 = "SURFSCAN.com" wide //weight: 1
        $x_1_7 = "c:\\L2M application\\Dev\\Installer" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((3 of ($x_5_*) and 1 of ($x_1_*))) or
            ((4 of ($x_5_*))) or
            (all of ($x*))
        )
}

rule EGroupInstantAccess_0
{
    meta:
        author = "defender2yara"
        detection_name = "EGroupInstantAccess"
        threat_id = "127697"
        severity = "Critical"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "7"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\Connections" ascii //weight: 2
        $x_2_2 = "InternetSetOption failed!" ascii //weight: 2
        $x_2_3 = {53 6f 66 74 77 61 72 65 5c 65 67 72 6f 75 70 00}  //weight: 2, accuracy: High
        $x_1_4 = " = s 'DialCom Class'" ascii //weight: 1
        $x_1_5 = "= s 'IEDial Class'" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((3 of ($x_2_*) and 1 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule WebHancer_A_0
{
    meta:
        author = "defender2yara"
        detection_name = "WebHancer.A"
        threat_id = "127924"
        severity = "47"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "15"
        strings_accuracy = "High"
    strings:
        $x_3_1 = "whieshm.dll" ascii //weight: 3
        $x_3_2 = "whAgent.exe" ascii //weight: 3
        $x_3_3 = "Software\\webHancer" ascii //weight: 3
        $x_3_4 = "whiehlpr.dll" ascii //weight: 3
        $x_6_5 = "whiedc.STATIC" ascii //weight: 6
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_6_*) and 3 of ($x_3_*))) or
            (all of ($x*))
        )
}

rule WebHancer_A_1
{
    meta:
        author = "defender2yara"
        detection_name = "WebHancer.A"
        threat_id = "127924"
        severity = "47"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "8"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "whieshm.dll" ascii //weight: 2
        $x_2_2 = "whAgent.exe" ascii //weight: 2
        $x_2_3 = "Software\\webHancer" ascii //weight: 2
        $x_2_4 = "whiedc.dll" ascii //weight: 2
        $x_1_5 = {43 6f 6c 6c 65 63 74 6f 72 4f 70 65 6e 00 00 00 43 6f 6c 6c 65 63 74 6f 72 57 72 69 74 65 00 00 43 6f 6c 6c 65 63 74 6f 72 43 6c 6f 73 65}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (
            ((4 of ($x_2_*))) or
            (all of ($x*))
        )
}

rule WebHancer_A_2
{
    meta:
        author = "defender2yara"
        detection_name = "WebHancer.A"
        threat_id = "127924"
        severity = "47"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "12"
        strings_accuracy = "High"
    strings:
        $x_3_1 = {77 65 62 68 61 6e 63 65 72 00 00}  //weight: 3, accuracy: High
        $x_3_2 = "wbhshare.dll" ascii //weight: 3
        $x_3_3 = "webhdll.dll" ascii //weight: 3
        $x_3_4 = "WebHancer Shim will not function" ascii //weight: 3
        $x_3_5 = "WhInetMutex" ascii //weight: 3
        $x_1_6 = "WHCURT=%c" ascii //weight: 1
        $x_1_7 = "WHAVGT=%c" ascii //weight: 1
        $x_1_8 = "WHCUR=%04d" ascii //weight: 1
        $x_1_9 = "\\Speed.log" wide //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((3 of ($x_3_*) and 3 of ($x_1_*))) or
            ((4 of ($x_3_*))) or
            (all of ($x*))
        )
}

rule WebHancer_A_3
{
    meta:
        author = "defender2yara"
        detection_name = "WebHancer.A"
        threat_id = "127924"
        severity = "47"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "15"
        strings_accuracy = "High"
    strings:
        $x_3_1 = "webHancer [UDP/IP]" wide //weight: 3
        $x_3_2 = "webHancer [TCP/IP]" wide //weight: 3
        $x_3_3 = {00 77 65 62 68 64 6c 6c 2e 64 6c 6c}  //weight: 3, accuracy: High
        $x_3_4 = "regwebh.dll" ascii //weight: 3
        $x_3_5 = "RegWhWs2Lsp" ascii //weight: 3
        $x_3_6 = "UnregWhWs2Lsp" ascii //weight: 3
        $x_3_7 = "whAgentPageData" ascii //weight: 3
        $x_3_8 = "whiehlpr.dll" ascii //weight: 3
        $x_3_9 = "programs\\wbhshare.dll" ascii //weight: 3
    condition:
        (filesize < 20MB) and
        (5 of ($x*))
}

rule WebHancer_A_4
{
    meta:
        author = "defender2yara"
        detection_name = "WebHancer.A"
        threat_id = "127924"
        severity = "47"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "13"
        strings_accuracy = "High"
    strings:
        $x_3_1 = "webHancer" wide //weight: 3
        $x_3_2 = "whieshm.dll" ascii //weight: 3
        $x_3_3 = "#!$[whAgent]$!#" ascii //weight: 3
        $x_3_4 = "Software\\webHancer\\CC" ascii //weight: 3
        $x_3_5 = "{23571E6C-CA95-4aa6-B236-6DB2B26BB68C}" ascii //weight: 3
        $x_1_6 = "webHancer Customer Companion Information" ascii //weight: 1
        $x_1_7 = "CLICKAWAY" ascii //weight: 1
        $x_1_8 = "CLICKTHROUGH" ascii //weight: 1
        $x_1_9 = "NOT_ABANDONED" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((3 of ($x_3_*) and 4 of ($x_1_*))) or
            ((4 of ($x_3_*) and 1 of ($x_1_*))) or
            ((5 of ($x_3_*))) or
            (all of ($x*))
        )
}

rule WebHancer_A_5
{
    meta:
        author = "defender2yara"
        detection_name = "WebHancer.A"
        threat_id = "127924"
        severity = "47"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "7"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "software\\webhancer" ascii //weight: 2
        $x_2_2 = "webHancer Survey Companion" ascii //weight: 2
        $x_2_3 = "whSurvey.ini" ascii //weight: 2
        $x_1_4 = "6AD10F18-D630-4eb6-9712-470371E95F57" ascii //weight: 1
        $x_1_5 = "9FF5D9A0-5EEB-45ce-B500-2491D1410E25" ascii //weight: 1
        $x_1_6 = "71BA7250-BC07-4cd2-BAB0-3E84FEBB108E" ascii //weight: 1
        $x_1_7 = "B84E731B-D2ED-4e82-8182-A52FD4714284" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((2 of ($x_2_*) and 3 of ($x_1_*))) or
            ((3 of ($x_2_*) and 1 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule WebHancer_A_6
{
    meta:
        author = "defender2yara"
        detection_name = "WebHancer.A"
        threat_id = "127924"
        severity = "47"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "11"
        strings_accuracy = "High"
    strings:
        $x_3_1 = "\\Programs\\whsurvey.exe" ascii //weight: 3
        $x_3_2 = "\\Programs\\whagent.exe" ascii //weight: 3
        $x_3_3 = "\\Programs\\webhdll.dll" ascii //weight: 3
        $x_3_4 = "2AA291C5-03E7-46bc-AC8C-14FB091A49CC" ascii //weight: 3
        $x_1_5 = "Customer Companion" ascii //weight: 1
        $x_1_6 = "Survey Companion" ascii //weight: 1
        $x_1_7 = "Software\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\webHancer Agent" ascii //weight: 1
        $x_1_8 = "UnregWhWs2Lsp" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((3 of ($x_3_*) and 2 of ($x_1_*))) or
            ((4 of ($x_3_*))) or
            (all of ($x*))
        )
}

rule WebHancer_A_7
{
    meta:
        author = "defender2yara"
        detection_name = "WebHancer.A"
        threat_id = "127924"
        severity = "47"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "15"
        strings_accuracy = "High"
    strings:
        $x_3_1 = "Software\\webHancer" ascii //weight: 3
        $x_3_2 = "webHancer Installer" ascii //weight: 3
        $x_3_3 = "The webHancer base directory value is not set" ascii //weight: 3
        $x_3_4 = "The webHancer '%s' registry value is not set.  The software cannot be removed." ascii //weight: 3
        $x_3_5 = "webHancer software %s %s" ascii //weight: 3
        $x_3_6 = "Initialization of the webHancer installer failed." ascii //weight: 3
    condition:
        (filesize < 20MB) and
        (5 of ($x*))
}

rule WebHancer_A_8
{
    meta:
        author = "defender2yara"
        detection_name = "WebHancer.A"
        threat_id = "127924"
        severity = "47"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "9"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "WhInetMutex" wide //weight: 2
        $x_2_2 = "webHancer" wide //weight: 2
        $x_2_3 = "msafd.dll" wide //weight: 2
        $x_2_4 = "Software\\webHancer" ascii //weight: 2
        $x_2_5 = "webhdll.dll" ascii //weight: 2
        $x_1_6 = "sporder.dll" ascii //weight: 1
        $x_1_7 = "6A803934-0F46-489a-B02A-8A6DDFE30BB0-" ascii //weight: 1
        $x_1_8 = "74F5FD53-368F-4e0d-805B-4A983826EF91-" ascii //weight: 1
        $x_1_9 = "912B4D64-E5A5-4bfc-9808-4CF149F2F965-" ascii //weight: 1
        $x_1_10 = "B317949A-EE2E-48e6-BE41-CD5744F706D2-" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((2 of ($x_2_*) and 5 of ($x_1_*))) or
            ((3 of ($x_2_*) and 3 of ($x_1_*))) or
            ((4 of ($x_2_*) and 1 of ($x_1_*))) or
            ((5 of ($x_2_*))) or
            (all of ($x*))
        )
}

rule WebHancer_B_0
{
    meta:
        author = "defender2yara"
        detection_name = "WebHancer.B"
        threat_id = "127925"
        severity = "Low"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "12"
        strings_accuracy = "High"
    strings:
        $x_3_1 = "Software\\webHancer" ascii //weight: 3
        $x_3_2 = "B84E731B-D2ED-4e82-8182-A52FD4714284" ascii //weight: 3
        $x_3_3 = "CCF23955-C5EC-4eca-9166-53DC22C1DBC9" ascii //weight: 3
        $x_3_4 = "whiehlpr.dll" ascii //weight: 3
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule PornDialer_H_0
{
    meta:
        author = "defender2yara"
        detection_name = "PornDialer.H"
        threat_id = "128290"
        severity = "Critical"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "27"
        strings_accuracy = "Low"
    strings:
        $x_10_1 = "RasSetEntryDialParamsA" ascii //weight: 10
        $x_1_2 = "verificato un errore. L'applicazione Verr" ascii //weight: 1
        $x_1_3 = "QUELLO CHE TI PIACE" ascii //weight: 1
        $x_1_4 = "STOP-PEDOFILIA" ascii //weight: 1
        $x_1_5 = "MODEM" ascii //weight: 1
        $x_1_6 = "Apertura Porta..." ascii //weight: 1
        $x_1_7 = "Connessione Device..." ascii //weight: 1
        $x_1_8 = "CONNESSO!" ascii //weight: 1
        $x_10_9 = {83 f8 05 7f 36 74 2d 2b c7 74 22 48 74 18 48 74 0e 48 0f 85 8d 00 00 00 68 ?? ?? 40 00 eb 7f 68 ?? ?? 40 00 eb 78 68 ?? ?? 40 00 eb 71 68 ?? ?? 40 00 eb 6a 68 ?? ?? 40 00 eb 63 83 e8 06 74 59 2d fa 1f 00 00 74 0a 48 75 5b 68 ?? ?? 40 00 eb 4d 68 ?? ?? 40 00 8b ce e8 ?? ?? ?? ?? 6a 01 58 50}  //weight: 10, accuracy: Low
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule SafeSurfing_0
{
    meta:
        author = "defender2yara"
        detection_name = "SafeSurfing"
        threat_id = "135023"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = "tmr_SurfTimer" ascii //weight: 1
        $x_1_2 = "TuTorrentService" ascii //weight: 1
        $x_1_3 = {43 4d 44 54 6f 53 65 72 76 ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? 53 65 6c 66 ?? ?? ?? ?? ?? ?? ?? ?? ?? 03 43 4d 44 ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? 4d 73 67}  //weight: 1, accuracy: Low
        $x_1_4 = "ad2.php?ad=ads&s=" ascii //weight: 1
        $x_1_5 = "Rand100to999" ascii //weight: 1
        $x_1_6 = "jetswap.com" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (4 of ($x*))
}

rule SafeSurfing_1
{
    meta:
        author = "defender2yara"
        detection_name = "SafeSurfing"
        threat_id = "135023"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "12"
        strings_accuracy = "High"
    strings:
        $x_4_1 = "gvum=1-fo2leqnv`q*fkk4szh+mcoAlttn@2-hl-gbrusau,frn0prd+ljk?" wide //weight: 4
        $x_5_2 = "http://go.jetswap.com/ssflang.php?it=4893473" wide //weight: 5
        $x_3_3 = "SafeSurf.Resources.resources" ascii //weight: 3
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Obfp_B_0
{
    meta:
        author = "defender2yara"
        detection_name = "Obfp.B"
        threat_id = "137699"
        severity = "Critical"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "23"
        strings_accuracy = "Low"
    strings:
        $x_10_1 = {55 8b ec 81 ec ?? ?? 00 00 56 83 a5 58 fd ff ff 00 83 a5 88 fd ff ff 00 83 a5 5c fd ff ff 00 83 a5 ?? ?? ff ff 00 83 65 bc 00 c6 45 d4 75 c6 45 d5 73 c6 45 d6 65 c6 45 d7 72 c6 45 d8 33 c6 45 d9 32 c6 45 da 2e c6 45 db 64 c6 45 dc 6c c6 45 dd 6c c6 45 de 00 c6 85 ?? ?? ff ff 4d c6 85 ?? ?? ff ff 65 c6 85 ?? ?? ff ff 73 c6 85 ?? ?? ff ff 73 c6 85 ?? ?? ff ff 61 c6 85 ?? ?? ff ff 67 c6 85 ?? ?? ff ff 65 c6 85 ?? ?? ff ff 42 c6 85 ?? ?? ff ff 6f c6 85 ?? ?? ff ff 78 c6 85 ?? ?? ff ff 41 c6 85 ?? ?? ff ff 00}  //weight: 10, accuracy: Low
        $x_10_2 = {c6 85 60 fd ff ff 6b c6 85 61 fd ff ff 65 c6 85 62 fd ff ff 72 c6 85 63 fd ff ff 6e c6 85 64 fd ff ff 65 c6 85 65 fd ff ff 6c c6 85 66 fd ff ff 33 c6 85 67 fd ff ff 32 c6 85 68 fd ff ff 2e c6 85 69 fd ff ff 64 c6 85 6a fd ff ff 6c c6 85 6b fd ff ff 6c c6 85 6c fd ff ff 00}  //weight: 10, accuracy: High
        $x_1_3 = {8b 75 fc 8b 4d 0c 0f b6 36 c1 e1 08 0b ce c1 e0 08 ff 45 fc 89 4d 0c [0-3] 8b f0 c1 ee 0b 0f af f1 39 75 0c 73 15 8b c6 be 00 08 00 00 2b f1 c1 ee 05 03 f1 89 [0-2] 03 d2 eb}  //weight: 1, accuracy: Low
        $x_1_4 = {ff ff 00 c6 85 ?? ?? ff ff 43 c6 85 ?? ?? ff ff 72 c6 85 ?? ?? ff ff 79 c6 85 ?? ?? ff ff 70 c6 85 ?? ?? ff ff 74 c6 85 ?? ?? ff ff 41 c6 85 ?? ?? ff ff 63 c6 85 ?? ?? ff ff 71 c6 85 ?? ?? ff ff 75 c6 85 ?? ?? ff ff 69 c6 85 ?? ?? ff ff 72 c6 85 ?? ?? ff ff 65 c6 85 ?? ?? ff ff 43 c6 85 ?? ?? ff ff 6f c6 85 ?? ?? ff ff 6e c6 85 ?? ?? ff ff 74 c6 85 ?? ?? ff ff 65 c6 85 ?? ?? ff ff 78 c6 85 ?? ?? ff ff 74 c6 85 ?? ?? ff ff 41}  //weight: 1, accuracy: Low
        $x_1_5 = {ff ff 00 c6 85 ?? ?? ff ff 43 c6 85 ?? ?? ff ff 72 c6 85 ?? ?? ff ff 79 c6 85 ?? ?? ff ff 70 c6 85 ?? ?? ff ff 74 c6 85 ?? ?? ff ff 44 c6 85 ?? ?? ff ff 65 c6 85 ?? ?? ff ff 72 c6 85 ?? ?? ff ff 69 c6 85 ?? ?? ff ff 76 c6 85 ?? ?? ff ff 65 c6 85 ?? ?? ff ff 4b c6 85 ?? ?? ff ff 65 c6 85 ?? ?? ff ff 79}  //weight: 1, accuracy: Low
        $x_1_6 = {ff ff 00 c6 85 ?? ?? ff ff 43 c6 85 ?? ?? ff ff 72 c6 85 ?? ?? ff ff 79 c6 85 ?? ?? ff ff 70 c6 85 ?? ?? ff ff 74 c6 85 ?? ?? ff ff 44 c6 85 ?? ?? ff ff 65 c6 85 ?? ?? ff ff 63 c6 85 ?? ?? ff ff 72 c6 85 ?? ?? ff ff 79 c6 85 ?? ?? ff ff 70 c6 85 ?? ?? ff ff 74}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (
            ((2 of ($x_10_*) and 3 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule Webdialer_0
{
    meta:
        author = "defender2yara"
        detection_name = "Webdialer"
        threat_id = "142060"
        severity = "Critical"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_1_1 = ".cfm?tid=&cn_id=" ascii //weight: 1
        $x_1_2 = "Opening the port..." ascii //weight: 1
        $x_1_3 = "Software\\Webdialer" ascii //weight: 1
        $x_1_4 = "PREMIUM LONG DISTANCE TOLL" ascii //weight: 1
        $x_1_5 = {53 6f 66 74 77 61 72 65 5c 4d 69 63 72 6f 73 6f 66 74 5c 49 6e 74 65 72 6e 65 74 20 45 78 70 6c 6f 72 65 72 5c 4d 61 69 6e 00 00 00 41 75 74 6f 43 6f 6e 6e 65 63 74}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Ranfruct_0
{
    meta:
        author = "defender2yara"
        detection_name = "Ranfruct"
        threat_id = "142219"
        severity = "Critical"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "41"
        strings_accuracy = "High"
    strings:
        $x_10_1 = {50 6c 65 61 73 65 20 57 61 69 74 00 25 73 5c 25 73 2e 65 78 65}  //weight: 10, accuracy: High
        $x_10_2 = "AuthChangePassword" ascii //weight: 10
        $x_10_3 = "EnableAutodial" ascii //weight: 10
        $x_10_4 = "ciblcimmdighdinidipedijidiaicinmbibec" ascii //weight: 10
        $x_1_5 = "freshkiss.net" ascii //weight: 1
        $x_1_6 = "cutygirls.net" ascii //weight: 1
        $x_1_7 = "g-spot.to/free" ascii //weight: 1
        $x_1_8 = "somethingpink.com" ascii //weight: 1
        $x_1_9 = "iij4u.or.jp" ascii //weight: 1
        $x_1_10 = "sukebeland.net/ad" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((4 of ($x_10_*) and 1 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule C2Lop_0
{
    meta:
        author = "defender2yara"
        detection_name = "C2Lop"
        threat_id = "143451"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "%02X-%02X-%02X-%02X-%02X-%02X" ascii //weight: 1
        $x_1_2 = "&MacName=" ascii //weight: 1
        $x_1_3 = {49 4e 53 63 72 69 70 74 2e 64 6c 6c 00 44 6c 6c 43 61 6e 55 6e 6c 6f 61 64 4e 6f 77}  //weight: 1, accuracy: High
        $x_1_4 = "wakenet\\installer\\plugins" ascii //weight: 1
        $x_1_5 = "8F12605B-00AA-4B29-95C6-2D77C8ED32A8" wide //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Accepis_0
{
    meta:
        author = "defender2yara"
        detection_name = "Accepis"
        threat_id = "143818"
        severity = "Critical"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {61 63 74 69 62 72 6f 77 2e 64 6c 6c [0-4] 2f 63 [0-4] 25 73 25 73}  //weight: 1, accuracy: Low
        $x_1_2 = "file://%sindex.html" ascii //weight: 1
        $x_1_3 = "%s Unistall" ascii //weight: 1
        $x_1_4 = "PHONEACCESSEXE" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Rinorp_A_0
{
    meta:
        author = "defender2yara"
        detection_name = "Rinorp.A"
        threat_id = "143862"
        severity = "Critical"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {4d 6f 64 75 6c 65 31 [0-4] 46 6f 72 6d 31 [0-4] 44 69 61 6c 65 72}  //weight: 1, accuracy: Low
        $x_1_2 = "cmdCreateConnection_Click" ascii //weight: 1
        $x_1_3 = "Windows\\Favorites\\Totally Free XXX.url" wide //weight: 1
        $x_1_4 = "Click Connect" wide //weight: 1
        $x_1_5 = "access to the hottest XXX porn" wide //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Chargit_0
{
    meta:
        author = "defender2yara"
        detection_name = "Chargit"
        threat_id = "143938"
        severity = "Critical"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "\\program\\plugins\\npchargitplug.dll" ascii //weight: 1
        $x_1_2 = "activexcache" ascii //weight: 1
        $x_1_3 = "http://%s/nph-update.cgi?%s" ascii //weight: 1
        $x_1_4 = "chargitplug_wininet" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Adultcont_0
{
    meta:
        author = "defender2yara"
        detection_name = "Adultcont"
        threat_id = "143992"
        severity = "Critical"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "http://192.168.0.17/adultcont" ascii //weight: 1
        $x_1_2 = "Area adulti" ascii //weight: 1
        $x_1_3 = "Thank you for using this Dialer" ascii //weight: 1
        $x_1_4 = "i-Dialer connection" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule DoubleD_0
{
    meta:
        author = "defender2yara"
        detection_name = "DoubleD"
        threat_id = "144734"
        severity = "95"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "{5617ECA9-488D-4BA2-8562-9710B9AB78D2}" ascii //weight: 1
        $x_1_2 = "desktopsmiley_" ascii //weight: 1
        $x_1_3 = "stbup.exe" ascii //weight: 1
        $x_1_4 = "%s\\%s /preupdate" ascii //weight: 1
        $x_1_5 = "desktopsmiley.startonce" wide //weight: 1
        $x_1_6 = "general.useragent.extra.desktopsmiley" wide //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule DoubleD_1
{
    meta:
        author = "defender2yara"
        detection_name = "DoubleD"
        threat_id = "144734"
        severity = "95"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "{5617ECA9-488D-4BA2-8562-9710B9AB78D2}" wide //weight: 1
        $x_1_2 = "http://www.desktopsmiley.com/toolbar/desktopsmiley/download/" wide //weight: 1
        $x_1_3 = {73 00 74 00 62 00 64 00 6c 00 2e 00 65 00 78 00 65 00 00 00 20 00 2f 00 62 00 79 00 70 00 61 00 73 00 73 00 3d 00}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule DoubleD_2
{
    meta:
        author = "defender2yara"
        detection_name = "DoubleD"
        threat_id = "144734"
        severity = "95"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "42"
        strings_accuracy = "High"
    strings:
        $x_10_1 = "<A href=\"%s\"><IMG id=\"%s\" src=\"%s\" alt=\"%s\" border=\"0\">" wide //weight: 10
        $x_10_2 = "SMDL_MUTEX" wide //weight: 10
        $x_10_3 = "Internet Explorer_Server" wide //weight: 10
        $x_10_4 = "{5617ECA9-488D-4BA2-8562-9710B9AB78D2}" wide //weight: 10
        $x_5_5 = "(IM with .*? from .*?)" wide //weight: 5
        $x_1_6 = "Module_Smiley_TellAFriend.mx" wide //weight: 1
        $x_1_7 = "desktopsmiley_" wide //weight: 1
        $x_1_8 = "OE_Envelope" wide //weight: 1
        $x_1_9 = "TBBtnSmiley20.bmp" wide //weight: 1
        $x_1_10 = "im_smiley__adv_img" wide //weight: 1
        $x_1_11 = "MSBLWindowClass" wide //weight: 1
        $x_1_12 = "AolHDllMsgWin" wide //weight: 1
        $x_5_13 = "SOFTWARE\\AOL\\AIM\\6" wide //weight: 5
        $x_1_14 = "YIMInputWindow" wide //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((3 of ($x_10_*) and 1 of ($x_5_*) and 7 of ($x_1_*))) or
            ((3 of ($x_10_*) and 2 of ($x_5_*) and 2 of ($x_1_*))) or
            ((4 of ($x_10_*) and 2 of ($x_1_*))) or
            ((4 of ($x_10_*) and 1 of ($x_5_*))) or
            (all of ($x*))
        )
}

rule DoubleD_3
{
    meta:
        author = "defender2yara"
        detection_name = "DoubleD"
        threat_id = "144734"
        severity = "95"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "0\" smiley=\"%s\"></A>" wide //weight: 1
        $x_1_2 = {69 00 6d 00 5f 00 73 00 6d 00 69 00 6c 00 65 00 79 00 5f 00 69 00 6d 00 67 00 00 00}  //weight: 1, accuracy: High
        $x_1_3 = {41 00 64 00 5f 00 43 00 6f 00 64 00 65 00 00 00}  //weight: 1, accuracy: High
        $x_1_4 = {44 00 6f 00 75 00 62 00 6c 00 65 00 44 00 00 00}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (3 of ($x*))
}

rule DoubleD_4
{
    meta:
        author = "defender2yara"
        detection_name = "DoubleD"
        threat_id = "144734"
        severity = "95"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {53 00 6d 00 69 00 6c 00 65 00 79 00 41 00 70 00 70 00 20 00 48 00 65 00 6c 00 70 00 65 00 72 00 00 00 00 00 73 00 74 00 62 00 61 00 70 00 70 00 48 00 65 00 6c 00 70 00 65 00 72 00 2e 00 65 00 78 00 65 00}  //weight: 1, accuracy: High
        $x_1_2 = "SmileyHookAPIExe\\" ascii //weight: 1
        $x_1_3 = {48 00 6f 00 6f 00 6b 00 20 00 4d 00 53 00 4e 00 20 00 46 00 61 00 69 00 6c 00 65 00 64 00 00 00}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule DoubleD_5
{
    meta:
        author = "defender2yara"
        detection_name = "DoubleD"
        threat_id = "144734"
        severity = "95"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {45 00 39 00 37 00 42 00 45 00 37 00 41 00 38 00 2d 00 37 00 46 00 42 00 41 00 2d 00 34 00 39 00 46 00 41 00 2d 00 41 00 37 00 34 00 32 00 2d 00 42 00 43 00 46 00 42 00 35 00 44 00 41 00 41 00 30 00 45 00 44 00 35 00 7d 00 00 00}  //weight: 1, accuracy: High
        $x_1_2 = "?AVCAxGifAnimatorModule@@" ascii //weight: 1
        $x_1_3 = {41 78 47 69 66 41 6e 69 6d 61 74 6f 72 2e 44 4c 4c 00}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule DoubleD_6
{
    meta:
        author = "defender2yara"
        detection_name = "DoubleD"
        threat_id = "144734"
        severity = "95"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {44 00 6f 00 75 00 62 00 6c 00 65 00 44 00 20 00 41 00 64 00 76 00 65 00 72 00 74 00 69 00 73 00 69 00 6e 00 67 00 20 00 4c 00 69 00 6d 00 69 00 74 00 65 00 64 00 0a 00}  //weight: 1, accuracy: High
        $x_1_2 = {73 00 6d 00 69 00 6c 00 65 00 79 00 5f 00 74 00 65 00 6c 00 6c 00 5f 00 66 00 72 00 69 00 65 00 6e 00 64 00 5f 00 75 00 72 00 6c 00 00 00}  //weight: 1, accuracy: High
        $x_1_3 = {73 00 74 00 62 00 61 00 73 00 73 00 74 00 2e 00 65 00 78 00 65 00 00 00}  //weight: 1, accuracy: High
        $x_1_4 = "SmileyCore.dll" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (3 of ($x*))
}

rule DoubleD_7
{
    meta:
        author = "defender2yara"
        detection_name = "DoubleD"
        threat_id = "144734"
        severity = "95"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {48 6f 6f 6b 41 6c 6c 50 72 6f 63 65 73 73 00 48 6f 6f 6b 4f 6e 65 50 72 6f 63 65 73 73 32 00 48 6f 6f 6b 4f 6e 65 50 72 6f 63 65 73 73 00 55 6e}  //weight: 1, accuracy: High
        $x_1_2 = {4c 6f 61 64 4d 79 44 6c 6c 20 25 73 20 66 61 69 6c 65 64 21 00}  //weight: 1, accuracy: High
        $x_1_3 = {48 6f 6f 6b 41 50 49 4e 54 2e 64 6c 6c 00}  //weight: 1, accuracy: High
        $x_1_4 = {65 78 70 6c 6f 72 65 72 2e 65 78 65 [0-4] 73 76 63 68 6f 73 74 2e 65 78 65 [0-4] 6c 73 61 73 73 2e 65 78 65 [0-4] 73 65 72 76 69 63 65 73 2e 65 78 65 [0-4] 77 69 6e 6c 6f 67 6f 6e 2e 65 78 65 [0-4] 73 6d 73 73 2e 65 78 65}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule DoubleD_8
{
    meta:
        author = "defender2yara"
        detection_name = "DoubleD"
        threat_id = "144734"
        severity = "95"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = "IMG id=\"%s\" src=\"%s\" alt=\"%s\" border=\"0\"" wide //weight: 1
        $x_1_2 = "SMDL_MUTEX" wide //weight: 1
        $x_1_3 = "im_smiley_img" wide //weight: 1
        $x_1_4 = {59 59 74 27 85 c0 ff 75 e4 ff 75 e8 ff 37 68 ?? ?? ?? ?? 75 07 68 ?? ?? ?? ?? eb 05 68 ?? ?? ?? ?? 68 ?? ?? ?? ?? e9 ?? ?? ?? ?? 85 c0 75 14 ff 75 e8 ff 37}  //weight: 1, accuracy: Low
        $x_1_5 = {ff 75 e8 ff 37 68 ?? ?? ?? ?? 68 ?? ?? ?? ?? 68 ?? ?? ?? ?? ff 75 e0 e8 ?? ?? ?? ?? 83 c4 18}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule DoubleD_9
{
    meta:
        author = "defender2yara"
        detection_name = "DoubleD"
        threat_id = "144734"
        severity = "95"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = "D45817B8-3EAD-4d1d-8FCA-EC63A8E35DE2" ascii //weight: 1
        $x_1_2 = "hotvideobar_" ascii //weight: 1
        $x_1_3 = {67 65 6e 65 72 61 6c 2e 75 73 65 72 61 67 65 6e 74 2e 65 78 74 72 61 [0-5] 68 6f 74 76 69 64 65 6f 62 61 72}  //weight: 1, accuracy: Low
        $x_1_4 = {67 00 65 00 6e 00 65 00 72 00 61 00 6c 00 2e 00 75 00 73 00 65 00 72 00 61 00 67 00 65 00 6e 00 74 00 2e 00 65 00 78 00 74 00 72 00 61 00 [0-5] 68 00 6f 00 74 00 76 00 69 00 64 00 65 00 6f 00 62 00 61 00 72 00}  //weight: 1, accuracy: Low
        $x_1_5 = "CurrentVersion\\Internet Settings\\User Agent\\Post Platform" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (4 of ($x*))
}

rule DoubleD_10
{
    meta:
        author = "defender2yara"
        detection_name = "DoubleD"
        threat_id = "144734"
        severity = "95"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "52"
        strings_accuracy = "High"
    strings:
        $x_50_1 = {44 00 6f 00 75 00 62 00 6c 00 65 00 44 00 00 00}  //weight: 50, accuracy: High
        $x_50_2 = {35 00 36 00 31 00 37 00 45 00 43 00 41 00 39 00 2d 00 34 00 38 00 38 00 44 00 2d 00 34 00 42 00 41 00 32 00 2d 00 38 00 35 00 36 00 32 00 2d 00 39 00 37 00 31 00 30 00 42 00 39 00 41 00 42 00 37 00 38 00 44 00 32 00 7d 00 00 00}  //weight: 50, accuracy: High
        $x_1_3 = {73 00 74 00 62 00 64 00 6c 00 2e 00 65 00 78 00 65 00 00 00}  //weight: 1, accuracy: High
        $x_1_4 = "/confirmPixel.do?p.pixelType=" wide //weight: 1
        $x_1_5 = "/download/cdn2/CurrentVersion.xml" wide //weight: 1
        $x_1_6 = {25 73 09 46 75 6e 43 65 6e 74 65 72 20 44 6f 77 6e 0a 0a 00 25 73 09 46 75 6e 43 65 6e 74 65 72 20 55 70}  //weight: 1, accuracy: High
        $x_1_7 = {61 00 64 00 62 00 61 00 72 00 5f 00 64 00 65 00 66 00 61 00 75 00 6c 00 74 00 5f 00 73 00 65 00 61 00 72 00 63 00 68 00 5f 00 75 00 72 00 6c 00 00 00}  //weight: 1, accuracy: High
        $x_1_8 = {73 00 74 00 62 00 61 00 73 00 73 00 74 00 2e 00 65 00 78 00 65 00 00 00 73 00 74 00 62 00 30 00 2e 00 64 00 6c 00 6c 00}  //weight: 1, accuracy: High
        $x_1_9 = {72 00 69 00 63 00 68 00 65 00 64 00 32 00 30 00 53 00 6d 00 69 00 6c 00 65 00 79 00 2e 00 64 00 6c 00 6c 00 00 00}  //weight: 1, accuracy: High
        $x_1_10 = {65 00 79 00 2e 00 64 00 6c 00 6c 00 00 00 00 00 6d 00 73 00 6e 00 6d 00 73 00 67 00 72 00 2e 00 65 00 78 00 65 00 00 00 72 00 69 00 63 00 68 00 65 00 64 00 32 00 30 00 2e 00 64 00 6c 00 6c 00}  //weight: 1, accuracy: High
        $x_1_11 = "desktopsmiley_" wide //weight: 1
        $x_1_12 = "%s\\zzz_%04d-%04d.htm" wide //weight: 1
        $x_1_13 = {46 00 61 00 69 00 6c 00 65 00 64 00 20 00 74 00 6f 00 20 00 53 00 74 00 61 00 72 00 74 00 20 00 53 00 6d 00 69 00 6c 00 65 00 79 00 20 00 44 00 69 00 61 00 6c 00 6f 00 67 00 00 00}  //weight: 1, accuracy: High
        $x_1_14 = {73 00 74 00 62 00 61 00 70 00 70 00 2e 00 65 00 78 00 65 00 00 00}  //weight: 1, accuracy: High
        $x_1_15 = {54 6f 6f 6c 62 61 72 20 44 6f 77 6e 6c 6f 61 64 65 72 00}  //weight: 1, accuracy: High
        $x_1_16 = {73 00 74 00 62 00 75 00 70 00 2e 00 65 00 78 00 65 00 00 00}  //weight: 1, accuracy: High
        $x_1_17 = {54 00 6f 00 6f 00 6c 00 62 00 61 00 72 00 20 00 55 00 70 00 64 00 61 00 74 00 65 00 72 00 00 00}  //weight: 1, accuracy: High
        $x_1_18 = {25 73 26 70 2e 70 69 78 65 6c 54 79 70 65 3d 25 73 26 68 64 73 6e 3d 25 73 26 6d 3d 25 73 26 6c 6f 3d 25 73 26 69 69 3d 25 73 00}  //weight: 1, accuracy: High
        $x_1_19 = {73 00 73 00 5f 00 70 00 69 00 78 00 65 00 6c 00 5f 00 61 00 66 00 66 00 69 00 64 00 5f 00 65 00 6e 00 61 00 62 00 6c 00 65 00 00 00}  //weight: 1, accuracy: High
        $x_1_20 = "desktopsmiley_(\\d+)_(\\d+)_(\\d+)_(\\d+)_(\\d+)" wide //weight: 1
        $x_1_21 = "smiley_pixel_" wide //weight: 1
        $x_1_22 = "p.pixelType=%s&a=%s&s=%s&p.price=%s&p.pixel=%s&" ascii //weight: 1
        $x_1_23 = "CDBFB47B-58A8-4111-BF95-06178DCE326D}" wide //weight: 1
        $x_1_24 = ".?AUIFunRedirector@@" ascii //weight: 1
        $x_1_25 = {35 32 39 37 45 39 30 35 2d 31 44 46 42 2d 34 41 39 43 2d 39 38 37 31 2d 41 34 46 39 35 46 44 35 38 39 34 35 7d 00}  //weight: 1, accuracy: High
        $x_1_26 = ".?AVCFunModule@@" ascii //weight: 1
        $x_1_27 = "/CallByUpdater=Yes /s %s" wide //weight: 1
        $x_1_28 = "%s.com/startBMDownload.do?pa=1&%s" wide //weight: 1
        $x_1_29 = {2f 00 62 00 79 00 70 00 61 00 73 00 73 00 3d 00 00 00 00 00 2e 00 78 00 6d 00 6c 00 00 00 00 00 2f 00 75 00 72 00 6c 00 3d 00}  //weight: 1, accuracy: High
        $x_1_30 = "?GetPixelAffid@" ascii //weight: 1
        $x_1_31 = "?GetAdsURL@" ascii //weight: 1
        $x_1_32 = "LCACommon.dll" wide //weight: 1
        $x_1_33 = "Live Content Advancer" wide //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_50_*) and 2 of ($x_1_*))) or
            ((2 of ($x_50_*))) or
            (all of ($x*))
        )
}

rule Terdial_A_0
{
    meta:
        author = "defender2yara"
        detection_name = "Terdial.A"
        threat_id = "148968"
        severity = "Critical"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "31"
        strings_accuracy = "High"
    strings:
        $x_10_1 = "Windows\\smart32.exe" wide //weight: 10
        $x_10_2 = {43 65 52 75 6e 41 70 70 41 74 54 69 6d 65 00}  //weight: 10, accuracy: High
        $x_10_3 = {43 00 45 00 55 00 58 00 0c 00 48 00 49 00 5f 00 52 00 45 00 53 00 5f 00 41 00 57 00 41 00 52 00 45 00 01 00 00 00}  //weight: 10, accuracy: High
        $x_1_4 = "+17675033611" wide //weight: 1
        $x_1_5 = "+88213213214" wide //weight: 1
        $x_1_6 = "+25240221601" wide //weight: 1
        $x_1_7 = "+2392283261" wide //weight: 1
        $x_1_8 = {2b 00 38 00 38 00 31 00 38 00 34 00 32 00 30 00 31 00 31 00 31 00 32 00 33 00 00 00}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (
            ((3 of ($x_10_*) and 1 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule Loudmo_0
{
    meta:
        author = "defender2yara"
        detection_name = "Loudmo"
        threat_id = "149351"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "12"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = "AdwAdBrFrm" wide //weight: 1
        $x_1_2 = "museum" wide //weight: 1
        $x_1_3 = "AdwAdWnd" wide //weight: 1
        $x_10_4 = {2a 0c 3a 99 f7 fe 8a c1 8a 0d ?? ?? ?? ?? fe c1 f6 2c 3a}  //weight: 10, accuracy: Low
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_10_*) and 2 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule Loudmo_1
{
    meta:
        author = "defender2yara"
        detection_name = "Loudmo"
        threat_id = "149351"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = "partners.adtelect.com/post/?CellID=" ascii //weight: 1
        $x_1_2 = "websearch.php?src=tops&search=" ascii //weight: 1
        $x_1_3 = "<key>HomePage</key>" ascii //weight: 1
        $x_1_4 = "congratulations.php?aff=" ascii //weight: 1
        $x_2_5 = {61 66 66 3d 22 [0-8] 22 20 2f 61 64 6f 6d 3d 22 [0-8] 22 20 2f 70 61 72 65 6e 74 3d}  //weight: 2, accuracy: Low
    condition:
        (filesize < 20MB) and
        (
            ((4 of ($x_1_*))) or
            ((1 of ($x_2_*) and 2 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule Loudmo_2
{
    meta:
        author = "defender2yara"
        detection_name = "Loudmo"
        threat_id = "149351"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "13"
        strings_accuracy = "Low"
    strings:
        $x_5_1 = {83 c0 02 83 f8 2a 72 20 00 33 c0 66 8b [0-4] 8b [0-5] 66 03 01 01 01 83 81 33 [0-4] 66 89}  //weight: 5, accuracy: Low
        $x_5_2 = {83 c0 02 83 f8 10 72 20 00 33 c0 66 8b [0-4] 8b [0-5] 66 03 01 01 01 83 81 33 [0-4] 66 89}  //weight: 5, accuracy: Low
        $x_5_3 = {83 c0 02 83 f8 0e 72 20 00 33 c0 66 8b [0-4] 8b [0-5] 66 03 01 01 01 83 81 33 [0-4] 66 89}  //weight: 5, accuracy: Low
        $x_3_4 = "AdwAdWnd" wide //weight: 3
        $x_3_5 = "AdwAdBrFrm" wide //weight: 3
    condition:
        (filesize < 20MB) and
        (
            ((2 of ($x_5_*) and 1 of ($x_3_*))) or
            ((3 of ($x_5_*))) or
            (all of ($x*))
        )
}

rule Loudmo_3
{
    meta:
        author = "defender2yara"
        detection_name = "Loudmo"
        threat_id = "149351"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_2_1 = {8b 16 0f b6 54 02 01 8b 4e 08 32 14 01 03 c8 88 51 01 8b 16 0f b6 54 02 02 8b 4e 08 32 54 01 01 03 c8 88 51 02 8b 16 0f b6 54 02 03}  //weight: 2, accuracy: High
        $x_1_2 = "invalid vector<t> subscript" ascii //weight: 1
        $x_1_3 = {64 6c 6c 63 61 6e 75 6e 6c 6f 61 64 6e 6f 77 00 64 6c 6c 67 65 74 63 6c 61 73 73 6f 62 6a 65 63 74 00 64 6c 6c 72 65 67 69 73 74 65 72 73 65 72 76 65 72 00 64 6c 6c 75 6e 72 65 67 69 73 74 65 72 73 65 72 76 65 72}  //weight: 1, accuracy: High
        $x_1_4 = "profitmuse" wide //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Loudmo_4
{
    meta:
        author = "defender2yara"
        detection_name = "Loudmo"
        threat_id = "149351"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "7"
        strings_accuracy = "High"
    strings:
        $x_5_1 = "LoudMo Contextual Ad Assistant" ascii //weight: 5
        $x_1_2 = {2f 73 65 74 75 70 2e 61 73 70 3f 72 65 73 3d 6f 6b 26 69 64 3d fd a8 80 22 2c 20 74 20 22 fd 9a 80 5c 6e 73 73 73}  //weight: 1, accuracy: High
        $x_1_3 = {2f 72 65 6d 6f 76 65 2e 61 73 70 3f 69 64 3d fd a8 80 22 2c 20 74 20 22 fd 9a 80 5c 75 6e 73 73 73}  //weight: 1, accuracy: High
        $x_1_4 = {52 31 2c 20 30 5d 3b 09 6a 2b 2b 09 7d 3b 09 74 5b 69 5d 20 3d 20 63 72 63 33 32 5f 72 65 66 6c 65 63 74 28 74 5b 69 5d 2c 20 33 32 29 3b 69 2b 2b 3b}  //weight: 1, accuracy: High
        $x_1_5 = {00 61 61 61 37 33 30 38 65 2d 61 62 30 39 2d 34 63 37 38 2d 61 66 35 33 2d 31 38 63 32 37 38 34 62 33 64 62 65 00}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_5_*) and 2 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule Loudmo_5
{
    meta:
        author = "defender2yara"
        detection_name = "Loudmo"
        threat_id = "149351"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "3"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {83 4d fc ff 8d 4d 88 a5 a5 e8 ?? ?? ?? ?? 8b 45 08 8d 75 e4 8b f8 8b 4d f4 a5 a5 a5 a5 5f 5e 64 89 0d 00 00 00 00 c9 c3}  //weight: 1, accuracy: Low
        $x_1_2 = "\\Local Settings\\Temporary Internet Files\\low" wide //weight: 1
        $x_1_3 = {44 6c 6c 43 61 6e 55 6e 6c 6f 61 64 4e 6f 77 00 44 6c 6c 47 65 74 43 6c 61 73 73 4f 62 6a 65 63 74 00 44 6c 6c 52 65 67 69 73 74 65 72 53 65 72 76 65 72 00 44 6c 6c 55 6e 72 65 67 69 73 74 65 72 53 65 72 76 65 72}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Loudmo_6
{
    meta:
        author = "defender2yara"
        detection_name = "Loudmo"
        threat_id = "149351"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_2_1 = {8b 16 0f b6 14 02 32 14 01 8b 7e 08 88 14 38 8b 16 0f b6 54 02 01 32 54 01 01 8b 7e 08 88 54 07 01 8b 16 0f b6 54 02 02 32 54 01 02}  //weight: 2, accuracy: High
        $x_2_2 = "\\Local Settings\\Temporary Internet Files\\low" wide //weight: 2
        $x_1_3 = "invalid vector<T> subscript" ascii //weight: 1
        $x_1_4 = {44 6c 6c 43 61 6e 55 6e 6c 6f 61 64 4e 6f 77 00 44 6c 6c 47 65 74 43 6c 61 73 73 4f 62 6a 65 63 74 00 44 6c 6c 52 65 67 69 73 74 65 72 53 65 72 76 65 72 00 44 6c 6c 55 6e 72 65 67 69 73 74 65 72 53 65 72 76 65 72}  //weight: 1, accuracy: High
        $x_1_5 = {4e 53 5f 46 72 65 65 00 78 70 63 6f 6d 2e 64 6c 6c 00}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (
            ((2 of ($x_2_*) and 2 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule Loudmo_7
{
    meta:
        author = "defender2yara"
        detection_name = "Loudmo"
        threat_id = "149351"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "56"
        strings_accuracy = "Low"
    strings:
        $x_50_1 = "Software\\AppDataLow\\HavingFunOnline" ascii //weight: 50
        $x_5_2 = {6c 6f 75 64 6d 6f 2e [0-16] 2f 61 66 66 5f 69 3f 6f 66 66 65 72 5f 69 64 3d [0-3] 26 61 66 66 5f 69 64 3d}  //weight: 5, accuracy: Low
        $x_2_3 = "/usr/getgeoipinfo.php?gup=" ascii //weight: 2
        $x_2_4 = "/usr/register_svc.php?gup=" ascii //weight: 2
        $x_1_5 = "{SearchTerms}" ascii //weight: 1
        $x_1_6 = "websearch.php?src=tops&search=" ascii //weight: 1
        $x_1_7 = "<key>HomePage</key>" ascii //weight: 1
        $x_1_8 = "iamwired.net" ascii //weight: 1
        $x_1_9 = "Bing/SearchToolbar-loudmo.exe" ascii //weight: 1
        $x_1_10 = "Bing/SearchToolbar-flvdirect.exe" ascii //weight: 1
        $x_1_11 = "Bing/SearchToolbar-gamebound.exe" ascii //weight: 1
        $x_1_12 = "chameleontom.com/track.php?v=" ascii //weight: 1
        $x_1_13 = "babelfishnetwork.com/Babylon" ascii //weight: 1
        $x_1_14 = "ibabelfish.com/Babylon" ascii //weight: 1
        $x_1_15 = "BingToolbar-loudmo.exe" ascii //weight: 1
        $n_100_16 = "register@havingfunonline.com" ascii //weight: -100
    condition:
        (filesize < 20MB) and
        (not (any of ($n*))) and
        (
            ((1 of ($x_50_*) and 6 of ($x_1_*))) or
            ((1 of ($x_50_*) and 1 of ($x_2_*) and 4 of ($x_1_*))) or
            ((1 of ($x_50_*) and 2 of ($x_2_*) and 2 of ($x_1_*))) or
            ((1 of ($x_50_*) and 1 of ($x_5_*) and 1 of ($x_1_*))) or
            ((1 of ($x_50_*) and 1 of ($x_5_*) and 1 of ($x_2_*))) or
            (all of ($x*))
        )
}

rule Infoaxe_0
{
    meta:
        author = "defender2yara"
        detection_name = "Infoaxe"
        threat_id = "149584"
        severity = "9"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {37 31 37 45 44 44 45 30 2d 34 34 34 46 2d 34 66 66 30 2d 42 39 43 39 2d 46 36 30 45 43 34 32 33 45 36 39 30 7d 00}  //weight: 1, accuracy: High
        $x_1_2 = {32 46 38 44 35 30 30 45 2d 34 35 34 36 2d 34 35 62 37 2d 39 32 33 36 2d 44 34 46 44 39 38 35 30 43 46 31 43 7d 00}  //weight: 1, accuracy: High
        $x_1_3 = {61 64 64 74 6f 73 6f 66 74 6c 69 6e 6b 73 66 6f 72 6d 2e 6a 73 70 3f 71 3d 25 55 52 4c 25 [0-5] 41 64 64 20 74 6f 20 71 75 69 63 6b 20 6c 69 6e 6b 73}  //weight: 1, accuracy: Low
        $x_1_4 = "SearchScopes\\infoaxe_google" ascii //weight: 1
        $x_1_5 = {44 69 73 70 6c 61 79 4e 61 6d 65 00 47 6f 6f 67 6c 65 20 2b 20 49 6e 66 6f 61 78 65}  //weight: 1, accuracy: High
        $x_1_6 = "Infoaxe\\InfoaxeToolbar" wide //weight: 1
        $x_1_7 = {44 49 53 50 49 44 5f 53 41 59 48 45 4c 4c 4f 00}  //weight: 1, accuracy: High
        $x_1_8 = "infoaxe.com/enhancedsearchform.jsp" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (4 of ($x*))
}

rule Adkubru_0
{
    meta:
        author = "defender2yara"
        detection_name = "Adkubru"
        threat_id = "152758"
        severity = "3"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "43"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "bho_project.dll" ascii //weight: 1
        $x_1_2 = "NoRemove 'Browser Helper Objects'" ascii //weight: 1
        $x_1_3 = "{625F420E-A4A9-4B40-BC23-716C1C43893A}" ascii //weight: 1
        $x_20_4 = "secure.loadasset.info/run.js" wide //weight: 20
        $x_20_5 = "{186E19A3-B909-4F48-B687-BB81EB8BC7CE}" wide //weight: 20
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Adkubru_1
{
    meta:
        author = "defender2yara"
        detection_name = "Adkubru"
        threat_id = "152758"
        severity = "3"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "43"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "bho_project.dll" ascii //weight: 1
        $x_1_2 = "NoRemove 'Browser Helper Objects'" ascii //weight: 1
        $x_1_3 = "{47CEEE9C-3B9B-492C-95CA-1AC3A99D154C}" ascii //weight: 1
        $x_1_4 = "{BA0454C5-FD30-428E-8DB9-3FF87A612F64}" ascii //weight: 1
        $x_1_5 = "{68DD98BF-9DE8-418C-89F0-E37AC61CC2D9}" ascii //weight: 1
        $x_1_6 = "{5C2E8E24-2F41-4958-921E-5A41DA19CFD6}" ascii //weight: 1
        $x_1_7 = "{3B002D6C-B678-4EC0-B2E0-1F7F36F065E8}" ascii //weight: 1
        $x_1_8 = "{b8c4f7f0-aee3-466c-9bfe-a0626c0395fe}" ascii //weight: 1
        $x_1_9 = "{82EA3E77-7BD2-4744-A8F2-670770767EC5}" ascii //weight: 1
        $x_1_10 = "{530BA0BB-BA29-42DA-B340-2773677E21D4}" ascii //weight: 1
        $x_1_11 = "{D0DBA715-D402-4801-9F0A-4A31165F6CAA}" ascii //weight: 1
        $x_1_12 = "{DB26DEC7-5D32-4608-BB28-ED22fAE7647A}" ascii //weight: 1
        $x_1_13 = "{8F04D391-CC20-4BAE-8517-50371C7349D2}" ascii //weight: 1
        $x_1_14 = "{F74E10BB-A169-4399-B121-183935962F67}" ascii //weight: 1
        $x_1_15 = "{7C74FF88-1A7D-406E-B94B-7DD8ABCC9DCC}" ascii //weight: 1
        $x_1_16 = "{F90A5A0D-CD98-49CC-9AA7-9CD11C7478BF}" ascii //weight: 1
        $x_1_17 = "{9194649F-7143-4308-90C1-D6A35B0E354E}" ascii //weight: 1
        $x_1_18 = "{87DD11DC-DD09-496C-BAEB-FD0954206973}" ascii //weight: 1
        $x_1_19 = "{2C45C304-4FC4-42AE-BF02-209008005AD2}" ascii //weight: 1
        $x_20_20 = "secure.secureasset.info/run.js" wide //weight: 20
        $x_20_21 = "secure.netloader.cc/run.js" wide //weight: 20
        $x_20_22 = "secure.loadasset.info/run.js" wide //weight: 20
        $x_20_23 = "{186E19A3-B909-4F48-B687-BB81EB8BC7CE}" wide //weight: 20
        $x_20_24 = "{2CFCFE64-23D3-4DAB-95A6-7441E0650DD0}" wide //weight: 20
    condition:
        (filesize < 20MB) and
        (
            ((2 of ($x_20_*) and 3 of ($x_1_*))) or
            ((3 of ($x_20_*))) or
            (all of ($x*))
        )
}

rule ClickPotato_0
{
    meta:
        author = "defender2yara"
        detection_name = "ClickPotato"
        threat_id = "153288"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "21"
        strings_accuracy = "High"
    strings:
        $x_10_1 = {eb 02 33 c0 8d 74 46 02 3b f3 72 b4 89 7d f4 85 ff 0f 8e 41 01 00 00 8b 5d 08 8b 0b 8b 41 f4 8b f0 2b f7 89 45 fc 89 75 ec 3b f0 7e 02 8b c6 85 c0 79 0a 68 57 00 07 80 e8}  //weight: 10, accuracy: High
        $x_10_2 = {4e 50 5f 47 65 74 45 6e 74 72 79 50 6f 69 6e 74 73 00 4e 50 5f 49 6e 69}  //weight: 10, accuracy: High
        $x_1_3 = {50 00 69 00 6e 00 62 00 61 00 6c 00 6c 00 20 00 43 00 6f 00 72 00 70}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule ClickPotato_1
{
    meta:
        author = "defender2yara"
        detection_name = "ClickPotato"
        threat_id = "153288"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "B60B6603-ACCF-4ce9-BF54-D59DEE0EAAC6" wide //weight: 1
        $x_1_2 = "ClickPotato Resource DLL" wide //weight: 1
        $x_1_3 = "http://open/?url=" ascii //weight: 1
        $x_1_4 = "its.not.ok" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule ClickPotato_2
{
    meta:
        author = "defender2yara"
        detection_name = "ClickPotato"
        threat_id = "153288"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Zbsrv.exe" ascii //weight: 1
        $x_1_2 = "SBUSA.exe" ascii //weight: 1
        $x_1_3 = "SADF.exe" ascii //weight: 1
        $x_1_4 = "clientaxproxy.dll" ascii //weight: 1
        $x_1_5 = "&comp_id=" ascii //weight: 1
        $x_1_6 = "Software\\Zango" ascii //weight: 1
        $x_1_7 = "Sending tracked event:" ascii //weight: 1
        $x_1_8 = "enable_ts_logging" ascii //weight: 1
        $x_1_9 = "{90B8B761-DF2B-48ac-BBE0-BCC03A819B3B}" ascii //weight: 1
        $x_1_10 = "{E1BACF55-35E1-4e47-9247-2D48660E5545}" ascii //weight: 1
        $x_1_11 = "{07AA283A-43D7-4CBE-A064-32A21112D94D}" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (6 of ($x*))
}

rule ClickPotato_3
{
    meta:
        author = "defender2yara"
        detection_name = "ClickPotato"
        threat_id = "153288"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "downloads.180solutions.com/" ascii //weight: 1
        $x_1_2 = "&adurl=%s&errorurl=%s&adid=%s&status=%d" ascii //weight: 1
        $x_1_3 = "Click here to stop showing ads when I am at:" ascii //weight: 1
        $x_1_4 = "This ad is from ClickPotato" ascii //weight: 1
        $x_1_5 = "<P>To uninstall ClickPotato" ascii //weight: 1
        $x_1_6 = "clickpotato.tv/" ascii //weight: 1
        $x_1_7 = {43 00 6c 00 69 00 63 00 6b 00 50 00 6f 00 74 00 61 00 74 00 6f 00 20 00 53 00 65 00 61 00 72 00 63 00 68 00 20 00 41 00 73 00 73 00 69 00 73 00 74 00 61 00 6e 00 74 00 00 00}  //weight: 1, accuracy: High
        $x_1_8 = "By clicking \"Keep ClickPotato" wide //weight: 1
    condition:
        (filesize < 20MB) and
        (5 of ($x*))
}

rule ClickPotato_4
{
    meta:
        author = "defender2yara"
        detection_name = "ClickPotato"
        threat_id = "153288"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "13"
        strings_accuracy = "High"
    strings:
        $x_10_1 = {43 00 6c 00 69 00 63 00 6b 00 50 00 6f 00 74 00 61 00 74 00 6f 00 20 00 53 00 65 00 61 00 72 00 63 00 68 00 20 00 41 00 73 00 73 00 69 00 73 00 74 00 61 00 6e 00 74 00 00 00}  //weight: 10, accuracy: High
        $x_5_2 = {53 65 61 72 63 68 20 41 73 73 69 73 74 61 6e 74 00}  //weight: 5, accuracy: High
        $x_5_3 = {4f 6e 65 38 54 53 6f 6c 75 74 69 6f 6e 73 50 40 73 73 57 25 72 64 00}  //weight: 5, accuracy: High
        $x_1_4 = {6f 6e 65 38 74 73 6f 6c 75 74 69 6f 6e 73 73 69 67 6e 40 74 75 72 33 00}  //weight: 1, accuracy: High
        $x_1_5 = {6f 6e 65 38 74 73 6f 6c 75 74 69 6f 6e 73 63 6f 6e 74 40 69 6e 33 72 6e 40 6d 65 00}  //weight: 1, accuracy: High
        $x_1_6 = "ClickPotatoLiteAX.Info" ascii //weight: 1
        $x_1_7 = {63 6f 75 6c 64 20 6e 6f 74 20 63 6f 6e 6e 65 63 74 20 74 6f 20 61 64 73 2e 61 73 70 78 00}  //weight: 1, accuracy: High
        $x_1_8 = "popping a GAD ad - ad id (%s)  keyword id (%s)" ascii //weight: 1
        $x_1_9 = {62 6b 75 70 5f 61 64 5f 75 72 6c 00}  //weight: 1, accuracy: High
        $x_1_10 = {62 6b 75 70 5f 61 64 5f 75 24 72 6c 00}  //weight: 1, accuracy: High
        $x_1_11 = {44 6f 77 6e 6c 6f 61 64 73 2e 31 38 30 73 6f 6c 75 74 69 6f 6e 73 2e 63 6f 6d 2f 6b 65 79 77 6f 72 64 73 2f 00}  //weight: 1, accuracy: High
        $x_1_12 = {6e 6f 77 68 65 72 65 2e 31 38 30 73 6f 6c 75 74 69 6f 6e 73 2e 63 6f 6d 00}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_5_*) and 8 of ($x_1_*))) or
            ((2 of ($x_5_*) and 3 of ($x_1_*))) or
            ((1 of ($x_10_*) and 3 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_5_*))) or
            (all of ($x*))
        )
}

rule ClickPotato_5
{
    meta:
        author = "defender2yara"
        detection_name = "ClickPotato"
        threat_id = "153288"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "3"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {03 c1 8b 4d 0c 8d 4c 08 ff 80 39 00 74 ?? 8b 7d 10 8b f0 2b f8 0f be 14 37 8a 92 ?? ?? ?? ?? 88 16 46 3b f1 76 ef}  //weight: 1, accuracy: Low
        $x_1_2 = "\\\\.\\Scsi%d:" ascii //weight: 1
        $x_1_3 = "pinballcorp.com/downloads" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule ClickPotato_6
{
    meta:
        author = "defender2yara"
        detection_name = "ClickPotato"
        threat_id = "153288"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "3"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {03 c1 8b 4d 0c 8d 4c 08 ff 80 39 00 74 ?? 8b 7d 10 8b f0 2b f8 0f be 14 37 8a 92 ?? ?? ?? ?? 88 16 46 3b f1 76 ef}  //weight: 1, accuracy: Low
        $x_1_2 = {b8 60 ea 00 00 39 84 24 b4 00 00 00 73 07 89 84 24 b4 00 00 00 6a 00}  //weight: 1, accuracy: High
        $x_1_3 = "Are you sure you want to cancel the download?" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule ClickPotato_7
{
    meta:
        author = "defender2yara"
        detection_name = "ClickPotato"
        threat_id = "153288"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "7"
        strings_accuracy = "Low"
    strings:
        $x_5_1 = {43 6c 69 63 6b 50 6f 74 61 74 6f [0-5] 53 41 48 6f 6f 6b 2e 64 6c 6c}  //weight: 5, accuracy: Low
        $x_1_2 = "HOOK_DLL: AD process ID (0x%08X) equals" ascii //weight: 1
        $x_1_3 = "HOOK_DLL: Hide Ad" ascii //weight: 1
        $x_1_4 = "enable_ts_logging" ascii //weight: 1
        $x_1_5 = "Software\\Zango" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_5_*) and 2 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule ClickPotato_8
{
    meta:
        author = "defender2yara"
        detection_name = "ClickPotato"
        threat_id = "153288"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "3"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {6e 70 63 6c 6e 74 61 78 5f 43 6c 69 63 6b 50 6f 74 61 74 6f [0-5] 53 41 2e 64 6c 6c}  //weight: 1, accuracy: Low
        $x_1_2 = "ClientUMT" wide //weight: 1
        $x_1_3 = "ClickPotatoLite" wide //weight: 1
        $x_1_4 = {4e 50 5f 47 65 74 45 6e 74 72 79 50 6f 69 6e 74 73 00 4e 50 5f 49 6e 69 74 69 61 6c 69 7a 65 00 4e 50 5f 53 68 75 74 64 6f 77 6e}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (3 of ($x*))
}

rule ClickPotato_9
{
    meta:
        author = "defender2yara"
        detection_name = "ClickPotato"
        threat_id = "153288"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "2"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = "User-Agent: PinballCorp-BSAI/VER_STR_COMMA" ascii //weight: 1
        $x_1_2 = {8d 34 01 3b f7 7e 8b 4d 08 a1 ?? ?? ?? ?? 03 c1 8b 4d 0c 8d 4c 08 ff 80 39 00 74 18 8b 7d 10 8b f0 2b f8 0f be 14 37 8a 92 ?? ?? ?? ?? 88 16 46 3b f1 76 ef}  //weight: 1, accuracy: Low
        $x_1_3 = {63 61 6c 44 72 69 76 65 00 00 00 00 50 68 79 73 69 00 00 ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? 53 43 53 49 44 49 53 4b 00 00 00 00}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (2 of ($x*))
}

rule ClickPotato_10
{
    meta:
        author = "defender2yara"
        detection_name = "ClickPotato"
        threat_id = "153288"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {03 c1 8b 4d 0c 8d 4c 08 ff 80 39 00 74 ?? 8b 7d 10 8b f0 2b f8 0f be 14 37 8a 92 ?? ?? ?? ?? 88 16 46 3b f1 76 ef}  //weight: 1, accuracy: Low
        $x_1_2 = "downloads.seekmo.com" ascii //weight: 1
        $x_1_3 = "enable_ts_logging" ascii //weight: 1
        $x_1_4 = "icname|icversion|tid|os|locale|browser|cscid|hdid|mt" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule ClickPotato_11
{
    meta:
        author = "defender2yara"
        detection_name = "ClickPotato"
        threat_id = "153288"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "ClickPotatoLiteSA" wide //weight: 1
        $x_1_2 = "ClickPotatoLiteAX.Info" ascii //weight: 1
        $x_1_3 = "One8TSolutionsCont@in3rN@me" ascii //weight: 1
        $x_1_4 = "Client_Build_StPauliGirl_" ascii //weight: 1
        $x_1_5 = "bis.180solutions.com+adforce." ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule ClickPotato_12
{
    meta:
        author = "defender2yara"
        detection_name = "ClickPotato"
        threat_id = "153288"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "\\\\.\\Scsi%d:" ascii //weight: 1
        $x_1_2 = ".pinballcorp.com" ascii //weight: 1
        $x_1_3 = "trackedeventsbatchmode" ascii //weight: 1
        $x_1_4 = "ICName|ICVersion|TID|os|locale|browser|cscid|hdid|mt" ascii //weight: 1
        $x_1_5 = "HKEY_CURRENT_USER\\Software\\DebugSettings_Platrium" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (4 of ($x*))
}

rule ClickPotato_13
{
    meta:
        author = "defender2yara"
        detection_name = "ClickPotato"
        threat_id = "153288"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "17"
        strings_accuracy = "Low"
    strings:
        $x_5_1 = {54 68 69 73 20 41 64 [0-4] 69 73 20 66 72 6f 6d 20 43 6c 69 63 6b 50 6f 74 61 74 6f}  //weight: 5, accuracy: Low
        $x_5_2 = "ClickPotato.com" wide //weight: 5
        $x_5_3 = "%s&errorurl=%s&adid=%s&status=%d" ascii //weight: 5
        $x_5_4 = {4f 6e 65 38 54 53 6f 6c 75 74 69 6f 6e 73 50 40 73 73 57 25 72 64 00}  //weight: 5, accuracy: High
        $x_1_5 = "Search Assistant" ascii //weight: 1
        $x_1_6 = "/disable_tv_ads=n" ascii //weight: 1
        $x_1_7 = {61 64 5f 68 69 73 74 6f 72 79 5f 63 6f 75 6e 74 00}  //weight: 1, accuracy: High
        $x_1_8 = "software\\zango" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((3 of ($x_5_*) and 2 of ($x_1_*))) or
            ((4 of ($x_5_*))) or
            (all of ($x*))
        )
}

rule ClickPotato_14
{
    meta:
        author = "defender2yara"
        detection_name = "ClickPotato"
        threat_id = "153288"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "7"
        strings_accuracy = "Low"
    strings:
        $x_5_1 = "Nullsoft Install System" ascii //weight: 5
        $x_1_2 = "ClickPotato Installer Started" ascii //weight: 1
        $x_1_3 = {43 68 65 63 6b 50 65 72 6d 69 73 73 69 6f 6e 00 53 6f 66 74 77 61 72 65 5c 43 6c 69 63 6b 50 6f 74 61 74 6f}  //weight: 1, accuracy: High
        $x_1_4 = {43 6c 69 63 6b 50 6f 74 61 74 6f 4c 69 74 65 2e 65 78 65 ?? ?? ?? ?? 5c 43 6c 69 63 6b 50 6f 74 61 74 6f 4c 69 74 65 2e 6c 6f 67 ?? ?? ?? ?? 5c 43 6c 69 63 6b 50 6f 74 61 74 6f 4c 69 74 65 5f 67 64 66 2e 64 61 74 ?? ?? ?? ?? 5c 43 6c 69 63 6b 50 6f 74 61 74 6f 4c 69 74 65 61 75 2e 64 61 74 ?? ?? ?? ?? 5c 43 6c 69 63 6b 50 6f 74 61 74 6f 4c 69 74 65 68 6f 6f 6b 2e 64 6c 6c}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_5_*) and 2 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule ClickPotato_15
{
    meta:
        author = "defender2yara"
        detection_name = "ClickPotato"
        threat_id = "153288"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "40"
        strings_accuracy = "Low"
    strings:
        $x_10_1 = {03 c1 8b 4d 0c 8d 4c 08 ff 80 39 00 74 ?? 8b 7d 10 8b f0 2b f8 0f be 14 37 8a 92 ?? ?? ?? ?? 88 16 46 3b f1 76 ef}  //weight: 10, accuracy: Low
        $x_10_2 = "\\\\.\\Scsi%d:" ascii //weight: 10
        $x_10_3 = "InsatllStarted" ascii //weight: 10
        $x_10_4 = "Please wait while setup initializes" wide //weight: 10
        $x_1_5 = {64 6f 77 6e 6c 6f 61 64 73 [0-3] 2e 70 6c 61 74 72 69 75 6d 2e 63 6f 6d}  //weight: 1, accuracy: Low
        $x_1_6 = "downloads.appbundler.net" ascii //weight: 1
        $x_1_7 = "freelandmedia.com/downloads" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((4 of ($x_10_*))) or
            (all of ($x*))
        )
}

rule ClickPotato_16
{
    meta:
        author = "defender2yara"
        detection_name = "ClickPotato"
        threat_id = "153288"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "3"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = "Are you sure you want to cancel the download?" ascii //weight: 1
        $x_1_2 = {5c 5c 2e 5c 50 68 79 73 69 63 61 6c 44 72 69 76 65 25 64 00 53 43 53 49 44 49 53 4b 00 00 00 00 5c 5c 2e 5c 53 63 73 69 25 64 3a}  //weight: 1, accuracy: High
        $x_1_3 = {0f b7 0e 8b c1 25 ff 0f 00 00 03 02 c1 e9 0c 03 c7 85 c9 74 0b 83 f9 03 75 06 8b 4c 24 14 01 08 83 c6 02 83 eb 01 75 d8}  //weight: 1, accuracy: High
        $x_1_4 = {0f b6 56 05 88 57 05 0f b6 4e 06 88 4f 06 0f b6 56 07 50 57 8b cb 88 57 07 e8 ?? ?? ?? ?? 83 c6 08 83 c7 08 83 ed 01 75 9d}  //weight: 1, accuracy: Low
        $x_1_5 = {8d 44 24 1c 50 8d 4c 24 24 51 8b cf e8 ?? ?? ?? ?? 8b 57 04 8b 44 24 20 89 04 16 8b 4f 04 8b 54 24 1c 89 54 0e 04 83 c6 08 83 eb 01 75 d2 81 fe 00 10 00 00 7c c5}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (3 of ($x*))
}

rule ClickPotato_17
{
    meta:
        author = "defender2yara"
        detection_name = "ClickPotato"
        threat_id = "153288"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "11"
        strings_accuracy = "Low"
    strings:
        $x_5_1 = {31 00 31 00 43 00 32 00 37 00 33 00 35 00 31 00 2d 00 37 00 31 00 36 00 42 00 2d 00 34 00 30 00 35 00 32 00 2d 00 39 00 33 00 36 00 31 00 2d 00 45 00 33 00 42 00 30 00 41 00 33 00 46 00 38 00 32 00 32 00 31 00 43 00 7d 00 00 00}  //weight: 5, accuracy: High
        $x_1_2 = {67 00 65 00 74 00 72 00 [0-2] 73 00 73 00 2e 00 63 00 6c 00 [0-2] 69 00 63 00 6b 00 70 00 6f 00 74 00 61 00 [0-2] 74 00 6f 00 2e 00 63 00 6f 00 6d 00 2f 00}  //weight: 1, accuracy: Low
        $x_1_3 = "HTMLPopupMenu_Class" ascii //weight: 1
        $x_5_4 = {43 6c 69 63 6b 50 6f 74 61 74 6f [0-5] 53 41 42 48 4f 2e 44 4c 4c}  //weight: 5, accuracy: Low
        $x_5_5 = "client_build_stpauligirl_" ascii //weight: 5
        $x_1_6 = "com/litemenu/menu.htm" wide //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((2 of ($x_5_*) and 1 of ($x_1_*))) or
            ((3 of ($x_5_*))) or
            (all of ($x*))
        )
}

rule ClickPotato_18
{
    meta:
        author = "defender2yara"
        detection_name = "ClickPotato"
        threat_id = "153288"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {33 c0 c3 ff 35 ?? ?? ?? ?? e8 ?? ?? ?? ?? 59 c3 6a 20 68 ?? ?? ?? ?? e8}  //weight: 1, accuracy: Low
        $x_1_2 = {56 8b 74 24 08 8b 0e 8b 01 8b 50 10 57 ff d2 83 7e 0c 00 8d 4e 0c 7c ?? 3b 06 75 ?? 8b fe b8 01 00 00 00 f0 0f c1 01}  //weight: 1, accuracy: Low
        $x_1_3 = {43 6c 69 63 6b 50 6f 74 61 74 6f [0-5] 53 41 42 48 4f 2e 44 4c 4c}  //weight: 1, accuracy: Low
        $x_1_4 = "HTMLPopupMenu_Class" wide //weight: 1
        $x_1_5 = {73 00 73 00 2e 00 63 00 6c 00 69 00 [0-2] 63 00 6b 00 70 00 [0-6] 74 00 61 00 74 00}  //weight: 1, accuracy: Low
        $x_1_6 = {70 00 6f 00 74 00 61 00 74 00 6f 00 [0-6] 72 00 73 00 73 00 2e 00 63 00 6c 00 69 00 63 00 6b 00}  //weight: 1, accuracy: Low
        $x_1_7 = "D2083641-E57F-4eab-BB85-0582424F4A29" wide //weight: 1
    condition:
        (filesize < 20MB) and
        (4 of ($x*))
}

rule ClickPotato_19
{
    meta:
        author = "defender2yara"
        detection_name = "ClickPotato"
        threat_id = "153288"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "7"
        strings_accuracy = "Low"
    strings:
        $x_5_1 = {43 6c 69 63 6b 50 6f 74 61 74 6f [0-5] 53 41 48 6f 6f 6b 2e 64 6c 6c}  //weight: 5, accuracy: Low
        $x_1_2 = "ClickPotatoLiteClientIconHandle" wide //weight: 1
        $x_1_3 = "ClickPotatoLiteCaptionLink" wide //weight: 1
        $x_1_4 = {48 4f 4f 4b 5f 44 4c 4c 3a 20 48 69 64 65 20 41 [0-8] 77 69 6e 64 6f 77 20 28 30 78 25 78 29}  //weight: 1, accuracy: Low
        $x_1_5 = "IEListener told to disconnect, but" ascii //weight: 1
        $x_1_6 = "IEListener about to disconnect, but" ascii //weight: 1
        $x_1_7 = "HOOK_DLL: User surfing away from original ad" ascii //weight: 1
        $x_1_8 = "HOOK_DLL: Ad Props timer is killed on IE window" ascii //weight: 1
        $x_1_9 = {42 69 6c 6c 79 42 6f 62 [0-8] 20 77 69 6e 64 6f 77 20 63 6c 61 73 73 20 72 65 67 69 73 74 65 72 20 65 72 72 6f 72 3a 20 25 64 2e}  //weight: 1, accuracy: Low
        $x_1_10 = "HOOK_DLL: AD process ID (0x%08X) equals" ascii //weight: 1
        $x_3_11 = "client_build_stpauligirl_" ascii //weight: 3
    condition:
        (filesize < 20MB) and
        (
            ((7 of ($x_1_*))) or
            ((1 of ($x_3_*) and 4 of ($x_1_*))) or
            ((1 of ($x_5_*) and 2 of ($x_1_*))) or
            ((1 of ($x_5_*) and 1 of ($x_3_*))) or
            (all of ($x*))
        )
}

rule Adialer_J_0
{
    meta:
        author = "defender2yara"
        detection_name = "Adialer.J"
        threat_id = "156095"
        severity = "Critical"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_3_1 = "{9B4AA442-9EBF-11D5-8C11-0050DA4957F5} = s 'bsd'" ascii //weight: 3
        $x_3_2 = "http://www.trafficjam.nl/?failed=initialize" ascii //weight: 3
        $x_2_3 = "Software\\Trafficjam\\Connection" wide //weight: 2
        $x_1_4 = "Start Page" ascii //weight: 1
        $x_1_5 = "RasSetEntryPropertiesA" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_3_*) and 1 of ($x_2_*) and 1 of ($x_1_*))) or
            ((2 of ($x_3_*))) or
            (all of ($x*))
        )
}

rule Adialer_L_0
{
    meta:
        author = "defender2yara"
        detection_name = "Adialer.L"
        threat_id = "163934"
        severity = "Critical"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "9"
        strings_accuracy = "High"
    strings:
        $x_3_1 = "/cgi-bin/redir.pl?id=%d&entry=%d&site=%d" ascii //weight: 3
        $x_4_2 = "software\\interbill\\ez-1-2-3\\prefs" ascii //weight: 4
        $x_2_3 = "Please E-Mail support@eznet.co.uk for assistance." ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Accesoprivado_0
{
    meta:
        author = "defender2yara"
        detection_name = "Accesoprivado"
        threat_id = "164810"
        severity = "Critical"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "9"
        strings_accuracy = "High"
    strings:
        $x_3_1 = "3) El servicio al que va a acceder puede contener" ascii //weight: 3
        $x_5_2 = "0.91 euros/minuto en horario normal. " ascii //weight: 5
        $x_1_3 = "RasSetEntryPropertiesA" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Bloiscom_0
{
    meta:
        author = "defender2yara"
        detection_name = "Bloiscom"
        threat_id = "165257"
        severity = "Critical"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "9"
        strings_accuracy = "High"
    strings:
        $x_4_1 = "JNo se encuentra ningun Modem / RDSI en su ordenador. No se puede conectar.#Hay que terminar AOL Avant primero!" wide //weight: 4
        $x_2_2 = " 2001 Bloiscom s.l." wide //weight: 2
        $x_3_3 = "Ahora simplemente CONECTATE Y DISFRUTA!!!" ascii //weight: 3
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Eorezo_0
{
    meta:
        author = "defender2yara"
        detection_name = "Eorezo"
        threat_id = "166246"
        severity = "56"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "2"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "prof.eorezo.com/cgi-bin/" ascii //weight: 1
        $x_1_2 = "root\\SecurityCenter -Class AntiVirus" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Eorezo_1
{
    meta:
        author = "defender2yara"
        detection_name = "Eorezo"
        threat_id = "166246"
        severity = "56"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "http://ads.eorezo.com/cgi-bin/advert/getads.cgi?" ascii //weight: 1
        $x_1_2 = "Avertissement de" ascii //weight: 1
        $x_1_3 = {6a 00 6a 64 68 ea 03 00 00}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Eorezo_2
{
    meta:
        author = "defender2yara"
        detection_name = "Eorezo"
        threat_id = "166246"
        severity = "56"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "appPartner\": \"eorezo" ascii //weight: 1
        $x_1_2 = "appName\": \"tuto4pc" ascii //weight: 1
        $x_1_3 = "conf.cyl" wide //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Eorezo_3
{
    meta:
        author = "defender2yara"
        detection_name = "Eorezo"
        threat_id = "166246"
        severity = "56"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "2"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "ads.eorezo.com/cgi-bin/advert/getads" ascii //weight: 1
        $x_1_2 = {5c 45 6f 45 6e 67 69 6e 65 2e 65 78 65 00 00 00 53 6f 66 74 77 61 72 65 5c 45 6f 52 65 7a 6f}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Eorezo_4
{
    meta:
        author = "defender2yara"
        detection_name = "Eorezo"
        threat_id = "166246"
        severity = "56"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "2"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "prof.eorezo.com/cgi-bin/packages/DYNPACKAGES_WEB_GET_INFO" ascii //weight: 1
        $x_1_2 = "?sdateg/trevda/nib-igc/moc.bupedeiger.sda//:ptth" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Eorezo_5
{
    meta:
        author = "defender2yara"
        detection_name = "Eorezo"
        threat_id = "166246"
        severity = "56"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {8a 04 31 bf 00 01 00 00 2c ?? 0f be c0 99 f7 ff 88 14 31 41 3b 4d 08 7c ?? 56 e8 ?? ?? ?? ?? 59 50 56 8d 4d e0 ff 15}  //weight: 1, accuracy: Low
        $x_1_2 = "Y2hvY28=" ascii //weight: 1
        $x_1_3 = {50 41 55 53 45 00 00 00 55 70 64 61 74 65 20 44 6f 6e 65 20 53 75 63 63 65 73 73 66 75 6c 6c 79 00}  //weight: 1, accuracy: High
        $x_1_4 = {74 80 80 7c 46 3b 3b 6d 70 7f 3a 7e}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Eorezo_6
{
    meta:
        author = "defender2yara"
        detection_name = "Eorezo"
        threat_id = "166246"
        severity = "56"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "2"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {51 c7 04 24 ?? 00 00 00 e8 ?? ?? ?? ?? 85 c0 74 09 8b 04 24 83 c0 ?? 89 04 24 8b 0c 24 ff 14 8d ?? ?? ?? ?? 33 c0 59 c3}  //weight: 1, accuracy: Low
        $x_1_2 = {8a 10 33 c9 83 c0 02 84 d2 0f 84 ?? 00 00 00 8d 9b 00 00 00 00 0f b6 d2 03 ca 8b d1 c1 ea ?? c1 e1 ?? 0b d1 81 f2 ?? ?? ?? ?? 8b ca 8a 10 83 c0 02 84 d2 75 e0 81 f9 ?? ?? ?? ?? 74}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Eorezo_7
{
    meta:
        author = "defender2yara"
        detection_name = "Eorezo"
        threat_id = "166246"
        severity = "56"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = "UrlObfuscator.cpp" ascii //weight: 1
        $x_1_2 = ".eorezo.com" wide //weight: 1
        $x_1_3 = "\\eoStats.txt" wide //weight: 1
        $x_1_4 = "Adsconfiguration.cpp" ascii //weight: 1
        $x_1_5 = {41 67 65 6e 63 65 [0-12] 2e 63 70 70}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (4 of ($x*))
}

rule Eorezo_8
{
    meta:
        author = "defender2yara"
        detection_name = "Eorezo"
        threat_id = "166246"
        severity = "56"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {39 5d 08 c6 45 fc 02 89 5d f0 7e ?? 8b 7d 0c 8b 37 56 e8 ?? ?? ?? ?? 59 50 56 ff 75 c8 8d 4d c0 53 ff 15}  //weight: 1, accuracy: Low
        $x_1_2 = {8a 04 31 bf 00 01 00 00 2c 0a 0f be c0 99 f7 ff 88 14 31 41 3b 4d 08 7c ?? 56 e8 ?? ?? ?? ?? 59 50 56 8d 4d e0 ff 15 ?? ?? ?? ?? 56 e8}  //weight: 1, accuracy: Low
        $x_1_3 = "Y2hvY28=" ascii //weight: 1
        $x_1_4 = "r~~zD99kn}8|oqsonoz" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Eorezo_9
{
    meta:
        author = "defender2yara"
        detection_name = "Eorezo"
        threat_id = "166246"
        severity = "56"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "3"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {c0 e8 04 8a 55 ?? 24 03 c0 e1 02 02 c1 80 e2 0f 88 45 ?? 8a 45 ?? 8a c8 24 03 c0 e9 02 c0 e0 06 02 45 ?? 80 e1 0f c0 e2 04 02 ca}  //weight: 1, accuracy: Low
        $x_1_2 = {8b 45 e0 59 3b c3 59 75 ?? b8 ?? ?? ?? ?? 6a 05 53 68 ?? ?? ?? ?? 50 68 ?? ?? ?? ?? 53 ff 15 ?? ?? ?? ?? 53}  //weight: 1, accuracy: Low
        $x_1_3 = "aHR0cDovL2Fkcy5yZWdpZWRlcHViLmNvbS9jZ2k" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Eorezo_10
{
    meta:
        author = "defender2yara"
        detection_name = "Eorezo"
        threat_id = "166246"
        severity = "56"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_4_1 = "\"url\":\"http://cdn.starter.fm/s/tuto4pc/ads/fr/startertv/player_tv.html?" ascii //weight: 4
        $x_1_2 = "Tuto4PCBHO" ascii //weight: 1
        $x_1_3 = "T4PCBHO" ascii //weight: 1
        $x_1_4 = "T4PCEngineBHO" ascii //weight: 1
        $x_1_5 = "Tuto4PCAdsDlg" wide //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((4 of ($x_1_*))) or
            ((1 of ($x_4_*))) or
            (all of ($x*))
        )
}

rule Eorezo_11
{
    meta:
        author = "defender2yara"
        detection_name = "Eorezo"
        threat_id = "166246"
        severity = "56"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "3"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {68 00 30 40 00 ff 35 ?? ?? ?? ?? ff 15 ?? ?? ?? ?? 81 3d ?? ?? ?? ?? ?? ?? 00 00 74 00 83 3d ?? ?? ?? ?? ff 74 0c ff 35 ?? ?? ?? ?? ff 15 ?? ?? ?? ?? 6a 01 68 ?? ?? ?? ?? 68 ?? ?? ?? ?? 68 ?? ?? ?? ?? e8 05 00 00 00 6f 70 65 6e 00 6a 00 ff 15}  //weight: 1, accuracy: Low
        $x_1_2 = {c7 45 00 3c 00 00 00 c7 45 04 40 01 00 00 8b 44 24 68 89 45 1c b8 ?? ?? ?? ?? 89 45 0c 8b 04 24 89 45 10 8b 44 24 08 89 45 14 8b 44 24 04 89 45 18 8d 44 24 0c 50 e8}  //weight: 1, accuracy: Low
        $x_2_3 = "ads.regiedepub.com/cgi-bin/advert/getads?" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_2_*) and 1 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule Eorezo_12
{
    meta:
        author = "defender2yara"
        detection_name = "Eorezo"
        threat_id = "166246"
        severity = "56"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "12"
        strings_accuracy = "Low"
    strings:
        $x_10_1 = {5c 72 65 6c 65 61 73 65 5f 65 6f 72 65 7a 6f 5c 45 6f 52 65 7a 6f [0-8] 2e 70 64 62}  //weight: 10, accuracy: Low
        $x_1_2 = "EoRezoAdsDlg" wide //weight: 1
        $x_1_3 = "EoEngineBHO" ascii //weight: 1
        $x_1_4 = "{C10DC1F4-CCDF-4224-A24D-B23AFC3573C8}" ascii //weight: 1
        $x_1_5 = ".eorezo.com" wide //weight: 1
        $x_1_6 = "x-eorezo-crypted" wide //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_10_*) and 2 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule Eorezo_13
{
    meta:
        author = "defender2yara"
        detection_name = "Eorezo"
        threat_id = "166246"
        severity = "56"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "2"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = "prof.eorezo.com/cgi-bin/packages/DYNPACKAGES_WEB_GET_INFO" ascii //weight: 1
        $x_1_2 = {57 72 69 74 65 2d 48 6f 73 74 20 5c 22 24 28 24 5f 2e 64 69 73 70 6c 61 79 4e 61 6d 65 29 5e 7c 24 28 69 66 20 28 24 5f 2e 6f 6e 41 63 63 65 73 73 53 63 61 6e 6e 69 6e 67 45 6e 61 62 6c 65 64 29 20 7b 5c 22 34 30 39 36 5c 22 7d ff 01 72 6f 6f 74 5c 53 65 63 75 72 69 74 79 43 65 6e 74 65 72 32 20 2d 43 6c 61 73 73 20 41 6e 74 69 (56 69 72|53 70 79 77 61) 50 72 6f 64 75 63 74}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Eorezo_14
{
    meta:
        author = "defender2yara"
        detection_name = "Eorezo"
        threat_id = "166246"
        severity = "56"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "Low"
    strings:
        $x_10_1 = {5c 52 65 6c 65 61 73 65 5c 43 6f 6d 42 72 6f 61 64 63 61 73 74 65 72 2e 70 64 62 00}  //weight: 10, accuracy: High
        $x_10_2 = {5c 52 65 6c 65 61 73 65 5c 74 75 74 6f 34 70 63 5f [0-6] 2e 70 64 62}  //weight: 10, accuracy: Low
        $x_1_3 = "conf.cyl" wide //weight: 1
        $x_1_4 = ".?AVIEUrlCatcher@@" ascii //weight: 1
        $x_1_5 = ".?AVFFUrlCatcher@@" ascii //weight: 1
        $x_1_6 = ".?AVMyUrlCatcher@@" ascii //weight: 1
        $x_1_7 = ".?AVFF10UC@@" ascii //weight: 1
        $x_1_8 = "contact@tutoriales100.com" ascii //weight: 1
        $x_1_9 = "contact@tuto4pc.com" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_1_*))) or
            ((1 of ($x_10_*))) or
            (all of ($x*))
        )
}

rule Eorezo_15
{
    meta:
        author = "defender2yara"
        detection_name = "Eorezo"
        threat_id = "166246"
        severity = "56"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "15"
        strings_accuracy = "High"
    strings:
        $x_8_1 = "{0495F4D7-9FE3-4456-AA9D-1D57E78DF5F0}" ascii //weight: 8
        $x_8_2 = "{2F2CC692-D1B6-433e-BEFF-745CE8087980}" ascii //weight: 8
        $x_8_3 = "{293A63F7-C3B6-423a-9845-901AC0A7EE6E}" ascii //weight: 8
        $x_2_4 = "123TutoBHO" ascii //weight: 2
        $x_2_5 = "'T100BHO Class'" ascii //weight: 2
        $x_2_6 = "'PCTBHO Class'" ascii //weight: 2
        $x_2_7 = "'AEBHO Class'" ascii //weight: 2
        $x_1_8 = "AgenceBHO.AEBHO" ascii //weight: 1
        $x_1_9 = "Tutoriales100BHO.T100BHO" ascii //weight: 1
        $x_1_10 = "PCTutoBHO.PCTBHO" ascii //weight: 1
        $x_4_11 = "NoRemove 'Browser Helper Objects'" ascii //weight: 4
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_4_*) and 4 of ($x_2_*) and 3 of ($x_1_*))) or
            ((1 of ($x_8_*) and 2 of ($x_2_*) and 3 of ($x_1_*))) or
            ((1 of ($x_8_*) and 3 of ($x_2_*) and 1 of ($x_1_*))) or
            ((1 of ($x_8_*) and 4 of ($x_2_*))) or
            ((1 of ($x_8_*) and 1 of ($x_4_*) and 3 of ($x_1_*))) or
            ((1 of ($x_8_*) and 1 of ($x_4_*) and 1 of ($x_2_*) and 1 of ($x_1_*))) or
            ((1 of ($x_8_*) and 1 of ($x_4_*) and 2 of ($x_2_*))) or
            ((2 of ($x_8_*))) or
            (all of ($x*))
        )
}

rule Eorezo_16
{
    meta:
        author = "defender2yara"
        detection_name = "Eorezo"
        threat_id = "166246"
        severity = "56"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "7"
        strings_accuracy = "High"
    strings:
        $x_7_1 = "aHR0cDovL2Fkcy5yZWdpZWRlcHViLmNvbS9jZ2ktYmluL2FkdmVydC9nZXRhZHM/ZGlkPT" ascii //weight: 7
        $x_4_2 = "prof.123Tuto.info" wide //weight: 4
        $x_2_3 = "x_guid_gen=%s&i_log=%x&x_servicever=%s&x_serviceid=%s&x_comment=%s" wide //weight: 2
        $x_1_4 = "@123TutoAgence" wide //weight: 1
        $x_1_5 = "x-123Tuto-crc32" wide //weight: 1
        $x_1_6 = "Tuto_confMedia.cyp" wide //weight: 1
        $x_1_7 = "\\eoStats.txt" wide //weight: 1
        $x_1_8 = "TutoAdsDlg" wide //weight: 1
        $x_1_9 = "x_guid_gen=%s&x_servicever=%s" wide //weight: 1
        $x_1_10 = "x_serviceid=%s&x_sconf=%s&i_changehome=%d" wide //weight: 1
        $x_1_11 = "x_homestartie=%s&x_homestartfirefox=%s" wide //weight: 1
        $x_1_12 = "x_homelastie=%s&x_homelastfirefox=%s" wide //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((7 of ($x_1_*))) or
            ((1 of ($x_2_*) and 5 of ($x_1_*))) or
            ((1 of ($x_4_*) and 3 of ($x_1_*))) or
            ((1 of ($x_4_*) and 1 of ($x_2_*) and 1 of ($x_1_*))) or
            ((1 of ($x_7_*))) or
            (all of ($x*))
        )
}

rule Kraddare_0
{
    meta:
        author = "defender2yara"
        detection_name = "Kraddare"
        threat_id = "166525"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "www.muuk.co.kr" ascii //weight: 2
        $x_1_2 = "windowstab.exe" ascii //weight: 1
        $x_1_3 = "windowstab.php" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Kraddare_1
{
    meta:
        author = "defender2yara"
        detection_name = "Kraddare"
        threat_id = "166525"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "www.muuk.co.kr/app/windowstab" ascii //weight: 2
        $x_1_2 = "windowstab.php" ascii //weight: 1
        $x_1_3 = "NetXtreme" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Kraddare_2
{
    meta:
        author = "defender2yara"
        detection_name = "Kraddare"
        threat_id = "166525"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "down.feel2day.com" ascii //weight: 2
        $x_1_2 = "down.feel2day.com/ap_cnt/bcc.php" ascii //weight: 1
        $x_1_3 = "Software\\F2Day" ascii //weight: 1
        $x_1_4 = "f2dux_1.0.0.2\\Release\\HiSantaNotifier.pdb" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Enumerate_0
{
    meta:
        author = "defender2yara"
        detection_name = "Enumerate"
        threat_id = "182874"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "2"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "SOFTWARE\\enumerate_gt" ascii //weight: 1
        $x_1_2 = "enumstate.co.kr" ascii //weight: 1
        $x_1_3 = "topsearch.enumerate.co.kr" ascii //weight: 1
        $x_1_4 = "enumst\\release\\enumst.pdb" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (2 of ($x*))
}

rule Vidsaver_0
{
    meta:
        author = "defender2yara"
        detection_name = "Vidsaver"
        threat_id = "194778"
        severity = "3"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "3"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = "Vid-Saver-Bho.txt" ascii //weight: 1
        $x_1_2 = "Software\\Vid-Saver\\" ascii //weight: 1
        $x_1_3 = {46 6f 72 63 65 52 65 6d 6f 76 65 20 7b ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? 7d 20 3d 20 73 20 27 56 69 64 2d 53 61 76 65 72 27}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule AddLyrics_0
{
    meta:
        author = "defender2yara"
        detection_name = "AddLyrics"
        threat_id = "195750"
        severity = "181"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_2_1 = {8b 7d 08 8a 14 3e 8b 5d 10 88 14 19 0f be 3c 07 8b c6 6a 03 99 5b f7 fb 41 47 3b d7}  //weight: 2, accuracy: High
        $x_1_2 = "2UIEInjectLibW" ascii //weight: 1
        $x_1_3 = ".?AV?$CComAggObject@VCInjectObject@@@ATL@@" ascii //weight: 1
        $x_1_4 = ".?AVCIEInjectModule@@" ascii //weight: 1
        $x_1_5 = {49 45 49 6e 6a 65 63 74 2e 64 6c 6c 00 44 6c 6c 43 61 6e 55 6e 6c 6f 61 64 4e 6f 77}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_2_*) and 3 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule AddLyrics_1
{
    meta:
        author = "defender2yara"
        detection_name = "AddLyrics"
        threat_id = "195750"
        severity = "181"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {8a 14 10 8b 7d 10 88 14 3b 6a 03 99 5f f7 ff 43 3b d1 75}  //weight: 1, accuracy: High
        $x_1_2 = {88 14 1e 6a 06 99 5b f7 fb 46 3b d1 74}  //weight: 1, accuracy: High
        $x_1_3 = "2UIEInjectLibW" ascii //weight: 1
        $x_1_4 = ".?AV?$CComAggObject@VCInjectObject@@@ATL@@" ascii //weight: 1
        $x_1_5 = ".?AVCIEInjectModule@@" ascii //weight: 1
        $x_1_6 = {49 45 49 6e 6a 65 63 74 2e 64 6c 6c 00 44 6c 6c 43 61 6e 55 6e 6c 6f 61 64 4e 6f 77}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule AddLyrics_2
{
    meta:
        author = "defender2yara"
        detection_name = "AddLyrics"
        threat_id = "195750"
        severity = "181"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "7"
        strings_accuracy = "High"
    strings:
        $x_2_1 = {3b cf 7d 34 8b 45 08 8a 04 06 8b 55 0c 88 04 11 8b c6 6a 03 99 5b f7 fb 41 85 d2 74 06 83 fa 02 74 01 46}  //weight: 2, accuracy: High
        $x_1_2 = "2UIEInjectLibW" ascii //weight: 1
        $x_1_3 = ".?AV?$CComAggObject@VCInjectObject@@@ATL@@" ascii //weight: 1
        $x_1_4 = ".?AVCIEInjectModule@@" ascii //weight: 1
        $x_1_5 = {49 45 49 6e 6a 65 63 74 2e 64 6c 6c 00 44 6c 6c 43 61 6e 55 6e 6c 6f 61 64 4e 6f 77}  //weight: 1, accuracy: High
        $x_1_6 = {4c 79 72 69 63 58 65 65 6b 65 72 00}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule AddLyrics_3
{
    meta:
        author = "defender2yara"
        detection_name = "AddLyrics"
        threat_id = "195750"
        severity = "181"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "Low"
    strings:
        $x_2_1 = {8b 45 08 8a 04 06 8b 55 10 88 04 11 8b c6 6a 03 99 5b f7 fb 41 83 fa}  //weight: 2, accuracy: High
        $x_2_2 = {8b 45 08 8b 7d fc 8a 14 07 8b 5d 0c 88 14 19 0f be 1c 30 8b c7 6a 03 99 5f f7 ff 41 43 3b d3}  //weight: 2, accuracy: High
        $x_1_3 = "IEInjectLib" wide //weight: 1
        $x_1_4 = "IInjectObject" wide //weight: 1
        $x_1_5 = {3f 00 69 00 64 00 3d 00 25 00 73 00 26 00 72 00 61 00 6e 00 64 00 3d 00 25 00 64 00 00 00 ?? ?? ?? ?? 30 00 75 00 70 00 64 00 61 00 74 00 65 00 75 00 72 00 6c 00 00 00}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_2_*) and 2 of ($x_1_*))) or
            ((2 of ($x_2_*))) or
            (all of ($x*))
        )
}

rule AddLyrics_4
{
    meta:
        author = "defender2yara"
        detection_name = "AddLyrics"
        threat_id = "195750"
        severity = "181"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "17"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "2UIEInjectLibW" ascii //weight: 2
        $x_3_2 = ".?AV?$CComAggObject@VCInjectObject@@@ATL@@" ascii //weight: 3
        $x_3_3 = ".?AVCIEInjectModule@@" ascii //weight: 3
        $x_4_4 = "AddLyrics" ascii //weight: 4
        $x_5_5 = "{4F3096B3-34FD-4EF5-9D29-89E08FCA5822}" wide //weight: 5
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule AddLyrics_5
{
    meta:
        author = "defender2yara"
        detection_name = "AddLyrics"
        threat_id = "195750"
        severity = "181"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "121"
        strings_accuracy = "High"
    strings:
        $x_100_1 = {3b 4d 0c 7d 2f 8b 45 08 8a 04 06 88 04 39 8b c6 6a 03 99 5b f7 fb 41 85 d2 74 06 83 fa 02 74 01 46 46 3b 75 0c 7c d9}  //weight: 100, accuracy: High
        $x_10_2 = "LyricsContainertmp.exe" ascii //weight: 10
        $x_10_3 = "LrcsCtrUpdr.exe.mtx" wide //weight: 10
        $x_10_4 = "lyrcsBupd.exe.mtx" wide //weight: 10
        $x_10_5 = "lyrcsBtmp.exe" ascii //weight: 10
        $x_10_6 = {4c 79 72 69 63 58 65 65 6b 65 72 00}  //weight: 10, accuracy: High
        $x_10_7 = "LyriXupdate.exe.mtx" ascii //weight: 10
        $x_1_8 = "IInjectObject" wide //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_100_*) and 2 of ($x_10_*) and 1 of ($x_1_*))) or
            ((1 of ($x_100_*) and 3 of ($x_10_*))) or
            (all of ($x*))
        )
}

rule AddLyrics_6
{
    meta:
        author = "defender2yara"
        detection_name = "AddLyrics"
        threat_id = "195750"
        severity = "181"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "Low"
    strings:
        $x_2_1 = {3b 4d 0c 7d 2f 8b 45 08 8a 04 06 88 04 39 8b c6 6a 03 99 5b f7 fb 41 85 d2 74 06 83 fa 02 74 01 46 46 3b 75 0c 7c d9}  //weight: 2, accuracy: High
        $x_2_2 = {3b cf 7d 30 8b 45 08 8a 04 06 8b 55 10 88 04 11 8b c6 6a 03 99 5b f7 fb 41 83 fa 01 75 01 46 46 3b f7 7c dc}  //weight: 2, accuracy: High
        $x_2_3 = {8b 4d 08 03 4d f8 0f be 09 8b 45 f8 99 f7 7d ec 8b 45 10 0f be 14 10 33 ca 8b 45 14 03 45 f8 88 08}  //weight: 2, accuracy: High
        $x_1_4 = "2UIEInjectLibW" ascii //weight: 1
        $x_1_5 = ".?AV?$CComAggObject@VCInjectObject@@@ATL@@" ascii //weight: 1
        $x_1_6 = ".?AVCIEInjectModule@@" ascii //weight: 1
        $x_1_7 = {49 45 49 6e 6a 65 63 74 [0-6] 2e 64 6c 6c 00 44 6c 6c 43 61 6e 55 6e 6c 6f 61 64 4e 6f 77}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_2_*) and 3 of ($x_1_*))) or
            ((2 of ($x_2_*) and 1 of ($x_1_*))) or
            ((3 of ($x_2_*))) or
            (all of ($x*))
        )
}

rule AddLyrics_7
{
    meta:
        author = "defender2yara"
        detection_name = "AddLyrics"
        threat_id = "195750"
        severity = "181"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "16"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {63 72 6f 73 73 42 68 6f 45 76 65 6e 74 00}  //weight: 1, accuracy: High
        $x_1_2 = {72 65 65 6e 61 62 6c 65 62 68 6f 00}  //weight: 1, accuracy: High
        $x_5_3 = {43 72 6f 73 73 72 69 64 65 72 41 70 70 30 30 34 31 38 36 38 00}  //weight: 5, accuracy: High
        $x_5_4 = {43 72 6f 73 73 72 69 64 65 72 41 70 70 30 30 34 33 39 31 32 00}  //weight: 5, accuracy: High
        $x_5_5 = {43 72 6f 73 73 72 69 64 65 72 41 70 70 30 30 34 33 38 38 36 00}  //weight: 5, accuracy: High
        $x_5_6 = {43 72 6f 73 73 72 69 64 65 72 41 70 70 30 30 34 33 39 30 35 00}  //weight: 5, accuracy: High
        $x_10_7 = {50 00 72 00 6f 00 64 00 75 00 63 00 74 00 4e 00 61 00 6d 00 65 00 00 00 00 00 4c 00 79 00 72 00 69 00 63 00 73 00 42 00 75 00 64 00 64 00 79 00}  //weight: 10, accuracy: High
        $x_10_8 = {50 00 72 00 6f 00 64 00 75 00 63 00 74 00 4e 00 61 00 6d 00 65 00 00 00 00 00 53 00 75 00 70 00 65 00 72 00 4c 00 79 00 72 00 69 00 63 00 73 00 2d 00 31 00 35 00}  //weight: 10, accuracy: High
        $x_10_9 = {50 00 72 00 6f 00 64 00 75 00 63 00 74 00 4e 00 61 00 6d 00 65 00 00 00 00 00 4c 00 79 00 72 00 69 00 63 00 73 00 50 00 61 00 72 00 74 00 79 00 2d 00 31 00 35 00}  //weight: 10, accuracy: High
        $x_10_10 = {50 00 72 00 6f 00 64 00 75 00 63 00 74 00 4e 00 61 00 6d 00 65 00 00 00 00 00 61 00 32 00 7a 00 4c 00 79 00 72 00 69 00 63 00 73 00 2d 00 31 00 35 00}  //weight: 10, accuracy: High
    condition:
        (filesize < 20MB) and
        (
            ((3 of ($x_5_*) and 1 of ($x_1_*))) or
            ((4 of ($x_5_*))) or
            ((1 of ($x_10_*) and 1 of ($x_5_*) and 1 of ($x_1_*))) or
            ((1 of ($x_10_*) and 2 of ($x_5_*))) or
            ((2 of ($x_10_*))) or
            (all of ($x*))
        )
}

rule AddLyrics_8
{
    meta:
        author = "defender2yara"
        detection_name = "AddLyrics"
        threat_id = "195750"
        severity = "181"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "3"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {2f 75 70 64 61 74 65 72 2f 31 30 36 30 2f ?? ?? ?? ?? 2f ?? ?? ?? 2e 78 6d 6c}  //weight: 1, accuracy: Low
        $x_1_2 = {2f 72 65 70 6f 72 74 2f 25 73 2f 3f 61 66 66 3d 31 30 36 30 26 73 75 62 61 66 66 3d ?? ?? ?? ?? 26 76 65 72 3d ?? ?? ?? 26 75 69 64 3d 25 73 26 6f 73 3d 25 73 26 62 72 6f 77 73 65 72 73 3d 25 73}  //weight: 1, accuracy: Low
        $x_1_3 = {66 75 6e 63 74 69 6f 6e [0-16] 76 61 72 [0-32] 76 65 72 73 69 6f 6e [0-32] 63 6c 69 65 6e 74 75 69 64 3d [0-32] 3b 77 69 6e 64 6f 77 2e 5f 72 76 7a}  //weight: 1, accuracy: Low
        $x_1_4 = "sprlrcs.dll" ascii //weight: 1
        $x_1_5 = "hppylrc.dll" ascii //weight: 1
        $x_1_6 = "lyrmix.dll" ascii //weight: 1
        $x_1_7 = "lrcspal.dll" ascii //weight: 1
        $x_1_8 = "singalng.dll" ascii //weight: 1
        $x_1_9 = "FindLyrics.dll" ascii //weight: 1
        $x_1_10 = "lrcson.dll" ascii //weight: 1
        $x_1_11 = "lfinder.dll" ascii //weight: 1
        $x_1_12 = "autolrcs.dll" ascii //weight: 1
        $x_1_13 = "plryics.dll" ascii //weight: 1
        $x_1_14 = "lfind.dll" ascii //weight: 1
        $x_1_15 = "lrcstube.dll" ascii //weight: 1
        $x_1_16 = "lrcfan.dll" ascii //weight: 1
        $x_1_17 = "lyricsmonkey.dll" ascii //weight: 1
        $x_1_18 = "coolrcs.dll" ascii //weight: 1
        $x_1_19 = "slyrics.dll" ascii //weight: 1
        $x_1_20 = "lyricstar.dll" ascii //weight: 1
        $x_1_21 = "ezlyrics.dll" ascii //weight: 1
        $x_1_22 = "lrsing.dll" ascii //weight: 1
        $x_1_23 = "lrcsplug.dll" ascii //weight: 1
        $x_1_24 = "lrcscr.dll" ascii //weight: 1
        $x_1_25 = "lkid.dll" ascii //weight: 1
        $x_1_26 = "ytkaraoke.dll" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (3 of ($x*))
}

rule AddLyrics_9
{
    meta:
        author = "defender2yara"
        detection_name = "AddLyrics"
        threat_id = "195750"
        severity = "181"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "16"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = "NoRemove CLSID" ascii //weight: 1
        $x_1_2 = {49 45 49 6e 6a 65 63 74 2e 64 6c 6c 00 44 6c 6c 43 61 6e 55 6e 6c 6f 61 64 4e 6f 77}  //weight: 1, accuracy: High
        $x_1_3 = ".?AVCIEInjectModule@@" ascii //weight: 1
        $x_5_4 = {2f 75 70 64 61 74 65 72 2f 31 30 36 30 2f [0-16] 2e 78 6d 6c}  //weight: 5, accuracy: Low
        $x_4_5 = {2f 72 65 70 6f 72 74 2f 25 73 2f 3f 61 66 66 3d 31 30 36 30 26 73 75 62 61 66 66 3d ?? ?? ?? ?? 26 76 65 72 3d ?? ?? ?? 26 75 69 64 3d 25 73 26 6f 73 3d 25 73 26 62 72 6f 77 73 65 72 73 3d 25 73}  //weight: 4, accuracy: Low
        $x_4_6 = {66 75 6e 63 74 69 6f 6e [0-16] 76 61 72 [0-32] 76 65 72 73 69 6f 6e [0-32] 63 6c 69 65 6e 74 75 69 64 3d [0-32] 3b 77 69 6e 64 6f 77 2e 5f 72 76 7a}  //weight: 4, accuracy: Low
        $x_5_7 = {66 75 6e 63 74 69 6f 6e [0-32] 66 72 6f 6d 43 68 61 72 43 6f 64 65 [0-16] 63 68 61 72 43 6f 64 65 41 74 [0-16] 6c 65 6e 67 74 68 ?? ?? 66 6f 72 28 76 61 72 [0-16] 2b 2b [0-16] 53 74 72 69 6e 67}  //weight: 5, accuracy: Low
        $x_5_8 = {66 6f 72 28 76 61 72 [0-2] 3d 30 3b [0-1] 3c [0-1] 5b [0-1] 5d 3b [0-2] 2b 2b 29 7b [0-1] 2b 3d 53 74 72 69 6e 67 5b [0-20] 29 3b 7d 72 65 74 75 72 6e}  //weight: 5, accuracy: Low
        $x_5_9 = {66 6f 72 28 76 61 72 [0-2] 3d 30 3b [0-1] 3c [0-1] 5b [0-1] 5d 3b [0-2] 2b 2b 29 [0-2] 2b 3d [0-4] 5b ?? 5d [0-16] 29 3b 7d 72 65 74 75 72 6e [0-16] 66 75 6e 63 74 69 6f 6e}  //weight: 5, accuracy: Low
        $x_2_10 = "updater_tmp" wide //weight: 2
        $x_2_11 = "affiliate_id" wide //weight: 2
        $x_2_12 = "inject_domain" wide //weight: 2
        $x_2_13 = "_last_inject_time" wide //weight: 2
    condition:
        (filesize < 20MB) and
        (
            ((2 of ($x_4_*) and 3 of ($x_2_*) and 2 of ($x_1_*))) or
            ((2 of ($x_4_*) and 4 of ($x_2_*))) or
            ((1 of ($x_5_*) and 4 of ($x_2_*) and 3 of ($x_1_*))) or
            ((1 of ($x_5_*) and 1 of ($x_4_*) and 2 of ($x_2_*) and 3 of ($x_1_*))) or
            ((1 of ($x_5_*) and 1 of ($x_4_*) and 3 of ($x_2_*) and 1 of ($x_1_*))) or
            ((1 of ($x_5_*) and 1 of ($x_4_*) and 4 of ($x_2_*))) or
            ((1 of ($x_5_*) and 2 of ($x_4_*) and 3 of ($x_1_*))) or
            ((1 of ($x_5_*) and 2 of ($x_4_*) and 1 of ($x_2_*) and 1 of ($x_1_*))) or
            ((1 of ($x_5_*) and 2 of ($x_4_*) and 2 of ($x_2_*))) or
            ((2 of ($x_5_*) and 2 of ($x_2_*) and 2 of ($x_1_*))) or
            ((2 of ($x_5_*) and 3 of ($x_2_*))) or
            ((2 of ($x_5_*) and 1 of ($x_4_*) and 2 of ($x_1_*))) or
            ((2 of ($x_5_*) and 1 of ($x_4_*) and 1 of ($x_2_*))) or
            ((2 of ($x_5_*) and 2 of ($x_4_*))) or
            ((3 of ($x_5_*) and 1 of ($x_1_*))) or
            ((3 of ($x_5_*) and 1 of ($x_2_*))) or
            ((3 of ($x_5_*) and 1 of ($x_4_*))) or
            ((4 of ($x_5_*))) or
            (all of ($x*))
        )
}

rule InfoAtoms_0
{
    meta:
        author = "defender2yara"
        detection_name = "InfoAtoms"
        threat_id = "195914"
        severity = "Low"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "28"
        strings_accuracy = "High"
    strings:
        $x_5_1 = ".?AVCInfoAtomsClientIEModule@@" ascii //weight: 5
        $x_7_2 = "(C) 2012 InfoAtoms Inc.,  All rights reserved." wide //weight: 7
        $x_8_3 = "ForceRemove '{103089DA-0F31-4A8B-843F-7D24A7FE8345}' = s 'InfoAtoms' {" ascii //weight: 8
        $x_8_4 = "//widgets.vitruvian.biz/kernel/" wide //weight: 8
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule FindLyrics_0
{
    meta:
        author = "defender2yara"
        detection_name = "FindLyrics"
        threat_id = "197863"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "7"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "2UIEInjectLibW" ascii //weight: 1
        $x_1_2 = ".?AV?$CComAggObject@VCInjectObject@@@ATL@@" ascii //weight: 1
        $x_1_3 = ".?AVCIEInjectModule@@" ascii //weight: 1
        $x_4_4 = {50 00 72 00 6f 00 64 00 75 00 63 00 74 00 4e 00 61 00 6d 00 65 00 00 00 00 00 46 00 69 00 6e 00 64 00 4c 00 79 00 72 00 69 00 63 00 73 00}  //weight: 4, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Lollipop_0
{
    meta:
        author = "defender2yara"
        detection_name = "Lollipop"
        threat_id = "198706"
        severity = "Low"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "2"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {6a 05 33 db 33 d2 c7 41 18 07 00 00 00 89 59 14 68}  //weight: 1, accuracy: High
        $x_1_2 = {6a 05 33 d2 33 c0 89 79 18 89 71 14 68}  //weight: 1, accuracy: High
        $x_1_3 = {c7 41 18 07 00 00 00 04 00 6a 05 33 (d2|c0)}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (2 of ($x*))
}

rule Lollipop_1
{
    meta:
        author = "defender2yara"
        detection_name = "Lollipop"
        threat_id = "198706"
        severity = "Low"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "12"
        strings_accuracy = "Low"
    strings:
        $x_10_1 = {40 33 db 3b c2 0f 9c c3 f6 c3 ?? 75}  //weight: 10, accuracy: Low
        $x_1_2 = "?AVDog@@" ascii //weight: 1
        $x_1_3 = "?AVMammal@@" ascii //weight: 1
        $x_1_4 = "?AVAnimal@@" ascii //weight: 1
        $x_1_5 = "?AVCat@@" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_10_*) and 2 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule Lollipop_2
{
    meta:
        author = "defender2yara"
        detection_name = "Lollipop"
        threat_id = "198706"
        severity = "Low"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "12"
        strings_accuracy = "Low"
    strings:
        $x_10_1 = {41 33 db 3b ca 0f 9c c3 f6 c3 ?? 75}  //weight: 10, accuracy: Low
        $x_1_2 = "?AVDog@@" ascii //weight: 1
        $x_1_3 = "?AVMammal@@" ascii //weight: 1
        $x_1_4 = "?AVAnimal@@" ascii //weight: 1
        $x_1_5 = "?AVCat@@" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_10_*) and 2 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule Lollipop_3
{
    meta:
        author = "defender2yara"
        detection_name = "Lollipop"
        threat_id = "198706"
        severity = "Low"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "12"
        strings_accuracy = "Low"
    strings:
        $x_10_1 = {46 33 db 3b f2 0f 9c c3 f6 c3 ?? 75}  //weight: 10, accuracy: Low
        $x_1_2 = "?AVDog@@" ascii //weight: 1
        $x_1_3 = "?AVMammal@@" ascii //weight: 1
        $x_1_4 = "?AVAnimal@@" ascii //weight: 1
        $x_1_5 = "?AVCat@@" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_10_*) and 2 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule Lollipop_4
{
    meta:
        author = "defender2yara"
        detection_name = "Lollipop"
        threat_id = "198706"
        severity = "Low"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "3"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {c7 41 18 07 00 00 00 89 ?? 14 68 06 00 6a 05 33 ?? 33}  //weight: 1, accuracy: Low
        $x_1_2 = {c7 41 18 07 00 00 00 04 00 6a 05 33 (d2|c0)}  //weight: 1, accuracy: Low
        $x_1_3 = {c7 41 18 07 00 00 00 c7 41 14 00 00 00 00 68}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Lollipop_5
{
    meta:
        author = "defender2yara"
        detection_name = "Lollipop"
        threat_id = "198706"
        severity = "Low"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "12"
        strings_accuracy = "Low"
    strings:
        $x_10_1 = {03 c6 33 db 3b c2 0f 9c c3 f6 c3 ?? 75}  //weight: 10, accuracy: Low
        $x_1_2 = "?AVDog@@" ascii //weight: 1
        $x_1_3 = "?AVMammal@@" ascii //weight: 1
        $x_1_4 = "?AVAnimal@@" ascii //weight: 1
        $x_1_5 = "?AVCat@@" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_10_*) and 2 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule Lollipop_6
{
    meta:
        author = "defender2yara"
        detection_name = "Lollipop"
        threat_id = "198706"
        severity = "Low"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "12"
        strings_accuracy = "Low"
    strings:
        $x_10_1 = {03 c7 33 d2 3b c1 0f 9c c2 f6 c2 ?? 75}  //weight: 10, accuracy: Low
        $x_1_2 = "?AVDog@@" ascii //weight: 1
        $x_1_3 = "?AVMammal@@" ascii //weight: 1
        $x_1_4 = "?AVAnimal@@" ascii //weight: 1
        $x_1_5 = "?AVCat@@" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_10_*) and 2 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule Lollipop_7
{
    meta:
        author = "defender2yara"
        detection_name = "Lollipop"
        threat_id = "198706"
        severity = "Low"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "FreeSexPlayerApp@@" ascii //weight: 1
        $x_1_2 = {3c 66 73 70 5f 70 61 72 61 6d 73 3e 00}  //weight: 1, accuracy: High
        $x_1_3 = {4c 00 6f 00 6c 00 6c 00 69 00 70 00 6f 00 70 00 5f 00 69 00 6e 00 73 00 74 00 61 00 6c 00 6c 00 65 00 72 00 2e 00 65 00 78 00 65 00 00 00}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Lollipop_8
{
    meta:
        author = "defender2yara"
        detection_name = "Lollipop"
        threat_id = "198706"
        severity = "Low"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_2_1 = ".?AVLollipopFunc@@" ascii //weight: 2
        $x_2_2 = ".?AVBaseLP@@" ascii //weight: 2
        $x_1_3 = "onAccessScanningEnabled" wide //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Lollipop_9
{
    meta:
        author = "defender2yara"
        detection_name = "Lollipop"
        threat_id = "198706"
        severity = "Low"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "18"
        strings_accuracy = "High"
    strings:
        $x_3_1 = ".?AVBaseLP@@" ascii //weight: 3
        $x_4_2 = "INSTALL:|14693||86400|1|0007||" ascii //weight: 4
        $x_6_3 = ".?AVLollipopFunc@@" ascii //weight: 6
        $x_5_4 = "Lollipop.exe" ascii //weight: 5
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Lollipop_10
{
    meta:
        author = "defender2yara"
        detection_name = "Lollipop"
        threat_id = "198706"
        severity = "Low"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "2"
        strings_accuracy = "Low"
    strings:
        $x_2_1 = {40 00 6a 05 68 ?? ?? 40 00 ff 15 ?? ?? 40 00 68 ?? ?? 40 00 ff 15 ?? ?? 40 00 68 ?? ?? 40 00 ff 15 ?? ?? 40 00 ?? [0-1] 68 ?? ?? 40 00 ?? [0-1] ff 15 ?? ?? 40 00 68 ?? ?? 40 00 ff 15 ?? ?? 40 00 68 ?? ?? 40 00 68 ?? ?? 40 00 ff 15 ?? ?? 40 00}  //weight: 2, accuracy: Low
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Lollipop_11
{
    meta:
        author = "defender2yara"
        detection_name = "Lollipop"
        threat_id = "198706"
        severity = "Low"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "12"
        strings_accuracy = "High"
    strings:
        $x_10_1 = {83 f9 30 74 23 8b 55 08 0f be 42 01 83 f8 3a 74 17 8b 4d 08 0f be 11 83 fa 33}  //weight: 10, accuracy: High
        $x_1_2 = "?AVDog@@" ascii //weight: 1
        $x_1_3 = "?AVMammal@@" ascii //weight: 1
        $x_1_4 = "?AVAnimal@@" ascii //weight: 1
        $x_1_5 = "?AVCat@@" ascii //weight: 1
        $x_2_6 = {66 8b 06 88 07 83 c6 02 47 49 75 f4 9d 61}  //weight: 2, accuracy: High
        $x_2_7 = {81 c2 28 e5 01 00 89}  //weight: 2, accuracy: High
        $x_2_8 = {81 c1 28 e5 01 00 89}  //weight: 2, accuracy: High
        $x_2_9 = {05 28 e5 01 00 89}  //weight: 2, accuracy: High
    condition:
        (filesize < 20MB) and
        (
            ((4 of ($x_2_*) and 4 of ($x_1_*))) or
            ((1 of ($x_10_*) and 2 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_2_*))) or
            (all of ($x*))
        )
}

rule Lollipop_12
{
    meta:
        author = "defender2yara"
        detection_name = "Lollipop"
        threat_id = "198706"
        severity = "Low"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "7"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = "87494a0ba8f8f94efd7debcaf918" ascii //weight: 1
        $x_1_2 = {50 75 62 6c 69 73 68 65 72 20 49 44 20 69 73 20 5c 6e 65 65 64 65 64 2e 00}  //weight: 1, accuracy: High
        $x_1_3 = {50 75 62 6c 69 73 68 65 72 20 49 44 20 69 73 20 69 6e 76 61 6c 69 64 2e 00}  //weight: 1, accuracy: High
        $x_1_4 = {00 2d 73 75 62 69 64 00}  //weight: 1, accuracy: High
        $x_1_5 = {00 2d 72 6e 61 6d 65 00}  //weight: 1, accuracy: High
        $x_1_6 = {00 2d 6e 6f 6a 73 00}  //weight: 1, accuracy: High
        $x_1_7 = {68 e8 03 00 00 ff 15 ?? ?? ?? ?? ff 74 24 0c ff 74 24 08 e8 cf ff ff ff}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Lollipop_13
{
    meta:
        author = "defender2yara"
        detection_name = "Lollipop"
        threat_id = "198706"
        severity = "Low"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "8"
        strings_accuracy = "Low"
    strings:
        $x_5_1 = {53 31 33 5f 00 [0-15] 00 73 ?? 6f ?? 66 ?? 74 ?? 77 ?? 61 ?? 72 ?? 65 ?? 5c ?? 6c ?? 6f ?? 6c ?? 6c ?? 69 ?? 70 ?? 6f ?? 70}  //weight: 5, accuracy: Low
        $x_3_2 = {6e 75 6d 73 3d 00 00 00 26 61 76 73 3d 31 00 00 26 61 76 73 3d 32 00 00 46 31 5f 00 53 31 5f 00}  //weight: 3, accuracy: High
        $x_1_3 = {00 46 31 33 5f 00}  //weight: 1, accuracy: High
        $x_1_4 = {00 46 31 32 5f 00}  //weight: 1, accuracy: High
        $x_1_5 = {00 53 31 33 5f 00}  //weight: 1, accuracy: High
        $x_1_6 = {00 53 31 32 5f 00}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_5_*) and 3 of ($x_1_*))) or
            ((1 of ($x_5_*) and 1 of ($x_3_*))) or
            (all of ($x*))
        )
}

rule Lollipop_14
{
    meta:
        author = "defender2yara"
        detection_name = "Lollipop"
        threat_id = "198706"
        severity = "Low"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "6"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {50 75 62 6c 69 73 68 65 72 20 49 44 20 69 73 20 5c 6e 65 65 64 65 64 2e 00}  //weight: 1, accuracy: High
        $x_1_2 = {50 75 62 6c 69 73 68 65 72 20 49 44 20 69 73 20 69 6e 76 61 6c 69 64 2e 00}  //weight: 1, accuracy: High
        $x_2_3 = {50 75 62 6c 69 73 68 65 72 20 49 44 20 69 73 ff 00 73 ?? 6f ?? 66 ?? 74 ?? 77 ?? 61 ?? 72 ?? 65 ?? 5c ?? 6c ?? 6f ?? 6c ?? 6c ?? 69 ?? 70 ?? 6f ?? 70}  //weight: 2, accuracy: Low
        $x_2_4 = {6e 75 6d 73 3d 00 00 00 26 61 76 73 3d 31 00 00 26 61 76 73 3d 32 00 00 46 31 5f 00 53 31 5f 00}  //weight: 2, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Lollipop_15
{
    meta:
        author = "defender2yara"
        detection_name = "Lollipop"
        threat_id = "198706"
        severity = "Low"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "3"
        strings_accuracy = "Low"
    strings:
        $x_2_1 = {ff d6 89 5d f0 80 7d ?? 4f 75 06 80 7d ?? 4b 74 1c}  //weight: 2, accuracy: Low
        $x_2_2 = {c6 45 80 53 c6 45 81 74 c6 45 82 61 c6 45 83 72 c6 45 84 74 c6 45 85 4d c6 45 86 43 c6 45 87 00}  //weight: 2, accuracy: High
        $x_2_3 = {c6 85 40 f7 ff ff 49 c6 85 41 f7 ff ff 4e c6 85 42 f7 ff ff 53 c6 85 43 f7 ff ff 54 c6 85 44 f7 ff ff 41 c6 85 45 f7 ff ff 4c c6 85 46 f7 ff ff 4c c6 85 47 f7 ff ff 3a}  //weight: 2, accuracy: High
        $x_2_4 = {4d 43 76 32 44 4c 4c 2e 64 6c 6c 00 53 74 61 72 74 4d 43 00}  //weight: 2, accuracy: High
        $x_2_5 = {3c 5f 45 47 4d 43 5f 3e 00}  //weight: 2, accuracy: High
        $x_1_6 = {26 67 72 70 69 64 3d 00}  //weight: 1, accuracy: High
        $x_1_7 = "Software\\fcn\\x00" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_2_*) and 1 of ($x_1_*))) or
            ((2 of ($x_2_*))) or
            (all of ($x*))
        )
}

rule Lollipop_16
{
    meta:
        author = "defender2yara"
        detection_name = "Lollipop"
        threat_id = "198706"
        severity = "Low"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "21"
        strings_accuracy = "High"
    strings:
        $x_9_1 = "INSTALL:|14693||86400|1|0007||" ascii //weight: 9
        $x_9_2 = "Lollipop.exe" ascii //weight: 9
        $x_1_3 = "?AVDog@@" ascii //weight: 1
        $x_1_4 = "?AVMammal@@" ascii //weight: 1
        $x_1_5 = "?AVAnimal@@" ascii //weight: 1
        $x_1_6 = "?AVCat@@" ascii //weight: 1
        $x_1_7 = "?AVLollipopFunc@@" ascii //weight: 1
        $x_1_8 = "?AVobfcls3@@" ascii //weight: 1
        $x_1_9 = "?AVobfcls5@@" ascii //weight: 1
        $x_1_10 = "?AVobfcls8@@" ascii //weight: 1
        $n_10_11 = "The value of ESP was not properly" ascii //weight: -10
    condition:
        (filesize < 20MB) and
        (not (any of ($n*))) and
        (
            ((2 of ($x_9_*) and 3 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule Lollipop_17
{
    meta:
        author = "defender2yara"
        detection_name = "Lollipop"
        threat_id = "198706"
        severity = "Low"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "111"
        strings_accuracy = "High"
    strings:
        $x_100_1 = "87494a0ba8f8f94efd7debcaf918" ascii //weight: 100
        $x_10_2 = "svovfvtvwvavrvev\\vlvovlvlvivpvovpv" ascii //weight: 10
        $x_10_3 = "LvovlvlvivpvovpvIvnvsvtvavlvlvevrv" ascii //weight: 10
        $x_10_4 = "sfoffftfwfafrfef\\flfoflflfifpfofpf" ascii //weight: 10
        $x_10_5 = "LfoflflfifpfofpfIfnfsftfaflflfefrf" ascii //weight: 10
        $x_1_6 = {50 75 62 6c 69 73 68 65 72 20 49 44 20 69 73 20 5c 6e 65 65 64 65 64 2e 00}  //weight: 1, accuracy: High
        $x_1_7 = {50 75 62 6c 69 73 68 65 72 20 49 44 20 69 73 20 69 6e 76 61 6c 69 64 2e 00}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_100_*) and 1 of ($x_10_*) and 1 of ($x_1_*))) or
            ((1 of ($x_100_*) and 2 of ($x_10_*))) or
            (all of ($x*))
        )
}

rule Lollipop_18
{
    meta:
        author = "defender2yara"
        detection_name = "Lollipop"
        threat_id = "198706"
        severity = "Low"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "2"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = "87494a0ba8f8f94efd7debcaf918" ascii //weight: 1
        $x_1_2 = {46 31 5f 00 53 31 5f 00 38 [0-5] 37 [0-5] 34 [0-5] 39 [0-5] 34 [0-5] 61}  //weight: 1, accuracy: Low
        $x_1_3 = "svovfvtvwvavrvev\\vlvovlvlvivpvovpv" ascii //weight: 1
        $x_1_4 = "LvovlvlvivpvovpvIvnvsvtvavlvlvevrv" ascii //weight: 1
        $x_1_5 = "sfoffftfwfafrfef\\flfoflflfifpfofpf" ascii //weight: 1
        $x_1_6 = "Svovfvtvwvavrvev\\vfvcvnv" ascii //weight: 1
        $x_1_7 = "sOoDfftqwqaOrleZ\\YlbomlglIiOpUoKpo" ascii //weight: 1
        $x_1_8 = {76 00 30 00 76 00 30 00 76 00 [0-16] 73 ?? 6f ?? 66 ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? 6c ?? 6f ?? 6c ?? 6c ?? 69}  //weight: 1, accuracy: Low
        $x_1_9 = "vIvNvSvTvAvLvLv:v|" wide //weight: 1
        $x_1_10 = "dvovwvnvlvovavdv_vfvavivlvevdv" ascii //weight: 1
        $x_1_11 = {26 6f 73 69 32 3d [0-5] 26 6f 73 69 31 3d [0-5] 26 61 73 3d [0-5] 26 66 77 3d [0-5] 26 61 76 3d}  //weight: 1, accuracy: Low
        $x_1_12 = {26 6f 73 69 39 3d [0-5] 26 61 64 6d 69 6e 3d [0-5] 26 6c 61 73 74 65 72 72 6f 72 3d [0-5] 26 61 76 65 72 72 6f 72 3d}  //weight: 1, accuracy: Low
        $x_1_13 = {6e 75 6d 73 3d 00 00 00 26 61 76 73 3d 31}  //weight: 1, accuracy: High
        $x_1_14 = "packer_typeversion" ascii //weight: 1
        $x_1_15 = {53 35 5f 00 46 34 62 5f}  //weight: 1, accuracy: High
        $x_1_16 = "mvyvmvuvtvsvgvlvwvovrvkv" ascii //weight: 1
        $x_1_17 = {00 2d 72 6e 61 6d 65 00}  //weight: 1, accuracy: High
        $x_1_18 = {00 2d 73 75 62 69 64 00}  //weight: 1, accuracy: High
        $x_1_19 = {00 2d 6e 6f 6a 73 00}  //weight: 1, accuracy: High
        $x_1_20 = {0d 6e 6f 6a 73 00}  //weight: 1, accuracy: High
        $x_1_21 = {d9 ee d9 c9 59 db f1 dd d9 76 0c}  //weight: 1, accuracy: High
        $x_1_22 = "AVLollipopFunc@@" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (2 of ($x*))
}

rule Safesaver_0
{
    meta:
        author = "defender2yara"
        detection_name = "Safesaver"
        threat_id = "198717"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "InfoURL=\"http://safesaver.net/\"" ascii //weight: 2
        $x_2_2 = "ProductName=\"safe ussAve\"" ascii //weight: 2
        $x_1_3 = "bgscript=\"DMxGsy8KhH82Ae43pSwFvyVKAfn3hNlKg6mPB7" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_2_*) and 1 of ($x_1_*))) or
            ((2 of ($x_2_*))) or
            (all of ($x*))
        )
}

rule Safesaver_1
{
    meta:
        author = "defender2yara"
        detection_name = "Safesaver"
        threat_id = "198717"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_2_1 = {50 72 6f 64 75 63 74 4e 61 6d 65 09 3d 20 22 73 61 61 66 65 20 73 73 61 56 65 61 22}  //weight: 2, accuracy: High
        $x_2_2 = {50 75 62 6c 69 73 68 65 72 09 3d 20 22 73 61 66 65 20 73 61 76 65 22}  //weight: 2, accuracy: High
        $x_2_3 = {49 6e 66 6f 55 52 4c 09 09 3d 20 22 68 74 74 70 3a 2f 2f 73 61 66 65 73 61 76 65 72 2e 6e 65 74 2f 22}  //weight: 2, accuracy: High
        $x_1_4 = "bgscript=\"DMxGsy8KhH82Ae43pSwFvyVKAfn3hNlKg6mPB7" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((2 of ($x_2_*) and 1 of ($x_1_*))) or
            ((3 of ($x_2_*))) or
            (all of ($x*))
        )
}

rule WebCake_0
{
    meta:
        author = "defender2yara"
        detection_name = "WebCake"
        threat_id = "198788"
        severity = "19"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "WebCakeDesktop" ascii //weight: 1
        $x_1_2 = "Y2Desktop.PlugInOS" ascii //weight: 1
        $x_1_3 = "bake cake" ascii //weight: 1
        $x_1_4 = {49 00 6e 00 74 00 65 00 72 00 6e 00 61 00 6c 00 4e 00 61 00 6d 00 65 00 00 00 44 00 65 00 73 00 6b 00 74 00 6f 00 70 00 2e 00 4f 00 53 00 2e 00 64 00 6c 00 6c 00}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule WebCake_1
{
    meta:
        author = "defender2yara"
        detection_name = "WebCake"
        threat_id = "198788"
        severity = "19"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "WebCakeDesktop" ascii //weight: 1
        $x_1_2 = "WebCake LLC. All rights reserved." ascii //weight: 1
        $x_1_3 = "WebCake.Desktop" ascii //weight: 1
        $x_1_4 = {50 00 72 00 6f 00 64 00 75 00 63 00 74 00 4e 00 61 00 6d 00 65 00 00 00 00 00 57 00 65 00 62 00 43 00 61 00 6b 00 65 00}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (3 of ($x*))
}

rule WebCake_2
{
    meta:
        author = "defender2yara"
        detection_name = "WebCake"
        threat_id = "198788"
        severity = "19"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "get_plugin_getwebcake_com" ascii //weight: 1
        $x_1_2 = "user_pref(\"extentions.webcake.installId\"" wide //weight: 1
        $x_1_3 = "WebCake.Desktop.OS" wide //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule WebCake_3
{
    meta:
        author = "defender2yara"
        detection_name = "WebCake"
        threat_id = "198788"
        severity = "19"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "3"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = "api.getwebcake.com" wide //weight: 1
        $x_1_2 = "WebCake Layers Api" ascii //weight: 1
        $x_1_3 = {50 72 6f 67 49 44 20 3d 20 73 20 27 57 65 62 43 61 6b 65 49 45 43 6c 69 65 6e 74 2e 4c 61 79 65 72 73 2e 31 27 0d 0a}  //weight: 1, accuracy: High
        $x_1_4 = {50 00 72 00 6f 00 64 00 75 00 63 00 74 00 4e 00 61 00 6d 00 65 00 00 00 00 00 57 00 65 00 62 00 [0-4] 43 00 61 00 6b 00 65 00}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (3 of ($x*))
}

rule WebCake_4
{
    meta:
        author = "defender2yara"
        detection_name = "WebCake"
        threat_id = "198788"
        severity = "19"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "2"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "WebCakeIEClient" wide //weight: 1
        $x_1_2 = "Copyright (c) 2013 Let Them Eat Web-Cake LLC.  All rights reserved." wide //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule WebCake_5
{
    meta:
        author = "defender2yara"
        detection_name = "WebCake"
        threat_id = "198788"
        severity = "19"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "3"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {54 53 55 20 4c 6f 61 64 65 72 00}  //weight: 1, accuracy: High
        $x_1_2 = {43 00 6f 00 70 00 79 00 72 00 69 00 67 00 68 00 74 00 20 00 28 00 63 00 29 00 20 00 32 00 30 00 31 00 33 00 20 00 57 00 65 00 62 00 [0-2] 43 00 61 00 6b 00 65 00 20 00 4c 00 4c 00 43 00 2e 00 20 00 20 00 41 00 6c 00 6c 00 20 00 72 00 69 00 67 00 68 00 74 00 73 00 20 00 72 00 65 00 73 00 65 00 72 00 76 00 65 00 64 00 2e 00}  //weight: 1, accuracy: Low
        $x_1_3 = {50 00 72 00 6f 00 64 00 75 00 63 00 74 00 4e 00 61 00 6d 00 65 00 00 00 00 00 57 00 65 00 62 00 [0-4] 43 00 61 00 6b 00 65 00}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule WebCake_6
{
    meta:
        author = "defender2yara"
        detection_name = "WebCake"
        threat_id = "198788"
        severity = "19"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "BrowserProtect.dll" wide //weight: 1
        $x_1_2 = "fjoijdanhaiflhibkljeklcghcmmfffh" ascii //weight: 1
        $x_1_3 = "urls_to_restore_on_startup\": [ \"http://search.getwebcake.com/\" ]}" ascii //weight: 1
        $x_1_4 = "WebCake Loud Installer (Main)\\Binaries\\WebCakeChromeWatch.pdb" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Vonteera_0
{
    meta:
        author = "defender2yara"
        detection_name = "Vonteera"
        threat_id = "198936"
        severity = "Low"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "VonteeraBHO@@" ascii //weight: 1
        $x_1_2 = "var vonteera_user_id='%s'" wide //weight: 1
        $x_1_3 = "Software\\Vonteera" wide //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule BetterSurf_0
{
    meta:
        author = "defender2yara"
        detection_name = "BetterSurf"
        threat_id = "200821"
        severity = "72"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "Low"
    strings:
        $x_5_1 = {5c 69 65 5c 52 65 6c 65 61 73 65 5c 42 65 74 74 65 72 53 01 00 72 66 2e 70 64 62}  //weight: 5, accuracy: Low
        $x_5_2 = {43 43 6f 6d 4f 62 6a 65 63 74 40 56 43 42 65 74 74 65 72 53 01 00 72 66 42 48 4f 40 40 40 41 54 4c 40 40}  //weight: 5, accuracy: Low
        $x_1_3 = {00 42 65 74 74 65 72 53 01 00 72 66 2e 64 6c 6c 00}  //weight: 1, accuracy: Low
        $x_1_4 = {46 00 69 00 6c 00 65 00 44 00 65 00 73 00 63 00 72 00 69 00 70 00 74 00 69 00 6f 00 6e 00 00 00 00 00 4d 00 61 00 6b 00 69 00 6e 00 67 00 20 00 77 00 65 00 62 00 20 00 62 00 72 00 6f 00 77 00 73 00 69 00 6e 00 67 00 20 00 6d 00 6f 00 72 00 65 00 20 00 65 00 6e 00 6a 00 6f 00 79 00 61 00 62 00 6c 00 65 00 00 00}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_1_*))) or
            ((1 of ($x_5_*))) or
            (all of ($x*))
        )
}

rule BetterSurf_1
{
    meta:
        author = "defender2yara"
        detection_name = "BetterSurf"
        threat_id = "200821"
        severity = "72"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "2"
        strings_accuracy = "Low"
    strings:
        $x_2_1 = {8b 08 8d 55 f0 52 50 8b 81 b0 01 00 00 89 7d fc ff d0 68 ?? ?? ?? ?? ff 15 ?? ?? ?? ?? 89 45 08 3b c7 75 ?? 68 0e 00 07 80 e8 ?? ?? ?? ?? 8b 35 ?? ?? ?? ?? 68 ?? ?? ?? ?? c6 45 fc 01 ff d6}  //weight: 2, accuracy: Low
        $x_2_2 = {43 43 6f 6d 4f 62 6a 65 63 74 40 56 43 57 65 62 65 78 70 45 6e 68 61 6e 63 65 64 [0-16] 42 48 4f 40 40 40 41 54 4c 40 40}  //weight: 2, accuracy: Low
        $x_1_3 = "'www.jsutils.net/ext.js?c=" wide //weight: 1
        $x_1_4 = "script.setAttribute('id','wsu_js')" wide //weight: 1
        $x_1_5 = "if(head && !document.getElementById('wsu_js'))" wide //weight: 1
        $x_1_6 = "if(top == self) {    var script = document.createElement('script');" wide //weight: 1
        $x_1_7 = {57 00 65 00 62 00 65 00 78 00 70 00 45 00 6e 00 68 00 61 00 6e 00 63 00 65 00 64 00 ?? ?? 61 00 6c 00 70 00 68 00 61 00}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (
            ((2 of ($x_1_*))) or
            ((1 of ($x_2_*))) or
            (all of ($x*))
        )
}

rule OKitSpace_0
{
    meta:
        author = "defender2yara"
        detection_name = "OKitSpace"
        threat_id = "202092"
        severity = "Critical"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "2"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = "\\PluginInjectIE\\Release\\BaseFlash.pdb" ascii //weight: 1
        $x_1_2 = "{C68AE9C0-0909-4DDC-B661-C1AFB9F5AE53}" ascii //weight: 1
        $x_1_3 = "sts.baseflash.com/software_stats/" ascii //weight: 1
        $x_1_4 = "open('POST', url, true);" ascii //weight: 1
        $x_1_5 = {26 61 63 74 69 6f 6e 5f 64 65 73 63 72 69 70 74 69 6f 6e 3d 49 45 [0-4] 75 73 65 72 5f 64 61 74 65 3d}  //weight: 1, accuracy: Low
        $x_1_6 = "&user_agent=IE&user_id=" ascii //weight: 1
        $x_1_7 = "&channel_id=" ascii //weight: 1
        $x_1_8 = "&affid=" ascii //weight: 1
        $x_1_9 = "st.rewinup.com/software_stats/" ascii //weight: 1
        $x_1_10 = "!document.getElementById('mybho_js') &&" ascii //weight: 1
        $x_1_11 = {2e 63 6f 6d 2f 62 61 73 65 2f (62 61|72 65 77) 2e 6a 73 00}  //weight: 1, accuracy: Low
        $x_1_12 = "ads.okitspace.com/uploads/cover.js" ascii //weight: 1
        $x_1_13 = "onreadystatechange = function () {};" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (2 of ($x*))
}

rule Feven_0
{
    meta:
        author = "defender2yara"
        detection_name = "Feven"
        threat_id = "202322"
        severity = "42"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "101"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = "CrossriderApp0051680" ascii //weight: 1
        $x_1_2 = "CrossriderApp0051682" ascii //weight: 1
        $x_1_3 = "CrossriderApp0051684" ascii //weight: 1
        $x_1_4 = "CrossriderApp0000000" ascii //weight: 1
        $x_1_5 = "CrossriderApp0038524" ascii //weight: 1
        $x_1_6 = "CrossriderApp0038526" ascii //weight: 1
        $x_1_7 = "CrossriderApp0038532" ascii //weight: 1
        $x_1_8 = "CrossriderApp0040594" ascii //weight: 1
        $x_1_9 = "CrossriderApp0049004" ascii //weight: 1
        $x_1_10 = "CrossriderApp0049010" ascii //weight: 1
        $x_1_11 = "CrossriderApp0049012" ascii //weight: 1
        $x_1_12 = "CrossriderApp0051678" ascii //weight: 1
        $x_1_13 = "CrossriderApp0058026" ascii //weight: 1
        $x_100_14 = {46 00 65 00 76 00 65 00 6e 00 30 00 50 00 72 00 6f 00 64 00 75 00 63 00 74 00 4e 00 61 00 6d 00 65 00}  //weight: 100, accuracy: Low
        $x_100_15 = {66 00 69 00 76 00 20 00 65 00 6e 00 00 00 30 00 50 00 72 00 6f 00 64 00 75 00 63 00 74 00 4e 00 61 00 6d 00 65 00}  //weight: 100, accuracy: Low
        $x_100_16 = {66 00 69 00 76 00 20 00 76 00 65 00 6e 00 00 00 30 00 50 00 72 00 6f 00 64 00 75 00 63 00 74 00 4e 00 61 00 6d 00 65 00}  //weight: 100, accuracy: Low
        $x_100_17 = {66 00 72 00 65 00 65 00 20 00 76 00 65 00 6e 00 00 00 30 00 50 00 72 00 6f 00 64 00 75 00 63 00 74 00 4e 00 61 00 6d 00 65 00}  //weight: 100, accuracy: Low
        $x_100_18 = {66 00 72 00 65 00 65 00 76 00 65 00 6e 00 00 00 30 00 50 00 72 00 6f 00 64 00 75 00 63 00 74 00 4e 00 61 00 6d 00 65 00}  //weight: 100, accuracy: Low
        $x_100_19 = {46 00 72 00 69 00 76 00 65 00 6e 00 30 00 50 00 72 00 6f 00 64 00 75 00 63 00 74 00 4e 00 61 00 6d 00 65 00}  //weight: 100, accuracy: Low
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_100_*) and 1 of ($x_1_*))) or
            ((2 of ($x_100_*))) or
            (all of ($x*))
        )
}

rule Fidot_0
{
    meta:
        author = "defender2yara"
        detection_name = "Fidot"
        threat_id = "204065"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "14"
        strings_accuracy = "High"
    strings:
        $x_3_1 = {02 7b 0f 00 00 0a 72 01 00 00 70 6f 12 00 00 0a 0a 02 6f 14 00 00 0a 26 02 72 2f 00 00 70 72 3f 00 00 70 6f 15 00 00 0a 26 2a}  //weight: 3, accuracy: High
        $x_3_2 = {02 7b 21 00 00 0a 72 41 00 00 70 6f 2b 00 00 0a 0a 02 6f 2d 00 00 0a 26 02 72 85 01 00 70 72 95 01 00 70 6f 2e 00 00 0a 26 2a}  //weight: 3, accuracy: High
        $x_10_3 = "adss.dotdo.net/adss/" wide //weight: 10
        $x_10_4 = "61%64%73%73%2E" wide //weight: 10
        $x_1_5 = "Starting FiddlerCore..." wide //weight: 1
        $x_1_6 = "fiddler.network.streaming.abortifclientaborts" wide //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_10_*) and 1 of ($x_3_*) and 1 of ($x_1_*))) or
            ((1 of ($x_10_*) and 2 of ($x_3_*))) or
            ((2 of ($x_10_*))) or
            (all of ($x*))
        )
}

rule Pirrit_0
{
    meta:
        author = "defender2yara"
        detection_name = "Pirrit"
        threat_id = "205602"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "2"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "1checkAndRunPirrit()" ascii //weight: 1
        $x_1_2 = {50 69 72 72 69 74 44 65 73 6b 74 6f 70 00}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Pirrit_1
{
    meta:
        author = "defender2yara"
        detection_name = "Pirrit"
        threat_id = "205602"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "1finishedDownloadInjectionContent(QNetwork" ascii //weight: 1
        $x_1_2 = "var prtLoader" ascii //weight: 1
        $x_1_3 = "function prtInIframe" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Pirrit_2
{
    meta:
        author = "defender2yara"
        detection_name = "Pirrit"
        threat_id = "205602"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "id=\"pirrit_is_service" ascii //weight: 1
        $x_1_2 = "var PIRRIT_IS_INSTALLED" ascii //weight: 1
        $x_1_3 = "var PIRRIT_IS_SERVICE" ascii //weight: 1
        $x_1_4 = "var PIRRIT_EXTID" ascii //weight: 1
        $x_1_5 = "var pirritLoader" ascii //weight: 1
        $x_1_6 = "suggestor.pirrit.com" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (3 of ($x*))
}

rule Dotdoads_0
{
    meta:
        author = "defender2yara"
        detection_name = "Dotdoads"
        threat_id = "206106"
        severity = "Low"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "2"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "document.write( unescape( '%3C%73%63%72%69%70%74%20%6C%61%6E%67%75%61%67%65%3D%27%4A%61%76%61%53%63%72%69%70%74%27%20" wide //weight: 1
        $x_1_2 = "%68%74%74%70%3A%2F%2F%61%61%2E%64%6F%74%64%6F%2E%6E%65%74%2F%61%64%73%73" wide //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule PennyBeeLinkury_0
{
    meta:
        author = "defender2yara"
        detection_name = "PennyBeeLinkury"
        threat_id = "207409"
        severity = "7"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "3"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {4d 6f 6e 65 74 69 7a 61 74 69 6f 6e 2e 49 6e 6a 65 63 74 41 70 70 00 44 6c 6c 49 6e 6a 65 63 74 69 6f 6e 52 65 73 75 6c 74 00 44 6c 6c 49 6e 6a 65 63 74 6f 72 00}  //weight: 1, accuracy: High
        $x_1_2 = {5c 4d 6f 6e 65 74 69 7a 61 74 69 6f 6e 5c 53 6d 61 72 74 62 61 72 2e 4d 6f 6e 65 74 69 7a 61 74 69 6f 6e 2e 49 6e 6a 65 63 74 41 70 70 5c 6f 62 6a [0-4] 5c 52 65 6c 65 61 73 65 5c 73 6d 69 61 2e 70 64 62}  //weight: 1, accuracy: Low
        $x_1_3 = "ntdis_32.dll" wide //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule PennyBeeLinkury_1
{
    meta:
        author = "defender2yara"
        detection_name = "PennyBeeLinkury"
        threat_id = "207409"
        severity = "7"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "14"
        strings_accuracy = "High"
    strings:
        $x_10_1 = "PennyBeeW.exe" ascii //weight: 10
        $x_1_2 = "_refreshInjectionInstructionsTimer" ascii //weight: 1
        $x_1_3 = "<ExternalInjections>k__BackingField" ascii //weight: 1
        $x_1_4 = "<RedirectionTargetUrl>k__BackingField" ascii //weight: 1
        $x_1_5 = "get_ProxyProtectorIntervalMinutes" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule PennyBeeLinkury_2
{
    meta:
        author = "defender2yara"
        detection_name = "PennyBeeLinkury"
        threat_id = "207409"
        severity = "7"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "3"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {48 00 74 00 74 00 70 00 73 00 49 00 6e 00 6a 00 65 00 63 00 74 00 69 00 6f 00 6e 00 ?? ?? 48 00 74 00 74 00 70 00 49 00 6e 00 6a 00 65 00 63 00 74 00 69 00 6f 00 6e 00 ?? ?? 42 00 48 00 4f 00 3a 00 20 00 4f 00 6e 00 44 00 6f 00 63 00 75 00 6d 00 65 00 6e 00 74 00 43 00 6f 00 6d 00 70 00 6c 00 65 00 74 00 65 00}  //weight: 1, accuracy: Low
        $x_1_2 = "LinkuryInternetExplorerBHO" ascii //weight: 1
        $x_1_3 = {4e 00 6f 00 45 00 78 00 70 00 6c 00 6f 00 72 00 65 00 72 00 ?? ?? 33 00 31 00 41 00 44 00 34 00 30 00 30 00 44 00 2d 00 31 00 42 00 30 00 36 00 2d 00 34 00 45 00 33 00 33 00 2d 00 41 00 35 00 39 00 41 00 2d 00 39 00 30 00 43 00 32 00 43 00 31 00 34 00 30 00 43 00 42 00 41 00 30 00}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule ZoomyLib_0
{
    meta:
        author = "defender2yara"
        detection_name = "ZoomyLib"
        threat_id = "207413"
        severity = "30"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {49 6e 73 74 61 6c 6c 65 72 55 74 69 6c 73 2e 64 6c 6c 00 43 49 00 43 4e 47 00 48 52 4e 00 4b 42 73 00 52 53 00 57 41 4d 00 67 43 55 44 00 67 49 44 00 69 43 50 4f 00 6f 49 53 00 72 4f 41 00 72 56 46 00 73 49 44 46 00 75 44 47 00 75 50 56 00}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule ZoomyLib_1
{
    meta:
        author = "defender2yara"
        detection_name = "ZoomyLib"
        threat_id = "207413"
        severity = "30"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "31"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {61 64 62 6c 6f 63 6b 65 72 00}  //weight: 1, accuracy: High
        $x_1_2 = {62 6f 6f 73 74 77 65 62 61 70 70 00}  //weight: 1, accuracy: High
        $x_1_3 = {6e 65 74 73 70 65 65 64 61 70 70 00}  //weight: 1, accuracy: High
        $x_10_4 = {53 6f 66 74 77 61 72 65 5c 31 (30|2d|39) (30|2d|39) 5f 33 31}  //weight: 10, accuracy: Low
        $x_10_5 = "{9191919-91919-91919-91919191919}" ascii //weight: 10
        $x_10_6 = "mac=112233445566" ascii //weight: 10
    condition:
        (filesize < 20MB) and
        (
            ((3 of ($x_10_*) and 1 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule ZoomyLib_2
{
    meta:
        author = "defender2yara"
        detection_name = "ZoomyLib"
        threat_id = "207413"
        severity = "30"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "9"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "zoomutil32.dll" ascii //weight: 1
        $x_1_2 = "apputil32.dll" ascii //weight: 1
        $x_2_3 = "In CallJS.Invoke -> 0x%08X" ascii //weight: 2
        $x_2_4 = "LoadIEBgWIndow" ascii //weight: 2
        $x_2_5 = "content/dgmain.js" ascii //weight: 2
        $x_2_6 = "content/jquery4toolbar.js" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (
            ((4 of ($x_2_*) and 1 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule ZoomyLib_3
{
    meta:
        author = "defender2yara"
        detection_name = "ZoomyLib"
        threat_id = "207413"
        severity = "30"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "3"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = "DosDevices\\tammg11" wide //weight: 1
        $x_1_2 = {83 7d 24 26 74 16 83 7d 24 03 74 10 83 7d 24 25 74 0a 83 7d 24 0c 0f 85 d7 02 00 00 8b 45 1c 89 85 f8 fb ff ff 83 a5 e8 fb ff ff 00 68 4f 46 49 52 68 00 04 00 00 6a 01 ff 15}  //weight: 1, accuracy: High
        $x_1_3 = {55 8b ec 51 c7 45 fc 65 03 00 c0 e8 ?? ?? ?? ?? 0f b6 c0 85 c0 74 34 e8 ?? ?? ?? ?? 0f b6 c0 85 c0 74}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule ZoomyLib_4
{
    meta:
        author = "defender2yara"
        detection_name = "ZoomyLib"
        threat_id = "207413"
        severity = "30"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "3"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {48 8b f8 ff 15 ?? ?? ?? ?? 8b d8 85 c0 74 10 ba 20 4e 00 00 48 8b cf ff 15 ?? ?? ?? ?? eb 05 e8 ?? ?? ?? ?? 85 db 75 db 33 c9 e8 ?? ?? ?? ?? cc 48 8b c4 55 48 8d a8 98 fc ff ff 48 81 ec 60 04 00 00}  //weight: 1, accuracy: Low
        $x_1_2 = {48 8b 5c 24 20 48 8b cb ff 15 ?? ?? ?? ?? 48 85 c0 74 18 48 8d 15 ?? ?? ?? ?? 48 8b c8 ff 15 ?? ?? ?? ?? 48 85 c0 74 03 ff d0}  //weight: 1, accuracy: Low
        $x_1_3 = {48 8d 53 e8 f0 83 42 10 ff 7f 16 48 8b 0a 48 8b 01 ff 50 08 eb 0b}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule ZoomyLib_5
{
    meta:
        author = "defender2yara"
        detection_name = "ZoomyLib"
        threat_id = "207413"
        severity = "30"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "3"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {8b 40 30 0f b6 40 02 89 45 fc 39 7d fc 74 0e 68 20 4e 00 00 56 ff 15 ?? ?? ?? ?? eb 05 e8 0c 00 00 00 39 7d fc 75 d3 57 e8 ?? ?? ?? ?? cc 55 81 ec 10 04 00 00 8d 6c 24 fc a1 ?? ?? ?? ?? 33 c5 89 85 10 04 00 00 6a 04}  //weight: 1, accuracy: Low
        $x_1_2 = {8b 75 f0 56 ff 15 ?? ?? ?? ?? 85 c0 74 12 68 ?? ?? ?? ?? 50 ff 15 ?? ?? ?? ?? 85 c0 74 02 ff d0}  //weight: 1, accuracy: Low
        $x_1_3 = {83 c6 f0 83 c9 ff 89 4d fc 8d 46 0c f0 0f c1 08 49 85 c9 7f 08 8b 0e 56 8b 01 ff 50 04}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule ZoomyLib_6
{
    meta:
        author = "defender2yara"
        detection_name = "ZoomyLib"
        threat_id = "207413"
        severity = "30"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "21"
        strings_accuracy = "High"
    strings:
        $x_10_1 = "kle.austries.com/amm/rapps/%s_%s/%s/loader.js?d=t" ascii //weight: 10
        $x_10_2 = "__AGT_WNDCLASS_PX__" wide //weight: 10
        $x_1_3 = {61 00 64 00 62 00 6c 00 6f 00 63 00 6b 00 65 00 72 00 00 00}  //weight: 1, accuracy: High
        $x_1_4 = {62 00 6f 00 6f 00 73 00 74 00 77 00 65 00 62 00 61 00 70 00 70 00 00 00}  //weight: 1, accuracy: High
        $x_1_5 = {6e 00 65 00 74 00 73 00 70 00 65 00 65 00 64 00 61 00 70 00 70 00 00 00}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (
            ((2 of ($x_10_*) and 1 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule ZoomyLib_7
{
    meta:
        author = "defender2yara"
        detection_name = "ZoomyLib"
        threat_id = "207413"
        severity = "30"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "9"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {65 00 61 00 7a 00 79 00 7a 00 6f 00 6f 00 6d 00 00 00}  //weight: 1, accuracy: High
        $x_1_2 = {6e 00 65 00 74 00 73 00 70 00 65 00 65 00 64 00 61 00 70 00 70 00 00 00}  //weight: 1, accuracy: High
        $x_2_3 = "?type=install_reg" wide //weight: 2
        $x_2_4 = "DosDevices\\tammgF11" wide //weight: 2
        $x_2_5 = "AG Filter Driver" wide //weight: 2
        $x_2_6 = "tammg.sys" wide //weight: 2
    condition:
        (filesize < 20MB) and
        (
            ((4 of ($x_2_*) and 1 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule ZoomyLib_8
{
    meta:
        author = "defender2yara"
        detection_name = "ZoomyLib"
        threat_id = "207413"
        severity = "30"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "72"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = "LoadIEBgWIndow" ascii //weight: 1
        $x_1_2 = "__AGT_WNDCLASS_PX__" wide //weight: 1
        $x_1_3 = "s3.zawss.info/client-cmd/cr.html" wide //weight: 1
        $x_8_4 = {61 64 62 6c 6f 63 6b 65 72 00}  //weight: 8, accuracy: High
        $x_8_5 = {62 6f 6f 73 74 77 65 62 61 70 70 00}  //weight: 8, accuracy: High
        $x_8_6 = {6e 65 74 73 70 65 65 64 61 70 70 00}  //weight: 8, accuracy: High
        $x_64_7 = {74 61 6d 6d 67 31 (30|2d|39) (30|2d|39) 00}  //weight: 64, accuracy: Low
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_64_*) and 1 of ($x_8_*))) or
            (all of ($x*))
        )
}

rule ZoomyLib_9
{
    meta:
        author = "defender2yara"
        detection_name = "ZoomyLib"
        threat_id = "207413"
        severity = "30"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "12"
        strings_accuracy = "High"
    strings:
        $x_10_1 = "pennybee" wide //weight: 10
        $x_1_2 = "agrep/bho/report.php" wide //weight: 1
        $x_1_3 = "ws.xcodelib.net" wide //weight: 1
        $x_1_4 = "In CallJS.Invoke -> 0x%08X" ascii //weight: 1
        $x_1_5 = "(Changing URL) Field Name: %s, URL: %s, hWnd: 0x%08X, Event: 0x%08X" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_10_*) and 2 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule ZoomyLib_10
{
    meta:
        author = "defender2yara"
        detection_name = "ZoomyLib"
        threat_id = "207413"
        severity = "30"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = "In CallJS.Invoke -> 0x%08X" ascii //weight: 1
        $x_1_2 = "in DispInvoke: Searching -> %s" ascii //weight: 1
        $x_1_3 = "content/jquery4toolbar.js" ascii //weight: 1
        $x_1_4 = "__GLOBAL_INSTALLER_CPP_CB_FUNCTION__" ascii //weight: 1
        $x_1_5 = "TrayIcons/logo.ico" ascii //weight: 1
        $x_1_6 = {83 4d fc ff 59 a1 ?? ?? ?? ?? 83 78 f4 00 75 1d 6a 02 59 e8 ?? ?? ?? ?? 68 ?? ?? ?? ?? ff 30 68 ?? ?? ?? ?? 56 e8 ?? ?? ?? ?? 83 c4 10 8b c6 e8 ?? ?? ?? ?? c3}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (5 of ($x*))
}

rule ZoomyLib_11
{
    meta:
        author = "defender2yara"
        detection_name = "ZoomyLib"
        threat_id = "207413"
        severity = "30"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "43"
        strings_accuracy = "High"
    strings:
        $x_10_1 = "HookedZwSetValueKey(): read only value path %s" ascii //weight: 10
        $x_10_2 = "HookedZwCreateFile" ascii //weight: 10
        $x_10_3 = "ServiceIdFromFn(): Bogus service ID %08x" ascii //weight: 10
        $x_10_4 = "Hooking SST %x Index %03x Old %08x" ascii //weight: 10
        $x_2_5 = "120%s %s (%d), PID=%u:" ascii //weight: 2
        $x_1_6 = "c:\\webwork\\adblocker\\agent\\driver\\32bit\\hookssrv.c" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule ZoomyLib_12
{
    meta:
        author = "defender2yara"
        detection_name = "ZoomyLib"
        threat_id = "207413"
        severity = "30"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "kle.austries.com/amm/rapps/%s_%s/%s/loader.js?d=t" ascii //weight: 1
        $x_1_2 = "mac=112233445566" ascii //weight: 1
        $x_1_3 = "<script type=\"text/javascript\" src=\"%s\" id=\"__amm_01\" charset=\"UTF-8\"></script>" ascii //weight: 1
        $x_1_4 = "replace.suni=\"%d\"; replace.dsr=\"%s\"; replace.pgd=\"%s\"; replace.tt = \"%s\";" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule ZoomyLib_13
{
    meta:
        author = "defender2yara"
        detection_name = "ZoomyLib"
        threat_id = "207413"
        severity = "30"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "31"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {61 00 64 00 62 00 6c 00 6f 00 63 00 6b 00 65 00 72 00 00 00}  //weight: 1, accuracy: High
        $x_1_2 = {62 00 6f 00 6f 00 73 00 74 00 77 00 65 00 62 00 61 00 70 00 70 00 00 00}  //weight: 1, accuracy: High
        $x_10_3 = "Soft%sicro%sdows\\Cur%sion\\R%s" wide //weight: 10
        $x_10_4 = {83 4d fc ff 59 a1 ?? ?? ?? ?? 83 78 f4 00 75 1d 6a 02 59 e8 ?? ?? ?? ?? 68 ?? ?? ?? ?? ff 30 68 ?? ?? ?? ?? 56 e8 ?? ?? ?? ?? 83 c4 10 8b c6 e8 ?? ?? ?? ?? c3}  //weight: 10, accuracy: Low
        $x_10_5 = {8d 44 24 10 50 57 57 68 ?? ?? ?? ?? 57 57 e8 ?? ?? ?? ?? 83 c4 18 b1 01 6a 02 5a e8 ?? ?? ?? ?? 68 ?? ?? ?? ?? 6a 01 57 ff 15 ?? ?? ?? ?? 8b d8 85 db 0f 84 b8 00 00 00 ff 15 ?? ?? ?? ?? 3d b7 00 00 00}  //weight: 10, accuracy: Low
    condition:
        (filesize < 20MB) and
        (
            ((3 of ($x_10_*) and 1 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule ZoomyLib_14
{
    meta:
        author = "defender2yara"
        detection_name = "ZoomyLib"
        threat_id = "207413"
        severity = "30"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "31"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "https://s.xcodelib.net/updates/ff/apps/900/10010045.xml" wide //weight: 1
        $x_10_2 = "lyricsgizmos" wide //weight: 10
        $x_10_3 = "{9E58233C-6B10-4357-BCF4-4B71DF7B5D0C}" wide //weight: 10
        $x_10_4 = "tb@jamboz.com" wide //weight: 10
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule ZoomyLib_15
{
    meta:
        author = "defender2yara"
        detection_name = "ZoomyLib"
        threat_id = "207413"
        severity = "30"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "10"
        strings_accuracy = "Low"
    strings:
        $x_4_1 = {31 00 30 00 30 00 38 00 30 00 30 00 (30|2d|39) 00 (30|2d|39) 00 00 00 00 00 31 00 31 00 39 00 00 00 31 00 30 00 30 00 38 00}  //weight: 4, accuracy: Low
        $x_4_2 = "ws.xcodelib.net" ascii //weight: 4
        $x_1_3 = "zo..omi..fy" ascii //weight: 1
        $x_1_4 = "zo..om..ify" ascii //weight: 1
        $x_1_5 = "{72351B45-9636-4F99-820B-7C552D27897D}" wide //weight: 1
        $x_1_6 = "{CE4560BB-8F73-4B39-8135-047BEDB94192}" wide //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((2 of ($x_4_*) and 2 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule ZoomyLib_16
{
    meta:
        author = "defender2yara"
        detection_name = "ZoomyLib"
        threat_id = "207413"
        severity = "30"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "41"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {61 00 64 00 62 00 6c 00 6f 00 63 00 6b 00 65 00 72 00 00 00}  //weight: 1, accuracy: High
        $x_1_2 = {62 00 6f 00 6f 00 73 00 74 00 77 00 65 00 62 00 61 00 70 00 70 00 00 00}  //weight: 1, accuracy: High
        $x_1_3 = {6e 00 65 00 74 00 73 00 70 00 65 00 65 00 64 00 61 00 70 00 70 00 00 00}  //weight: 1, accuracy: High
        $x_10_4 = "?type=install_reg" wide //weight: 10
        $x_10_5 = "?type=active&cnt=%d&prvtm=%s&dl=%d" wide //weight: 10
        $x_10_6 = "%s?type=install_start&affId=%s&pubId=%s&appId=%s&agver=%s" wide //weight: 10
        $x_10_7 = "Tempo Runner %s" wide //weight: 10
    condition:
        (filesize < 20MB) and
        (
            ((4 of ($x_10_*) and 1 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule ZoomyLib_17
{
    meta:
        author = "defender2yara"
        detection_name = "ZoomyLib"
        threat_id = "207413"
        severity = "30"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "12"
        strings_accuracy = "Low"
    strings:
        $x_2_1 = {65 61 7a 79 7a 6f 6f 6d 00}  //weight: 2, accuracy: High
        $x_2_2 = {62 6f 62 79 7a 6f 6f 6d 00}  //weight: 2, accuracy: High
        $x_2_3 = {77 65 62 73 6d 61 72 74 61 70 70 00}  //weight: 2, accuracy: High
        $x_2_4 = {6e 65 74 73 70 65 65 64 61 70 70 00}  //weight: 2, accuracy: High
        $x_1_5 = "+sp=%s +un=NT AUTHORITY\\SYSTEM +cl=/ts2=1" wide //weight: 1
        $x_1_6 = "s3.xrepaws.com/client-cmd/cr.html" wide //weight: 1
        $x_1_7 = "s3.xamzaws.com/client-cmd/cr.html" wide //weight: 1
        $x_1_8 = "content/jquery4toolbar.js" ascii //weight: 1
        $x_1_9 = "url\": \"http://kle.austries" ascii //weight: 1
        $x_10_10 = {74 61 6d 6d 67 52 31 31 (30|2d|39) 00}  //weight: 10, accuracy: Low
    condition:
        (filesize < 20MB) and
        (
            ((4 of ($x_2_*) and 4 of ($x_1_*))) or
            ((1 of ($x_10_*) and 2 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_2_*))) or
            (all of ($x*))
        )
}

rule ZoomyLib_18
{
    meta:
        author = "defender2yara"
        detection_name = "ZoomyLib"
        threat_id = "207413"
        severity = "30"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "31"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = "https://s.xcodelib.net/updates/ff/apps/119/10080008.xml" wide //weight: 1
        $x_1_2 = "https://s.xcodelib.net/updates/ff/apps/119/10080009.xml" wide //weight: 1
        $x_1_3 = {31 00 30 00 30 00 38 00 30 00 30 00 (30|2d|39) 00 (30|2d|39) 00 00 00 00 00 31 00 31 00 39 00 00 00 31 00 30 00 30 00 38 00}  //weight: 1, accuracy: Low
        $x_10_4 = "Zoomify" ascii //weight: 10
        $x_10_5 = "tb@zoomify.com" ascii //weight: 10
        $x_10_6 = "{72351B45-9636-4F99-820B-7C552D27897D}" wide //weight: 10
    condition:
        (filesize < 20MB) and
        (
            ((3 of ($x_10_*) and 1 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule Bawswerps_0
{
    meta:
        author = "defender2yara"
        detection_name = "Bawswerps"
        threat_id = "213074"
        severity = "Low"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "$a4a3ad39-84f0-4398-80bb-02ac2ea626ee" ascii //weight: 1
        $x_1_2 = "BrowserPlayer.Browser.resources" ascii //weight: 1
        $x_1_3 = "BrowserPlayer.MainClass.resources" ascii //weight: 1
        $x_1_4 = "BrowserPlayer.Properties.Resources.resources" ascii //weight: 1
        $x_1_5 = "BrowserWeb" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Peapoon_0
{
    meta:
        author = "defender2yara"
        detection_name = "Peapoon"
        threat_id = "213663"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "e:\\updatecheck\\UpdateCheck\\release\\UpdateCheck.pdb" ascii //weight: 1
        $x_1_2 = "//%s/install?uid=%s&aid=%d&z=%d&success=1&fwrite=1" ascii //weight: 1
        $x_1_3 = "//%s/update?a=%s&b=%d&z=%d&v=%d" ascii //weight: 1
        $x_1_4 = "upd.6vm94.com" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (3 of ($x*))
}

rule Peapoon_1
{
    meta:
        author = "defender2yara"
        detection_name = "Peapoon"
        threat_id = "213663"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "3"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {6a 02 6a 00 6a 01 6a 00 6a 04 8d 8d ?? ?? ff ff 56 c7 85 ?? ?? ff ff ?? ?? ?? ?? 89 8d ?? ?? ff ff ff d7 56 ff 15 ?? ?? ?? ?? 8d b5 ?? ?? ff ff e8}  //weight: 1, accuracy: Low
        $x_1_2 = {43 00 6f 00 75 00 70 00 6f 00 6f 00 6e 00 53 00 65 00 72 00 76 00 69 00 63 00 65 00 00 00}  //weight: 1, accuracy: High
        $x_1_3 = {3c 73 2a 3f 68 65 61 64 2e 2a 3f 3e 00}  //weight: 1, accuracy: High
        $x_1_4 = {43 00 6f 00 75 00 70 00 6f 00 6f 00 6e 00 53 00 65 00 72 00 76 00 69 00 63 00 65 00 36 00 34 00 00 00}  //weight: 1, accuracy: High
        $x_1_5 = {6e 65 74 66 69 6c 74 65 72 36 34 00}  //weight: 1, accuracy: High
        $x_1_6 = "http://i.compucrush.com/i.php" ascii //weight: 1
        $x_1_7 = {5c 6e 66 72 65 67 64 72 76 2e 65 78 65 20 6e 65 74 66 69 6c 74 65 72 36 34 00}  //weight: 1, accuracy: High
        $x_1_8 = "Software\\coupoon\\coupoon" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (3 of ($x*))
}

rule Putalol_0
{
    meta:
        author = "defender2yara"
        detection_name = "Putalol"
        threat_id = "221945"
        severity = "17"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "3"
        strings_accuracy = "Low"
    strings:
        $x_2_1 = {8a 04 30 8b 4d ?? 32 04 0f 8d 4d ?? 0f b6 c0 50 6a 01 e8}  //weight: 2, accuracy: Low
        $x_1_2 = {49 00 6e 00 73 00 74 00 61 00 6c 00 6c 00 5f 00 44 00 69 00 72 00 00 00}  //weight: 1, accuracy: High
        $x_2_3 = {8a 04 08 8d 4d ?? 32 04 1e 0f b6 c0 50 6a 01 e8 05 00 8b c7 8b 4d}  //weight: 2, accuracy: Low
        $x_1_4 = {53 4f 46 54 57 41 52 45 5c 46 6c 61 73 68 62 65 61 74 00}  //weight: 1, accuracy: High
        $x_1_5 = {53 4f 46 54 57 41 52 45 5c 4c 6f 6c 6c 69 53 63 61 6e 00}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (
            ((3 of ($x_1_*))) or
            ((1 of ($x_2_*) and 1 of ($x_1_*))) or
            ((2 of ($x_2_*))) or
            (all of ($x*))
        )
}

rule Putalol_1
{
    meta:
        author = "defender2yara"
        detection_name = "Putalol"
        threat_id = "221945"
        severity = "17"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "3"
        strings_accuracy = "Low"
    strings:
        $x_2_1 = {49 83 fb 10 48 0f 43 c3 42 0f b6 14 10 4c 8d 45 ?? 4c 0f 43 c3 ?? 0f b6 ce 41 f6 d1 0f b6 ca f6 d1 ?? 22 ce 41 0f b6 c1 22 c2 0a c8 43 88 0c 10}  //weight: 2, accuracy: Low
        $x_2_2 = {49 83 f9 10 49 0f 43 c3 41 0f b6 14 02 4c 8d 45 ?? 4d 0f 43 c3 0f b6 ca f6 d1 41 22 ce 41 0f b6 c6 f6 d0 22 c2 0a c8 43 88 0c 10}  //weight: 2, accuracy: Low
        $x_1_3 = {44 8d 40 39 48 8d 15 ?? ?? ?? ?? 48 8d 4c 24 ?? e8 ?? ?? ?? ?? 48 8b d8 03 00 41 b1}  //weight: 1, accuracy: Low
        $x_1_4 = {48 8b d8 41 b1 ?? 41 b8 ?? 00 00 00 48 8d 15 ?? ?? ?? ?? 48 8d 4d ?? e8 19 00 41 b1 ?? 41 b8 ?? 00 00 00 48 8d 15 ?? ?? ?? ?? 48 8d 4d ?? e8}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_2_*) and 1 of ($x_1_*))) or
            ((2 of ($x_2_*))) or
            (all of ($x*))
        )
}

rule Putalol_2
{
    meta:
        author = "defender2yara"
        detection_name = "Putalol"
        threat_id = "221945"
        severity = "17"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "3"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {2f 00 67 00 65 00 74 00 5f 00 63 00 6f 00 6e 00 66 00 69 00 67 00 2f 00 00 00}  //weight: 1, accuracy: High
        $x_1_2 = {2f 00 67 00 65 00 74 00 5f 00 75 00 70 00 64 00 61 00 74 00 65 00 2f 00 00 00}  //weight: 1, accuracy: High
        $x_1_3 = {7b 00 33 00 42 00 44 00 46 00 44 00 31 00 44 00 37 00 2d 00 37 00 41 00 39 00 42 00 2d 00 34 00 44 00 32 00 39 00 2d 00 38 00 30 00 42 00 33 00 2d 00 44 00 30 00 30 00 45 00 36 00 36 00 45 00 36 00 32 00 38 00 38 00 35 00 7d 00 00 00}  //weight: 1, accuracy: High
        $x_2_4 = {5c 00 5f 00 57 00 50 00 5f 00 49 00 4e 00 53 00 54 00 41 00 4c 00 4c 00 45 00 52 00 5f 00 4d 00 55 00 54 00 45 00 58 00 00 00}  //weight: 2, accuracy: High
        $x_1_5 = {4c 00 6f 00 6c 00 6c 00 69 00 53 00 63 00 61 00 6e 00 33 00 32 00 2e 00 64 00 6c 00 6c 00 00 00}  //weight: 1, accuracy: High
        $x_2_6 = {8a 14 78 8b 45 0c 8a ca 8a d8 f6 d1 22 c8 f6 d3 8a c3 22 c2 0a c8 0f b6 c1 66 89 04 7e}  //weight: 2, accuracy: High
        $x_2_7 = {8b 75 08 85 c9 75 ?? 68 ?? 00 00 00 6a 0c 8d 45 ?? 68 ?? ?? ?? ?? 50 e8 ?? ?? ?? ?? 83 c4 10 83 65 ?? 00 83 78 14 10 72 02 8b 00 50 e8}  //weight: 2, accuracy: Low
        $x_1_8 = {53 4f 46 54 57 41 52 45 5c 46 6c 61 73 68 62 65 61 74 00}  //weight: 1, accuracy: High
        $x_1_9 = {2d 45 58 54 49 44 3d 00}  //weight: 1, accuracy: High
        $x_1_10 = {5c 6b 65 79 2e 64 61 74 00}  //weight: 1, accuracy: High
        $x_1_11 = {53 4f 46 54 57 41 52 45 5c 4c 6f 6c 6c 69 53 63 61 6e 00}  //weight: 1, accuracy: High
        $x_2_12 = {8a 04 50 32 c3 0f b6 c0 66 89 04 51 8d 45 ?? 8b 75 ?? 83 fe 08 8b 7d ?? 0f 43 c7 32 1c 50 42 3b 55 ?? 72 cd}  //weight: 2, accuracy: Low
        $x_1_13 = "-delete -update" wide //weight: 1
        $x_1_14 = {8a 5d 14 8a cc f6 d3 f6 d1 22 4d 14 8a c3 22 c4 0a c8 88 0c 17 8b 7e 14 83 ff 10 72 04 8b 06 eb 02 8b c6 8a 0c 10 8a d1 22 d9 f6 d2 22 55 14 0a d3 88 55 14 8b 55 f0 42 89 55 f0 3b 56 10 72}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (
            ((3 of ($x_1_*))) or
            ((1 of ($x_2_*) and 1 of ($x_1_*))) or
            ((2 of ($x_2_*))) or
            (all of ($x*))
        )
}

rule Sogou_0
{
    meta:
        author = "defender2yara"
        detection_name = "Sogou"
        threat_id = "222541"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "PushWare\\cpush.dll" ascii //weight: 1
        $x_1_2 = "{11F09AFE-75AD-4E52-AB43-E09E9351CE17}" ascii //weight: 1
        $x_1_3 = "Software\\cpush\\update" ascii //weight: 1
        $x_1_4 = "push.vocloo.com" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (3 of ($x*))
}

rule Loones_0
{
    meta:
        author = "defender2yara"
        detection_name = "Loones"
        threat_id = "222643"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {4c 00 6f 00 6f 00 6e 00 73 00 ?? ?? 68 00 74 00 74 00 70 00 3a 00 2f 00 2f 00 [0-64] 2e 00 63 00 6f 00 6d 00 2f 00 73 00 65 00 74 00 74 00 69 00 6e 00 67 00 73 00 2e 00}  //weight: 1, accuracy: Low
        $x_1_2 = {53 00 6f 00 66 00 74 00 77 00 61 00 72 00 65 00 5c 00 4c 00 6f 00 6f 00 6e 00 73 00 5c 00 43 00 61 00 6d 00 70 00 61 00 69 00 67 00 6e 00 73 00 ?? ?? ?? ?? 64 00 61 00 69 00 6c 00 79 00 5f 00 63 00 6e 00 74 00 ?? ?? 63 00 61 00 6d 00 70 00 61 00 69 00 67 00 6e 00 5f 00 69 00 64 00}  //weight: 1, accuracy: Low
        $x_1_3 = {64 00 69 00 73 00 70 00 6c 00 61 00 79 00 5f 00 69 00 6e 00 74 00 65 00 72 00 76 00 61 00 6c 00 ?? ?? 64 00 61 00 69 00 6c 00 79 00 5f 00 64 00 69 00 73 00 70 00 6c 00 61 00 79 00 5f 00 63 00 61 00 70 00}  //weight: 1, accuracy: Low
        $x_1_4 = {55 00 6e 00 72 00 65 00 67 00 53 00 65 00 72 00 76 00 65 00 72 00 50 00 65 00 72 00 55 00 73 00 65 00 72 00 00 00 00 00 52 00 65 00 67 00 53 00 65 00 72 00 76 00 65 00 72 00 50 00 65 00 72 00 55 00 73 00 65 00 72 00}  //weight: 1, accuracy: High
        $x_1_5 = {5c 69 6d 65 64 69 61 5c 63 70 70 [0-32] 5c 52 65 6c 65 61 73 65 5c 4c 6f 6f 6e 73}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Bayads_0
{
    meta:
        author = "defender2yara"
        detection_name = "Bayads"
        threat_id = "222698"
        severity = "6"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "3"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = ".srf?rid=cnpyprcs_${VRSN}_${MMPRDCT}_$FRSTAV$_$CNPYID$[$RBASE$]&hardId=$HRDID$&tag=$TAG" ascii //weight: 1
        $x_1_2 = "_noav_3firtstInit" wide //weight: 1
        $x_1_3 = {8d 50 d8 80 fa 56 77 1a 0f be c0 83 e8 28 78 ?? 8b 15 ?? ?? ?? ?? 8b 12 3b 42 f4 7f ?? 8a 04 02 eb 09 3c 25 75 05 a0 ?? ?? ?? ?? 88 01 43 41 3b de 72}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Bayads_1
{
    meta:
        author = "defender2yara"
        detection_name = "Bayads"
        threat_id = "222698"
        severity = "6"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "3"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = "prdct=${mmprdct}&tlbrId=base&aflt=${afltId}&instlDate=${instlDay}&vrsn=${vrsn}&instlRef=${instlRef}" ascii //weight: 1
        $x_1_2 = {73 00 65 00 72 00 76 00 69 00 63 00 65 00 73 00 2e 00 6d 00 6f 00 6e 00 74 00 69 00 65 00 72 00 61 00 2e 00 63 00 6f 00 6d 00 2f 00 72 00 65 00 70 00 6f 00 72 00 74 00 73 00 2f 00 6a 00 73 00 43 00 6e 00 74 00 2e 00 73 00 72 00 66 00 3f 00 72 00 69 00 64 00 3d 00 63 00 72 00 61 00 73 00 68 00 5f 00 63 00 6e 00 70 00 79 00 5f 00 25 00 73 00 5f 00 25 00 78 00 5f 00 25 00 78 00 [0-2] 25 00 73 00 5d 00 26 00 68 00 61 00 72 00 64 00 49 00 64 00 3d 00 25 00 73 00}  //weight: 1, accuracy: Low
        $x_1_3 = {63 72 72 55 6e 69 73 6e 74 6c 44 73 70 6c 79 3d [0-16] 63 72 72 44 73 70 6c 79 3d [0-15] 70 72 64 63 74 55 6e 69 6e 73 74 3d [0-15] 61 70 70 73 3d}  //weight: 1, accuracy: Low
        $n_10_4 = {73 6d 70 6c 47 72 70 3d [0-16] 69 6e 73 74 6c 52 65 66 [0-128] 6c 61 62 65 6c 3d}  //weight: -10, accuracy: Low
        $n_10_5 = {5b 6d 61 69 6e 5d 0d 0a 65 70 3d [0-16] 65 70 49 44 3d ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? [0-128] 73 6d 70 6c 47 72 70 3d [0-16] 69 6e 73 74 6c 52 65 66}  //weight: -10, accuracy: Low
        $n_10_6 = "4061947F-F54F-4912-922C-1624FEB8746F" ascii //weight: -10
    condition:
        (filesize < 20MB) and
        (not (any of ($n*))) and
        (all of ($x*))
}

rule HostSecure_0
{
    meta:
        author = "defender2yara"
        detection_name = "HostSecure"
        threat_id = "223145"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "2B0183D6-3C22-4F0B-F62F-58AF52F66606" wide //weight: 1
        $x_1_2 = "hostsecureplugin.com" ascii //weight: 1
        $x_1_3 = "--enable-easy-off-store-extension-install --load-extension" wide //weight: 1
        $x_1_4 = "schtasks /create /tn \"SecureHost\" /tr" wide //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Gomsek_0
{
    meta:
        author = "defender2yara"
        detection_name = "Gomsek"
        threat_id = "223701"
        severity = "7"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "SOFTWARE\\GOMSEK.COM\\" ascii //weight: 2
        $x_1_2 = "CDirectKeywordApp::UpdateThread() error" ascii //weight: 1
        $x_1_3 = "%s?companyID=%s&mac=%s&ver=%d&ProgID=%s" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Chekua_0
{
    meta:
        author = "defender2yara"
        detection_name = "Chekua"
        threat_id = "224736"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "6"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {5c 64 72 65 61 6d 5c 77 69 6e 7a 79 2e 6c 6f 67 00 51 51 50 43 54 72 61 79 2e 65 78 65 00 6b 78 65 74 72 61 79 2e 65 78 65}  //weight: 1, accuracy: High
        $x_1_2 = ".cnzz.com/stat.htm?id=" ascii //weight: 1
        $x_1_3 = {2f 66 73 69 6e 74 66 2f [0-48] 3f 70 75 62 6c 69 63 26 63 6f 64 65 3d}  //weight: 1, accuracy: Low
        $x_1_4 = "\\HomeSafe\" /v \"StartFlagNoTip\"" ascii //weight: 1
        $x_1_5 = "<BrowserItem Process=\"iexplore.exe\"" ascii //weight: 1
        $x_1_6 = "\\HomeSafe\\start_config.xml" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule AVDown_0
{
    meta:
        author = "defender2yara"
        detection_name = "AVDown"
        threat_id = "225221"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "B326963E-3A46-45A8-8035-75C1FF66B0F4" ascii //weight: 1
        $x_1_2 = "68DE54BD-49C8-4982-BF5E-895C3124931A" ascii //weight: 1
        $x_1_3 = "Browser Helper Objects" ascii //weight: 1
        $x_1_4 = "Audio and video downloads" wide //weight: 1
        $x_1_5 = "Downloader.dll" wide //weight: 1
        $x_1_6 = "NoRemove 'Ext'" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (5 of ($x*))
}

rule MailSmtp__MailSmtp_0
{
    meta:
        author = "defender2yara"
        detection_name = "MailSmtp!!MailSmtp"
        threat_id = "236866"
        severity = "Mid"
        signature_type = "SIGNATURE_TYPE_ARHSTR_EXT"
        threshold = "35"
        strings_accuracy = "High"
    strings:
        $x_5_1 = "HELO" ascii //weight: 5
        $x_5_2 = "EHLO" ascii //weight: 5
        $x_5_3 = "250 OK" ascii //weight: 5
        $x_10_4 = {44 41 54 41 0d 0a}  //weight: 10, accuracy: High
        $x_10_5 = "RCPT TO:<" ascii //weight: 10
        $x_10_6 = "MAIL FROM:<" ascii //weight: 10
    condition:
        (filesize < 20MB) and
        (
            ((2 of ($x_10_*) and 3 of ($x_5_*))) or
            ((3 of ($x_10_*) and 1 of ($x_5_*))) or
            (all of ($x*))
        )
}

rule SquareNet_I_0
{
    meta:
        author = "defender2yara"
        detection_name = "SquareNet.I"
        threat_id = "244067"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "2"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "ldtmp.dat" wide //weight: 1
        $x_1_2 = "download.dat" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule SquareNet_J_0
{
    meta:
        author = "defender2yara"
        detection_name = "SquareNet.J"
        threat_id = "244070"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "2"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "/c start \"\" \"%s\" %s" ascii //weight: 1
        $x_1_2 = "F:\\downloader\\download_mgr\\Release\\shell.pdb" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule SquareNet_K_0
{
    meta:
        author = "defender2yara"
        detection_name = "SquareNet.K"
        threat_id = "244071"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "\\Registry\\Machine\\System\\CurrentControlSet\\services\\udiskMgr" wide //weight: 1
        $x_1_2 = "\\DosDevices\\DrvProtect" wide //weight: 1
        $x_1_3 = "\\Registry\\Machine\\System\\CurrentControlSet\\services\\msidntfs" wide //weight: 1
        $x_1_4 = "\\SPYHUNTER4.EXE" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Aplugger_A_0
{
    meta:
        author = "defender2yara"
        detection_name = "Aplugger.A"
        threat_id = "244582"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "32.exe" wide //weight: 1
        $x_1_2 = "2USER32.DLL" wide //weight: 1
        $x_1_3 = "stdole2.tlbWWW" ascii //weight: 1
        $x_1_4 = "YfindChildNameWWW" ascii //weight: 1
        $x_1_5 = "bszObjectNameWWWd" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Cjishu_0
{
    meta:
        author = "defender2yara"
        detection_name = "Cjishu"
        threat_id = "245039"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "api.lmifeng.com" ascii //weight: 1
        $x_1_2 = "Software\\iPdfReader" ascii //weight: 1
        $x_1_3 = "Software\\iHuYa" ascii //weight: 1
        $x_1_4 = "aiyasuo.cn" ascii //weight: 1
        $x_1_5 = "show.g.mediav.com" ascii //weight: 1
        $x_1_6 = "PeekMessageW" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (4 of ($x*))
}

rule Cjishu_1
{
    meta:
        author = "defender2yara"
        detection_name = "Cjishu"
        threat_id = "245039"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "ipdfread.exe" ascii //weight: 1
        $x_1_2 = "ipdfreadertools" ascii //weight: 1
        $x_1_3 = "mini.lmifeng.com" ascii //weight: 1
        $x_1_4 = "ipdfreadertoolsApp" ascii //weight: 1
        $x_1_5 = "Software\\iPdfReader\\" ascii //weight: 1
        $n_100_6 = "Uninst.exe" ascii //weight: -100
        $n_100_7 = "Uninstaller.exe" ascii //weight: -100
        $n_100_8 = "Uninstal.exe" ascii //weight: -100
    condition:
        (filesize < 20MB) and
        (not (any of ($n*))) and
        (all of ($x*))
}

rule Asedlgat_0
{
    meta:
        author = "defender2yara"
        detection_name = "Asedlgat"
        threat_id = "245579"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "4@LFX2" ascii //weight: 1
        $x_1_2 = "4@LFX2S9" ascii //weight: 1
        $x_1_3 = "RevivalMF.New.xls" ascii //weight: 1
        $x_1_4 = {3a 5c 55 73 65 72 73 5c 57 69 7a 7a 6c 61 62 73 5c 50 69 63 74 75 72 65 73 5c 53 61 76 65 64 20 50 69 63 74 75 72 65 73 5c 54 72 69 63 6b 54 72 69 63 6b 5c 53 68 6f 77 4c 6f 76 65 5c 6f 62 6a 5c 52 65 6c 65 61 73 65 5c 52 65 76 69 76 61 6c 4d 46 2e 70 64 62 00}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule CsdiMonetize_A_0
{
    meta:
        author = "defender2yara"
        detection_name = "CsdiMonetize.A"
        threat_id = "245851"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "sales_campaign_target_id" ascii //weight: 1
        $x_1_2 = "user_show_capping" ascii //weight: 1
        $x_1_3 = "SanOo.Properties" ascii //weight: 1
        $x_1_4 = "SanOo.exe" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule CsdiMonetize_A_1
{
    meta:
        author = "defender2yara"
        detection_name = "CsdiMonetize.A"
        threat_id = "245851"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "PublicKeyToken=3e56350693f7355e" wide //weight: 1
        $x_1_2 = "http://james.newtonking.com/projects/json" wide //weight: 1
        $x_1_3 = "{71461f04-2faa-4bb9-a0dd-28a79101b599}" wide //weight: 1
        $x_1_4 = "$ea78aeb4-8a56-4276-81da-98d5cc27a5c4" ascii //weight: 1
        $x_1_5 = "sales_campaign_target_id" ascii //weight: 1
        $x_1_6 = "CinemaSins.Properties" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Ndmser_A_0
{
    meta:
        author = "defender2yara"
        detection_name = "Ndmser.A"
        threat_id = "246092"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "http://nthnuest.com:40000/tickets" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule OxyPump_0
{
    meta:
        author = "defender2yara"
        detection_name = "OxyPump"
        threat_id = "246159"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "<>onmmno>/CdmaamdC<" wide //weight: 1
        $x_1_2 = "SnFRWnRi\\riVrnsrfu\\\\iwdOuT\\AoEsMectoeortCWsno" wide //weight: 1
        $x_1_3 = "<>sIredU<UderIs>/" wide //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Cjishu_A_0
{
    meta:
        author = "defender2yara"
        detection_name = "Cjishu.A"
        threat_id = "246348"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "2"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "http://lh.cjishu.com/index.php" wide //weight: 1
        $x_1_2 = "C:\\MyLog\\SvrDebugLog.log" wide //weight: 1
        $x_1_3 = "http://calendar.cjishu.com/index.php" wide //weight: 1
        $x_1_4 = "EncryDataSvc.exe" wide //weight: 1
    condition:
        (filesize < 20MB) and
        (2 of ($x*))
}

rule Hebogo_B_0
{
    meta:
        author = "defender2yara"
        detection_name = "Hebogo.B"
        threat_id = "246350"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "/Config/DreamConf/ServerList.asp" wide //weight: 1
        $x_1_2 = "/Config/DreamConf/DownloadConf.asp" wide //weight: 1
        $x_1_3 = "http://korserver.com" wide //weight: 1
        $x_1_4 = "http://domainserver.co.kr" wide //weight: 1
        $x_1_5 = "http://hostserver.kr" wide //weight: 1
        $x_1_6 = "http://makevalue.com" wide //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Neoreklami_A_0
{
    meta:
        author = "defender2yara"
        detection_name = "Neoreklami.A"
        threat_id = "248300"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {8b 45 f0 8b 45 e0 8b 45 f8 8b 45 f8 8b 45 f8 8b 45 dc 8b 45 f4 89 5e 08 8b 4c 85 e8 8b 45 f4 89 4c 85 e8 33 c0 81 f9 a2 79 00 00 0f 9e c0 33 c9 85 c0 0f 9e c1 33 d2 81 f9 13 c0 00 00 89 4d d8 8b 45 f8 0f 94 c2 33 c9 3b d0 0f 9e c1 89 4d f8 89 5d f8}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule OpenSUpdater_0
{
    meta:
        author = "defender2yara"
        detection_name = "OpenSUpdater"
        threat_id = "249604"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "update.updater.one/installers/OU_Updater.exe" ascii //weight: 1
        $x_1_2 = "update.updater.one/update.php" ascii //weight: 1
        $x_1_3 = "d:\\Code\\OneUpdater\\Source\\OneUpdater\\obj\\Release\\OneUpdater.pdb" ascii //weight: 1
        $x_1_4 = "ACTIVATE" ascii //weight: 1
        $x_1_5 = "ou-version.php" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Ksdler_SA_0
{
    meta:
        author = "defender2yara"
        detection_name = "Ksdler.SA"
        threat_id = "250071"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Frm_KsDlerSplash" ascii //weight: 1
        $x_1_2 = "WebBrowser_byWANGRUI" ascii //weight: 1
        $x_1_3 = "PIniAdsManager" ascii //weight: 1
        $x_1_4 = "barclient.dll" wide //weight: 1
        $x_1_5 = "wyptk.com/xzq/" wide //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule OxyPump_SB_0
{
    meta:
        author = "defender2yara"
        detection_name = "OxyPump.SB"
        threat_id = "251080"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "66533DF7-E752-427C-84AB-C8548FDE6A3D" wide //weight: 1
        $x_1_2 = "SELECT * FROM AntiVirusProduct" wide //weight: 1
        $x_1_3 = "OneSystemCareK" wide //weight: 1
        $x_1_4 = "/pushbot.exe" wide //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule LightSee_SA_0
{
    meta:
        author = "defender2yara"
        detection_name = "LightSee.SA"
        threat_id = "251749"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "HKEY_CURRENT_USER\\software\\minisite" wide //weight: 1
        $x_1_2 = "{B3635496-1D9E-4b21-8D56-04CAAD0064CB}" wide //weight: 1
        $x_1_3 = "http://ic.mousebaby.cn/" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Tracker_A_0
{
    meta:
        author = "defender2yara"
        detection_name = "Tracker.A"
        threat_id = "252189"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "buying_track_id" ascii //weight: 1
        $x_1_2 = "sales_track_id" ascii //weight: 1
        $x_1_3 = "sales_campaign_target_id" ascii //weight: 1
        $x_1_4 = "AnalysisData.exe" wide //weight: 1
        $x_1_5 = "aspnet_wp.exe" wide //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Qjwmonkey_Z_0
{
    meta:
        author = "defender2yara"
        detection_name = "Qjwmonkey.Z"
        threat_id = "257070"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Output\\Release\\BZDownload.pdb" ascii //weight: 1
        $x_1_2 = "qqpctray.exe" wide //weight: 1
        $x_1_3 = "http://cdn.zry97.com" wide //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule OxyPumper_SB_0
{
    meta:
        author = "defender2yara"
        detection_name = "OxyPumper.SB"
        threat_id = "257788"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_4_1 = "SELECT * FROM AntiVirusProduct" wide //weight: 4
        $x_1_2 = "http://www.ewrtw.pw/c/niubilityc.exe" wide //weight: 1
        $x_1_3 = "http://www.rtuhrt.pw/a/wmydybda.exe" wide //weight: 1
        $x_1_4 = " http://exe-1.icu/install2.exe" wide //weight: 1
        $x_1_5 = "Gkjfdshfkjjd: dsdjdsjdhv" wide //weight: 1
        $x_1_6 = "Khsopeyrkdmva: hoemckleka" wide //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((5 of ($x_1_*))) or
            ((1 of ($x_4_*) and 1 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule Keylogger_G_MTB_0
{
    meta:
        author = "defender2yara"
        detection_name = "Keylogger.G!MTB"
        threat_id = "259269"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "\\UltraNic\\UltraNic\\" ascii //weight: 1
        $x_1_2 = "/log.txt" ascii //weight: 1
        $x_1_3 = "get_Password" ascii //weight: 1
        $x_1_4 = "<SHIFT>" ascii //weight: 1
        $x_1_5 = "<CTRL>" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Cutoart_A_MSR_0
{
    meta:
        author = "defender2yara"
        detection_name = "Cutoart.A!MSR"
        threat_id = "259681"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "2"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "http://union.hao3603.com/api/down" ascii //weight: 1
        $x_1_2 = "MTIzNDU2Nzg5MTIzNDU2Nzg5MTIzNDU2" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Adposhel_S_MTB_0
{
    meta:
        author = "defender2yara"
        detection_name = "Adposhel.S!MTB"
        threat_id = "260297"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Jetmedia\\NativeDesktopMediaService" wide //weight: 1
        $x_1_2 = "{711E0759-3245-49C6-A4D0-B5EE99B2ECA2}" wide //weight: 1
        $x_1_3 = "Software\\Caphyon\\Advanced Installer\\" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Adpeak_S_MTB_0
{
    meta:
        author = "defender2yara"
        detection_name = "Adpeak.S!MTB"
        threat_id = "260723"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "CLSID\\{10AD2C61-0898-4348-8600-14A342F22AC3}" ascii //weight: 1
        $x_1_2 = "d.khb09w.com/xuiow" ascii //weight: 1
        $x_1_3 = "Software\\AppDataLow\\Software\\ScorpionSaver" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Gator_GJ_ibt_0
{
    meta:
        author = "defender2yara"
        detection_name = "Gator.GJ!ibt"
        threat_id = "260897"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "trickle.gator.bla" ascii //weight: 1
        $x_1_2 = "QwertyuiInf" ascii //weight: 1
        $x_1_3 = "SilentSetup completes" ascii //weight: 1
        $x_1_4 = "TricklerRunningMutex" ascii //weight: 1
        $x_1_5 = "gator.com" ascii //weight: 1
        $x_1_6 = "IEGator.inf" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Keylogger_GB_MTB_0
{
    meta:
        author = "defender2yara"
        detection_name = "Keylogger.GB!MTB"
        threat_id = "261488"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "43"
        strings_accuracy = "Low"
    strings:
        $x_10_1 = {63 00 6d 00 64 00 2e 00 65 00 78 00 65 00 20 00 2f 00 63 00 20 00 70 00 69 00 6e 00 67 00 20 00 30 00 20 00 2d 00 6e 00 20 00 [0-4] 20 00 26 00 20 00 64 00 65 00 6c 00}  //weight: 10, accuracy: Low
        $x_10_2 = {63 6d 64 2e 65 78 65 20 2f 63 20 70 69 6e 67 20 30 20 2d 6e 20 [0-4] 20 26 20 64 65 6c}  //weight: 10, accuracy: Low
        $x_10_3 = "netsh firewall add allowedprogram" ascii //weight: 10
        $x_10_4 = "FromBase64String" ascii //weight: 10
        $x_10_5 = "SEE_MASK_NOZONECHECKS" ascii //weight: 10
        $x_1_6 = "netsh firewall delete allowedprogram" ascii //weight: 1
        $x_1_7 = "Software\\Microsoft\\Windows\\CurrentVersion\\Run" ascii //weight: 1
        $x_1_8 = "127.0.0.1" ascii //weight: 1
        $x_1_9 = "[ENTER]" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((4 of ($x_10_*) and 3 of ($x_1_*))) or
            ((5 of ($x_10_*))) or
            (all of ($x*))
        )
}

rule Qjwmonkey_A_MSR_0
{
    meta:
        author = "defender2yara"
        detection_name = "Qjwmonkey.A!MSR"
        threat_id = "261584"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "8"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "DownLoadFrame_splash" wide //weight: 1
        $x_3_2 = "x.93ne.com" ascii //weight: 3
        $x_1_3 = "zhudongfangyu.exe" wide //weight: 1
        $x_5_4 = "http://cdn.zry97.com/youxi" wide //weight: 5
        $x_1_5 = "http://down.anhuiry.com/" wide //weight: 1
        $x_3_6 = "http://dl.360safe.com/gf/360ini.cab" wide //weight: 3
    condition:
        (filesize < 20MB) and
        (
            ((2 of ($x_3_*) and 2 of ($x_1_*))) or
            ((1 of ($x_5_*) and 3 of ($x_1_*))) or
            ((1 of ($x_5_*) and 1 of ($x_3_*))) or
            (all of ($x*))
        )
}

rule Kavconn_RR_MTB_0
{
    meta:
        author = "defender2yara"
        detection_name = "Kavconn.RR!MTB"
        threat_id = "264829"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "2"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {b9 c4 9c 61 00 c7 05 ?? ?? ?? ?? 40 00 00 00 8b 39 83 c1 04 33 c7 81 f9 c4 9d 61 00 72 f1}  //weight: 1, accuracy: Low
        $x_1_2 = {68 00 00 00 c0 68 f4 9a 61 00 ff 55}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule KuaiZip_SP_MSR_0
{
    meta:
        author = "defender2yara"
        detection_name = "KuaiZip.SP!MSR"
        threat_id = "265548"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "guanwang_001" ascii //weight: 1
        $x_1_2 = "xiaoyu.exe" ascii //weight: 1
        $x_1_3 = "XY7zData.7z" ascii //weight: 1
        $x_1_4 = "SELECT * FROM Win32_BIOS" wide //weight: 1
        $x_1_5 = "xiaoyu_Install_FendyC_" wide //weight: 1
    condition:
        (filesize < 20MB) and
        (4 of ($x*))
}

rule BestOffers_K_MSR_0
{
    meta:
        author = "defender2yara"
        detection_name = "BestOffers.K!MSR"
        threat_id = "269557"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "thebestoffersin" ascii //weight: 1
        $x_1_2 = "SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run" ascii //weight: 1
        $x_1_3 = "/VERYSILENT" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule InstallUnion_I_MTB_0
{
    meta:
        author = "defender2yara"
        detection_name = "InstallUnion.I!MTB"
        threat_id = "270205"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "PremierOpinion" wide //weight: 1
        $x_1_2 = "PI1032/ContentI3.exe" wide //weight: 1
        $x_1_3 = "5.8.88.14/downloads/InlogBrowser.exe" wide //weight: 1
        $x_1_4 = "getmytab.net/mytab4.exe" wide //weight: 1
        $x_1_5 = "InstallUnion\\1538" wide //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Linkury_RS_MTB_0
{
    meta:
        author = "defender2yara"
        detection_name = "Linkury.RS!MTB"
        threat_id = "270307"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "7"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "LINKURYINTERNETEXPLORERBHO.DLL" ascii //weight: 1
        $x_1_2 = "C:\\TEMP\\smartbar\\" wide //weight: 1
        $x_1_3 = "Search.linkury.com" wide //weight: 1
        $x_1_4 = "HomePageURLChrome" wide //weight: 1
        $x_1_5 = "NewTabURL" wide //weight: 1
        $x_1_6 = "var redirectUrlNewTab =" wide //weight: 1
        $x_1_7 = "urls_to_restore_on_startup" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Linkury_RS_MTB_1
{
    meta:
        author = "defender2yara"
        detection_name = "Linkury.RS!MTB"
        threat_id = "270307"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Linkury.Resources.ChromeNewTab.BlackListManager::BlackListManager:True:" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Dotdo_SR_MSR_0
{
    meta:
        author = "defender2yara"
        detection_name = "Dotdo.SR!MSR"
        threat_id = "272122"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {fa 25 33 00 16 00 00 01 00 00 00 11 00 00 00 02 00 00 00 03 00 00 00 02 00 00 00 11 00 00 00 0c 00 00 00 01 00 00 00 01 00 00 00 02 00 00 00}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule HPDefender_KT_0
{
    meta:
        author = "defender2yara"
        detection_name = "HPDefender.KT"
        threat_id = "272912"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "2"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "D:\\projects\\new_Clicker\\SIV\\original\\daemon\\NewClieckerDll\\Release\\SIVUpdate.pdb" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Trickler_A_MTB_0
{
    meta:
        author = "defender2yara"
        detection_name = "Trickler.A!MTB"
        threat_id = "273969"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "2"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {8a 03 32 06 46 4f 75 0a be ?? ?? ?? ?? bf ?? ?? ?? ?? 88 03 83 f9 00 74 04 4b 49 eb e3}  //weight: 1, accuracy: Low
        $x_1_2 = "trickle.gator.com" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule CsdiMonetize_KA_0
{
    meta:
        author = "defender2yara"
        detection_name = "CsdiMonetize.KA"
        threat_id = "274486"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "PROZIPPER.pdb" ascii //weight: 2
        $x_1_2 = "PROZIPPER.g.resources" ascii //weight: 1
        $x_1_3 = "iYpx5TZIpxjWDVEIl3.mkR6eNO8f1ug7hnX6l" ascii //weight: 1
        $x_1_4 = "aR3nbf8dQp2feLmk31.lSfgApatkdxsVcGcrktoFd.resources" ascii //weight: 1
        $x_1_5 = "StandAlone_EnkwyHnL6addQSRI.Properties.Resources.resources" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Maldown_A_MTB_0
{
    meta:
        author = "defender2yara"
        detection_name = "Maldown.A!MTB"
        threat_id = "275122"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "2"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "http://zaxarstore2.com/download.php" wide //weight: 1
        $x_1_2 = "http://dreple.com/download.php" wide //weight: 1
        $x_1_3 = "https://salebooks.xyz/app/app.exe" wide //weight: 1
        $x_1_4 = "Software\\Microsoft\\WindowsUpdater\\pushbot" wide //weight: 1
        $x_1_5 = "Software\\pushbot2" wide //weight: 1
        $x_1_6 = "freekzvideo" wide //weight: 1
    condition:
        (filesize < 20MB) and
        (2 of ($x*))
}

rule Matiex_MTB_0
{
    meta:
        author = "defender2yara"
        detection_name = "Matiex!MTB"
        threat_id = "277829"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "--M-A-T-I-E-X--K-E-Y-L-O-G-E-R--" ascii //weight: 1
        $x_1_2 = "VirtualProtect" ascii //weight: 1
        $x_1_3 = "MyComputer" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Clonewbo_0
{
    meta:
        author = "defender2yara"
        detection_name = "Clonewbo"
        threat_id = "280272"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "toastpop.net/SWC" ascii //weight: 1
        $x_1_2 = "toastpop.pdb" ascii //weight: 1
        $x_1_3 = "NewsFeed" ascii //weight: 1
        $x_1_4 = "byboot" ascii //weight: 1
        $x_1_5 = "Window nfc" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (3 of ($x*))
}

rule Kuaiba_RS_MTB_0
{
    meta:
        author = "defender2yara"
        detection_name = "Kuaiba.RS!MTB"
        threat_id = "284882"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "run456.com" ascii //weight: 1
        $x_1_2 = "kuai8.com" ascii //weight: 1
        $x_1_3 = "kuai8_for_installer.exe" ascii //weight: 1
        $x_1_4 = "Gamestart" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Cjishu_RS_MTB_0
{
    meta:
        author = "defender2yara"
        detection_name = "Cjishu.RS!MTB"
        threat_id = "284883"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "cjishu.com" ascii //weight: 1
        $x_1_2 = "softinfo.cn" ascii //weight: 1
        $x_1_3 = "SOFTWARE\\Grabsun" ascii //weight: 1
        $x_1_4 = "Hintsoft1\\XunShanPro" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Swiminen_0
{
    meta:
        author = "defender2yara"
        detection_name = "Swiminen"
        threat_id = "285955"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = "mini,news,fmt,tips,twinkler" wide //weight: 1
        $x_1_2 = {44 3a 5c 78 77 6f 72 6b 5f 76 73 32 30 31 35 5c 52 65 74 65 6e 74 69 6f 6e 53 6f 66 74 77 61 72 65 5c 62 69 6e 5c (53 65 72 76 69 63|(??|?? ??|?? ?? ??|?? ?? ?? ??|?? ?? ?? ?? ??|?? ?? ?? ?? ?? ??|?? ?? ?? ?? ?? ?? ??|?? ?? ?? ?? ?? ?? ?? ??|?? ?? ?? ?? ?? ?? ?? ?? ??|?? ?? ?? ?? ?? ?? ?? ?? ?? ??|?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ??|?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ??|?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ??|?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ??|?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ??) 73) 2e 70 64 62}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (1 of ($x*))
}

rule Swiminen_1
{
    meta:
        author = "defender2yara"
        detection_name = "Swiminen"
        threat_id = "285955"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "2"
        strings_accuracy = "Low"
    strings:
        $x_2_1 = {44 3a 5c 78 77 6f 72 6b 5f 76 73 32 30 31 35 5c 52 65 74 65 6e 74 69 6f 6e 53 6f 66 74 77 61 72 65 5c 62 69 6e 5c 61 64 5f [0-32] 2e 70 64 62}  //weight: 2, accuracy: Low
        $x_1_2 = {64 61 74 61 3d 25 73 00 68 74 74 70 3a 2f 2f 73 6f 66 74 6c 6f 67 2e 74 77 6f 73 68 61 64 6f 77 2e 63 6e 2f 61 70 69 2f 64 61 74 61 2f 73 79 6e 63}  //weight: 1, accuracy: High
        $x_1_3 = {53 00 4f 00 46 00 54 00 57 00 41 00 52 00 45 00 5c 00 4d 00 69 00 63 00 72 00 6f 00 73 00 6f 00 66 00 74 00 5c 00 6a 00 69 00 6e 00 67 00 7a 00 75 00 00 00 53 00 4f 00 46 00 54 00 57 00 41 00 52 00 45 00 5c 00 69 00 43 00 61 00 66 00 65 00 38 00}  //weight: 1, accuracy: High
        $x_1_4 = {25 00 73 00 5c 00 74 00 77 00 69 00 6e 00 6b 00 6c 00 65 00 72 00 2e 00 69 00 63 00 6f 00 00 00 33 00 36 00 30 00 70 00 69 00 64 00}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (
            ((2 of ($x_1_*))) or
            ((1 of ($x_2_*))) or
            (all of ($x*))
        )
}

rule Swiminen_2
{
    meta:
        author = "defender2yara"
        detection_name = "Swiminen"
        threat_id = "285955"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "2"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {6d 00 67 00 72 00 2e 00 65 00 78 00 65 00 00 [0-8] 25 00 73 00 25 00 73 00 00 [0-8] 72 00 65 00 6c 00 61 00 74 00 65 00 66 00 69 00 6c 00 65 00 [0-32] 73 00 76 00 72 00 2e 00 65 00 78 00 65 00 00 [0-8] 2d 00 69 00 6e 00 73 00 74 00 61 00 6c 00 6c 00 00 [0-8] [0-32] 65 00 78 00 74 00 2e 00 64 00 6c 00 6c 00 00 [0-8] 72 00 65 00 67 00 64 00 6c 00 6c 00 3d 00 25 00 73 00 25 00 73 00 00 [0-8] [0-32] 36 00 34 00 2e 00 64 00 6c 00 6c 00}  //weight: 1, accuracy: Low
        $x_1_2 = {53 00 4f 00 46 00 54 00 57 00 41 00 52 00 45 00 5c 00 4d 00 69 00 63 00 72 00 6f 00 73 00 6f 00 66 00 74 00 5c 00 6a 00 69 00 6e 00 67 00 7a 00 75 00 00 00 53 00 4f 00 46 00 54 00 57 00 41 00 52 00 45 00 5c 00 69 00 43 00 61 00 66 00 65 00 38 00}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Swiminen_3
{
    meta:
        author = "defender2yara"
        detection_name = "Swiminen"
        threat_id = "285955"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "Low"
    strings:
        $x_2_1 = {25 73 5c 63 6f 6e 66 69 67 2e 64 6c 6c 00 00 00 74 77 6f 73 68 61 64 6f 77 2e 63 6e 00 00 00 00 5b 64 6f 6d 61 69 6e 6e 61 6d 65 5d}  //weight: 2, accuracy: High
        $x_2_2 = {44 3a 5c 78 77 6f 72 6b 5f 76 73 32 30 31 35 5c 52 65 74 65 6e 74 69 6f 6e 53 6f 66 74 77 61 72 65 5c 62 69 6e 5c [0-16] 6d 67 72 2e 70 64 62}  //weight: 2, accuracy: Low
        $x_1_3 = {3c 00 7b 00 24 00 72 00 61 00 6e 00 64 00 6f 00 6d 00 7d 00 3e 00 00 00 5c 00 5c 00 00 00 00 00 63 00 6d 00 64 00 00 00 7b 00 63 00 6d 00 64 00 7d 00}  //weight: 1, accuracy: High
        $x_1_4 = {53 00 4f 00 46 00 54 00 57 00 41 00 52 00 45 00 5c 00 4d 00 69 00 63 00 72 00 6f 00 73 00 6f 00 66 00 74 00 5c 00 6a 00 69 00 6e 00 67 00 7a 00 75 00 00 00 53 00 4f 00 46 00 54 00 57 00 41 00 52 00 45 00 5c 00 69 00 43 00 61 00 66 00 65 00 38 00}  //weight: 1, accuracy: High
        $x_1_5 = {68 74 74 70 3a 2f 2f 73 6f 66 74 6c 6f 67 2e 5b 64 6f 6d 61 69 6e 6e 61 6d 65 5d 2f 61 70 69 2f 64 61 74 61 2f 73 79 6e 63 00 00 00 5c 6d 61 69 6e 2e 69 6e 69}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_2_*) and 2 of ($x_1_*))) or
            ((2 of ($x_2_*))) or
            (all of ($x*))
        )
}

rule NewTab_A_0
{
    meta:
        author = "defender2yara"
        detection_name = "NewTab.A"
        threat_id = "304139"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_MACHOHSTR_EXT"
        threshold = "11"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = "/usr/bin/ditto" ascii //weight: 1
        $x_3_2 = {43 6f 6e 74 65 6e 74 73 2f 4c 69 62 72 61 72 79 2f 4c 6f 67 69 6e 49 74 65 6d 73 2f [0-64] 2e 61 70 70}  //weight: 3, accuracy: Low
        $x_2_3 = "LSQuarantineDataURLString" ascii //weight: 2
        $x_2_4 = "LSQuarantineEventIdentifier" ascii //weight: 2
        $x_3_5 = "operatingSystemVersion" ascii //weight: 3
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Scenic_0
{
    meta:
        author = "defender2yara"
        detection_name = "Scenic"
        threat_id = "313081"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "2"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "/tell-a-friend.htm" ascii //weight: 1
        $x_1_2 = "d:\\Dev\\outsource\\JoinerEx\\Source\\Starter\\Release\\Starter.pdb" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Trickler_RT_MTB_0
{
    meta:
        author = "defender2yara"
        detection_name = "Trickler.RT!MTB"
        threat_id = "313409"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "24"
        strings_accuracy = "High"
    strings:
        $x_10_1 = {b9 00 08 00 00 8d 54 24 60 2b c8 8b 44 24 5c 52 83 c1 fe 50 51 56}  //weight: 10, accuracy: High
        $x_10_2 = {8d 54 01 01 52 e8 b1 f8 00 00 8b f0 83 c4 04 85 f6 74 6b 55 53 c6 06}  //weight: 10, accuracy: High
        $x_1_3 = "CSpudDelete" ascii //weight: 1
        $x_1_4 = "GetGator" ascii //weight: 1
        $x_1_5 = "trickler.inf" ascii //weight: 1
        $x_1_6 = "software\\Qwertyuio\\Trickler\\Sessions" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Wareda_RS_MTB_0
{
    meta:
        author = "defender2yara"
        detection_name = "Wareda.RS!MTB"
        threat_id = "314165"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "10"
        strings_accuracy = "High"
    strings:
        $x_5_1 = "54.164.144.252:10000" ascii //weight: 5
        $x_1_2 = "getOffers.php" ascii //weight: 1
        $x_1_3 = "run_offer" ascii //weight: 1
        $x_1_4 = "ListOffers.php" ascii //weight: 1
        $x_1_5 = "ModelName" ascii //weight: 1
        $x_1_6 = "PCModel" ascii //weight: 1
        $x_1_7 = "appCalculator" ascii //weight: 1
        $x_1_8 = "appCalendar" ascii //weight: 1
        $x_1_9 = "appChess" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_5_*) and 5 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule Neoreklami_RT_MTB_0
{
    meta:
        author = "defender2yara"
        detection_name = "Neoreklami.RT!MTB"
        threat_id = "315857"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "hzuSGCQpxZlxGREXCQpVFHMOVFPwsMWgOq" ascii //weight: 1
        $x_1_2 = "AVKfavflXTvNhFe@std@@" ascii //weight: 1
        $x_1_3 = "ZphRNLtYBCMrQzcyYewrUNXruGSnIElxzrzLkDejx" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Kraddare_DK_MTB_0
{
    meta:
        author = "defender2yara"
        detection_name = "Kraddare.DK!MTB"
        threat_id = "325849"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "7"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "update.mindtop.kr" ascii //weight: 2
        $x_2_2 = "totallog.co.kr/log/" ascii //weight: 2
        $x_1_3 = "DOWNLOAD LAUNCHER MANAGER" ascii //weight: 1
        $x_1_4 = "CWebBrowser2" ascii //weight: 1
        $x_1_5 = "launc.exe" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Pirrit_B_0
{
    meta:
        author = "defender2yara"
        detection_name = "Pirrit.B"
        threat_id = "326638"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_MACHOHSTR_EXT"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "jsleepForTimeInterval:" ascii //weight: 1
        $x_1_2 = "%j9}oQ" ascii //weight: 1
        $x_1_3 = "M2<Pwc:" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Pirrit_B_1
{
    meta:
        author = "defender2yara"
        detection_name = "Pirrit.B"
        threat_id = "326638"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_MACHOHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "pirrit.com" ascii //weight: 2
        $x_2_2 = "PirritSuggestor" ascii //weight: 2
        $x_1_3 = "t.trkitok.com/track/rep" ascii //weight: 1
        $x_1_4 = "VSearch.framework" ascii //weight: 1
        $x_1_5 = "delta-search.com" ascii //weight: 1
        $x_1_6 = "BrowserEnhancer" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((4 of ($x_1_*))) or
            ((1 of ($x_2_*) and 2 of ($x_1_*))) or
            ((2 of ($x_2_*))) or
            (all of ($x*))
        )
}

rule Pirrit_C_0
{
    meta:
        author = "defender2yara"
        detection_name = "Pirrit.C"
        threat_id = "326639"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_MACHOHSTR_EXT"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {80 35 33 53 02 00 b1 80 35 2d 53 02 00 f7 80 35 27 53 02 00 1b}  //weight: 1, accuracy: High
        $x_1_2 = "=_tW,t5=" ascii //weight: 1
        $x_1_3 = "}m1ej[r" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Pirrit_C_1
{
    meta:
        author = "defender2yara"
        detection_name = "Pirrit.C"
        threat_id = "326639"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_MACHOHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "projects/pirrit/macos/ProxyServer" ascii //weight: 1
        $x_1_2 = "thecloudservices.net" ascii //weight: 1
        $x_1_3 = "rec_script.sh" ascii //weight: 1
        $x_1_4 = "AdsProxyEngine::init()" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Pirrit_D_0
{
    meta:
        author = "defender2yara"
        detection_name = "Pirrit.D"
        threat_id = "326640"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_MACHOHSTR_EXT"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "k6H}Z}N:" ascii //weight: 1
        $x_1_2 = "[7%qskOp" ascii //weight: 1
        $x_1_3 = "3AtZejk" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Pirrit_E_0
{
    meta:
        author = "defender2yara"
        detection_name = "Pirrit.E"
        threat_id = "326641"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_MACHOHSTR_EXT"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "keVoBLnl" ascii //weight: 1
        $x_1_2 = "{Eh.c1d" ascii //weight: 1
        $x_1_3 = "KB5eLT\\T" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Pirrit_F_0
{
    meta:
        author = "defender2yara"
        detection_name = "Pirrit.F"
        threat_id = "326642"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_MACHOHSTR_EXT"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "-ROFkMCM1" ascii //weight: 1
        $x_1_2 = "mK2L2N9" ascii //weight: 1
        $x_1_3 = "C*l0s+=" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Pirrit_G_0
{
    meta:
        author = "defender2yara"
        detection_name = "Pirrit.G"
        threat_id = "326643"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_MACHOHSTR_EXT"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "dR9yjv" ascii //weight: 1
        $x_1_2 = "EIRBRCp" ascii //weight: 1
        $x_1_3 = "7>z4]@" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Ketin_H_0
{
    meta:
        author = "defender2yara"
        detection_name = "Ketin.H"
        threat_id = "327450"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_MACHOHSTR_EXT"
        threshold = "6"
        strings_accuracy = "Low"
    strings:
        $x_2_1 = {02 00 80 74 08 ?? c8 48 ff c8 48 83 f8 ?? 77 f2}  //weight: 2, accuracy: Low
        $x_1_2 = "URLForApplicationToOpenURL" ascii //weight: 1
        $x_1_3 = "willPerformHTTPRedirection" ascii //weight: 1
        $x_2_4 = {48 8d 4d c8 48 89 4c 24 28 31 c9 48 89 4c 24 10 48 89 4c 24 08 48 89 04 24 c7 44 24 20 02 00 00 00 c7 44 24 18 00 00 00 00 bf 01 00 00 00 be 04 00 00 00 31 d2 b9 01 00 00 00 4d 89 ?? 49 89 d9 e8}  //weight: 2, accuracy: Low
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule InstallUnion_AB_MTB_0
{
    meta:
        author = "defender2yara"
        detection_name = "InstallUnion.AB!MTB"
        threat_id = "332623"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Software\\Google\\Chrome\\Extensions\\gnplhahbcoldbildffdchneaepapccbn" ascii //weight: 1
        $x_1_2 = "GenericSetup.exe" ascii //weight: 1
        $x_1_3 = "installOffer" ascii //weight: 1
        $x_1_4 = "!nbsp_injection" ascii //weight: 1
        $x_1_5 = "/callback/geo/geo.php" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Synataeb_A_MTB_0
{
    meta:
        author = "defender2yara"
        detection_name = "Synataeb.A!MTB"
        threat_id = "341222"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_MACHOHSTR_EXT"
        threshold = "2"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {4c 8b 7d c8 48 09 01 48 8b 5d c0 48 8b 43 30 4c 89 e9 48 c1 e1 04 4c 89 34 08 4c 89 64 08 08 49 c1 e5 05 4c 03 6b 38 4c 8d b5 50 ff ff ff 4c 89 f7 4c 89 ee e8 b5 00 00 00 4c 89 f7}  //weight: 1, accuracy: High
        $x_1_2 = {49 89 df e8 b7 0a 00 00 49 89 c5 8a 4b 20 48 c7 c3 ff ff ff ff 48 d3 e3 48 f7 d3 49 21 dd 4c 89 ea 48 c1 ea 06 49 8b 74 d7 40 b8 01 00 00 00 44 89 e9 48 d3 e0}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Pirrit_A_MTB_0
{
    meta:
        author = "defender2yara"
        detection_name = "Pirrit.A!MTB"
        threat_id = "341223"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_MACHOHSTR_EXT"
        threshold = "2"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {66 ef 97 ac 2a 79 ba 21 b2 43 64 5f 68 67 63 74 9f 88 bc c0 2f 35 9b b4 2b 42 98 e2 0e c8 a1 ba 13 85 da}  //weight: 1, accuracy: High
        $x_1_2 = {20 52 5a 38 4c 55 f9 93 a1 04 61 f9 3a 3e 8e e8 3c ba 33 6d 8d 85 85 ca a9 0c 40 72 c0 de 66 32 26 2a a6 54 29 af 46 ac 86 07 80 47 97 b5 fb b1 42}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Pirrit_A_MTB_1
{
    meta:
        author = "defender2yara"
        detection_name = "Pirrit.A!MTB"
        threat_id = "341223"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_MACHOHSTR_EXT"
        threshold = "2"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {31 db 85 c0 0f 94 c3 48 8d 05 44 58 0d 00 48 89 95 50 ff ff ff 48 89 bd 58 ff ff ff 48 89 4d b0 48 89 75 c8 ff 24 d8}  //weight: 1, accuracy: High
        $x_1_2 = {48 8d 15 33 f8 0c 00 48 8d 0d 4c f8 0c 00 4c 89 e7 48 89 de ff 55 80 48 8d 0d bc f7 0c 00 4c 89 e7 48 89 de 4c 89 fa ff 55 d0 48 8d 15 89 f7 0c 00 31 ff 4c 89 fe 48 8b 5d b0 48 89 d9 4d 89 e0 31 c0 e8 22 3c 05 00}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule SAgnt_A_MTB_0
{
    meta:
        author = "defender2yara"
        detection_name = "SAgnt.A!MTB"
        threat_id = "341224"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_MACHOHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {c7 45 fc 00 00 00 00 89 7d f8 48 89 75 f0 e8 33 00 00 00 48 8d 35 e6 03 00 00 48 89 f7 48 89 45 e8 b0 00 e8 12 00 00 00 48 8b 7d e8 e8 0f 00 00 00 31 c0 48 83 c4 20}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule XFilesStealer_A_MTB_0
{
    meta:
        author = "defender2yara"
        detection_name = "XFilesStealer.A!MTB"
        threat_id = "344086"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "17"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {06 07 02 8c ?? 00 00 1b 6f ?? 00 00 0a 00 28 ?? 00 00 0a 07 6f ?? 00 00 0a 6f ?? 00 00 0a 0c de}  //weight: 1, accuracy: Low
        $x_1_2 = "cm9vdFxDSU1WMg==" wide //weight: 1
        $x_1_3 = "fT3BlcmF0aW5nU3lzdGVt" wide //weight: 1
        $x_1_4 = "TmFtZQ==" wide //weight: 1
        $x_1_5 = "SEFSRFdBUkVcRGVzY3JpcHRpb25cU3lzdGVtXENlbnRyYWxQcm9jZXNzb3JcMA==" wide //weight: 1
        $x_1_6 = "SWRlbnRpZmllcg==" wide //weight: 1
        $x_1_7 = "XHJvb3RcU2VjdXJpdHlDZW50ZXI" wide //weight: 1
        $x_1_8 = "U2VsZWN0ICogZnJvbSBBbnRpdmlydXNQcm9kdWN0" wide //weight: 1
        $x_1_9 = "ZGlzcGxheU5hbWU=" wide //weight: 1
        $x_1_10 = "U0VMRUNUICogRlJPTSBXaW4zMl9Qcm9jZXNzb3I=" wide //weight: 1
        $x_1_11 = "TnVtYmVyT2ZDb3Jlcw==" wide //weight: 1
        $x_1_12 = "c2VsZWN0ICogZnJvbSBXaW4zMl9WaWRlb0NvbnRyb2xsZXI=" wide //weight: 1
        $x_1_13 = "U2VsZWN0ICogRnJvbSBXaW4zMl9Db21wdXRlclN5c3RlbQ==" wide //weight: 1
        $x_1_14 = "VG90YWxQaHlzaWNhbE1lbW9yeQ==" wide //weight: 1
        $x_1_15 = "get_UTF8" ascii //weight: 1
        $x_1_16 = "GetString" ascii //weight: 1
        $x_1_17 = "FromBase64String" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Ketin_C_MTB_0
{
    meta:
        author = "defender2yara"
        detection_name = "Ketin.C!MTB"
        threat_id = "347928"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_MACHOHSTR_EXT"
        threshold = "2"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {48 8d 05 39 42 02 00 31 c9 48 8b 15 18 3c 02 00 8b 7d e4 48 8b 12 48 89 c6 e8 e4 a2 01 00 48 89 45 d8 48 83 7d d8 00}  //weight: 1, accuracy: High
        $x_1_2 = {48 89 c1 48 8d 15 08 63 04 00 31 f6 41 b8 81 00 00 00 48 8b bd d0 fe ff ff 40 88 b5 8f fe ff ff 44 89 c6 4c 8b 8d a8 fe ff ff 48 89 8d 80 fe ff ff 4c 89 c9 49 89 c0 8a 85 8f fe ff ff}  //weight: 1, accuracy: High
        $x_1_3 = "sendEvent:hostName:g0btIPr1:callback" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (2 of ($x*))
}

rule Adload_AA_MTB_0
{
    meta:
        author = "defender2yara"
        detection_name = "Adload.AA!MTB"
        threat_id = "347931"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_MACHOHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_2_1 = {48 8b 00 48 89 45 d0 31 c0 48 89 47 10 48 89 47 08 48 89 bd 18 fe ff ff 48 89 07 48 89 85 00 ff ff ff 66 0f 57 c0 66 0f 29 85 f0 fe ff ff 48 89 85 30 ff ff ff 48 89 85 60 ff ff ff 88 85 70 ff ff ff 48 89 45 a8 48 89 45 a0 48 89 45 98 88 85 28 ff ff ff 48 89 85 20 ff ff ff 66 0f 29 85 10 ff ff ff 88 45 90 48 89 45 88 48 89 45 80 48 89 85 78 ff ff ff 88 45 c0 48 89 85 60 fe ff ff 66 0f 29 85 50 fe ff ff 48 8d 35 a7 e9 00 00 48 8d bd 30 bd ff ff ba 22 00 00 00}  //weight: 2, accuracy: High
        $x_2_2 = {4c 8b ad d0 fe ff ff 4c 39 ad d8 fe ff ff 0f 84 84 09 00 00 48 8d 3d 59 b6 00 00 ba 07 00 00 00 4c 89 ee e8 bc ac 00 00 85 c0 0f 85 79 09 00 00 49 8d 75 10 49 63 45 08 49 8d 54 05 10 48 8d bd b0 fe ff ff e8 f1 51 00 00 48 8b 8d b0 fe ff ff 48 8b b5 b8 fe ff ff 48 39 ce 74 41 48 63 85 88 fe ff ff 48 69 d0 d3 4d 62 10 48 89 d6 48 c1 ee 3f 48 c1 ea 23 01 f2 6b d2 7d 29 d0 31 d2 30 04 11}  //weight: 2, accuracy: High
        $x_1_3 = "uuid_generate_random" ascii //weight: 1
        $x_1_4 = "keyenumerator" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_2_*) and 2 of ($x_1_*))) or
            ((2 of ($x_2_*))) or
            (all of ($x*))
        )
}

rule pirrit_K_MTB_0
{
    meta:
        author = "defender2yara"
        detection_name = "pirrit.K!MTB"
        threat_id = "349156"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_MACHOHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {c7 05 b3 2d 10 00 01 00 00 00 31 ff be 0a 00 00 00 e8 47 4a 0c 00 48 8d 35 05 23 0d 00 48 89 c7 e8 3e 4a 0c 00 31 ff be 0a 00 00 00 e8 2c 4a 0c 00 48 8d 35 d9 22 0d 00 48 89 c7 e8 23 4a 0c 00 31 ff be 0a 00 00 00 e8 11 4a 0c 00 48 8d 35 af 22 0d 00 48 89 c7 e8 08 4a 0c 00 31 ff be 0a 00 00 00 e8 f6 49 0c 00 48 8d 35 83 22 0d 00 48 89 c7 e8 ed 49 0c 00 31 ff be 0a 00 00 00 e8 db 49 0c 00 48 8d 35 59 22 0d 00 48 89 c7 e8 d2 49 0c 00 31 ff be 0a 00 00 00}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule AdLoad_B_MTB_0
{
    meta:
        author = "defender2yara"
        detection_name = "AdLoad.B!MTB"
        threat_id = "349462"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_MACHOHSTR_EXT"
        threshold = "4"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {48 83 f9 04 0f 82 ?? ?? 00 00 48 89 c2 8b 00 8b 74 0a fc c1 e0 03 48 01 c8 48 31 f0 48 ba 69 2d 38 eb 08 ea df 9d 48 89 d7 48 0f af c2 48 89 c2 48 c1 ea 2f 48 31 f0}  //weight: 1, accuracy: Low
        $x_1_2 = {44 8b 68 04 48 89 df ?? ?? ?? 02 00 48 85 c0 74 dc 8a 18 84 db 74 d6 41 83 c5 07 41 83 e5 f8 4c 89 f9 4c 29 e9 48 c1 e9 03 31 d2}  //weight: 1, accuracy: Low
        $x_1_3 = "uuid_generate_random" ascii //weight: 1
        $x_1_4 = "keyEnumerator" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Synataeb_C_MTB_0
{
    meta:
        author = "defender2yara"
        detection_name = "Synataeb.C!MTB"
        threat_id = "354798"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_MACHOHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {10 10 10 40 90 01 10 80 01 e0 02 60 10 70 10 10 10 a0 06 50 10 40 90 01 90 01 50 10 30 20 c0 01 80 03 f0 05 20 10 90 01 90 03 b0 01 c0 01 80 01 90 13 90 09 30 60 20 4e d2 01 20 50 20 20 20 20 30 20 20 20 10 20}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule SAgnt_B_MTB_0
{
    meta:
        author = "defender2yara"
        detection_name = "SAgnt.B!MTB"
        threat_id = "355161"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_MACHOHSTR_EXT"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_5_1 = "api.mac.flmgr.net" ascii //weight: 5
        $x_1_2 = "/homepageBookmark.sh -updateMarkUrlMatch" ascii //weight: 1
        $x_1_3 = "com.ydsd.YDSteward" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_5_*) and 1 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule Adload_A_MTB_0
{
    meta:
        author = "defender2yara"
        detection_name = "Adload.A!MTB"
        threat_id = "355812"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_MACHOHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {63 00 d7 1d 0b e6 66 00 91 1e 0c c1 63 00 ee 1f 80 03 dc 66 00 86 23 0b bc 66 00 d5 23 1e fb 65 00 f3 23 0b f9 65 00 c2 24 08 d4 66 00 d2 24 08 d2 66 00 f6 24 08 b7 63 00 a7 25 2c 92 64 00 d8 25 13 8d 64 00 eb 25 13 ee 63 00 ca 28 0c d4 66 00 dd 28 08 f4 62}  //weight: 1, accuracy: High
        $x_1_2 = {da 01 35 bd 01 c6 01 66 6a 6a 2e 3e 3d af 02 96 05 4d 91 03 88 02 3e 1e 3e aa 01 0a 1c 84 02 94 02 fc 01 c0 01 ac 04 a6 05 48 91 05 31 26 2c 36 26 26 2c 9e 01 30 38 e2 02 26 42 5a fe 02 7e 86 01 7a 82 01 84 01 8c 01 20 0e 0e 26 2c 26 2c 0a 1c 0e 0e 4e 56 58 60 ba 04 a2 04 6e 76 76 7e 4e 72 50 48 2a}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (1 of ($x*))
}

rule Adload_C_MTB_0
{
    meta:
        author = "defender2yara"
        detection_name = "Adload.C!MTB"
        threat_id = "355813"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_MACHOHSTR_EXT"
        threshold = "2"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {4b 65 79 38 69 73 55 6e 69 71 75 65 79 71 5f 6e 5f 78 53 62 74 46 53 53 5f 79 70 54 67 35 54 66 34 6e 78 6e 6e 5f 6e 00 5f 24 73 53 44 79 71 5f 53 67 78 63 69 73 53 53 5f 79 70 54 67 35 54 66 34 6e 67 58 6e 5f 6e 00 5f}  //weight: 1, accuracy: High
        $x_1_2 = "sharedUserDefaults" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Ketin_A_MTB_0
{
    meta:
        author = "defender2yara"
        detection_name = "Ketin.A!MTB"
        threat_id = "357119"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_MACHOHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {f4 e5 af a5 e4 bf df e1 f0 e9 eb e5 f9 bd e3 b5 e5 b4 e4 b9 e3 b2 e6 b8 b5 b0 e3 b2 e4 e1 b0 b6 b7 b9 b0 b0 b8 b0 e5 e3 b5 b3 e3 e4 b5 b6 b0 e4 b6 e3 b1 b4 b7 e2 80 c7 c5 d4 80 c4 c5 c2 d5 c7 a0 80 a5 c0 80 c4 c5 c2 d5 c7 a0 80 e4 ef f7 ee ec}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Pirrit_B_MTB_0
{
    meta:
        author = "defender2yara"
        detection_name = "Pirrit.B!MTB"
        threat_id = "357120"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_MACHOHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {12 77 8f f0 ec c9 cc 29 7e e1 0d 6f c1 35 80 69 03 48 1d 46 c7 50 90 8a 3b ab 91 b1 61 24 63}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule DockMaster_K_MTB_0
{
    meta:
        author = "defender2yara"
        detection_name = "DockMaster.K!MTB"
        threat_id = "357226"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_MACHOHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_2_1 = {4c 8b 3d a0 40 00 00 4c 8b 35 59 3f 00 00 ff 15 93 23 00 00 48 89 c3 48 8d 15 19 2a 00 00 4c 8b 25 72 23 00 00 4c 89 ff 4c 89 f6 41 ff d4 48 8b 35 fa 3f 00 00 48 89 df 41 ff d4 48 89 df}  //weight: 2, accuracy: High
        $x_1_2 = "will_install_update" ascii //weight: 1
        $x_1_3 = "getRunningApplications" ascii //weight: 1
        $x_1_4 = "getMacSerialNumber" ascii //weight: 1
        $x_1_5 = "setAutomaticallyDownloadsUpdates" ascii //weight: 1
        $x_1_6 = "getHardwareUuid" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((5 of ($x_1_*))) or
            ((1 of ($x_2_*) and 3 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule Cimpli_A_MTB_0
{
    meta:
        author = "defender2yara"
        detection_name = "Cimpli.A!MTB"
        threat_id = "357922"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_MACHOHSTR_EXT"
        threshold = "2"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {49 63 c5 48 8d 0d ?? ?? 02 00 8a 04 08 42 32 44 35 b0 88 45 98 4c 89 e7 48 8d 75 98 e8 ?? ?? fe ff 45 85 ed 41 8d 45 ff 41 0f 4e c7 49 ff c6 41 89 c5 49 83 fe 11 75 c8}  //weight: 1, accuracy: Low
        $x_1_2 = "1.2.11" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Cimpli_B_MTB_0
{
    meta:
        author = "defender2yara"
        detection_name = "Cimpli.B!MTB"
        threat_id = "357924"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_MACHOHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {79 0c a0 01 00 85 01 3f 00 00 00 ff ff 01 1f 00 4d 00 00 4d 05 ce 02 00 68 5b cc 02 00 f0 01 13 ca 02 00 93 02 0e ce 02 00 a1 02 43 00 00 00 ff ff 01 0c 00 36 00 00 36 12 54 00 48 22 00 00 ff ff 01 10 00 c9 03 00 00 c9 03 09 f2 03 00 d2 03 36 00 00 ff ff 01 0c 00 2a}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule InstallCore_A_MTB_0
{
    meta:
        author = "defender2yara"
        detection_name = "InstallCore.A!MTB"
        threat_id = "359891"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_MACHOHSTR_EXT"
        threshold = "2"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {89 c1 83 e1 1f 41 8a 0c 0f 41 32 4c 05 00 88 ?? ?? ?? ef ff ff 48 ff c0 48 39 c3}  //weight: 1, accuracy: Low
        $x_1_2 = "_targetClass" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule AdwRemPro_A_MTB_0
{
    meta:
        author = "defender2yara"
        detection_name = "AdwRemPro.A!MTB"
        threat_id = "367318"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_MACHOHSTR_EXT"
        threshold = "7"
        strings_accuracy = "High"
    strings:
        $x_5_1 = "Adware-Removal-Pro/src/" ascii //weight: 5
        $x_1_2 = "AppDelegate isInTrashDir" ascii //weight: 1
        $x_1_3 = "AdwareRemovalPro" ascii //weight: 1
        $x_1_4 = "applicationDidHide:" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_5_*) and 2 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule MacSearch_A_MTB_0
{
    meta:
        author = "defender2yara"
        detection_name = "MacSearch.A!MTB"
        threat_id = "367597"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_MACHOHSTR_EXT"
        threshold = "2"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {a3 8b ff 66 ab 4c fe 1d 74 5f f5 62 42 f2 59 ed 0b 2c 34 e0 53 45 38 00 cc 8e f2 5a 58 a0 77 22 b2 a2 e2 81 58 fb 48 ba f5 f5 63 bc 14 6d 26 1f 73 42 25 37 e0 90 28 f3 ea e1 d4 76 cc db 16 de 5c 3d ba e4 c9 5c 92 18 96 c6 1b 57 73 79 d8 d3 c7 61 0f fb 46 c5 df 7a 0a d6 9c 3a ec 8a 85 ec}  //weight: 1, accuracy: High
        $x_1_2 = "SafariSearchAppExtension" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Pirrit_D_MTB_0
{
    meta:
        author = "defender2yara"
        detection_name = "Pirrit.D!MTB"
        threat_id = "367884"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_MACHOHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "com.GoSearch22.Extension" ascii //weight: 2
        $x_1_2 = "K69G52FWT9" ascii //weight: 1
        $x_1_3 = "hongsheng yan" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Pirrit_A_0
{
    meta:
        author = "defender2yara"
        detection_name = "Pirrit.A"
        threat_id = "367885"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_MACHOHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "HKEY_LOCAL_MACHINE\\SOFTWARE\\Pirrit" ascii //weight: 2
        $x_1_2 = "projects/pirrit/macos/ProxyServer" ascii //weight: 1
        $x_1_3 = "thecloudservices.net" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Adload_AK_MTB_0
{
    meta:
        author = "defender2yara"
        detection_name = "Adload.AK!MTB"
        threat_id = "368170"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_MACHOHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "delegatec5shownsbvpwvd" ascii //weight: 1
        $x_1_2 = "getStateOfSafariExtensionWithIdentifier" ascii //weight: 1
        $x_1_3 = "DelegateC5checkyyFZyy" ascii //weight: 1
        $x_1_4 = "sharedUserDefaults" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Bundlore_X_0
{
    meta:
        author = "defender2yara"
        detection_name = "Bundlore.X"
        threat_id = "368416"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_CMDHSTR_EXT"
        threshold = "5"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = "SELECT LSQuarantineDataURLString FROM LSQuarantineEvent ORDER BY LSQuarantineTimeStamp" wide //weight: 1
        $x_1_2 = {28 00 75 00 75 00 69 00 64 00 67 00 65 00 6e 00 29 00 [0-4] 3b 00 69 00 66 00 20 00 6f 00 75 00 74 00 70 00 75 00 74 00 3d 00 [0-4] 24 00 28 00 63 00 75 00 72 00 6c 00 20 00 2d 00 6b 00 4c 00 53 00 73 00 20 00 2d 00 6d 00}  //weight: 1, accuracy: Low
        $x_1_3 = {72 00 6d 00 20 00 2d 00 72 00 66 00 [0-32] 3e 00 2f 00 64 00 65 00 76 00 2f 00 6e 00 75 00 6c 00 6c 00 20 00 32 00 3e 00 26 00 31 00 3b 00 65 00 78 00 69 00 74 00 3b 00 7d 00 3b 00 6d 00 61 00 69 00 6e 00 28 00 29 00 7b 00 20 00 75 00 72 00 6c 00 3d 00 [0-32] 70 00 6b 00 69 00 6c 00 6c 00 20 00 2d 00 39 00 [0-4] 74 00 65 00 72 00 6d 00 69 00 6e 00 61 00 6c 00}  //weight: 1, accuracy: Low
        $x_1_4 = "(/usr/bin/sw_vers -productVersion)" wide //weight: 1
        $x_1_5 = {3b 00 63 00 6c 00 65 00 61 00 6e 00 75 00 70 00 3b 00 7d 00 3b 00 6d 00 61 00 69 00 6e 00 [0-4] 68 00 74 00 74 00 70 00}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Adload_D_MTB_0
{
    meta:
        author = "defender2yara"
        detection_name = "Adload.D!MTB"
        threat_id = "369308"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_MACHOHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {00 00 8e 0a 06 e0 23 00 9d 0b 0c ef 22 00 ad 0b 0f ea 22 00 da 0b 34 ab 23 00 8e 0c 82 02 00 00 90 0e 0c b2 22 00 b9 0f 05 b0 22 00 b2 11 f0 01 9a 23 00 dd 13 09 e8 22 00 eb 13 09 e3 22 00 8d 14 30 f1 22 00 95 16 a5 01 9a 23 00 de 17 0a ab 22 00 f2 17 13 93 22 00 85 18 ed 01 00 00 f2 19 05 b4 22 00 90 1b 20 9a 23 00 ce 21 05 8e 22 00 d5}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule LuWheel_SD_MTB_0
{
    meta:
        author = "defender2yara"
        detection_name = "LuWheel.SD!MTB"
        threat_id = "405066"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "kill.bat" ascii //weight: 1
        $x_1_2 = "LuckyWheel1" ascii //weight: 1
        $x_1_3 = "Lucky Joe" ascii //weight: 1
        $x_1_4 = "c:\\Users\\win.txt" ascii //weight: 1
        $x_1_5 = "KillProcDLL.dll" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Ketin_B_MTB_0
{
    meta:
        author = "defender2yara"
        detection_name = "Ketin.B!MTB"
        threat_id = "407512"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_MACHOHSTR_EXT"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {00 5f 73 79 73 63 74 6c 00 5f 73 79 73 63 74 6c 62 79 6e 61 6d 65 00 5f 73 79 73 74 65 6d 00 64 79 6c 64 5f 73 74 75 62 5f 62 69 6e 64 65 72 00 72 61 64 72 3a 2f 2f 35 36 31 34 35 34 32}  //weight: 1, accuracy: High
        $x_1_2 = "urlforapplicationtoopenurl" ascii //weight: 1
        $x_1_3 = "operatingSystemVersion" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Adload_E_MTB_0
{
    meta:
        author = "defender2yara"
        detection_name = "Adload.E!MTB"
        threat_id = "409007"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_MACHOHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {d1 28 05 b2 11 19 c5 28 05 f1 11 08 ef 2c 05 89 13 1d a6 31 03 a6 13 40 da 32 03 e6 13 0f 8f 2e 03 fe 13 0c f7 2d 03 90 14 0f e2 2d 03 9f 14 26 ca 2d 03 c8 14 0f b6 2d 03 a9 15 16 c3 31 03 bf 15 16 f0 30 03 e5 15 13 ab 31 03 89 16 13 93 2f 03 a7 16 16 e7 2b 03 92 17 0f af 32 03 a1 17 31}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Bundlore_Y_0
{
    meta:
        author = "defender2yara"
        detection_name = "Bundlore.Y"
        threat_id = "413643"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_CMDHSTR_EXT"
        threshold = "5"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = "SELECT LSQuarantineDataURLString FROM LSQuarantineEvent ORDER BY LSQuarantineTimeStamp" wide //weight: 1
        $x_1_2 = {6b 00 69 00 6c 00 6c 00 61 00 6c 00 6c 00 [0-4] 54 00 65 00 72 00 6d 00 69 00 6e 00 61 00 6c 00}  //weight: 1, accuracy: Low
        $x_1_3 = {28 00 75 00 75 00 69 00 64 00 67 00 65 00 6e 00 29 00 [0-16] 20 00 63 00 75 00 72 00 6c 00 20 00 2d 00 66 00 20 00 2d 00 73 00 20 00 2d 00 6f 00 20 00}  //weight: 1, accuracy: Low
        $x_1_4 = {2f 00 75 00 73 00 72 00 2f 00 62 00 69 00 6e 00 2f 00 6d 00 6b 00 74 00 65 00 6d 00 70 00 20 00 2d 00 64 00 [0-64] 28 00 75 00 75 00 69 00 64 00 67 00 65 00 6e 00 29 00 [0-16] 74 00 61 00 72 00 20 00 2d 00 78 00 7a 00 66 00}  //weight: 1, accuracy: Low
        $x_1_5 = {72 00 6d 00 20 00 2d 00 72 00 66 00 [0-32] 3b 00 7d 00 3b 00 6d 00 61 00 69 00 6e 00 [0-4] 68 00 74 00 74 00 70 00}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Adload_K_MTB_0
{
    meta:
        author = "defender2yara"
        detection_name = "Adload.K!MTB"
        threat_id = "416026"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_MACHOHSTR_EXT"
        threshold = "3"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {44 8b 68 04 48 89 df e8 ?? ?? ?? 00 48 85 c0 74 dc 8a 18 84 db 74 d6 41 83 c5 07 41 83 e5 f8 4c 89 f9 4c 29 e9 48 c1 e9 03 31 d2}  //weight: 1, accuracy: Low
        $x_1_2 = {48 8d bd 10 ff ff ff e8 ?? ?? ?? ?? 48 8b 9d 80 fe ff ff 48 85 db 74 23 48 c7 c0 ff ff ff ff f0 48 0f c1 43 08 48 85 c0 75 ?? 48 8b 03}  //weight: 1, accuracy: Low
        $x_1_3 = "keyenumerator" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Adload_N_MTB_0
{
    meta:
        author = "defender2yara"
        detection_name = "Adload.N!MTB"
        threat_id = "416027"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_MACHOHSTR_EXT"
        threshold = "4"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {48 39 de 0f 86 b0 03 00 00 8a 44 19 ff 8b 0c 19 44 01 e1 28 c8 88 85 0f ff ff ff 48 8b 8d f8 fe ff ff 48 3b 8d 00 ff ff ff 73 0b 88 01 48 ff 85 f8 fe ff ff}  //weight: 1, accuracy: High
        $x_1_2 = {44 8b 68 04 48 89 df e8 ?? ?? ?? 00 48 85 c0 74 dc 8a 18 84 db 74 d6 41 83 c5 07 41 83 e5 f8 4c 89 f9 4c 29 e9 48 c1 e9 03 31 d2}  //weight: 1, accuracy: Low
        $x_1_3 = "IOMACAddress" ascii //weight: 1
        $x_1_4 = "IOPlatformUUID" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Pirrit_L_MTB_0
{
    meta:
        author = "defender2yara"
        detection_name = "Pirrit.L!MTB"
        threat_id = "416028"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_MACHOHSTR_EXT"
        threshold = "2"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {44 8b 68 04 48 89 df e8 ?? ?? ?? 00 48 85 c0 74 dc 8a 18 84 db 74 d6 41 83 c5 07 41 83 e5 f8 4c 89 f9 4c 29 e9 48 c1 e9 03 31 d2}  //weight: 1, accuracy: Low
        $x_1_2 = {80 35 db 9e 11 00 24 80 35 d5 9e 11 00 06 80 35 cf 9e 11 00 f3 80 35 c9 9e 11 00 b3 80 35 c3 9e 11 00 3f 80 35 bd 9e 11 00 a0 80 35 b7 9e 11 00 68 80 35 b1 9e 11 00 90 80 35 ab 9e 11 00 d1 80 35 a5 9e 11 00 18 b0 e1 30 05 9e 9e 11 00 80 35 98 9e 11 00 17 80 35 92 9e 11 00 9f 80 35 8c 9e 11 00 64 80 35 86 9e 11 00 b8 80 35 65 9e 11 00 55 30 05 60 9e 11 00 80 35 5a 9e 11 00 dc 80 35 54 9e 11 00 41 ff 25 2f a4 11 00}  //weight: 1, accuracy: High
        $x_1_3 = {f2 0f 11 45 d0 48 8d 3d 27 99 11 00 ff d3 48 89 c3 48 8d 3d 27 99 11 00 41 ff d6 49 89 c6 48 8d 15 b2 6c 11 00 48 8d 0d 7b 99 11 00 48 89 df 48 89 c6 45 31 c0 31 c0 41 ff d7 48 8b 05 36 9f 11 00}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (2 of ($x*))
}

rule Pirrit_N_MTB_0
{
    meta:
        author = "defender2yara"
        detection_name = "Pirrit.N!MTB"
        threat_id = "416029"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_MACHOHSTR_EXT"
        threshold = "3"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {44 8b 68 04 48 89 df e8 ?? ?? ?? 00 48 85 c0 74 dc 8a 18 84 db 74 d6 41 83 c5 07 41 83 e5 f8 4c 89 f9 4c 29 e9 48 c1 e9 03 31 d2}  //weight: 1, accuracy: Low
        $x_1_2 = {48 8d 35 46 1e 01 00 e8 8d f9 00 00 48 8b 05 46 33 01 00 48 83 c0 10 48 89 03 48 83 c4 08}  //weight: 1, accuracy: High
        $x_1_3 = {48 8d bd b0 d7 ff ff 48 8d b5 e0 d6 ff ff 31 d2 e8 7c 84 00 00 48 8d bd b0 d7 ff ff e8 5c 8b 00 00 48 8d bd e0 d6 ff ff e8 0a 98 00 00 4c 89 ef e8 dc 43 00 00 48 85 c0 75 1e 48 8b 85 a0 d4 ff ff 48 8b 40 e8 48 8d bc 05 a0 d4 ff ff 8b 77 20}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Pirrit_O_MTB_0
{
    meta:
        author = "defender2yara"
        detection_name = "Pirrit.O!MTB"
        threat_id = "425390"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_MACHOHSTR_EXT"
        threshold = "2"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {c7 05 07 03 26 00 01 00 00 00 31 ff be 0a 00 00 00 e8 e2 a1 1d 00 48 8d 35 0c 2b 21 00 48 89 c7 e8 d9 a1 1d 00 49 89 c6 31 ff be 0a 00 00 00 e8 c4 a1 1d 00 ff 25 af 33 21 00}  //weight: 1, accuracy: High
        $x_1_2 = {31 ff be 0a 00 00 00 e8 6b ba 1c 00 48 8d 35 d5 5b 20 00 48 89 c7 e8 62 ba 1c 00 49 89 c7 31 ff be 0a 00 00 00 e8 4d ba 1c 00 48 8d 35 87 5b 20 00 48 89 c7 e8 44 ba 1c 00 48 8d 3d 95 59 20 00 ff d0 49 89 c5 48 8d 3d e4 5a 20 00 41 ff d7 4c 89 ef 48 89 c6 41 ff d4 48 89 c7 e8 d7 ba 1c 00 ff 25 aa 94 20 00}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Pirrit_P_MTB_0
{
    meta:
        author = "defender2yara"
        detection_name = "Pirrit.P!MTB"
        threat_id = "429889"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_MACHOHSTR_EXT"
        threshold = "2"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {41 b7 6d 44 30 3d da 6c 00 00 41 b0 e0 44 30 05 d1 6c 00 00 b0 94 30 05 ca 6c 00 00 80 35 c4 6c 00 00 89 80 35 be 6c 00 00 6a 80 35 bb 6c 00 00 30 41 b2 77 44 30 15 b2 6c 00 00 b0 b0 30 05 ab 6c 00 00 80 35 a5 6c 00 00 d7 80 35 9f 6c 00 00 ef b1 45 30 0d 98 6c 00 00 80 35 93 6c 00 00 58 30 05 8e 6c 00 00}  //weight: 1, accuracy: High
        $x_1_2 = {80 35 a7 32 00 00 48 80 35 a1 32 00 00 d6 80 35 9b 32 00 00 c9 80 35 95 32 00 00 bb 80 35 8f 32 00 00 c3 80 35 89 32 00 00 e0 80 35 83 32 00 00 b7 80 35 7d 32 00 00 14 ff 25 60 37 00 00}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Pirrit_J_MTB_0
{
    meta:
        author = "defender2yara"
        detection_name = "Pirrit.J!MTB"
        threat_id = "430072"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_MACHOHSTR_EXT"
        threshold = "2"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {8b 05 52 cf 0a 00 8b 0d 50 cf 0a 00 21 c8 25 92 33 61 18 2d 33 42 5f ee 8b 0d 1a 94 0b 00 89 4d a8 b9 21 b8 32 d5 ba 9e 6f 8c 80 0f 45 d1 89 55 a0 48 8b 35 48 d1 0a 00 89 85 f4 fe ff ff ff e6}  //weight: 1, accuracy: High
        $x_1_2 = {c7 05 63 50 0b 00 01 00 00 00 48 89 e0 48 89 c1 48 83 c1 f0 48 89 cc 48 89 e1 48 83 c1 f0 48 89 cc 48 8b 4d f8 48 89 48 f0 48 8b 05 e9 8d 0a 00 ff e0}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Pirrit_U_MTB_0
{
    meta:
        author = "defender2yara"
        detection_name = "Pirrit.U!MTB"
        threat_id = "430073"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_MACHOHSTR_EXT"
        threshold = "2"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {4c 89 f7 ff 15 82 be 20 00 ff 25 04 4a 21 00 48 8b 3b ff 15 73 be 20 00 4c 8b 33 eb e3}  //weight: 1, accuracy: High
        $x_1_2 = {88 05 1c 2d 21 00 8a 0d 07 2d 21 00 80 f1 5a 88 0d 0e 2d 21 00 8a 0d f9 2c 21 00 80 f1 58 88 0d 00 2d 21 00 8a 0d eb 2c 21 00 8d 14 09 80 e2 64 28 d1 80 c1 32 88 0d ea 2c 21 00 8a 0d d5 2c 21 00 80 f1 df 88 0d dc 2c 21 00 8a 0d d7 2c 21 00 80 f1 47 88 0d d1 2c 21 00 8a 0d c9 2c 21 00 80 f1 bb 88 0d c3 2c 21 00 8a 0d bb 2c 21 00 80 f1 53 88 0d b5 2c 21 00 ff 25 e9 34 21 00}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Adload_F_MTB_0
{
    meta:
        author = "defender2yara"
        detection_name = "Adload.F!MTB"
        threat_id = "430466"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_MACHOHSTR_EXT"
        threshold = "2"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {48 89 c1 48 c1 e1 08 8b 85 58 fc ff ff 48 09 c8 49 c1 e7 10 49 09 c7 89 d8 48 c1 e0 18 4c 09 f8 48 3d 50 4b 03 04 41 bc 99 ff ff ff b8 00 00 00 00 44 0f 44 e0}  //weight: 1, accuracy: High
        $x_1_2 = {4c 8b b5 c0 fc ff ff 4c 29 f3 48 89 d8 48 ff c0 0f 88 ?? ?? ?? ?? 49 bd ff ff ff ff ff ff ff 7f 48 b9 ff ff ff ff ff ff ff 3f 48 39 cb 73 ?? 4c 8d 2c 1b 49 39 c5 4c 0f 42 e8 4d 85 ed}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Pirrit_V_MTB_0
{
    meta:
        author = "defender2yara"
        detection_name = "Pirrit.V!MTB"
        threat_id = "432240"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_MACHOHSTR_EXT"
        threshold = "2"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {66 0f 3a 0e c3 fe 40 0f b6 d6 66 0f 3a 20 c2 08 66 0f f8 d0 66 0f ef e3 0f 28 05 e3 22 1f 00 66 0f 38 10 d4 88 0d bc 50 22 00}  //weight: 1, accuracy: High
        $x_1_2 = {49 89 f2 49 89 d1 49 89 c8 31 c9 85 c0 0f 94 c1}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule MaxOfferDeal_A_MTB_0
{
    meta:
        author = "defender2yara"
        detection_name = "MaxOfferDeal.A!MTB"
        threat_id = "433473"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_MACHOHSTR_EXT"
        threshold = "2"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {f3 0f 6f 5c 0d a0 66 0f 6f e0 66 0f fc e1 66 0f ef e3 f3 0f 7f 64 0d a0 66 0f fc c2 48 83 c1 10 48 83 f9 35}  //weight: 1, accuracy: High
        $x_1_2 = {40 30 74 10 04 48 ff c2 48 39 d1 75 f0 c6 44 08 04 00 48 83 c0 04 5d c3}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Pirrit_Q_MTB_0
{
    meta:
        author = "defender2yara"
        detection_name = "Pirrit.Q!MTB"
        threat_id = "433490"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_MACHOHSTR_EXT"
        threshold = "2"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {89 c1 80 f1 b3 88 0d f8 d1 04 00 80 35 f2 d1 04 00 55 b1 6a 30 0d eb d1 04 00 80 35 e5 d1 04 00 e5 80 35 df d1 04 00 01 80 35 d9 d1 04 00 16 80 35 d3 d1 04 00 f8 80 35 cd d1 04 00 33 30 0d c8 d1 04 00}  //weight: 1, accuracy: High
        $x_1_2 = {8a 45 d0 34 69 88 05 fd 30 07 00 b0 f3 30 05 f6 30 07 00 b0 7a 30 05 ef 30 07 00 80 35 ea 30 07 00 37 80 35 e4 30 07 00 55 b1 82 30 0d dd 30 07 00 40 b6 82 80 35 d4 30 07 00 ab 80 35 ce 30 07 00 46 b1 bb 30 0d c7 30 07 00 30 05 c2 30 07 00 80 35 bc 30 07 00 3a 40 b7 f8}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Adload_G_MTB_0
{
    meta:
        author = "defender2yara"
        detection_name = "Adload.G!MTB"
        threat_id = "433491"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_MACHOHSTR_EXT"
        threshold = "3"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {49 63 c7 42 8a 04 28 42 32 44 35 c0 8b 4d a8 88 45 a8 4c 89 e7 48 8d 75 a8 e8 6e be ff ff 8b 45 a8 45 85 ff}  //weight: 1, accuracy: High
        $x_1_2 = {8a 4b 10 88 08 48 83 c3 08 48 ff c0 48 8b 1b 49 39 df}  //weight: 1, accuracy: High
        $x_2_3 = {b8 ff ff ff ff 83 fe 10 75 ?? 40 80 cf 20 89 f9 80 c1 9f 80 f9 05 77 ?? 40 0f b6 c7 83 c0 a9}  //weight: 2, accuracy: Low
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_2_*) and 1 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule MaxOfferDeal_B_MTB_0
{
    meta:
        author = "defender2yara"
        detection_name = "MaxOfferDeal.B!MTB"
        threat_id = "434143"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_MACHOHSTR_EXT"
        threshold = "2"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {31 c0 89 c6 48 8d 4d c8 48 ?? ?? ?? c9 22 00 00 8b 45 d4 83 c0 01 89 45 d4 e9 ?? ?? ?? ?? 48 89 45 e8 89 55 e4}  //weight: 1, accuracy: Low
        $x_1_2 = {31 c0 89 c6 48 8d 4d f0 48 ?? ?? ?? e0 21 00 00 31 c0 89 c6}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Adload_J_MTB_0
{
    meta:
        author = "defender2yara"
        detection_name = "Adload.J!MTB"
        threat_id = "434144"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_MACHOHSTR_EXT"
        threshold = "2"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {f2 0f 59 05 1d 0d 00 00 f2 0f 10 0d 1d 0d 00 00 66 0f 28 d0 f2 0f 5c d1 f2 48 0f 2c c2 48 c7 47 10 00 00 00 00 48 0f ba f8 3f f2 48 0f 2c f0 66 0f 2e c1 48 0f 43 f0 e8 9d fe fe ff 48 8b 4d b8 48 8b 75 c0 48 39 f1}  //weight: 1, accuracy: High
        $x_1_2 = {4c 89 d0 4d 85 e4 0f ?? ?? ?? ?? ?? 48 29 f2 41 83 f8 02 0f ?? ?? ?? ?? ?? 48 85 d2 0f ?? ?? ?? ?? ?? 48 89 d0 48 d1 f8 31 c9 66 c1 84 4f 00 08 00 00 08 48 ff c1 48 39 c8}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Adload_I_MTB_0
{
    meta:
        author = "defender2yara"
        detection_name = "Adload.I!MTB"
        threat_id = "434674"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_MACHOHSTR_EXT"
        threshold = "2"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {41 55 41 54 53 48 83 ec 48 49 89 d7 49 39 d0 74 ?? 48 89 ca 48 29 f2 48 c1 e2 05 4c 89 c0 48 2b 01 48 c1 f8 04 48 01 d0 4c 89 f9 48 2b 0e 48 c1 f9 04 48 29 c8}  //weight: 1, accuracy: Low
        $x_1_2 = {48 8b 4f 08 4c 8b 4f 10 4d 89 ce 49 29 ce 4c 89 f3 48 c1 e3 05 48 ff cb 4d 85 f6 49 0f 44 de 48 8b 57 20 48 89 7d b0 48 8b 7f 28 48 01 d7 48 29 fb 48 29 d8 4c 89 45 a0 0f ?? ?? ?? ?? ?? 48 89 75 ?? 31 ff 49 39 c9 40 0f 94 c7 48 01 f8 48 89 c7 48 c1 ef 08}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule MaxOfferDeal_G_MTB_0
{
    meta:
        author = "defender2yara"
        detection_name = "MaxOfferDeal.G!MTB"
        threat_id = "434959"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_MACHOHSTR_EXT"
        threshold = "2"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {48 89 df 48 8b 35 ec 4a 03 00 41 ff d7 48 ff c8 4c 39 e0 76 50 48 89 df 48 8b 75 b0 4c 89 e2 41 ff d7 48 89 c7 e8 e8 01 02 00 49 89 c6 48 89 c7 48 8b 75 b8 41 ff d7 48 98 48 8d 0d 46 84 02 00 0f be 0c 08 48 8b 7d d0 4c 89 ee 48 8d 15 3c 04 03 00 31 c0 41 ff d7 4c 89 f7 ff 15 46 fa 02 00 49 ff c4 eb 9b}  //weight: 1, accuracy: High
        $x_1_2 = {48 89 df 48 8b 1d 37 fa 02 00 ff d3 48 8b 7d c0 ff d3 48 8b 7d d0 48 83 c4 28 5b 41 5c 41 5d 41 5e 41 5f 5d e9 24 01 02 00}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Pirrit_M_MTB_0
{
    meta:
        author = "defender2yara"
        detection_name = "Pirrit.M!MTB"
        threat_id = "436161"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_MACHOHSTR_EXT"
        threshold = "2"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {41 81 e6 00 01 00 00 41 09 d6 c1 ef 13 81 e7 00 10 00 00 44 09 f7 8b 55 98 31 d6 31 f1 89 c8 8b 5d 9c 31 d8 41 31 d9 8b 5d a0 31 de 44 31 ce 66 89 75 b8 66 89 4d ba 66 89 55 bc 44 31 e2 31 fa 44 31 ca 89 ce 44 31 e6 31 f9 31 df 66 89 55 be 66 89 4d c0 31 c7 66 89 45 c2 66 89 75 c4 66 89 7d c6}  //weight: 1, accuracy: High
        $x_1_2 = {48 8b bd d8 fe ff ff 4c 89 f6 48 89 8d 38 fe ff ff 48 89 ca e8 1a cb 0c 00 48 8b 85 60 fb ff ff 48 89 85 40 fe ff ff 8b 85 f8 fb ff ff 89 85 a4 fe ff ff f2 0f 10 85 fc fb ff ff 0f 29 85 60 fc ff ff 48 8b 85 78 fb ff ff b9 08 00 00 00 48 89 8d 30 ff ff ff b9 08 00 00 00 48 89 8d c8 fe ff ff 48 89 85 a8 fe ff ff 48 85 c0 0f 84 f6 00 00 00}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Adload_L_MTB_0
{
    meta:
        author = "defender2yara"
        detection_name = "Adload.L!MTB"
        threat_id = "436414"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_MACHOHSTR_EXT"
        threshold = "2"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {48 85 5d d0 0f 84 a2 01 00 00 48 8d 43 ff 4c 21 e8 48 83 c0 20 42 8a 14 20 80 e2 c0 4c 89 e1 80 fa 80 0f 84 95 01 00 00 48 89 c8 48 c1 e0 10 4c 39 e1 4c 0f 45 f8 eb 44}  //weight: 1, accuracy: High
        $x_1_2 = {75 05 49 89 c4 eb 13 49 c1 e6 02 4c 89 f8 48 c1 e8 0e 4c 39 f0 75 09 45 31 e4 4c 8b 75 d0 eb 19 4c 89 ff 48 c1 ef 10 4c 8b 75 d0 4c 89 f6 4c 89 ea}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Adload_P_MTB_0
{
    meta:
        author = "defender2yara"
        detection_name = "Adload.P!MTB"
        threat_id = "436415"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_MACHOHSTR_EXT"
        threshold = "2"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {45 31 e4 49 89 dd e8 63 00 00 00 4d 85 e4 74 0a 4c 89 e7 e8 02 a1 00 00 eb 3d 48 8b 3d ad c5 00 00 e8 06 a1 00 00 48 8b 35 b9 c3 00 00 48 89 c7 e8 3d a0 00 00 48 89 c7 e8 4d a0 00 00 48 89 c3 48 8b 35 a7 c3 00 00 48 89 c7 e8 23 a0 00 00 48 89 df e8 27 a0 00 00 31 c0}  //weight: 1, accuracy: High
        $x_1_2 = {48 83 ec 60 4c 89 65 80 4c 89 6d 88 31 ff e8 88 9d 00 00 48 89 c3 31 ff 48 89 c6 e8 47 9e 00 00 48 8b 40 f8 48 8b 40 40 48 83 c0 0f 48 83 e0 f0 48 89 e1 48 29 c1 48 89 4d b0 48 89 cc 48 89 5d b8 48 8b 43 f8 48 89 45 c0 48 8b 40 40 49 89 e5}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Pirrit_S_MTB_0
{
    meta:
        author = "defender2yara"
        detection_name = "Pirrit.S!MTB"
        threat_id = "438432"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_MACHOHSTR_EXT"
        threshold = "2"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {48 89 e0 48 83 c0 f0 48 89 c4 48 89 45 b0 48 89 e0 48 83 c0 f0 48 89 c4 48 89 45 c0 48 89 e0 48 83 c0 f0 48 89 c4 48 89 45 a8 b8 a9 08 e2 ef}  //weight: 1, accuracy: High
        $x_1_2 = {8a 45 d7 88 05 02 45 00 00 80 35 fc 44 00 00 10 44 30 25 f6 44 00 00 80 35 f0 44 00 00 39 80 35 ea 44 00 00 79 80 35 e4 44 00 00 08 b0 0f 30 05 dd 44 00 00 80 35 d7 44 00 00 2a 80 35 d1 44 00 00 cc 80 35 cb 44 00 00 44 30 05 c6 44 00 00 80 35 c0 44 00 00 21 b0 c8 30 05 9d 44 00 00}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Pirrit_R_MTB_0
{
    meta:
        author = "defender2yara"
        detection_name = "Pirrit.R!MTB"
        threat_id = "439795"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_MACHOHSTR_EXT"
        threshold = "2"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {8a 05 54 8d 11 00 34 c9 88 05 4f 8d 11 00 8a 05 47 8d 11 00 34 bf 88 05 42 8d 11 00 8a 05 3a 8d 11 00 34 fc 88 05 35 8d 11 00 66 0f 6e 05 30 8d 11 00 8a 05 2e 8d 11 00 8d ?? ?? 04 4c}  //weight: 1, accuracy: Low
        $x_1_2 = {48 8b 43 38 49 89 46 28 48 8b 43 20 49 89 46 20 4c 89 ef 48 8b 75 d0 4c 89 e2 4c 89 f9 4d 89 f0 e8 ?? ?? ?? ?? 4c 89 ff}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule MaxOfferDeal_C_MTB_0
{
    meta:
        author = "defender2yara"
        detection_name = "MaxOfferDeal.C!MTB"
        threat_id = "439796"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_MACHOHSTR_EXT"
        threshold = "2"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {55 48 89 e5 41 57 41 56 41 55 41 54 53 48 83 ec 18 49 89 f4 89 7d cc 4c 63 ef 31 db}  //weight: 1, accuracy: High
        $x_1_2 = {4c 89 ff 41 ?? ?? 48 8b 7d c8 41 ?? ?? 48 8b 7d c0 41 ?? ?? 41 0f b6 c6 48 83 c4 28 5b 41 5c 41 5d 41 5e 41 5f 5d c3}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Adload_H_MTB_0
{
    meta:
        author = "defender2yara"
        detection_name = "Adload.H!MTB"
        threat_id = "439872"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_MACHOHSTR_EXT"
        threshold = "2"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {41 bf 01 00 00 00 45 31 f6 49 c1 e6 04 48 8b 45 80 4a 8b 3c 30 48 89 de e8 36 7d 03 00 85 c0 74 0d 45 89 fe 41 ff c7 4d 39 ee 72 dd eb 14 48 8b 45 80 4a 8b 44 30 08 48 8b 8d 68 ff ff ff 4a 89 04 e1}  //weight: 1, accuracy: High
        $x_1_2 = {49 89 d6 49 89 ff e8 d8 79 03 00 48 89 c7 4c 89 e6 e8 4d 78 03 00 48 85 c0 74 13 48 89 c3 4c 89 ff 48 89 c6 4c 89 f2 e8 c3 79 03 00 eb 02 31 db 48 89 d8}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Adload_M_MTB_0
{
    meta:
        author = "defender2yara"
        detection_name = "Adload.M!MTB"
        threat_id = "439873"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_MACHOHSTR_EXT"
        threshold = "2"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {48 8b 15 89 24 00 00 48 85 d2 75 1d 48 8b 3d f5 20 00 00 48 8b 35 e6 20 00 00 e8 d9 1b 00 00 48 89 c2 48 89 05 67 24 00 00 48 8b 35 d0 20 00 00 31 ff e8 2b 1b 00 00 49 89 c5 48 85 d2 75 07 4c 89 2d 42 24 00 00 48 89 5d c0}  //weight: 1, accuracy: High
        $x_1_2 = {48 85 c0 75 2d 48 8b 05 cd 1b 00 00 48 89 85 d8 fe ff ff 48 8d 8d d8 fe ff ff bf 01 00 00 00 31 f6 ba 01 00 00 00 e8 7a 16 00 00 48 89 05 27 1f 00 00 48 8b 15 70 1b 00 00 48 8d bd 20 ff ff ff 48 8d b5 e0 fe ff ff 41 b8 06 00 00 00}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Adload_O_MTB_0
{
    meta:
        author = "defender2yara"
        detection_name = "Adload.O!MTB"
        threat_id = "439874"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_MACHOHSTR_EXT"
        threshold = "2"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {e8 66 23 00 00 84 c0 75 2e 48 8b 3d 93 32 00 00 ba 01 00 00 00 b9 01 00 00 00 4c 89 f6 e8 d3 23 00 00 48 89 d1 48 8d 15 a5 07 00 00 48 89 df 48 89 c6 e8 f8 22 00 00 48 8d 3d 49 29 00 00 e8 64 23 00 00 48 89 c3}  //weight: 1, accuracy: High
        $x_1_2 = {74 12 48 8d 35 bd 0d 00 00 48 89 c7 e8 d4 20 00 00 48 89 c1 48 89 0d 4a 32 00 00 48 8b 35 43 2f 00 00 4c 89 f7 e8 61 20 00 00 48 85 c0 74 12 48 8d 35 a3 0d 00 00 48 89 c7 e8 a7 20 00 00 48 89 c3 48 89 1d 25 32 00 00 48 8d 3d bf 26 00 00 e8 9d 20 00 00}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Pirrit_T_MTB_0
{
    meta:
        author = "defender2yara"
        detection_name = "Pirrit.T!MTB"
        threat_id = "440192"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_MACHOHSTR_EXT"
        threshold = "2"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {48 8d 3d eb b5 09 00 e8 48 0b 08 00 49 89 c6 48 8d 3d 14 b6 09 00 e8 63 0b 08 00 4c 89 f7 48 89 c6 ff 15 03 16 09 00 48 8d 3d e4 b5 09 00 e8 21 0b 08 00 48 8d 3d b8 b5 09 00 e8 15 0b 08 00 49 89 c6 48 8d 3d e1 b5 09 00 e8 30 0b 08 00 4c 89 f7 48 89 c6}  //weight: 1, accuracy: High
        $x_1_2 = {66 0f 3a 20 c0 02 8a 05 c8 b3 09 00 34 ae 88 05 d4 b3 09 00 8a 05 bb b3 09 00 8d 0c 00 80 e1 20 28 c8 04 10 88 05 bf b3 09 00 8a 05 a6 b3 09 00 34 a0 88 05 b2 b3 09 00 8a 05 99 b3 09 00 89 c1 f6 d1 80 c9 d7 0c 28 20 c8 8a 0d 8d b3 09 00 89 ca f6 d2 80 c9 66 80 ca 99}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Ketin_D_MTB_0
{
    meta:
        author = "defender2yara"
        detection_name = "Ketin.D!MTB"
        threat_id = "440307"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_MACHOHSTR_EXT"
        threshold = "2"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {fd 03 1d aa e0 17 40 f9 76 ?? ?? ?? a8 83 5e f8 69 00 00 ?? 29 41 1b 91 21 01 40 f9 e9 1b 40 f9 e0 13 00 f9 e0 03 09 aa e2 13 40 f9 ea 03 00 91 48 01 00 f9 5c ?? ?? ?? e0 0f 00 f9}  //weight: 1, accuracy: Low
        $x_1_2 = {08 01 40 f9 aa 83 5e f8 1f 01 0a eb e9 0f 00 b9 c1 ?? ?? ?? e8 0f 40 b9 08 01 00 12 00 1d 00 12 ff c3 11 91 fd 7b 41 a9 f4 4f c2 a8 c0 03 5f d6 a0 03 02 d1 08 00 80 d2 e1 03 08 aa}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Adload_Q_MTB_0
{
    meta:
        author = "defender2yara"
        detection_name = "Adload.Q!MTB"
        threat_id = "441794"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_MACHOHSTR_EXT"
        threshold = "2"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {41 8a 13 4c 89 e6 4c 89 d7 0f 1f 80 00 00 00 00 48 89 f1 48 89 fe 48 c1 ee 3f 48 01 fe 48 d1 fe 48 89 f0 48 f7 d0 48 01 f8 38 14 31 48 0f 4d c6 48 8d 74 31 01 48 0f 4d f1 48 89 c7 48 85 c0 75 ?? 4c 39 c6 74 ?? 38 16 7f ?? 49 ff c3 4d 39 f3}  //weight: 1, accuracy: Low
        $x_1_2 = {4d 89 de e9 ?? ?? ?? ?? 4d 8b 54 24 10 49 83 fa 11 0f 83 ?? ?? ?? ?? 4f 8d 04 14 4d 85 d2 0f 84 ?? ?? ?? ?? 4d 89 eb 66 2e 0f 1f 84 00 00 00 00 00 ?? 41 8a 13 4c 89 e6 4c 89 d7}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Ketin_E_MTB_0
{
    meta:
        author = "defender2yara"
        detection_name = "Ketin.E!MTB"
        threat_id = "441979"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_MACHOHSTR_EXT"
        threshold = "2"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {48 89 45 b0 31 c0 48 8d 95 60 ff ff ff 48 89 02 48 89 52 08 48 b9 00 00 00 32 30 00 00 00 48 89 4a 10 48 8d 0d 93 04 00 00 48 89 4a 18 48 8d 0d 9e 04 00 00 48 89 4a 20 48 89 42 28 31 ff}  //weight: 1, accuracy: High
        $x_1_2 = {31 c0 4c 8d b5 50 ff ff ff 49 89 06 4d 89 76 08 48 b9 00 00 00 20 20 00 00 00 49 89 4e 10 49 c7 46 18 ff ff ff ff 48 8d 9d 20 ff ff ff 48 89 03 48 89 5b 08 48 b9 00 00 00 32 30 00 00 00 48 89 4b 10 48 8d 0d b8 ee ff ff 48 89 4b 18 48 8d 0d c3 ee ff ff 48 89 4b 20 48 89 43 28}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Pirrit_X_MTB_0
{
    meta:
        author = "defender2yara"
        detection_name = "Pirrit.X!MTB"
        threat_id = "442376"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_MACHOHSTR_EXT"
        threshold = "2"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {8a 05 d1 b9 0a 00 8d 0c 00 80 e1 10 28 c8 04 88 88 05 ce b9 0a 00 8a 05 bc b9 0a 00 34 7e 88 05 c1 b9 0a 00 8a 05 af b9 0a 00 34 7d 88 05 b4 b9 0a 00 8a 05 a2 b9 0a 00 34 e0}  //weight: 1, accuracy: High
        $x_1_2 = {c7 05 ce 2b 0c 00 01 00 00 00 31 ff be 0a 00 00 00 e8 ?? ?? ?? ?? 48 8d 35 3f 36 0a 00 48 89 c7 e8 ?? ?? ?? ?? 48 89 c3 49 89 e4 49 83 c4 f0 4c 89 e4 48 89 e0 48 83 c0 b0 48 89 c4 48 89 e1 48 83 c1 b0 48 89 cc}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Pirrit_AC_MTB_0
{
    meta:
        author = "defender2yara"
        detection_name = "Pirrit.AC!MTB"
        threat_id = "443068"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_MACHOHSTR_EXT"
        threshold = "2"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {48 8b 0d 94 1d 04 00 48 31 c1 48 89 0d 95 1d 04 00 8a 0d 8c 1d 04 00 80 f1 17 88 0d 8e 1d 04 00 8a 0d 89 1d 04 00 80 f1 bf 88 0d 8a 1d 04 00 ff 25 01 39 04 00}  //weight: 1, accuracy: High
        $x_1_2 = {31 ff be 0a 00 00 00 e8 7c 52 03 00 48 8d 35 38 18 04 00 48 89 c7 e8 73 52 03 00 49 89 c4 31 ff be 0a 00 00 00 e8 5e 52 03 00 48 8d 35 fc 17 04 00 48 89 c7 e8 55 52 03 00}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Bundlore_C_MTB_0
{
    meta:
        author = "defender2yara"
        detection_name = "Bundlore.C!MTB"
        threat_id = "443670"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_MACHOHSTR_EXT"
        threshold = "2"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {55 48 89 e5 41 56 53 49 89 f6 48 8b 05 ef 2d 00 00 ff e0}  //weight: 1, accuracy: High
        $x_1_2 = {31 c9 85 c0 0f 94 c1 48 8d 05 ?? 2d 00 00 ff 24 c8 ff 25 ?? 2d 00 00}  //weight: 1, accuracy: Low
        $x_1_3 = {48 89 df e8 ?? ?? 00 00 ff 25 ?? ?? 00 00 31 c0 5b 41 5e 5d c3}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (2 of ($x*))
}

rule Adload_R_MTB_0
{
    meta:
        author = "defender2yara"
        detection_name = "Adload.R!MTB"
        threat_id = "443996"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_MACHOHSTR_EXT"
        threshold = "2"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {4c 01 f2 c6 02 26 49 8b 86 08 28 00 00 41 c6 44 06 01 71 49 8b 86 08 28 00 00 41 c6 44 06 02 75 49 8b 86 08 28 00 00 41 c6 44 06 03 6f 49 8b 86 08 28 00 00 41 c6 44 06 04 74 49 8b 86 08 28 00 00 41 c6 44 06 05 3b 49 83 86 08 28 00 00 06 8a 0b 49 89 dc 4c 89 e6 84 c9}  //weight: 1, accuracy: High
        $x_1_2 = {31 c0 48 89 43 28 48 89 43 30 48 89 43 38 31 c0 80 bb 92 01 00 00 00 0f 94 c0 b9 68 00 00 00 ba 40 00 00 00 48 0f 44 d1 48 c1 e0 04 48 8b 0c 13 48 8b 74 03 60 48 01 ce 48 89 4b 10 4c 8d 7b 18 48 89 73 18 48 89 73 20 c7 83 8c 01 00 00 08 00 00 00 b0 01}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Adload_AC_MTB_0
{
    meta:
        author = "defender2yara"
        detection_name = "Adload.AC!MTB"
        threat_id = "445454"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_MACHOHSTR_EXT"
        threshold = "2"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {55 48 89 e5 48 8b 77 08 8b 57 10 48 8b 3f e8 db 30 21 00 85 c0 7d 09 e8 cc 30 21 00 8b 00 f7 d8}  //weight: 1, accuracy: High
        $x_1_2 = {55 48 89 e5 48 89 fb 48 8b 3b 48 8b 73 08 8b 53 10 8b 4b 14 44 8b 43 18 44 8b 4b 1c e8 af 2d 21 00 31 d2 48 83 f8 ff 75 0a e8 5a 2d 21 00 48 63 10 31 c0}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Pirrit_CK_MTB_0
{
    meta:
        author = "defender2yara"
        detection_name = "Pirrit.CK!MTB"
        threat_id = "446405"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_MACHOHSTR_EXT"
        threshold = "2"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {49 74 91 52 69 61 bf 72 1f 01 09 6b e8 17 9f 1a 08 01 00 12 e8 17 04 b9 e8 0f 42 f9 e9 17 44 b9 29 7d 40 93 0a 01 80 d2 28 21 0a 9b 08 01 40 f9 69 27 00 90 29 41 33 91 29 01 40 b9 ca 95 91 52 aa 08 b1 72 29 01 0a 4a e9 03 09 4b 29 7d 40 93 08 01 09 8b 00 01 1f d6}  //weight: 1, accuracy: High
        $x_1_2 = {e9 bd 83 52 09 f6 b7 72 1f 01 09 6b e8 17 9f 1a 08 01 00 12 e8 57 02 b9 e8 2f 41 f9 e9 57 42 b9 29 7d 40 93 0a 01 80 d2 28 21 0a 9b 08 01 40 f9 69 27 00 90 29 c1 3d 91 29 01 40 b9 0a 15 9d 52 ea 80 bf 72 29 01 0a 4a e9 03 09 4b 29 7d 40 93 08 01 09 8b 00 01 1f d6}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Bundlore_D_MTB_0
{
    meta:
        author = "defender2yara"
        detection_name = "Bundlore.D!MTB"
        threat_id = "448265"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_MACHOHSTR_EXT"
        threshold = "2"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {88 05 03 11 00 00 80 35 fd 10 00 00 7e 80 35 f7 10 00 00 eb 80 35 f1 10 00 00 79 80 35 eb 10 00 00 1d 80 35 e5 10 00 00 93 80 35 df 10 00 00 4b 80 35 d9 10 00 00 af 80 35 d3 10 00 00 5c 80 35 cd 10 00 00 7a 80 35 c7 10 00 00 6e 80 35 c1 10 00 00 84 80 35 bb 10 00 00 48 80 35 b5 10 00 00 c7 80 35 af 10 00 00 2f 80 35 a9 10 00 00 99 80 35 a3 10 00 00 5b 80 35 9d 10 00 00 37 80 35 97 10 00 00 f8 80 35 91 10 00 00 fe 80 35 8b 10 00 00 47 80 35 85 10 00 00 83 80 35 7f 10 00 00 3d 80 35 79 10 00 00 22 ff 25 2b 11 00 00}  //weight: 1, accuracy: High
        $x_1_2 = {31 c9 85 c0 0f 94 c1 48 8d 05 f2 31 00 00 ff 24 c8}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Genieo_A_MTB_0
{
    meta:
        author = "defender2yara"
        detection_name = "Genieo.A!MTB"
        threat_id = "449467"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_MACHOHSTR_EXT"
        threshold = "2"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {e8 eb ea 03 00 88 45 e7 48 8b 0d a7 eb 06 00 48 8b 35 58 ca 06 00 48 89 cf e8 d2 ea 03 00 48 8b 35 b1 e1 06 00 48 89 c7 e8 c3 ea 03 00 88 45 e6 0f be 55 e7 44 0f be 45 e6 44 39 c2}  //weight: 1, accuracy: High
        $x_1_2 = {48 89 c7 e8 85 e5 03 00 88 85 97 fe ff ff 48 8b 35 9e e7 06 00 8a 85 97 fe ff ff 48 8b 3d 39 dd 06 00 48 89 bd e0 fd ff ff 48 89 f7 48 8b b5 e0 fd ff ff 0f be d0 e8 52 e5 03 00 48 8b 05 31 e6 06 00 48 8b 35 da c4 06 00 48 89 c7 e8 3c e5 03 00 48 83 f8 02}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule MaxOfferDeal_Y_MTB_0
{
    meta:
        author = "defender2yara"
        detection_name = "MaxOfferDeal.Y!MTB"
        threat_id = "451113"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_MACHOHSTR_EXT"
        threshold = "2"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {55 48 89 e5 41 56 53 49 89 f6 48 89 fb 48 83 c7 20 48 8b 76 20 ba 08 00 00 00 e8 b8 c9 01 00 48 83 c3 28 49 8b 76 28 48 89 df ba 08 00 00 00 5b 41 5e 5d e9 9f c9 01 00}  //weight: 1, accuracy: High
        $x_1_2 = {55 48 89 e5 41 57 41 56 53 50 48 89 f3 49 89 fe 48 8b 7e 20 4c 8b 3d 08 b1 02 00 41 ff d7 48 8b 7b 28 41 ff d7 49 83 c6 30 48 8b 73 30 4c 89 f7 ba 07 00 00 00 e8 a5 b1 01 00 48 8b 7b 38 4c 89 f8 48 83 c4 08 5b 41 5e 41 5f 5d ff e0}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Pirrit_W_MTB_0
{
    meta:
        author = "defender2yara"
        detection_name = "Pirrit.W!MTB"
        threat_id = "456160"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_MACHOHSTR_EXT"
        threshold = "2"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {8a 05 42 29 02 00 8d 0c 00 80 e1 a8 04 54 0f b6 15 32 29 02 00 66 0f 6e ca 0f b6 c0 66 0f 3a 20 c8 01 66 0f 6e 05 21 29 02 00 66 0f 6f d1 66 0f 3a 20 15 11 29 02 00 02 66 0f 3a 20 15 08 29 02 00 03 66 0f 62 d0 0f b6 c1 66 0f 6f 05 dc a7 00 00 66 0f ef d0 66 0f 3a 20 c0 01 66 0f f8 c8 0f 28 05 c7 40 00 00 66 0f 38 10 ca 66 0f d6 0d e2 28 02 00 0f b7 05 df 25 02 00 66 0f 6e c8 66 0f 6e 05 d6 25 02 00 8a 05 d4 25 02 00 89 c1 f6 d1 0c 1b 66 0f 3a 20 0d bf 25 02 00 02 80 c9 e4 66 0f 60 c1 66 0f 38 00 05 31 40 00 00 20 c1}  //weight: 1, accuracy: High
        $x_1_2 = {66 0f 3a 20 c1 03 80 e2 64 0f b6 c0 66 0f 3a 20 c0 04 0f b6 c2 66 0f 3a 20 c0 05 66 0f f8 c8 0f 28 05 0b 7f 03 00 66 0f 38 10 ca 66 0f d6 0d e3 78 04 00 8a 05 c5 78 04 00 34 6c 88 05 dd 78 04 00 8a 05 b8 78 04 00 34 9e 88 05 d0 78 04 00 8a 05 ab 78 04 00 34 c0 88 05 c3 78 04 00 8a 05 9e 78 04 00 8d 0c 00 80 e1 8e 28 c8 04 c7 88 05 ae 78 04 00 66 0f 6e 0d b7 78 04 00 8a 15 b5 78 04 00 8d 04 12 80 c2 73 f3 0f 7e 05 aa 78 04 00}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Pirrit_Y_MTB_0
{
    meta:
        author = "defender2yara"
        detection_name = "Pirrit.Y!MTB"
        threat_id = "464165"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_MACHOHSTR_EXT"
        threshold = "2"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {9c d4 00 00 34 60 88 05 9a d4 00 00 8a 05 8f d4 00 00 8d 0c 00 80 e1 6a 28 c8 04 35 88 05 85 d4 00 00 8a 05 7a d4 00 00 34 ec 88 05 78 d4 00 00 8a 05 6d d4 00 00 89 c1 f6 d1 80 c9 21 0c de 20 c8 88 05 62 d4 00 00 8a 05 5d d4 00 00 34 2b}  //weight: 1, accuracy: High
        $x_1_2 = {80 e1 58 28 c8 04 2c 88 05 f9 d0 00 00 8a 05 e8 d0 00 00 34 6e 88 05 ec d0 00 00 b8 3b d4 82 1b 33 05 e2 d0 00 00 89 05 ec d0 00 00 8a 05 da d0 00 00 34 09 88 05 e2 d0 00 00 8a 05 cd d0 00 00 34 91 88 05 d5 d0 00 00 8a 05 c0 d0 00 00 88 05 ca d0 00 00 8a 05 b5 d0 00 00 34 d3}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule SAgnt_C_MTB_0
{
    meta:
        author = "defender2yara"
        detection_name = "SAgnt.C!MTB"
        threat_id = "466766"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_MACHOHSTR_EXT"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "fireTweakTuneupHit:forTheProduct:toProductId:fromProductId" ascii //weight: 1
        $x_1_2 = "goToTweakAndTuneup" ascii //weight: 1
        $x_1_3 = "/Applications/Disk Clean Pro.app" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule TuneupMyMac_A_MTB_0
{
    meta:
        author = "defender2yara"
        detection_name = "TuneupMyMac.A!MTB"
        threat_id = "466767"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_MACHOHSTR_EXT"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "gotToTuneupMyMac" ascii //weight: 1
        $x_1_2 = "/Applications/Smart Mac Care.app" ascii //weight: 1
        $x_1_3 = "lblPKMacUpdtTitle" ascii //weight: 1
        $x_1_4 = "/Applications/iPhotoDuplicateCleaner.app" ascii //weight: 1
        $x_1_5 = "lblDuplicatePhotoFixer" ascii //weight: 1
        $x_1_6 = "Developer ID Application: Systweak Software Private Limited" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (3 of ($x*))
}

rule Pirrit_Z_MTB_0
{
    meta:
        author = "defender2yara"
        detection_name = "Pirrit.Z!MTB"
        threat_id = "466768"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_MACHOHSTR_EXT"
        threshold = "2"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {80 e2 e2 28 d1 80 c1 f1 88 0d 4e fd 01 00 8a 0d 29 fd 01 00 8d 14 09 80 e2 24 28 d1 80 c1 92 88 0d 38 fd 01 00 0f 28 05 12 fd 01 00 0f 57 05 5b 7e 01 00 f3 0f 11 05 23 fd 01 00 8a 0d 01 fd 01 00 8d 14 09 80 e2 be 28 d1 80 c1 5f 88 0d 10 fd 01 00 b9 ce c3 99 50 33 0d e6 fc 01 00 89 0d 00 fd 01 00 8a 0d de fc 01 00 80 f1 e3 88 0d f5 fc 01 00 8a 0d d0 fc 01 00 80 f1 6f}  //weight: 1, accuracy: High
        $x_1_2 = {8a 05 97 30 01 00 34 a6 88 05 97 30 01 00 8a 05 8a 30 01 00 8d 0c 00 80 e1 d4 28 c8 04 6a 88 05 82 30 01 00 8a 05 75 30 01 00 34 fa 88 05 75 30 01 00 8a 05 68 30 01 00 34 ae 88 05 68 30 01 00 8a 05 5b 30 01 00 8d 0c 00 28 c8 04 7f 88 05 56 30 01 00 8a 05 49 30 01 00 34 ea 88 05 49 30 01 00 8a 05 3c 30 01 00 88 05 3e 30 01 00}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule WsTunnel_A_0
{
    meta:
        author = "defender2yara"
        detection_name = "WsTunnel.A"
        threat_id = "472891"
        severity = "Mid"
        signature_type = "SIGNATURE_TYPE_MACHOHSTR_EXT"
        threshold = "60"
        strings_accuracy = "High"
    strings:
        $x_10_1 = "wsTunnelClient" ascii //weight: 10
        $x_10_2 = "wsTunnelServer" ascii //weight: 10
        $x_10_3 = "reverse tunnel" ascii //weight: 10
        $x_10_4 = "HandshakePayload" ascii //weight: 10
        $x_10_5 = "USER:PASS@HOST:PORT" ascii //weight: 10
        $x_10_6 = "HTTP_UPGRADE_PATH_PREFIX" ascii //weight: 10
        $x_10_7 = "hickory-proto" ascii //weight: 10
    condition:
        (filesize < 20MB) and
        (6 of ($x*))
}

rule _PseudoThreat_40000020_0
{
    meta:
        author = "defender2yara"
        detection_name = "!PseudoThreat_40000020"
        threat_id = "1073741856"
        severity = "Low"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "40"
        strings_accuracy = "High"
    strings:
        $x_10_1 = "Client IP-IPX" ascii //weight: 10
        $x_10_2 = "0000}\\Update.exe.lzma" ascii //weight: 10
        $x_5_3 = "svchosts" ascii //weight: 5
        $x_5_4 = "Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\Run" ascii //weight: 5
        $x_5_5 = "HARDWARE\\DESCRIPTION\\System\\CentralProcessor\\0" ascii //weight: 5
        $x_5_6 = {56 69 64 65 6f 42 69 6f 73 44 61 74 65 00 00 00 53 79 73 74 65 6d 42 69 6f 73 44 61 74 65}  //weight: 5, accuracy: High
        $x_3_7 = {25 30 34 64 00 00 00 00 2d 00 00 00 25 30 34 58 00 00 00 00 7e 4d 68 7a 00}  //weight: 3, accuracy: High
    condition:
        (filesize < 20MB) and
        (
            ((2 of ($x_10_*) and 4 of ($x_5_*))) or
            (all of ($x*))
        )
}

rule _PseudoThreat_40000021_0
{
    meta:
        author = "defender2yara"
        detection_name = "!PseudoThreat_40000021"
        threat_id = "1073741857"
        severity = "Low"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {53 6f 66 74 77 61 72 65 5c (53 65 63 75 72 69|50 72 6f 74 65 63 74 69) 20 54 6f 6f 6c 73 00}  //weight: 1, accuracy: Low
        $x_1_2 = {56 69 64 65 6f 20 41 58 20 4f 62 6a 65 63 74 00}  //weight: 1, accuracy: High
        $x_1_3 = {49 6d 61 67 65 20 41 58 20 4f 62 6a 65 63 74 00}  //weight: 1, accuracy: High
        $x_1_4 = {41 74 74 65 6e 74 69 6f 6e 21 00}  //weight: 1, accuracy: High
        $x_1_5 = "if exist \"%s\" goto" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule _PseudoThreat_40000022_0
{
    meta:
        author = "defender2yara"
        detection_name = "!PseudoThreat_40000022"
        threat_id = "1073741858"
        severity = "Low"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "7"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "\\Security Tools\\x00" ascii //weight: 1
        $x_1_2 = "iesbpl.dll" ascii //weight: 1
        $x_1_3 = "if exist \"%s\" goto" ascii //weight: 1
        $x_1_4 = "216.195.*.*" ascii //weight: 1
        $x_1_5 = "66.235.*.*" ascii //weight: 1
        $x_1_6 = "205.177.*.*" ascii //weight: 1
        $x_1_7 = "funxxxporn.com" ascii //weight: 1
        $x_1_8 = "contentlocker.net" ascii //weight: 1
        $x_1_9 = "adultfilmsite.com" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (7 of ($x*))
}

rule _PseudoThreat_40000023_0
{
    meta:
        author = "defender2yara"
        detection_name = "!PseudoThreat_40000023"
        threat_id = "1073741859"
        severity = "Low"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {6c 64 72 49 6e 73 75 72 61 6e 63 65 45 76 65 6e 74 45 78 00}  //weight: 1, accuracy: High
        $x_1_2 = {4c 6f 61 64 65 72 53 74 61 72 74 65 64 5f 25 58 00}  //weight: 1, accuracy: High
        $x_1_3 = "/php/loader3/download.php" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule _PseudoThreat_40000024_0
{
    meta:
        author = "defender2yara"
        detection_name = "!PseudoThreat_40000024"
        threat_id = "1073741860"
        severity = "Low"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "420"
        strings_accuracy = "High"
    strings:
        $x_100_1 = "Attention!" ascii //weight: 100
        $x_100_2 = "Removable" ascii //weight: 100
        $x_100_3 = "reboot your computer" ascii //weight: 100
        $x_50_4 = "createtoolhelp32snapshot" ascii //weight: 50
        $x_50_5 = "del " ascii //weight: 50
        $x_10_6 = "Media-Codec" ascii //weight: 10
        $x_10_7 = ".Chl" ascii //weight: 10
        $x_10_8 = "video" ascii //weight: 10
        $n_500_9 = "SOFTWARE\\GREATIS\\REGRUN2\\" ascii //weight: -500
    condition:
        (filesize < 20MB) and
        (not (any of ($n*))) and
        (
            ((3 of ($x_100_*) and 2 of ($x_50_*) and 2 of ($x_10_*))) or
            (all of ($x*))
        )
}

rule _PseudoThreat_40000025_0
{
    meta:
        author = "defender2yara"
        detection_name = "!PseudoThreat_40000025"
        threat_id = "1073741861"
        severity = "Low"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "3"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {b8 68 58 4d 56 bb 00 00 00 00 b9 0a 00 00 00 ba 58 56 00 00 ed 81 fb 68 58 4d 56}  //weight: 1, accuracy: High
        $x_1_2 = "IESPlugin" ascii //weight: 1
        $x_2_3 = {56 68 04 01 00 00 6a 00 be ?? ?? ?? ?? 56 e8 ?? ?? ?? ?? ff 74 24 14 e8 ?? ?? ?? ?? 83 c4 10 48 78 1a 8b 4c 24 08 2b ce 8a 94 01 ?? ?? ?? ?? 32 54 24 0c 48 88 90 ?? ?? ?? ?? 79 ec 8b c6 5e c3}  //weight: 2, accuracy: Low
        $x_2_4 = {8a 08 40 84 c9 75 f9 2b c2 48 78 1c 8a 4c 24 ?? 81 ?? ?? ?? ?? ?? 8a 94 ?? ?? ?? ?? ?? 32 d1 48 88 90 ?? ?? ?? ?? 79 ee}  //weight: 2, accuracy: Low
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_2_*) and 1 of ($x_1_*))) or
            ((2 of ($x_2_*))) or
            (all of ($x*))
        )
}

rule _PseudoThreat_40000026_0
{
    meta:
        author = "defender2yara"
        detection_name = "!PseudoThreat_40000026"
        threat_id = "1073741862"
        severity = "Low"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "13"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {db 5b ba ba ff 4e db 48 b4 43 67 96 51 d3 71 28}  //weight: 1, accuracy: High
        $x_1_2 = {e7 a8 0e 15 7c a9 16 48 ad 02 48 65 ee f8 c5 ff}  //weight: 1, accuracy: High
        $x_1_3 = "NewMediaCodec.ocx" wide //weight: 1
        $x_3_4 = "NewMediaCodec.NewMediaCodecPropPage.1" wide //weight: 3
        $x_3_5 = "NewMediaCodec ControlW" ascii //weight: 3
        $x_3_6 = "CNewMediaCodecCtrl" ascii //weight: 3
        $x_3_7 = "CNewMediaCodecPropPage" ascii //weight: 3
    condition:
        (filesize < 20MB) and
        (
            ((4 of ($x_3_*) and 1 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule _PseudoThreat_40000027_0
{
    meta:
        author = "defender2yara"
        detection_name = "!PseudoThreat_40000027"
        threat_id = "1073741863"
        severity = "Low"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "36"
        strings_accuracy = "High"
    strings:
        $x_4_1 = "\\PC Drive Tool" ascii //weight: 4
        $x_1_2 = "C:\\WINDOWS\\rmvgor.dll" wide //weight: 1
        $x_1_3 = "C:\\WINDOWS\\popnetxog.dll" wide //weight: 1
        $x_1_4 = "C:\\WINDOWS\\sapnet.dll" wide //weight: 1
        $x_1_5 = "C:\\WINDOWS\\jokwmp.dll" wide //weight: 1
        $x_10_6 = "ShellServiceObjectDelayLoad" wide //weight: 10
        $x_10_7 = "HTTPClient" ascii //weight: 10
        $x_10_8 = "software\\software\\products" ascii //weight: 10
    condition:
        (filesize < 20MB) and
        (
            ((3 of ($x_10_*) and 1 of ($x_4_*) and 2 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule _PseudoThreat_40000028_0
{
    meta:
        author = "defender2yara"
        detection_name = "!PseudoThreat_40000028"
        threat_id = "1073741864"
        severity = "Low"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "11"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = "if exist \"%s\" goto " ascii //weight: 1
        $x_1_2 = "if exist \"C:\\myapp.exe\" goto " ascii //weight: 1
        $x_1_3 = "del \"%s\"" ascii //weight: 1
        $x_1_4 = "del \"C:\\myapp.exe\"" ascii //weight: 1
        $x_1_5 = "%s%i.bat" ascii //weight: 1
        $x_1_6 = {64 65 6c 20 22 43 3a 5c 54 45 4d 50 5c [0-4] 2e 62 61 74}  //weight: 1, accuracy: Low
        $x_1_7 = "cmd /c start /min" ascii //weight: 1
        $x_1_8 = "modem" ascii //weight: 1
        $x_1_9 = "RASAPI32.dll" ascii //weight: 1
        $x_1_10 = "SOFTWARE\\Casiop" ascii //weight: 1
        $x_1_11 = "GetAdaptersInfo" ascii //weight: 1
        $x_1_12 = "RasEnumDevicesA" ascii //weight: 1
        $x_1_13 = "ShellExecuteA" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (11 of ($x*))
}

rule _PseudoThreat_40000029_0
{
    meta:
        author = "defender2yara"
        detection_name = "!PseudoThreat_40000029"
        threat_id = "1073741865"
        severity = "Low"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "IESPlugin" ascii //weight: 1
        $x_1_2 = "ToolbarWindow32" ascii //weight: 1
        $x_1_3 = "Software\\Microsoft\\Internet Explorer\\Toolbar" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule _PseudoThreat_4000002a_0
{
    meta:
        author = "defender2yara"
        detection_name = "!PseudoThreat_4000002a"
        threat_id = "1073741866"
        severity = "Low"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "36"
        strings_accuracy = "High"
    strings:
        $x_10_1 = "/search.php?qq=%s" ascii //weight: 10
        $x_10_2 = {43 4c 41 46 2e 64 6c 6c 00 44 6c 6c 43 61 6e 55 6e 6c 6f 61 64 4e 6f 77 00 44 6c 6c 47 65 74 43 6c 61 73 73 4f 62 6a 65 63 74 00 44 6c 6c 52 65 67 69 73 74 65 72 53 65 72 76 65 72 00}  //weight: 10, accuracy: High
        $x_5_3 = "http://auto.search.msn.com/response.asp?MT=" wide //weight: 5
        $x_5_4 = "/search.php?qq=%s" wide //weight: 5
        $x_5_5 = {72 65 6c 65 61 73 65 00}  //weight: 5, accuracy: High
        $x_1_6 = "{5DDE5591-A8AB-4897-93EF-1E4E943F85A7}" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule _PseudoThreat_4000002b_0
{
    meta:
        author = "defender2yara"
        detection_name = "!PseudoThreat_4000002b"
        threat_id = "1073741867"
        severity = "Low"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "3"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {85 c0 75 14 68 2c 01 00 00 6a 08 ff 15 ?? ?? ?? ?? 50 ff 15 ?? ?? ?? ?? 56 8b 74 24 08 8a 16 84 d2 a3 ?? ?? ?? ?? 8b c8 74 10 2b f0 32 54 24 0c 88 11 41 8a 14 0e 84 d2 75 f2 c6 01 00 5e c3}  //weight: 1, accuracy: Low
        $x_1_2 = {46 69 6e 64 43 6c 6f 73 65 55 72 6c 43 61 63 68 65 00 00 00 46 69 6e 64 46 69 72 73 74 55 72 6c 43 61 63 68 65 45 6e 74 72 79 41 00}  //weight: 1, accuracy: High
        $x_1_3 = {47 65 74 46 69 6c 65 56 65 72 73 69 6f 6e 49 6e 66 6f 41 00 47 65 74 46 69 6c 65 56 65 72 73 69 6f 6e 49 6e 66 6f 53 69 7a 65 41 00}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule _PseudoThreat_4000002c_0
{
    meta:
        author = "defender2yara"
        detection_name = "!PseudoThreat_4000002c"
        threat_id = "1073741868"
        severity = "Low"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {56 41 43 2e 56 69 64 65 6f 00}  //weight: 1, accuracy: High
        $x_1_2 = {72 6c 65 2e 64 6c 6c 00}  //weight: 1, accuracy: High
        $x_1_3 = "elr" wide //weight: 1
        $x_1_4 = {46 69 6e 64 43 6c 6f 73 65 55 72 6c 43 61 63 68 65 00 00 00 46 69 6e 64 46 69 72 73 74 55 72 6c 43 61 63 68 65 45 6e 74 72 79 41 00}  //weight: 1, accuracy: High
        $x_1_5 = {47 65 74 46 69 6c 65 56 65 72 73 69 6f 6e 49 6e 66 6f 41 00 47 65 74 46 69 6c 65 56 65 72 73 69 6f 6e 49 6e 66 6f 53 69 7a 65 41 00}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (4 of ($x*))
}

rule _PseudoThreat_4000002d_0
{
    meta:
        author = "defender2yara"
        detection_name = "!PseudoThreat_4000002d"
        threat_id = "1073741869"
        severity = "Low"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "36"
        strings_accuracy = "Low"
    strings:
        $x_10_1 = "InternetReadFile" ascii //weight: 10
        $x_10_2 = "OpenEventW" ascii //weight: 10
        $x_10_3 = "Netbios" ascii //weight: 10
        $x_3_4 = {68 00 74 00 74 00 70 00 3a 00 2f 00 2f 00 74 00 68 00 65 00 6e 00 6d 00 65 00 74 00 77 00 6f 00 72 00 6b 00 63 00 6f 00 2e 00 63 00 6f 00 6d 00 2f 00 64 00 77 00 2e 00 70 00 68 00 70 00}  //weight: 3, accuracy: Low
        $x_2_5 = "?code=00-00-00-00-00-00&hash=" wide //weight: 2
        $x_1_6 = "bx18dxv.dat" wide //weight: 1
        $x_1_7 = "bx18dxv.dat" ascii //weight: 1
        $x_2_8 = "MyBITSTrans_new" wide //weight: 2
    condition:
        (filesize < 20MB) and
        (
            ((3 of ($x_10_*) and 2 of ($x_2_*) and 2 of ($x_1_*))) or
            ((3 of ($x_10_*) and 1 of ($x_3_*) and 1 of ($x_2_*) and 1 of ($x_1_*))) or
            ((3 of ($x_10_*) and 1 of ($x_3_*) and 2 of ($x_2_*))) or
            (all of ($x*))
        )
}

rule _PseudoThreat_4000002e_0
{
    meta:
        author = "defender2yara"
        detection_name = "!PseudoThreat_4000002e"
        threat_id = "1073741870"
        severity = "Low"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "41"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "{E99D4D0C-EB54-46AF-B62A-3AA1F31D53E5}" ascii //weight: 1
        $x_1_2 = "{ABF529BE-6245-465A-BBD4-238C4EAB0F0A}" ascii //weight: 1
        $x_1_3 = "{F17B1418-2C0C-4295-BD55-BCDD3C730FBE}" ascii //weight: 1
        $x_1_4 = "{D1413F77-5B69-4562-84E1-78F997794E9D}" ascii //weight: 1
        $x_1_5 = "{899B0EF2-E0BE-41BA-BB41-0ABFB232813C}" ascii //weight: 1
        $x_10_6 = "netadv.ToolBar.1" ascii //weight: 10
        $x_10_7 = {6e 65 74 61 64 76 2e 64 6c 6c 00 64 6c 6c 63 61 6e 75 6e 6c 6f 61 64 6e 6f 77 00 64 6c 6c 67 65 74 63 6c 61 73 73 6f 62 6a 65 63 74 00 64 6c 6c 72 65 67 69 73 74 65 72 73 65 72 76 65 72 00 64 6c 6c 75 6e 72 65 67 69 73 74 65 72 73 65 72 76 65 72 00 00}  //weight: 10, accuracy: High
        $x_10_8 = "netadv.dll" wide //weight: 10
        $x_10_9 = "netadvTOOLBAR" wide //weight: 10
        $x_10_10 = "writefile" ascii //weight: 10
    condition:
        (filesize < 20MB) and
        (
            ((4 of ($x_10_*) and 1 of ($x_1_*))) or
            ((5 of ($x_10_*))) or
            (all of ($x*))
        )
}

rule _PseudoThreat_40000031_0
{
    meta:
        author = "defender2yara"
        detection_name = "!PseudoThreat_40000031"
        threat_id = "1073741873"
        severity = "Low"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {64 6e 73 64 75 65 70 61 67 65 2e 63 6f 6d 00 25 73}  //weight: 1, accuracy: High
        $x_1_2 = "puresafetyhere.com/search.php?qq=%s" wide //weight: 1
        $x_1_3 = "{C2A1C5CB-C0EF-4689-9436-F62CCA1C5383}" wide //weight: 1
        $x_1_4 = {25 00 73 00 73 00 3a 00 2f 00 2f 00 25 00 73 00 5c 00 73 00 68 00 64 00 6f 00 25 00 73 00 25 00 73 00 72 00 72 00 25 00 73 00 25 00 73 00 00 00 72 00 65 00 00 00 00 00 63 00 6c 00 63 00 2e 00 64 00 00 00 6c 00 6c 00 2f 00 64 00 6e 00 73 00 65 00 00 00 6f 00 72 00 00 00 00 00 2e 00 68 00 74 00 6d 00 00 00 00 00 72 00 65 00 73 00 3a 00 2f 00 2f 00 25 00 73 00 5c 00 73 00 25 00 73 00 25 00 73 00 25 00 73 00 30 00 34 00 2e 00 68 00 74 00 6d 00}  //weight: 1, accuracy: High
        $x_1_5 = {26 00 73 00 72 00 63 00 68 00 3d 00 00 00 00 00 3f 00 4d 00 54 00 3d 00 00 00 00 00 65 00 2e 00 61 00 73 00 70 00 3f 00 4d 00 54 00 3d 00 00 00 70 00 6f 00 6e 00 73 00 00 00 00 00 73 00 6e 00 2e 00 63 00 6f 00 6d 00 2f 00 72 00 65 00 73 00 00 00 00 00 61 00 72 00 63 00 68 00 2e 00 6d 00 00 00 00 00 61 00 75 00 74 00 6f 00 2e 00 73 00 65 00 00 00 68 00 74 00 74 00 70 00 3a 00 2f 00 2f 00}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (4 of ($x*))
}

rule __PUA_Block_FusionCore_0
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:FusionCore"
        threat_id = "1879048193"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "Fusion.dll" ascii //weight: 2
        $x_2_2 = "FUS_SHOWOFFERS" ascii //weight: 2
        $x_2_3 = "FUS_NEXTOFFER" ascii //weight: 2
        $x_2_4 = "FUS_INSTALLOFFERS" ascii //weight: 2
        $x_2_5 = "FUS_SETMAINPRODUCTSTATUS" ascii //weight: 2
        $x_2_6 = "FUS_WAITANDFREEDLL" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (3 of ($x*))
}

rule __PUA_Block_FusionCore_1
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:FusionCore"
        threat_id = "1879048193"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "13"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Fusion.dll" ascii //weight: 1
        $x_1_2 = "FreeOffers" ascii //weight: 1
        $x_1_3 = "GetOffersProgress" ascii //weight: 1
        $x_1_4 = "GetOffersStatus" ascii //weight: 1
        $x_1_5 = "HelperHideIcon" ascii //weight: 1
        $x_1_6 = "HelperSyncThread" ascii //weight: 1
        $x_1_7 = "InitOffers" ascii //weight: 1
        $x_1_8 = "InstallOffers" ascii //weight: 1
        $x_1_9 = "IsLoaded" ascii //weight: 1
        $x_1_10 = "NextOffer" ascii //weight: 1
        $x_1_11 = "SetMainProductStatus" ascii //weight: 1
        $x_1_12 = "SetOffersWindow" ascii //weight: 1
        $x_1_13 = "ShowOffers" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_FusionCore_2
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:FusionCore"
        threat_id = "1879048193"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "11"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Fusion.dll" ascii //weight: 1
        $x_1_2 = "FUS_GetOfferCaptionA" ascii //weight: 1
        $x_1_3 = "FUS_GetOffersProgress" ascii //weight: 1
        $x_1_4 = "FUS_HideOffers" ascii //weight: 1
        $x_1_5 = "FUS_InstallOffers" ascii //weight: 1
        $x_1_6 = "FUS_NextOffer" ascii //weight: 1
        $x_1_7 = "FUS_SetMainProductStatus" ascii //weight: 1
        $x_1_8 = "FUS_SetOffersWindow" ascii //weight: 1
        $x_1_9 = "FUS_ShowOffers" ascii //weight: 1
        $x_1_10 = "FUS_WaitAndFreeDll" ascii //weight: 1
        $x_1_11 = "FUS_WaitForOffersToBeReady" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_FusionCore_3
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:FusionCore"
        threat_id = "1879048193"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "7"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "Fusion.dll" wide //weight: 2
        $x_2_2 = "\\Temp\\Fusion_ld\\" wide //weight: 2
        $x_2_3 = "showOffer end" wide //weight: 2
        $x_1_4 = "download_acceptOffer" wide //weight: 1
        $x_1_5 = "Zhi\\LDPlayer" wide //weight: 1
        $x_1_6 = "\\downloader\\bin\\ldplayerinst.pdb" ascii //weight: 1
        $x_5_7 = "d2janltnicv7uh.cloudfront.net/LDPlayer" ascii //weight: 5
        $x_2_8 = "WinApiDecryptFileFusion" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (
            ((2 of ($x_2_*) and 3 of ($x_1_*))) or
            ((3 of ($x_2_*) and 1 of ($x_1_*))) or
            ((4 of ($x_2_*))) or
            ((1 of ($x_5_*) and 2 of ($x_1_*))) or
            ((1 of ($x_5_*) and 1 of ($x_2_*))) or
            (all of ($x*))
        )
}

rule __PUA_Block_FusionCore_4
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:FusionCore"
        threat_id = "1879048193"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "Fusion.dll" ascii //weight: 2
        $x_1_2 = "ImgBurn" ascii //weight: 1
        $x_1_3 = "ioSpecial.ini" ascii //weight: 1
        $x_1_4 = "www.imgburn.com" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_FusionCore_5
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:FusionCore"
        threat_id = "1879048193"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "Fusion.dll" ascii //weight: 2
        $x_1_2 = "Bededafo" ascii //weight: 1
        $x_1_3 = "Hopuk" ascii //weight: 1
        $x_1_4 = "Mamirofepi" ascii //weight: 1
        $x_1_5 = "Nonome" ascii //weight: 1
        $x_1_6 = "Pasek" ascii //weight: 1
        $x_1_7 = "Somop" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((5 of ($x_1_*))) or
            ((1 of ($x_2_*) and 3 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule __PUA_Block_FusionCore_6
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:FusionCore"
        threat_id = "1879048193"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "Fusion.dll" ascii //weight: 2
        $x_1_2 = "dl4j2il4tdu3m.cloudfront.net/BigNox/Fusion.zip" ascii //weight: 1
        $x_1_3 = "slot_install_offer" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_FusionCore_7
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:FusionCore"
        threat_id = "1879048193"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "Fusion.dll" ascii //weight: 2
        $x_1_2 = "nox_fusion" ascii //weight: 1
        $x_2_3 = "dl4j2il4tdu3m.cloudfront.net/BigNox" ascii //weight: 2
        $x_1_4 = "show offer" ascii //weight: 1
        $x_1_5 = "Temp\\Fusion_nox" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_2_*) and 2 of ($x_1_*))) or
            ((2 of ($x_2_*))) or
            (all of ($x*))
        )
}

rule __PUA_Block_FusionCore_8
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:FusionCore"
        threat_id = "1879048193"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {64 6c 6c 3a 73 65 74 75 70 3a 66 69 6c 65 73 3a [0-15] 2e 64 6c 6c}  //weight: 1, accuracy: Low
        $x_1_2 = "dll:files:itdownload.dll" ascii //weight: 1
        $x_1_3 = "RUNRKVERIFY" ascii //weight: 1
        $x_1_4 = "SetupLdr.exe" ascii //weight: 1
        $x_1_5 = "unknowndll.pdb" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_FusionCore_9
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:FusionCore"
        threat_id = "1879048193"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "free fusindll start" ascii //weight: 1
        $x_1_2 = "FUS_InitDll start" ascii //weight: 1
        $x_1_3 = "funsion_dll_initerror" ascii //weight: 1
        $x_1_4 = "recommended for your computer" ascii //weight: 1
        $x_1_5 = "FusionAPIImpl::releaseDLL" ascii //weight: 1
        $x_1_6 = "net/LDPlayer_IC_FS/Fusion.zip" ascii //weight: 1
        $x_1_7 = "FusionAPIImpl  showNextOffser cap %s, desc %s" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (3 of ($x*))
}

rule __PUA_Block_FusionCore_10
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:FusionCore"
        threat_id = "1879048193"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "FUSIONINITIALIZEINIT" ascii //weight: 1
        $x_1_2 = "FUSIONINITIALIZEWIZARD" ascii //weight: 1
        $x_1_3 = "FUSIONSHOULDSKIPPAGE" ascii //weight: 1
        $x_1_4 = "FUSIONCURPAGECHANGED" ascii //weight: 1
        $x_1_5 = "FUSIONDEINITIALIZESETUP" ascii //weight: 1
        $x_1_6 = "FUSIONSETOFFERSPAGEBACKGROUND" ascii //weight: 1
        $x_1_7 = "FUSIONWAITFOROFFER" ascii //weight: 1
        $x_1_8 = "FUSIONREPORTINSTALLATIONERROR" ascii //weight: 1
        $x_1_9 = "FUSIONGETOFFERSPROGRESS" ascii //weight: 1
        $x_1_10 = "Recommended for your computer" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (3 of ($x*))
}

rule __attrmatch_rescan_psif_0
{
    meta:
        author = "defender2yara"
        detection_name = "!#attrmatch_rescan_psif"
        threat_id = "1879048195"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {8b 40 28 83 c0 0e 66 8b 00 66 3b 45 e6 0f 84}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __attrmatch_rescan_psif_1
{
    meta:
        author = "defender2yara"
        detection_name = "!#attrmatch_rescan_psif"
        threat_id = "1879048195"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {8b 43 28 83 c0 ?? 66 8b 00 66 3b 45 e6 0f 84 4e 02 00 00}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __attrmatch_rescan_psif_2
{
    meta:
        author = "defender2yara"
        detection_name = "!#attrmatch_rescan_psif"
        threat_id = "1879048195"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "11"
        strings_accuracy = "Low"
    strings:
        $x_10_1 = {0f 31 89 c3 0f 31 29 d8 77 fa}  //weight: 10, accuracy: High
        $x_1_2 = {e8 00 00 00 00 58 89 45 ?? c6 45 ?? 59 c6 45 ?? 2a c6 45 ?? 38}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __attrmatch_rescan_psif_3
{
    meta:
        author = "defender2yara"
        detection_name = "!#attrmatch_rescan_psif"
        threat_id = "1879048195"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {51 c7 45 fc 02 00 00 00 e8 ?? ?? ?? ?? 85 c0 74 04 83 45 fc 06 8b 45 fc ff 14 85}  //weight: 1, accuracy: Low
        $x_1_2 = {51 c7 45 fc 02 00 00 00 e8 ?? ?? ?? ?? 85 c0 74 09 8b 45 fc 83 c0 06 89 45 fc 8b 4d fc ff 14 8d}  //weight: 1, accuracy: Low
        $x_1_3 = {51 c7 04 24 02 00 00 00 e8 ?? ?? ?? ?? 85 c0 74 09 8b 04 24 83 c0 06 89 04 24 8b 0c 24 ff 14 8d}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (1 of ($x*))
}

rule __attrmatch_rescan_psif_4
{
    meta:
        author = "defender2yara"
        detection_name = "!#attrmatch_rescan_psif"
        threat_id = "1879048195"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {56 69 72 41 6c 6c 78 00 6d 79 61 70 70 2e 65 78 65}  //weight: 1, accuracy: High
        $x_1_2 = {6d 79 61 70 70 2e 65 78 65 00 00 00 71 65 6d 75}  //weight: 1, accuracy: High
        $x_1_3 = {01 46 46 46 1f 5c 5c 5c 69 68 67 68 b9 73 72 73}  //weight: 1, accuracy: High
        $x_1_4 = {6d 79 61 70 70 2e 65 78 65 00 00 00 73 52 61 53}  //weight: 1, accuracy: High
        $x_1_5 = {6d 79 61 70 70 2e 65 78 65 00 00 00 00 53 00 4f 00 46 ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? 61 00 76 00 61 00 73 00 74}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (1 of ($x*))
}

rule __attrmatch_rescan_psif_5
{
    meta:
        author = "defender2yara"
        detection_name = "!#attrmatch_rescan_psif"
        threat_id = "1879048195"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {64 8b 1d 30 00 00 00 89 5d fc 8b 45 fc 8b 40 0c 8b 70 0c 66 c7 45 ?? 70 00 66 c7 45 ?? 6d 00 66 c7 45 ?? 62 00 8b 46 28}  //weight: 1, accuracy: Low
        $x_1_2 = {e8 00 00 00 00 58 89 45 ?? c6 45 ?? 59 c6 45 ?? 2a c6 45 ?? 38 33 (c0 40|d2 42) 8b (4d|75) 00}  //weight: 1, accuracy: Low
        $x_1_3 = {66 8b 00 66 3b 85 ?? ?? ff ff 74 16 8b 45 ?? 8b 40 28 83 c0 06 66 8b 00 66 3b 85 ?? ?? ff ff 75 01 c3}  //weight: 1, accuracy: Low
        $x_1_4 = {64 8b 15 30 00 00 00 89 55 fc 8b 45 fc 8b 40 0c 8b 48 0c 66 c7 85 ?? ?? ff ff ?? 00 66 c7 85 ?? ?? ff ff ?? 00 8b 41 28}  //weight: 1, accuracy: Low
        $x_1_5 = {8b 5e 28 8b f8 03 ff 03 df 66 8b 1b 66 89 19 40 83 c1 02 4a 75 ea}  //weight: 1, accuracy: High
        $x_1_6 = {8b 43 28 8b d0 83 c2 ?? 66 8b 12 66 3b 55 ?? 0f 84 ?? ?? ?? ?? 83 c0 ?? 66 8b 00 66 3b 45 ?? 0f 84}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (1 of ($x*))
}

rule __attrmatch_rescan_psif_6
{
    meta:
        author = "defender2yara"
        detection_name = "!#attrmatch_rescan_psif"
        threat_id = "1879048195"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {ff d7 c6 45 ?? 43 c6 45 ?? 6d c6 45 ?? 61 c6 45 ?? 2e 8a 85 ?? ?? ff ff 3a 45 ?? 75 ?? 8a 85 ?? ?? ff ff 3a 45 ?? 75 ?? 8a 85 ?? ?? ff ff 3a 45 ?? 75 ?? 8a 85 ?? ?? ff ff 3a 45 ?? 75}  //weight: 1, accuracy: Low
        $x_1_2 = {66 8b 09 66 8b 55 ?? 66 3b ca 75 1d 00 66 c7 45 ?? 70 00 66 c7 45 ?? 6d 00 66 c7 45 ?? 62 00 8b 45 ?? 8b 40 ?? 8b c8 83 c1 0c}  //weight: 1, accuracy: Low
        $x_1_3 = {64 8b 05 30 00 00 00 89 45 ?? 8b 45 ?? 8b 40 0c 8b 70 0c 66 c7 45 ?? 6d 00 66 c7 45 ?? 61 00 8b 46 28 8b d0 83 c2 06 66 8b 12 66 3b 55 ?? 75}  //weight: 1, accuracy: Low
        $x_1_4 = {64 8b 15 30 00 00 00 89 55 ?? 8b 45 ?? 8b 40 0c 8b 48 0c 66 c7 85 ?? ?? ff ff (6d|79|61|70|70) 00 66 c7 85 ?? ?? ff ff (6d|79|61|70|70) 00 8b 41 28 8b d0 83 c2 ?? 66 8b 12 66 3b 95 ?? ?? ff ff 75}  //weight: 1, accuracy: Low
        $x_1_5 = {64 8b 15 30 00 00 00 89 55 ?? 8b 45 ?? 8b 40 0c 8b 48 0c 66 c7 85 ?? ?? ?? ?? 61 00 66 c7 85 ?? ?? ?? ?? 79 00 66 c7 85 ?? ?? ?? ?? 70 00 8b 41 28 8b d0 83 c2 ?? 66 8b 12 66 3b 95 ?? ?? ff ff 75}  //weight: 1, accuracy: Low
        $x_1_6 = {64 8b 15 30 00 00 00 89 55 ?? 8b 45 ?? 8b 40 0c 8b 48 0c 66 c7 85 ?? ?? ?? ?? 70 00 8b 41 28 8b d0 83 c2 ?? 66 8b 12 66 3b 95 ?? ?? ?? ?? 75}  //weight: 1, accuracy: Low
        $x_1_7 = {6d 00 66 c7 45 ?? 61 00 66 c7 45 ?? 78 00 8b 45 ?? 8b 40 28 8b d0 83 c2 06 66 8b 12 66 3b 55 ?? 75 1b 8b d0 83 c2 ?? 66 8b 12 66 3b 55 ?? 75}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (1 of ($x*))
}

rule __PUA_Block_InstallCore_0
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:InstallCore"
        threat_id = "1879048197"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {89 e2 89 32 b9 ?? ?? ?? ?? 89 ca 68 ?? ?? ?? ?? 5a 31 d1 8b 31 8b d6 31 c2 89 13 81 c1 ?? ?? ?? ?? ba ?? ?? ?? ?? 03 da bf ?? ?? ?? ?? 8b d7 68 ?? ?? ?? ?? 5a 33 fa 31 cf 81 cf ?? ?? ?? ?? 0f 85 ?? ?? ?? ?? c3}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_InstallCore_1
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:InstallCore"
        threat_id = "1879048197"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {89 c2 81 c2 ?? ?? ?? ?? ff ca 8b 4a ?? 33 cb 89 0f ba ?? ?? ?? ?? 03 c2 c7 c1 ?? ?? ?? ?? 03 f9 c7 c1 ?? ?? ?? ?? 8b d1 68 ?? ?? ?? ?? 5a 33 ca 31 c1 c7 c6 ?? ?? ?? ?? ba ?? ?? ?? ?? c1 ea ?? 31 d6 29 f1 0f 85}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_InstallCore_2
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:InstallCore"
        threat_id = "1879048197"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "rp.Dadafarada.com" ascii //weight: 2
        $x_1_2 = "SKIP_OFFER" ascii //weight: 1
        $x_1_3 = "offer_html.html" ascii //weight: 1
        $x_1_4 = "www.xs4all.nl" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_InstallCore_3
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:InstallCore"
        threat_id = "1879048197"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "InstallCore" ascii //weight: 2
        $x_1_2 = "Installer Powered by installcore.com" ascii //weight: 1
        $x_1_3 = "team@installcore.com" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_2_*) and 1 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule __PUA_Block_InstallCore_4
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:InstallCore"
        threat_id = "1879048197"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "//www.xs4all.nl/~peterned/" ascii //weight: 1
        $x_1_2 = "//rp.Tadanadanet.com/" ascii //weight: 1
        $x_1_3 = "SPONSORED_OFFER=" ascii //weight: 1
        $x_1_4 = "BUTTON_INSTALL=Install Now" ascii //weight: 1
        $x_1_5 = "IWebBrowser" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_InstallCore_5
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:InstallCore"
        threat_id = "1879048197"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "//sciter.com/docs/content/script/Stream.htm" ascii //weight: 1
        $x_1_2 = "IC001.Resources.OfferPage.html" ascii //weight: 1
        $x_1_3 = "GenericSetup.exe.config" ascii //weight: 1
        $x_1_4 = "InstallCapital" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_InstallCore_6
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:InstallCore"
        threat_id = "1879048197"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "DOWNLOADER_MODE=EXE_INJECTED_DATA" ascii //weight: 1
        $x_1_2 = "irsoIsOperaInstalled" ascii //weight: 1
        $x_1_3 = "InstallCore" ascii //weight: 1
        $x_1_4 = "chrome.exe" ascii //weight: 1
        $x_1_5 = "Software\\Macromedia\\FlashPlayer" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_InstallCore_7
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:InstallCore"
        threat_id = "1879048197"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "os.secureddownloadcdn.com/SecuredDownload/" ascii //weight: 2
        $x_1_2 = "SHOW_SPONSORED_OFFER" ascii //weight: 1
        $x_1_3 = "SKIP_OFFER" ascii //weight: 1
        $x_1_4 = "DEFAULT_OFR_CHECKER" ascii //weight: 1
        $x_1_5 = "DEFAULT_OFR_ON_FINISH" ascii //weight: 1
        $x_1_6 = "Opera" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((5 of ($x_1_*))) or
            ((1 of ($x_2_*) and 3 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule __PUA_Block_InstallCore_8
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:InstallCore"
        threat_id = "1879048197"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "rp.coolvideoconverter.com" ascii //weight: 1
        $x_1_2 = "cdnus.coolvideoconverter.com" ascii //weight: 1
        $x_1_3 = "SKIP_OFFER" ascii //weight: 1
        $x_1_4 = "CHOOSE_DEFAULT_OFFER" ascii //weight: 1
        $x_1_5 = "operaprefs.ini" ascii //weight: 1
        $n_100_6 = "Uninst.exe" ascii //weight: -100
        $n_100_7 = "Uninstall.exe" ascii //weight: -100
    condition:
        (filesize < 20MB) and
        (not (any of ($n*))) and
        (all of ($x*))
}

rule __PUA_Block_InstallCore_9
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:InstallCore"
        threat_id = "1879048197"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "8"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "xs4all.nl/~peterned/" ascii //weight: 1
        $x_1_2 = "rp.baixakialtcdn2.com/" ascii //weight: 1
        $x_1_3 = "DEFAULT_OFR_CODE1=defaultOffer/offer_code.html" ascii //weight: 1
        $x_1_4 = "InstallCore: v5.66" ascii //weight: 1
        $x_1_5 = "opera.exe" ascii //weight: 1
        $x_1_6 = "chrome.exe" ascii //weight: 1
        $x_1_7 = "ToolBar" ascii //weight: 1
        $x_1_8 = "TaskbarCreated" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_KuaiZip_0
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:KuaiZip"
        threat_id = "1879048198"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Software\\7654Browser\\" ascii //weight: 1
        $x_1_2 = "Software\\KuaiZip\\" ascii //weight: 1
        $x_1_3 = "SuZip" ascii //weight: 1
        $x_1_4 = "XunZip" ascii //weight: 1
        $x_1_5 = "kpzip.com" ascii //weight: 1
        $x_1_6 = "7654.com/n/tui" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (5 of ($x*))
}

rule __PUA_Block_KuaiZip_1
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:KuaiZip"
        threat_id = "1879048198"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "tj.glzip.com" ascii //weight: 1
        $x_1_2 = "tj1.7654.com" ascii //weight: 1
        $x_1_3 = "xynote.shzhanmeng.com" ascii //weight: 1
        $x_1_4 = "mini_news_skin_ad.dll" ascii //weight: 1
        $x_1_5 = "kuaizipreport" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_KuaiZip_2
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:KuaiZip"
        threat_id = "1879048198"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "branches\\xiaoyuTrunk\\bin\\Release\\Win32\\Upgrade.pdb" ascii //weight: 2
        $x_1_2 = "Software\\xiaoyu\\UpdateChecker" wide //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_KuaiZip_3
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:KuaiZip"
        threat_id = "1879048198"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "7"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "http://news.7654.com/" ascii //weight: 2
        $x_2_2 = "{88F600AC-E6A8-4AE1-ACF7-73D5CAAD0943}" ascii //weight: 2
        $x_2_3 = "/smartlook/popup?code=" ascii //weight: 2
        $x_1_4 = "HKEY_CURRENT_USER\\Software\\" ascii //weight: 1
        $x_1_5 = "7654Browser" ascii //weight: 1
        $x_1_6 = "MiniNewsInfo" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((2 of ($x_2_*) and 3 of ($x_1_*))) or
            ((3 of ($x_2_*) and 1 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule __PUA_Block_KuaiZip_4
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:KuaiZip"
        threat_id = "1879048198"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_3_1 = {53 00 4f 00 46 00 54 00 57 00 41 00 52 00 45 00 5c 00 53 00 69 00 63 00 65 00 6e 00 74 00 00 00 53 00 4f 00 46 00 54 00 57 00 41 00 52 00 45 00 5c 00 47 00 6f 00 79 00 6f 00 6f 00 00 00 00 00 53 00 4f 00 46 00 54 00 57 00 41 00 52 00 45 00 5c 00 48 00 69 00 6e 00 74 00 73 00 6f 00 66 00 74 00}  //weight: 3, accuracy: High
        $x_1_2 = "SOFTWARE\\Heinote" ascii //weight: 1
        $x_1_3 = "Software\\xiaoyu" ascii //weight: 1
        $x_1_4 = "heinote.7654.com/xieyi.html" ascii //weight: 1
        $x_1_5 = "xiaoyu.shzhanmeng.com/logo" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_3_*) and 2 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule __PUA_Block_KuaiZip_5
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:KuaiZip"
        threat_id = "1879048198"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_3_1 = "down1.nanjingchenxi.com" ascii //weight: 3
        $x_2_2 = "Software\\WhirlwindPdf" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_KuaiZip_6
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:KuaiZip"
        threat_id = "1879048198"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "mediav.shzhanmeng.com" ascii //weight: 2
        $x_1_2 = "12.gif" ascii //weight: 1
        $x_1_3 = "up_urls.ini" ascii //weight: 1
        $x_1_4 = "UrlRepor" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_KuaiZip_7
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:KuaiZip"
        threat_id = "1879048198"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "KuaiZip" ascii //weight: 1
        $x_1_2 = "KuaiZip.MainWnd.Toolbar" ascii //weight: 1
        $x_1_3 = "WaitOtherKZip" ascii //weight: 1
        $x_1_4 = "KZipShell.dll" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (3 of ($x*))
}

rule __PUA_Block_KuaiZip_8
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:KuaiZip"
        threat_id = "1879048198"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "hotnews.dftoutiao.com" ascii //weight: 2
        $x_1_2 = "kuaizipreport/mininews" ascii //weight: 1
        $x_1_3 = "tianqi.eastday.com" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_KuaiZip_9
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:KuaiZip"
        threat_id = "1879048198"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "7"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "kpzip.com" ascii //weight: 2
        $x_2_2 = "KuaiZip Setup" ascii //weight: 2
        $x_1_3 = "SOFTWARE\\Sicent" ascii //weight: 1
        $x_1_4 = "SOFTWARE\\Hintsoft" ascii //weight: 1
        $x_1_5 = "SOFTWARE\\Goyoo" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_KuaiZip_10
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:KuaiZip"
        threat_id = "1879048198"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "down1.7654.com" ascii //weight: 1
        $x_1_2 = "i.kpzip.com" ascii //weight: 1
        $x_1_3 = "kuaiyamini" ascii //weight: 1
        $x_1_4 = "www.88ysg.com/templets/88ysg/ceshi3.htm" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_KuaiZip_11
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:KuaiZip"
        threat_id = "1879048198"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "KuaiZipTips2" ascii //weight: 1
        $x_1_2 = "tj.kpzip.com" ascii //weight: 1
        $x_1_3 = "hao123Juzi.exe" ascii //weight: 1
        $x_1_4 = "api.kpzip.com/showcount.php?name=" ascii //weight: 1
        $x_1_5 = "heinote" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_KuaiZip_12
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:KuaiZip"
        threat_id = "1879048198"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "//report.uchiha.ltd" ascii //weight: 1
        $x_1_2 = "down4.7654.com" ascii //weight: 1
        $x_1_3 = "d.heinote.com" ascii //weight: 1
        $x_1_4 = "Report.exe" ascii //weight: 1
        $x_1_5 = "software\\Heinote\\report" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_KuaiZip_13
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:KuaiZip"
        threat_id = "1879048198"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "kuaiyatitle" ascii //weight: 1
        $x_1_2 = "zsrckcg.xyz" ascii //weight: 1
        $x_1_3 = "hotnews.dftoutiao.com" ascii //weight: 1
        $x_1_4 = "popname=mininews" ascii //weight: 1
        $x_1_5 = "MiniDebuger" ascii //weight: 1
        $x_1_6 = "ad1.7654.com" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_KuaiZip_14
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:KuaiZip"
        threat_id = "1879048198"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "D:\\workspace\\svn\\photoviewer\\bin\\Release\\recentview.pdb" ascii //weight: 2
        $x_1_2 = "Software\\PhotoViewer\\UpdateChecker" ascii //weight: 1
        $x_1_3 = "skin3.jpg" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_KuaiZip_15
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:KuaiZip"
        threat_id = "1879048198"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "kuaizipreport/mininews" ascii //weight: 1
        $x_1_2 = "Software\\xiaoyu\\Report\\offline" ascii //weight: 1
        $x_1_3 = "KZReport.exe" ascii //weight: 1
        $x_1_4 = "SetPopupPeriod" ascii //weight: 1
        $x_1_5 = "MininewsTitleAdsWnd" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_KuaiZip_16
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:KuaiZip"
        threat_id = "1879048198"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "7"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "tips.nanjingchenxi.com" ascii //weight: 1
        $x_1_2 = "kuaizip" ascii //weight: 1
        $x_1_3 = "2345chrome.exe" ascii //weight: 1
        $x_1_4 = "360SE.exe" ascii //weight: 1
        $x_1_5 = "opera.exe" ascii //weight: 1
        $x_1_6 = "2345explorer.exe" ascii //weight: 1
        $x_1_7 = "qqbrowser.exe" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_KuaiZip_17
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:KuaiZip"
        threat_id = "1879048198"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Kuaizip" ascii //weight: 1
        $x_1_2 = "//i.kpzip.com/n/report/report.txt" ascii //weight: 1
        $x_1_3 = "Software\\KuaiZip\\Install" ascii //weight: 1
        $x_1_4 = "Software\\KuaiZip\\Report\\Install" ascii //weight: 1
        $x_1_5 = "KZReport.exe" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_KuaiZip_18
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:KuaiZip"
        threat_id = "1879048198"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "d:\\svnroot\\kuaizip\\trunk\\bin\\Release\\X86\\KzUpdateAgency.pdb" ascii //weight: 1
        $x_1_2 = "i.kpzip.com/n/tui/update_agency/kb.xml" ascii //weight: 1
        $x_1_3 = "kzupdate_agency" ascii //weight: 1
        $x_1_4 = "KuaiZip" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_KuaiZip_19
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:KuaiZip"
        threat_id = "1879048198"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Software\\7654Browser\\UpdateChecker" ascii //weight: 1
        $x_1_2 = "llq001\\src\\out\\Official\\UpdateChecker.exe.pdb" ascii //weight: 1
        $x_1_3 = "err.log" ascii //weight: 1
        $x_1_4 = "zm_tools\\multi_exe\\update_checker.cc" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (3 of ($x*))
}

rule __PUA_Block_KuaiZip_20
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:KuaiZip"
        threat_id = "1879048198"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Software\\lszip\\submit\\turnoff" ascii //weight: 1
        $x_1_2 = "Software\\xinnote\\report\\offline" ascii //weight: 1
        $x_1_3 = "MiniDumpWriteDump" ascii //weight: 1
        $x_1_4 = "TaskbarCreated" ascii //weight: 1
        $x_1_5 = "Software\\QingJiePdf\\Report" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_KuaiZip_21
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:KuaiZip"
        threat_id = "1879048198"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "//down1.wallpaper.shqingzao.com/report/queryinfo.xml" ascii //weight: 1
        $x_1_2 = "minkernel\\crts\\ucrt\\inc\\corecrt_internal_strtox.h" ascii //weight: 1
        $x_1_3 = "Report.exe" ascii //weight: 1
        $x_1_4 = "Software\\CalfWallpaper\\Install" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_KuaiZip_22
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:KuaiZip"
        threat_id = "1879048198"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "i.kpzip.com" ascii //weight: 1
        $x_1_2 = "Software\\KuaiZip\\Install" ascii //weight: 1
        $x_1_3 = "chrome.exe" ascii //weight: 1
        $x_1_4 = "kuaizip\\trunk\\bin\\Release\\X86\\UpdateChecker.pdb" ascii //weight: 1
        $x_1_5 = "opera.exe" ascii //weight: 1
        $x_1_6 = "Software\\KuaiZip\\UpdateChecker" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_KuaiZip_23
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:KuaiZip"
        threat_id = "1879048198"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "mininews-hn.7654.com/n/tui/wke.dll" ascii //weight: 1
        $x_1_2 = "tj.kpzip.com/kuaizipreport" ascii //weight: 1
        $x_1_3 = "e:\\ZM_Project\\KuaiZip\\bin\\Release\\X86\\mininews.pdb" ascii //weight: 1
        $x_1_4 = "www.kuaizip.com/member/index.php" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_KuaiZip_24
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:KuaiZip"
        threat_id = "1879048198"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "d:\\svnroot\\kuaizip\\trunk\\bin\\Release\\X86\\UpdateChecker.pdb" ascii //weight: 2
        $x_1_2 = "liebao.exe" ascii //weight: 1
        $x_1_3 = "i.kpzip.com/n/updatechecker/kb.xml" ascii //weight: 1
        $x_1_4 = "Software\\KuaiZip\\Install" ascii //weight: 1
        $x_1_5 = "kuaizipreport" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_2_*) and 3 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule __PUA_Block_KuaiZip_25
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:KuaiZip"
        threat_id = "1879048198"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "8"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "kuaiya" ascii //weight: 1
        $x_1_2 = "kuaizip" ascii //weight: 1
        $x_1_3 = "WhirlwindPdf" ascii //weight: 1
        $x_1_4 = "2345chrome" ascii //weight: 1
        $x_1_5 = "tips.nanjingchenxi.com" ascii //weight: 1
        $x_1_6 = "news.toutiaobashi.com" ascii //weight: 1
        $x_1_7 = "360chrome.exe" ascii //weight: 1
        $x_1_8 = "opera.exe" ascii //weight: 1
        $n_100_9 = "Uninst.exe" ascii //weight: -100
        $n_100_10 = "Uninstall.exe" ascii //weight: -100
    condition:
        (filesize < 20MB) and
        (not (any of ($n*))) and
        (all of ($x*))
}

rule __PUA_Block_KuaiZip_26
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:KuaiZip"
        threat_id = "1879048198"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "tpop.kpzip.com/n/tui/tpop/tpop4/kb_nopop.xml" ascii //weight: 1
        $x_1_2 = "down2.7654.com" ascii //weight: 1
        $x_1_3 = "e:\\ZM_Project\\KuaiZip\\bin\\Release\\X86\\tpop4.pdb" ascii //weight: 1
        $x_1_4 = "hotnews.dftoutiao.com" ascii //weight: 1
        $x_1_5 = "/kuaizipreport/mininews" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_KuaiZip_27
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:KuaiZip"
        threat_id = "1879048198"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "6"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = "kuaiyatitle" ascii //weight: 1
        $x_1_2 = "Software\\xinnote\\Install" ascii //weight: 1
        $x_1_3 = "hotnews.dftoutiao.com" ascii //weight: 1
        $x_1_4 = "news.7654.com" ascii //weight: 1
        $x_1_5 = "MiniDebuger" ascii //weight: 1
        $x_1_6 = {72 00 65 00 70 00 6f 00 72 00 74 00 2e 00 [0-15] 2e 00 6d 00 75 00 78 00 69 00 6e 00 2e 00 66 00 75 00 6e 00}  //weight: 1, accuracy: Low
        $x_1_7 = {72 65 70 6f 72 74 2e [0-15] 2e 6d 75 78 69 6e 2e 66 75 6e}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (6 of ($x*))
}

rule __PUA_Block_KuaiZip_28
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:KuaiZip"
        threat_id = "1879048198"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "i.kpzip.com" ascii //weight: 1
        $x_1_2 = "\\KuaiZip\\KuaiZip_Setup.exe" ascii //weight: 1
        $x_1_3 = "api.kpzip.com" ascii //weight: 1
        $x_1_4 = "d:\\svnroot\\kuaizip\\trunk\\bin\\Release\\X86\\KzUpdateAgency.pdb" ascii //weight: 1
        $x_1_5 = "kzupdateagency" ascii //weight: 1
        $n_100_6 = "Uninst.exe" ascii //weight: -100
        $n_100_7 = "Uninstall.exe" ascii //weight: -100
    condition:
        (filesize < 20MB) and
        (not (any of ($n*))) and
        (all of ($x*))
}

rule __PUA_Block_KuaiZip_29
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:KuaiZip"
        threat_id = "1879048198"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "7"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "use_run_screensaver_hotkey" ascii //weight: 1
        $x_1_2 = "SOFTWARE\\Sicent" ascii //weight: 1
        $x_1_3 = "ad_browser_event_handler" ascii //weight: 1
        $x_1_4 = "SOFTWARE\\Goyoo" ascii //weight: 1
        $x_1_5 = "SOFTWARE\\Hintsoft" ascii //weight: 1
        $x_1_6 = "Release_zhan_meng\\Win32\\screen_saver.exe.pdb" ascii //weight: 1
        $x_1_7 = "Software\\ScreenSaver" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_KuaiZip_30
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:KuaiZip"
        threat_id = "1879048198"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\KuaiZip" ascii //weight: 1
        $x_1_2 = "Software\\KuaiZip\\CityCheck" ascii //weight: 1
        $x_1_3 = "Heinote.ini" ascii //weight: 1
        $x_1_4 = "//api.kpzip.com/showcount.php?name=" ascii //weight: 1
        $x_1_5 = "//kyposition.dftoutiao.com/position/get02" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_KuaiZip_31
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:KuaiZip"
        threat_id = "1879048198"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "abckantu.com" wide //weight: 2
        $x_2_2 = "report.screensavers.shzhanmeng.com" ascii //weight: 2
        $x_2_3 = "down22.zmmdn.com" wide //weight: 2
        $x_1_4 = "down.xiald.com" ascii //weight: 1
        $x_1_5 = "SOFTWARE\\Hintsoft" ascii //weight: 1
        $x_1_6 = "SOFTWARE\\Sicent" ascii //weight: 1
        $x_1_7 = "SOFTWARE\\Goyoo" ascii //weight: 1
        $x_2_8 = "Software\\PhotoViewer" wide //weight: 2
        $x_2_9 = "Software\\ScreenSaver" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (
            ((4 of ($x_1_*))) or
            ((1 of ($x_2_*) and 2 of ($x_1_*))) or
            ((2 of ($x_2_*))) or
            (all of ($x*))
        )
}

rule __PUA_Block_KuaiZip_32
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:KuaiZip"
        threat_id = "1879048198"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "stat.kpzip.com/stat/index.php" ascii //weight: 2
        $x_1_2 = "i.kpzip.com/n/update/kb.xml" ascii //weight: 1
        $x_1_3 = "kzUpdate.CPromptUpgrade.SC_CLOSE" ascii //weight: 1
        $x_1_4 = "d:\\svnroot\\kuaizip\\trunk\\bin\\Release\\X86\\Update.pdb" ascii //weight: 1
        $x_1_5 = "PerryShadowWnd" ascii //weight: 1
        $x_1_6 = "KzUpdate.exe" ascii //weight: 1
        $x_1_7 = "KuaizipSetup_" ascii //weight: 1
        $n_100_8 = "Uninst.exe" ascii //weight: -100
        $n_100_9 = "Uninstaller.exe" ascii //weight: -100
        $n_100_10 = "Uninstal.exe" ascii //weight: -100
    condition:
        (filesize < 20MB) and
        (not (any of ($n*))) and
        (
            ((6 of ($x_1_*))) or
            ((1 of ($x_2_*) and 4 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule __PUA_Block_KuaiZip_33
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:KuaiZip"
        threat_id = "1879048198"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = "Software\\CalfWallpaper\\install" ascii //weight: 1
        $x_1_2 = {43 00 3a 00 5c 00 44 00 6f 00 63 00 75 00 6d 00 65 00 6e 00 74 00 73 00 20 00 61 00 6e 00 64 00 20 00 53 00 65 00 74 00 74 00 69 00 6e 00 67 00 73 00 5c 00 [0-15] 5c 00 41 00 70 00 70 00 6c 00 69 00 63 00 61 00 74 00 69 00 6f 00 6e 00 20 00 44 00 61 00 74 00 61 00 5c 00 43 00 61 00 6c 00 66 00 57 00 61 00 6c 00 6c 00 70 00 61 00 70 00 65 00 72 00 5c 00}  //weight: 1, accuracy: Low
        $x_1_3 = {43 3a 5c 44 6f 63 75 6d 65 6e 74 73 20 61 6e 64 20 53 65 74 74 69 6e 67 73 5c [0-15] 5c 41 70 70 6c 69 63 61 74 69 6f 6e 20 44 61 74 61 5c 43 61 6c 66 57 61 6c 6c 70 61 70 65 72 5c}  //weight: 1, accuracy: Low
        $x_1_4 = "CalfWallpaper.exe" ascii //weight: 1
        $x_1_5 = "guanwang_001" ascii //weight: 1
        $x_1_6 = "http://report.wallpaper.shqingzao.com" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (4 of ($x*))
}

rule __PUA_Block_Softcnapp_0
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:Softcnapp"
        threat_id = "1879048199"
        severity = "255"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {0f 10 84 f5 74 ff ff ff 8b 8d 38 ff ff ff 83 ec 10 0f 11 04 24 e8 84 bb f7 ff 83 c6 02 3b f7 7c df}  //weight: 1, accuracy: High
        $x_1_2 = {0f 10 84 f5 74 ff ff ff 8b 8d 38 ff ff ff 83 ec 10 0f 11 04 24 e8 b6 bb f7 ff 83 c6 02 3b f7 7c df}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (1 of ($x*))
}

rule __PUA_Block_Softcnapp_1
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:Softcnapp"
        threat_id = "1879048199"
        severity = "255"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "est.com/wuming/png/monids.png" ascii //weight: 1
        $x_1_2 = "dwonload.sinosteelinvest.com" ascii //weight: 1
        $x_1_3 = "D:\\XiaZaiQi\\ProjectCopy\\Mixed\\pdbmap\\WanNeng\\Install.pdb" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_Softcnapp_2
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:Softcnapp"
        threat_id = "1879048199"
        severity = "255"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "\\TrunkPY\\Bin\\pdbmap\\SmartCloud\\Mutual32.pdb" ascii //weight: 1
        $x_1_2 = "SCMutual.exe" ascii //weight: 1
        $x_1_3 = ".znshuru.com" wide //weight: 1
        $x_1_4 = "tjtv3.znyshurufa.com/" ascii //weight: 1
        $x_1_5 = "spark.exetheworld.exe" wide //weight: 1
    condition:
        (filesize < 20MB) and
        (4 of ($x*))
}

rule __PUA_Block_Softcnapp_3
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:Softcnapp"
        threat_id = "1879048199"
        severity = "255"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "tji.leisurelypanda.com" ascii //weight: 1
        $x_1_2 = "\\Bundles\\Little\\SoftSkin" wide //weight: 1
        $x_1_3 = "LittlePic" wide //weight: 1
        $x_1_4 = "C:\\Program Files\\LittlePicture" wide //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_Softcnapp_4
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:Softcnapp"
        threat_id = "1879048199"
        severity = "255"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "55kantu.com" ascii //weight: 2
        $x_1_2 = "WinIntercept.exe" ascii //weight: 1
        $x_1_3 = "PopBlock.pdb" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_Softcnapp_5
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:Softcnapp"
        threat_id = "1879048199"
        severity = "255"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "51xuanbin" ascii //weight: 1
        $x_1_2 = "CIcoPro.exe" ascii //weight: 1
        $x_1_3 = "tj.peilancao.cn" ascii //weight: 1
        $x_1_4 = "CliPra_In_" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_Softcnapp_6
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:Softcnapp"
        threat_id = "1879048199"
        severity = "255"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "sogouexplorer.exe" ascii //weight: 1
        $x_1_2 = "Clover.exe" ascii //weight: 1
        $x_1_3 = "ejie.me" ascii //weight: 1
        $x_1_4 = "updmp.shusw.com" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_Softcnapp_7
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:Softcnapp"
        threat_id = "1879048199"
        severity = "255"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "njmyy.jiuzhaoren.top" ascii //weight: 2
        $x_1_2 = "AJiJianUrcmvn.exe" ascii //weight: 1
        $x_1_3 = "JiJianSysReset.ini" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_Softcnapp_8
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:Softcnapp"
        threat_id = "1879048199"
        severity = "255"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "YZOverInfo.ini" ascii //weight: 2
        $x_1_2 = "YZWallpaper.ini" ascii //weight: 1
        $x_1_3 = "UseVestige.in" ascii //weight: 1
        $x_1_4 = "Mutnly.exe" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_Softcnapp_9
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:Softcnapp"
        threat_id = "1879048199"
        severity = "255"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "tjtv3.wn51.com" ascii //weight: 2
        $x_1_2 = "www.wnwb.com" ascii //weight: 1
        $x_1_3 = "UseVestige.ini" ascii //weight: 1
        $x_1_4 = "WnUtility.exe" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_Softcnapp_10
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:Softcnapp"
        threat_id = "1879048199"
        severity = "255"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "tjtv3.wn51.com" ascii //weight: 2
        $x_1_2 = "wnwb.com" ascii //weight: 1
        $x_1_3 = "WanNeng\\Mutual32.pdb" ascii //weight: 1
        $x_1_4 = "WanNengInfo.ini" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_Softcnapp_11
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:Softcnapp"
        threat_id = "1879048199"
        severity = "255"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "XiaZaiQi\\ProjectCopy\\Mixed\\pdbmap\\WanNeng\\" ascii //weight: 2
        $x_1_2 = "Install.pdb" ascii //weight: 1
        $x_1_3 = "haxx.se" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_Softcnapp_12
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:Softcnapp"
        threat_id = "1879048199"
        severity = "255"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "tjtv3.wn51.com" ascii //weight: 2
        $x_1_2 = "www.wnwb.com" ascii //weight: 1
        $x_1_3 = "WanNengWBInfo.ini" ascii //weight: 1
        $x_1_4 = "WnImeManager.exe" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_Softcnapp_13
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:Softcnapp"
        threat_id = "1879048199"
        severity = "255"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "chinavipsoft.com" ascii //weight: 1
        $x_1_2 = "UseVestige.ini" ascii //weight: 1
        $x_1_3 = "WanNengZip.ini" ascii //weight: 1
        $n_10_4 = "UninstFinishBgSkin" ascii //weight: -10
    condition:
        (filesize < 20MB) and
        (not (any of ($n*))) and
        (all of ($x*))
}

rule __PUA_Block_Softcnapp_14
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:Softcnapp"
        threat_id = "1879048199"
        severity = "255"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "3"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {65 6c 65 70 68 61 6e 74 70 64 66 [0-15] 2e 79 65 62 61 6e 6b 65 6a 69 2e 63 6e}  //weight: 1, accuracy: Low
        $x_1_2 = "EhPDF" ascii //weight: 1
        $x_1_3 = "Program Files\\Elephant" ascii //weight: 1
        $n_5_4 = "Uninst.exe" ascii //weight: -5
    condition:
        (filesize < 20MB) and
        (not (any of ($n*))) and
        (all of ($x*))
}

rule __PUA_Block_Softcnapp_15
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:Softcnapp"
        threat_id = "1879048199"
        severity = "255"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "www.kangarootec.cn" ascii //weight: 2
        $x_1_2 = "ktw/privacy.html" ascii //weight: 1
        $x_1_3 = "UseVestige.ini" ascii //weight: 1
        $x_1_4 = "ZhuDongFangYu.exe" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_Softcnapp_16
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:Softcnapp"
        threat_id = "1879048199"
        severity = "255"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "yjynz.kfollow.com" ascii //weight: 2
        $x_1_2 = "qywji.kfollow.com" ascii //weight: 1
        $x_1_3 = "ZhuDongFangYu.exe" ascii //weight: 1
        $x_1_4 = "BKPDFReader.ini" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_Softcnapp_17
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:Softcnapp"
        threat_id = "1879048199"
        severity = "255"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "tj.peilancao.cn" ascii //weight: 1
        $x_1_2 = "/log/sendmsg.php" ascii //weight: 1
        $x_1_3 = "lore.exe" ascii //weight: 1
        $x_1_4 = "CIcoPro.exe" ascii //weight: 1
        $x_1_5 = "51xuanbin.exe" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_Softcnapp_18
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:Softcnapp"
        threat_id = "1879048199"
        severity = "255"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "RaccoonWifi" ascii //weight: 1
        $x_1_2 = "InstallPath" ascii //weight: 1
        $x_1_3 = "userconfig.ini" ascii //weight: 1
        $x_1_4 = "RaccoonWifi.ini" ascii //weight: 1
        $x_1_5 = "RaccoonWifi.cfg" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_Softcnapp_19
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:Softcnapp"
        threat_id = "1879048199"
        severity = "255"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "PDConfig.exe" ascii //weight: 1
        $x_1_2 = "wnie.exe" ascii //weight: 1
        $x_1_3 = "sogouexplorer.exe" ascii //weight: 1
        $x_1_4 = "UseVestige.ini" ascii //weight: 1
        $x_1_5 = "PuddingDesktop.ini" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_Softcnapp_20
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:Softcnapp"
        threat_id = "1879048199"
        severity = "255"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "wc.wn51.com/wkbgl.php" ascii //weight: 2
        $x_1_2 = "LocalLow\\Shkb\\Config.ini" ascii //weight: 1
        $x_1_3 = "UseVestige.ini" ascii //weight: 1
        $x_1_4 = "WanNengInstall.pdb" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_Softcnapp_21
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:Softcnapp"
        threat_id = "1879048199"
        severity = "255"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "backstagewww.wnwb.com" ascii //weight: 2
        $x_1_2 = "WnUserPage.exe" ascii //weight: 1
        $x_1_3 = "SoftSkin" ascii //weight: 1
        $x_1_4 = "WanNengWBIME.users" ascii //weight: 1
        $x_1_5 = "UseVestige.ini" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_2_*) and 3 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule __PUA_Block_Softcnapp_22
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:Softcnapp"
        threat_id = "1879048199"
        severity = "255"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "wnwb.exe" ascii //weight: 2
        $x_1_2 = "tjtv3.wn51.com" ascii //weight: 1
        $x_1_3 = "www.wnwb.com/policy.html" ascii //weight: 1
        $x_1_4 = "WanNengWBInfo.ini" ascii //weight: 1
        $x_1_5 = "UseVestige.ini" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_2_*) and 3 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule __PUA_Block_Softcnapp_23
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:Softcnapp"
        threat_id = "1879048199"
        severity = "255"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "ott.newtab123.com" ascii //weight: 2
        $x_1_2 = "uKAD38TH7e" ascii //weight: 1
        $x_1_3 = "subRepair" ascii //weight: 1
        $x_1_4 = "jto.newtab123.com" ascii //weight: 1
        $n_100_5 = "Uninst.exe" ascii //weight: -100
        $n_100_6 = "Uninstall.exe" ascii //weight: -100
    condition:
        (filesize < 20MB) and
        (not (any of ($n*))) and
        (all of ($x*))
}

rule __PUA_Block_Softcnapp_24
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:Softcnapp"
        threat_id = "1879048199"
        severity = "255"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "ott.newtab123.com" ascii //weight: 2
        $x_1_2 = "pu0kjbbq" ascii //weight: 1
        $x_1_3 = "jto.newtab123.com" ascii //weight: 1
        $x_1_4 = "subclear" ascii //weight: 1
        $n_100_5 = "Uninst.exe" ascii //weight: -100
        $n_100_6 = "Uninstall.exe" ascii //weight: -100
    condition:
        (filesize < 20MB) and
        (not (any of ($n*))) and
        (all of ($x*))
}

rule __PUA_Block_Softcnapp_25
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:Softcnapp"
        threat_id = "1879048199"
        severity = "255"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "ott.newtab123.com" ascii //weight: 2
        $x_1_2 = "jto.newtab123.com" ascii //weight: 1
        $x_1_3 = "CapableWin" ascii //weight: 1
        $x_1_4 = "dvi0vp" ascii //weight: 1
        $n_100_5 = "Uninst.exe" ascii //weight: -100
        $n_100_6 = "Uninstall.exe" ascii //weight: -100
    condition:
        (filesize < 20MB) and
        (not (any of ($n*))) and
        (all of ($x*))
}

rule __PUA_Block_Softcnapp_26
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:Softcnapp"
        threat_id = "1879048199"
        severity = "255"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "zjjky.kangarootec.cn" ascii //weight: 2
        $x_1_2 = "tmodm.kangarootec.cn" ascii //weight: 1
        $x_1_3 = "vstginf.ini" ascii //weight: 1
        $x_1_4 = "GoodZip.ini" ascii //weight: 1
        $n_100_5 = "Uninst.exe" ascii //weight: -100
        $n_100_6 = "Uninstall.exe" ascii //weight: -100
    condition:
        (filesize < 20MB) and
        (not (any of ($n*))) and
        (all of ($x*))
}

rule __PUA_Block_Softcnapp_27
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:Softcnapp"
        threat_id = "1879048199"
        severity = "255"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "C:\\Program Files\\XsPicture\\XsPicMeans.exe" ascii //weight: 1
        $x_1_2 = "zycultura.com" ascii //weight: 1
        $x_1_3 = "XsPicInfo.ini" ascii //weight: 1
        $x_1_4 = "UseVestige.ini" ascii //weight: 1
        $n_5_5 = "Uninst.exe" ascii //weight: -5
    condition:
        (filesize < 20MB) and
        (not (any of ($n*))) and
        (all of ($x*))
}

rule __PUA_Block_Softcnapp_28
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:Softcnapp"
        threat_id = "1879048199"
        severity = "255"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "XinSuZip.ini" ascii //weight: 2
        $x_2_2 = "tji.zhilingshidai.com" ascii //weight: 2
        $x_1_3 = "down.zhilingshidai.com" ascii //weight: 1
        $x_1_4 = "UseInfo.ini" ascii //weight: 1
        $n_100_5 = "Uninst.exe" ascii //weight: -100
        $n_100_6 = "Uninstall.exe" ascii //weight: -100
    condition:
        (filesize < 20MB) and
        (not (any of ($n*))) and
        (
            ((2 of ($x_2_*) and 1 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule __PUA_Block_Softcnapp_29
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:Softcnapp"
        threat_id = "1879048199"
        severity = "255"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "MGWallpaper" ascii //weight: 1
        $x_1_2 = "C:\\Program Files\\MGWallpaper\\" ascii //weight: 1
        $x_1_3 = "softtj.panshixk.com" ascii //weight: 1
        $x_1_4 = "MgWall.exe" ascii //weight: 1
        $n_5_5 = "PersistBar_OnContinueUninst" ascii //weight: -5
    condition:
        (filesize < 20MB) and
        (not (any of ($n*))) and
        (all of ($x*))
}

rule __PUA_Block_Softcnapp_30
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:Softcnapp"
        threat_id = "1879048199"
        severity = "255"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "downdcdn.jia-si.cn/cfg.dat" ascii //weight: 1
        $x_1_2 = "wc.jia-si.cn/wkbgl.php" ascii //weight: 1
        $x_1_3 = "ZhuDongFangYu.exe" ascii //weight: 1
        $x_1_4 = "\\LocalLow\\Shkb\\Config.ini" ascii //weight: 1
        $x_1_5 = "wnsoft.ini" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_Softcnapp_31
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:Softcnapp"
        threat_id = "1879048199"
        severity = "255"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "soft.xsfaya.com/mini/price" ascii //weight: 1
        $x_1_2 = "C:\\NoShowHttpConte.ntl" ascii //weight: 1
        $x_1_3 = "MiniPage.exe" ascii //weight: 1
        $x_1_4 = "ott.xsfaya.com" ascii //weight: 1
        $n_100_5 = "Uninst.exe" ascii //weight: -100
        $n_100_6 = "Uninstall.exe" ascii //weight: -100
    condition:
        (filesize < 20MB) and
        (not (any of ($n*))) and
        (all of ($x*))
}

rule __PUA_Block_Softcnapp_32
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:Softcnapp"
        threat_id = "1879048199"
        severity = "255"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "Low"
    strings:
        $x_2_1 = "XsPicInfo.ini" ascii //weight: 2
        $x_2_2 = "zycultura.com" ascii //weight: 2
        $x_1_3 = "XsPicView" ascii //weight: 1
        $x_1_4 = {58 00 73 00 50 00 69 00 63 00 [0-15] 2e 00 65 00 78 00 65 00}  //weight: 1, accuracy: Low
        $x_1_5 = {58 73 50 69 63 [0-15] 2e 65 78 65}  //weight: 1, accuracy: Low
        $n_100_6 = "XsPicUninstall.exe" ascii //weight: -100
        $n_100_7 = "Uninst.exe" ascii //weight: -100
        $n_100_8 = "Uninstall.exe" ascii //weight: -100
    condition:
        (filesize < 20MB) and
        (not (any of ($n*))) and
        (
            ((1 of ($x_2_*) and 3 of ($x_1_*))) or
            ((2 of ($x_2_*) and 1 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule __PUA_Block_Softcnapp_33
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:Softcnapp"
        threat_id = "1879048199"
        severity = "255"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "http://mmtkm.zsincer.com/pdf/jike/32fc2b42d556a387d1c944bd0d530a2b.ded" ascii //weight: 1
        $x_1_2 = "JkRtron.exe" ascii //weight: 1
        $x_1_3 = "Hollon.ini" ascii //weight: 1
        $x_1_4 = "minkernel\\crts\\ucrt\\inc\\corecrt_internal_strtox.h" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_Softcnapp_34
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:Softcnapp"
        threat_id = "1879048199"
        severity = "255"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "SWSkinInst.exe" ascii //weight: 1
        $x_1_2 = "Config\\UseVestige.ini" ascii //weight: 1
        $x_1_3 = "UseVestige.ini" ascii //weight: 1
        $x_1_4 = "SmartCloudWBInfo.ini" ascii //weight: 1
        $x_1_5 = "E:\\git\\shurufa\\src\\ImeWB\\Bundles\\SmartCloud\\Bin\\pdbmap\\WanNeng\\SkinReg32.pdb" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_Softcnapp_35
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:Softcnapp"
        threat_id = "1879048199"
        severity = "255"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "laohuangli365.com" ascii //weight: 2
        $x_1_2 = "nsk2890.tmp" ascii //weight: 1
        $x_1_3 = "nsu.tmp" ascii //weight: 1
        $x_1_4 = "AdjustTokenPrivileges" ascii //weight: 1
        $x_1_5 = "SeShutdownPrivilege" ascii //weight: 1
        $x_1_6 = "DestroyWindow" ascii //weight: 1
        $n_100_7 = "Uninst.exe" ascii //weight: -100
        $n_100_8 = "Uninstaller.exe" ascii //weight: -100
        $n_100_9 = "Uninstal.exe" ascii //weight: -100
    condition:
        (filesize < 20MB) and
        (not (any of ($n*))) and
        (
            ((1 of ($x_2_*) and 4 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule __PUA_Block_Softcnapp_36
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:Softcnapp"
        threat_id = "1879048199"
        severity = "255"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "8"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "JsPDFView.exe" ascii //weight: 1
        $x_1_2 = "JsTolhsj.exe" ascii //weight: 1
        $x_1_3 = "tjtv3.znshuru.com" ascii //weight: 1
        $x_1_4 = "JsPdfMin.exe" ascii //weight: 1
        $x_1_5 = "down.znshuru.com" ascii //weight: 1
        $x_1_6 = "JsPdftp.exe" ascii //weight: 1
        $x_1_7 = "JinSPDFReader.ini" ascii //weight: 1
        $x_1_8 = "JinsPDFVest.ini" ascii //weight: 1
        $n_100_9 = "Uninst.exe" ascii //weight: -100
        $n_100_10 = "Uninstall.exe" ascii //weight: -100
    condition:
        (filesize < 20MB) and
        (not (any of ($n*))) and
        (all of ($x*))
}

rule __PUA_Block_Softcnapp_37
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:Softcnapp"
        threat_id = "1879048199"
        severity = "255"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "jcxyt.cangyakeji.cn/image/ink/dd5d4b81873cc8be81220eb03205c9c3.bbf" ascii //weight: 1
        $x_1_2 = "InkImgEse.exe" ascii //weight: 1
        $x_1_3 = "InkImgEsd.dll" ascii //weight: 1
        $x_1_4 = "minkernel\\crts\\ucrt\\inc\\corecrt_internal_strtox.h" ascii //weight: 1
        $x_1_5 = "IivRip" ascii //weight: 1
        $x_1_6 = "IivRip.cfg" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_Softcnapp_38
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:Softcnapp"
        threat_id = "1879048199"
        severity = "255"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "7"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "SCMutual.exe" ascii //weight: 1
        $x_1_2 = "SCConfig.exe" ascii //weight: 1
        $x_1_3 = "scie.exe" ascii //weight: 1
        $x_1_4 = "UseVestige.ini" ascii //weight: 1
        $x_1_5 = "\\TrunkPY\\Bin\\pdbmap\\SmartCloud\\Moniter32.pdb" ascii //weight: 1
        $x_1_6 = "hhctrl.ocx" ascii //weight: 1
        $x_1_7 = "f:\\sp\\vctools\\vc7libs\\ship\\atlmfc\\src\\mfc\\appcore.cpp" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_Softcnapp_39
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:Softcnapp"
        threat_id = "1879048199"
        severity = "255"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "7"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "CreatePopupMenu" ascii //weight: 1
        $x_1_2 = "CMYWND_MINIPAGE" ascii //weight: 1
        $x_1_3 = "CMYWND_MINIPAGE=Popup" ascii //weight: 1
        $x_1_4 = "APP_MINIPAGE_EXE=Travis.exe" ascii //weight: 1
        $x_1_5 = "MiniDumpWriteDump" ascii //weight: 1
        $x_1_6 = "opt.vkupdf.com" ascii //weight: 1
        $x_1_7 = "BestZip.exe" ascii //weight: 1
        $n_100_8 = "Uninst.exe" ascii //weight: -100
        $n_100_9 = "Uninstall.exe" ascii //weight: -100
    condition:
        (filesize < 20MB) and
        (not (any of ($n*))) and
        (all of ($x*))
}

rule __PUA_Block_Softcnapp_40
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:Softcnapp"
        threat_id = "1879048199"
        severity = "255"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "PDFReader" ascii //weight: 1
        $x_1_2 = "PDFView" ascii //weight: 1
        $x_1_3 = "ZhongHuaPdf" ascii //weight: 1
        $x_1_4 = "JKCovUpd" ascii //weight: 1
        $x_1_5 = "chinavipsoft.com" ascii //weight: 1
        $x_1_6 = "zsincer.com" ascii //weight: 1
        $x_1_7 = "Soaodwaife.ini" ascii //weight: 1
        $x_1_8 = "JKCovybawby.ini" ascii //weight: 1
        $x_1_9 = "JikePDFConverter.ini" ascii //weight: 1
        $x_1_10 = "ZHPDFInfo.ini" ascii //weight: 1
        $n_5_11 = "UninstFinishBgSkin" ascii //weight: -5
    condition:
        (filesize < 20MB) and
        (not (any of ($n*))) and
        (3 of ($x*))
}

rule __PUA_Block_Softcnapp_41
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:Softcnapp"
        threat_id = "1879048199"
        severity = "255"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "ymjqn.bijiatu.com" ascii //weight: 1
        $x_1_2 = "ZhongXiangWiFi.ini" ascii //weight: 1
        $x_1_3 = "KoalaWall.ini" ascii //weight: 1
        $x_1_4 = "UseVestige.ini" ascii //weight: 1
        $x_1_5 = "zmiwn.bijiatu.com" ascii //weight: 1
        $x_1_6 = "NiuXiaoQuan.ini" ascii //weight: 1
        $x_1_7 = "NXQShopping.exe" ascii //weight: 1
        $x_1_8 = "Fotholpidd.ini" ascii //weight: 1
        $x_1_9 = "Flirtckyous" ascii //weight: 1
        $x_1_10 = "Muoterine.ini" ascii //weight: 1
        $x_1_11 = "Yarnround" ascii //weight: 1
        $n_5_12 = "UninstFinishBgSkin" ascii //weight: -5
    condition:
        (filesize < 20MB) and
        (not (any of ($n*))) and
        (3 of ($x*))
}

rule __PUA_Block_Softcnapp_42
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:Softcnapp"
        threat_id = "1879048199"
        severity = "255"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "tjsoft." ascii //weight: 1
        $x_1_2 = "/fdot.php?data=" ascii //weight: 1
        $x_1_3 = "jia-si.cn/api.php" wide //weight: 1
        $x_1_4 = "101.37.188.42/" wide //weight: 1
        $x_1_5 = "downdcdn.jia-si.cn/xiazaiqi/xiazaiqi.html" wide //weight: 1
        $x_1_6 = "kxetray.exe|kxescore.exe" wide //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_Softcnapp_43
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:Softcnapp"
        threat_id = "1879048199"
        severity = "255"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = "\\Mixed\\pdbmap\\WanNeng\\Install.pdb" ascii //weight: 1
        $x_1_2 = {43 00 3a 00 5c 00 44 00 6f 00 63 00 75 00 6d 00 65 00 6e 00 74 00 73 00 20 00 61 00 6e 00 64 00 20 00 53 00 65 00 74 00 74 00 69 00 6e 00 67 00 73 00 5c 00 [0-15] 5c 00 41 00 70 00 70 00 6c 00 69 00 63 00 61 00 74 00 69 00 6f 00 6e 00 20 00 44 00 61 00 74 00 61 00 5c 00 42 00 75 00 6e 00 64 00 6c 00 65 00 42 00 69 00 6e 00 64 00 5c 00}  //weight: 1, accuracy: Low
        $x_1_3 = {43 3a 5c 44 6f 63 75 6d 65 6e 74 73 20 61 6e 64 20 53 65 74 74 69 6e 67 73 5c [0-15] 5c 41 70 70 6c 69 63 61 74 69 6f 6e 20 44 61 74 61 5c 42 75 6e 64 6c 65 42 69 6e 64 5c}  //weight: 1, accuracy: Low
        $x_1_4 = "UseVestige.ini" ascii //weight: 1
        $x_1_5 = {64 00 6f 00 77 00 6e 00 2e 00 [0-31] 2e 00 63 00 6f 00 6d 00}  //weight: 1, accuracy: Low
        $x_1_6 = {64 6f 77 6e 2e [0-31] 2e 63 6f 6d}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (4 of ($x*))
}

rule __PUA_Block_Softcnapp_44
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:Softcnapp"
        threat_id = "1879048199"
        severity = "255"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "Low"
    strings:
        $x_2_1 = "\\Mixed\\pdbmap\\WanNeng\\Install.pdb" ascii //weight: 2
        $x_1_2 = {43 00 3a 00 5c 00 44 00 6f 00 63 00 75 00 6d 00 65 00 6e 00 74 00 73 00 20 00 61 00 6e 00 64 00 20 00 53 00 65 00 74 00 74 00 69 00 6e 00 67 00 73 00 5c 00 [0-15] 5c 00 41 00 70 00 70 00 6c 00 69 00 63 00 61 00 74 00 69 00 6f 00 6e 00 20 00 44 00 61 00 74 00 61 00 5c 00 42 00 75 00 6e 00 64 00 6c 00 65 00 42 00 69 00 6e 00 64 00 5c 00}  //weight: 1, accuracy: Low
        $x_1_3 = {43 3a 5c 44 6f 63 75 6d 65 6e 74 73 20 61 6e 64 20 53 65 74 74 69 6e 67 73 5c [0-15] 5c 41 70 70 6c 69 63 61 74 69 6f 6e 20 44 61 74 61 5c 42 75 6e 64 6c 65 42 69 6e 64 5c}  //weight: 1, accuracy: Low
        $x_2_4 = {64 00 6f 00 77 00 6e 00 2e 00 [0-31] 2e 00 63 00 6f 00 6d 00}  //weight: 2, accuracy: Low
        $x_2_5 = {64 6f 77 6e 2e [0-31] 2e 63 6f 6d}  //weight: 2, accuracy: Low
        $x_1_6 = " QQPCTray.exe" ascii //weight: 1
        $x_1_7 = "wnsoft.ini" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_2_*) and 3 of ($x_1_*))) or
            ((2 of ($x_2_*) and 1 of ($x_1_*))) or
            ((3 of ($x_2_*))) or
            (all of ($x*))
        )
}

rule __PUA_Block_OfferCore_0
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:OfferCore"
        threat_id = "1879048201"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "partners-offapi.net/apiBundle" ascii //weight: 2
        $x_1_2 = "offering" ascii //weight: 1
        $x_1_3 = "YandexInstaller.pdb" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_2_*) and 1 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule __PUA_Block_OfferCore_1
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:OfferCore"
        threat_id = "1879048201"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "control.kochava.com" ascii //weight: 1
        $x_2_2 = "Installoffers" ascii //weight: 2
        $x_1_3 = "innosetup" ascii //weight: 1
        $x_1_4 = "Linkvertise GmbH & Co. KG" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_OfferCore_2
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:OfferCore"
        threat_id = "1879048201"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "dt-updates.com" ascii //weight: 2
        $x_1_2 = "dt.web-search-home.com" ascii //weight: 1
        $x_1_3 = "BrightVpnOffer" ascii //weight: 1
        $x_1_4 = "IAvastOffer" ascii //weight: 1
        $x_1_5 = "DTWpfInstaller.pdb" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_OfferCore_3
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:OfferCore"
        threat_id = "1879048201"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "//risecodes.com/privacy" ascii //weight: 1
        $x_1_2 = "TDOWNLOADWIZARDPAGE" ascii //weight: 1
        $x_1_3 = "HIDEDOWNLOADPAGE" ascii //weight: 1
        $x_1_4 = "OPENMAINCARRIERINWEBBROWSER" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_OfferCore_4
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:OfferCore"
        threat_id = "1879048201"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "7"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "offer_size" ascii //weight: 1
        $x_1_2 = "yaoffer" ascii //weight: 1
        $x_1_3 = "YandexPackSetup" ascii //weight: 1
        $x_1_4 = "opera" ascii //weight: 1
        $x_1_5 = "AvastSvc" ascii //weight: 1
        $x_1_6 = "bundlesInstalled" ascii //weight: 1
        $x_1_7 = "pixelsee.exe" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_OfferCore_5
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:OfferCore"
        threat_id = "1879048201"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "8"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Accept" ascii //weight: 1
        $x_1_2 = "Decline" ascii //weight: 1
        $x_1_3 = "Optional Offer" ascii //weight: 1
        $x_1_4 = "BundleOfferAction" ascii //weight: 1
        $x_1_5 = "AN Soft" ascii //weight: 1
        $x_1_6 = "campaignid" ascii //weight: 1
        $x_1_7 = "Survey" ascii //weight: 1
        $x_1_8 = "PremierOpinion" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_OfferCore_6
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:OfferCore"
        threat_id = "1879048201"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "12"
        strings_accuracy = "High"
    strings:
        $x_5_1 = "d2u4d080ckhplh.cloudfront.net" ascii //weight: 5
        $x_1_2 = "CHECKOFFER" ascii //weight: 1
        $x_1_3 = "INSTALLOFFERS" ascii //weight: 1
        $x_1_4 = "PageOfferActivate" ascii //weight: 1
        $x_1_5 = "GetSearchEngines" ascii //weight: 1
        $x_5_6 = "cheatengine" ascii //weight: 5
    condition:
        (filesize < 20MB) and
        (
            ((2 of ($x_5_*) and 2 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule __PUA_Block_OfferCore_7
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:OfferCore"
        threat_id = "1879048201"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "//risecodes.com/privacy" ascii //weight: 1
        $x_1_2 = "d1r1qou28c7cqg.cloudfront.net/zbd" ascii //weight: 1
        $x_1_3 = "GETINSTALLS" ascii //weight: 1
        $x_1_4 = "DOWNLOADTEMPORARYFILE" ascii //weight: 1
        $x_1_5 = "ContainsKey" ascii //weight: 1
        $x_1_6 = "Avinstaller" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_OfferCore_8
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:OfferCore"
        threat_id = "1879048201"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "MentalMentor.exe" ascii //weight: 1
        $x_1_2 = "SETBUNDLEOFFERED" ascii //weight: 1
        $x_1_3 = "BDVPN_ONLINKOPTIONALOFFER" ascii //weight: 1
        $x_1_4 = "DOWNLOADBUNDLE" ascii //weight: 1
        $x_1_5 = "LINKBRIGHTDATACLICKED" ascii //weight: 1
        $n_100_6 = "Uninst.exe" ascii //weight: -100
        $n_100_7 = "Uninstall.exe" ascii //weight: -100
    condition:
        (filesize < 20MB) and
        (not (any of ($n*))) and
        (all of ($x*))
}

rule __PUA_Block_OfferCore_9
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:OfferCore"
        threat_id = "1879048201"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "7"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "GETOFFERINDEXBYPAGE" ascii //weight: 1
        $x_1_2 = "ISTHELASTOFFERPAGEIFANY" ascii //weight: 1
        $x_1_3 = "PAGEOFFERACTIVATE" ascii //weight: 1
        $x_1_4 = "PAGEOFFERDEINITIALIZE" ascii //weight: 1
        $x_1_5 = "PAGEOFFERCREATE" ascii //weight: 1
        $x_1_6 = "INSTALLOFFERS" ascii //weight: 1
        $x_1_7 = "CHECKOFFER" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_OfferCore_10
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:OfferCore"
        threat_id = "1879048201"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "7"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Softonic_DLM" ascii //weight: 1
        $x_1_2 = "GETADSERVERRESPONSE" ascii //weight: 1
        $x_1_3 = "PAGEOFFERCREATE" ascii //weight: 1
        $x_1_4 = "PAGEOFFERACTIVATE" ascii //weight: 1
        $x_1_5 = "GETOFFERINDEXBYPAGE" ascii //weight: 1
        $x_1_6 = "ISTHELASTOFFERPAGEIFANY" ascii //weight: 1
        $x_1_7 = "PAGEOFFERDEINITIALIZE" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_OfferCore_11
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:OfferCore"
        threat_id = "1879048201"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "7"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "control.kochava.com/v1/cpi/click" ascii //weight: 1
        $x_1_2 = "d1pqn6m5ywnw3a.cloudfront.net" ascii //weight: 1
        $x_1_3 = "GETOFFERSARRAY" ascii //weight: 1
        $x_1_4 = "PageOfferActivate" ascii //weight: 1
        $x_1_5 = "PAGEOFFERCREATE" ascii //weight: 1
        $x_1_6 = "YandexBrowser" ascii //weight: 1
        $x_1_7 = "kohotspot-shield" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_OfferCore_12
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:OfferCore"
        threat_id = "1879048201"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "7"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "check_offer_result" ascii //weight: 1
        $x_1_2 = "eligible_offer" ascii //weight: 1
        $x_1_3 = "offer_set" ascii //weight: 1
        $x_1_4 = "GETOFFERINDEXBYPAGE" ascii //weight: 1
        $x_1_5 = "PAGEOFFERACTIVATE" ascii //weight: 1
        $x_1_6 = "CREATEOFFERS" ascii //weight: 1
        $x_1_7 = "CHECKOFFER" ascii //weight: 1
        $x_1_8 = "PROCESSOFFERSTRINGS" ascii //weight: 1
        $x_1_9 = "GETADSERVERRESPONSE" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (7 of ($x*))
}

rule __PUA_Block_OfferCore_13
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:OfferCore"
        threat_id = "1879048201"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "7"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "OfferInstallerConfig" ascii //weight: 1
        $x_1_2 = "OfferInstaller.exe" ascii //weight: 1
        $x_1_3 = "OfferInstallData" ascii //weight: 1
        $x_1_4 = "OnOfferInstalled" ascii //weight: 1
        $x_1_5 = "BundleInstallError" ascii //weight: 1
        $x_1_6 = "get_Offers" ascii //weight: 1
        $x_1_7 = "OfferInstaller.pdb" ascii //weight: 1
        $n_100_8 = "Uninst.exe" ascii //weight: -100
        $n_100_9 = "Uninstall.exe" ascii //weight: -100
    condition:
        (filesize < 20MB) and
        (not (any of ($n*))) and
        (all of ($x*))
}

rule __PUA_Block_OfferCore_14
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:OfferCore"
        threat_id = "1879048201"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "7"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "GETOFFERINDEXBYPAGE" ascii //weight: 1
        $x_1_2 = "GETOFFERSARRAY" ascii //weight: 1
        $x_1_3 = "PAGEOFFERACTIVATE" ascii //weight: 1
        $x_1_4 = "INSTALLOFFERS" ascii //weight: 1
        $x_1_5 = "CHECKOFFER" ascii //weight: 1
        $x_1_6 = "PAGEOFFERBACKBUTTONCLICK" ascii //weight: 1
        $x_1_7 = "PAGEOFFERSHOULDSKIPPAGE" ascii //weight: 1
        $x_1_8 = "PROCESSOFFERSTRINGS" ascii //weight: 1
        $x_1_9 = "GETADSERVERRESPONSE" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (7 of ($x*))
}

rule __PUA_Block_OfferCore_15
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:OfferCore"
        threat_id = "1879048201"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "9"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "openpdf.exe" ascii //weight: 1
        $x_1_2 = "Programs\\Opera\\opera.exe" ascii //weight: 1
        $x_1_3 = "Bright VPN\\Bright VPN.exe" ascii //weight: 1
        $x_1_4 = "360TotalSecurity" ascii //weight: 1
        $x_1_5 = "pages_offered" ascii //weight: 1
        $x_1_6 = "offered" ascii //weight: 1
        $x_1_7 = "external_offer_screen" ascii //weight: 1
        $x_1_8 = "external_offer_code_accepted" ascii //weight: 1
        $x_1_9 = "external_offer_code_canceled" ascii //weight: 1
        $n_100_10 = "Uninst.exe" ascii //weight: -100
        $n_100_11 = "Uninstall.exe" ascii //weight: -100
    condition:
        (filesize < 20MB) and
        (not (any of ($n*))) and
        (all of ($x*))
}

rule __PUA_Block_OfferCore_16
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:OfferCore"
        threat_id = "1879048201"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "11"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "SETBUNDLEOFFERED" ascii //weight: 1
        $x_1_2 = "DOWNLOADBUNDLE" ascii //weight: 1
        $x_1_3 = "INSTALLBUNDLE" ascii //weight: 1
        $x_1_4 = "INSTALLACCEPTEDBUNDLES" ascii //weight: 1
        $x_1_5 = "OPERA_LINKTERMSCLICKED" ascii //weight: 1
        $x_1_6 = "OPERA_LINKPOLICYCLICKED" ascii //weight: 1
        $x_1_7 = "CREATEOPERAPAGE" ascii //weight: 1
        $x_1_8 = "AV360_LINKTERMSCLICKED" ascii //weight: 1
        $x_1_9 = "AV360_LINKPOLICYCLICKED" ascii //weight: 1
        $x_1_10 = "CREATEAV360PAGE" ascii //weight: 1
        $x_1_11 = "mentalmentor.exe" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_OfferCore_17
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:OfferCore"
        threat_id = "1879048201"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "16"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Appinstaller" ascii //weight: 1
        $x_1_2 = "Appdater" ascii //weight: 1
        $x_1_3 = "AppInst.exe" ascii //weight: 1
        $x_1_4 = "softprecdn.ru" ascii //weight: 1
        $x_1_5 = "app-offers" ascii //weight: 1
        $x_1_6 = "offer-exists" ascii //weight: 1
        $x_1_7 = "offer-shown" ascii //weight: 1
        $x_1_8 = "offer-installing" ascii //weight: 1
        $x_1_9 = "offer-cancelled" ascii //weight: 1
        $x_1_10 = "offer-aborted" ascii //weight: 1
        $x_1_11 = "offer-activating" ascii //weight: 1
        $x_1_12 = "offer-falsepositive" ascii //weight: 1
        $x_1_13 = "offer-installed" ascii //weight: 1
        $x_1_14 = "offer-activated" ascii //weight: 1
        $x_1_15 = "offer-failed" ascii //weight: 1
        $x_1_16 = "offers" ascii //weight: 1
        $n_100_17 = "Uninst.exe" ascii //weight: -100
        $n_100_18 = "Uninstall.exe" ascii //weight: -100
    condition:
        (filesize < 20MB) and
        (not (any of ($n*))) and
        (all of ($x*))
}

rule __PUA_Block_OfferCore_18
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:OfferCore"
        threat_id = "1879048201"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "20"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Appinstaller" ascii //weight: 1
        $x_1_2 = "appdater" ascii //weight: 1
        $x_1_3 = "://softprecdn.ru/offerscreens/avast-icon.png" ascii //weight: 1
        $x_1_4 = "://softprecdn.ru/offerscreens/avast-checkbox.png" ascii //weight: 1
        $x_1_5 = "://softprecdn.ru/offerscreens/kis-icon.png" ascii //weight: 1
        $x_1_6 = "://softprecdn.ru/offerscreens/only_offer_kis_200.png" ascii //weight: 1
        $x_1_7 = "://softprecdn.ru/offerscreens/opera-icon.png" ascii //weight: 1
        $x_1_8 = "://softprecdn.ru/offerscreens/yandex-icon.png" ascii //weight: 1
        $x_1_9 = "://softprecdn.ru/offerscreens/only_offer_ya_200.png" ascii //weight: 1
        $x_1_10 = "app-offers" ascii //weight: 1
        $x_1_11 = "offer-exists" ascii //weight: 1
        $x_1_12 = "offer-shown" ascii //weight: 1
        $x_1_13 = "offer-aborted" ascii //weight: 1
        $x_1_14 = "offer-cancelled" ascii //weight: 1
        $x_1_15 = "offer-installing" ascii //weight: 1
        $x_1_16 = "offer-activating" ascii //weight: 1
        $x_1_17 = "offer-installed" ascii //weight: 1
        $x_1_18 = "offer-activated" ascii //weight: 1
        $x_1_19 = "offer-failed" ascii //weight: 1
        $x_1_20 = "offers" ascii //weight: 1
        $n_100_21 = "Uninst.exe" ascii //weight: -100
        $n_100_22 = "Uninstall.exe" ascii //weight: -100
    condition:
        (filesize < 20MB) and
        (not (any of ($n*))) and
        (all of ($x*))
}

rule __PUA_Block_CoinMiner_0
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:CoinMiner"
        threat_id = "1879048204"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "genesis block rewards" ascii //weight: 1
        $x_1_2 = "Failed to construct miner tx" ascii //weight: 1
        $x_1_3 = "Wallet" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_CoinMiner_1
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:CoinMiner"
        threat_id = "1879048204"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "poolstate.bin" ascii //weight: 1
        $x_1_2 = "miner_tx" ascii //weight: 1
        $x_1_3 = "getwalletsyncdata" ascii //weight: 1
        $x_1_4 = "wallet_address" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (3 of ($x*))
}

rule __PUA_Block_CoinMiner_2
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:CoinMiner"
        threat_id = "1879048204"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "9"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "job_id" ascii //weight: 1
        $x_1_2 = "worker-id" ascii //weight: 1
        $x_1_3 = "\"nicehash\":" ascii //weight: 1
        $x_1_4 = "\"pass\": \"" ascii //weight: 1
        $x_1_5 = "\"user\": \"" ascii //weight: 1
        $x_1_6 = "\"url\": \"" ascii //weight: 1
        $x_1_7 = "\"donate-over-proxy\": 1," ascii //weight: 1
        $x_1_8 = "cpu-affinity" ascii //weight: 1
        $x_1_9 = "pools" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_CoinMiner_3
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:CoinMiner"
        threat_id = "1879048204"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "bfgminer.exe" ascii //weight: 1
        $x_1_2 = "stratum_thread" ascii //weight: 1
        $x_1_3 = "cgminer_pool_stats" ascii //weight: 1
        $x_1_4 = "cgminer_stats" ascii //weight: 1
        $x_1_5 = "coinbase" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (3 of ($x*))
}

rule __PUA_Block_CoinMiner_4
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:CoinMiner"
        threat_id = "1879048204"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "cryptonote_format_utils.cpp" ascii //weight: 1
        $x_1_2 = "Stop mining" ascii //weight: 1
        $x_1_3 = "miner_conf.json" ascii //weight: 1
        $x_1_4 = "cryptonote_protocol_handler.inl" ascii //weight: 1
        $x_1_5 = "miner.cpp" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_CoinMiner_5
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:CoinMiner"
        threat_id = "1879048204"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "qt/crowdcoin.cpp" ascii //weight: 1
        $x_1_2 = "crowdcoind.pid" ascii //weight: 1
        $x_1_3 = "10BitcoinGUI" ascii //weight: 1
        $x_1_4 = "2receivedPaymentRequest(SendCoinsRecipient)" ascii //weight: 1
        $x_1_5 = "2receivedURI(QString)" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (4 of ($x*))
}

rule __PUA_Block_CoinMiner_6
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:CoinMiner"
        threat_id = "1879048204"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "SOLVED %d BLOCK%s!" ascii //weight: 1
        $x_1_2 = "Invalid bitburner-voltage %d must be %dmv - %dmv" ascii //weight: 1
        $x_1_3 = "coinbasetxn" ascii //weight: 1
        $x_1_4 = "Connected to multiple pools with%s block change notify" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_CoinMiner_7
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:CoinMiner"
        threat_id = "1879048204"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Usage: minerd [OPTIONS]" ascii //weight: 1
        $x_1_2 = "minerd --help" ascii //weight: 1
        $x_1_3 = "cpuminer" ascii //weight: 1
        $x_1_4 = "LONGPOLL detected new block" ascii //weight: 1
        $x_1_5 = "mining.submit" ascii //weight: 1
        $x_1_6 = "stratum+tcp://" ascii //weight: 1
        $x_2_7 = "\"method\": \"mining.subscribe\"" ascii //weight: 2
        $x_2_8 = "\"method\": \"mining.authorize\"" ascii //weight: 2
        $x_2_9 = "\"agent\": \"cpuminer-multi/0.1\"" ascii //weight: 2
        $x_1_10 = "mining.set_difficulty" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((3 of ($x_1_*))) or
            ((1 of ($x_2_*) and 1 of ($x_1_*))) or
            ((2 of ($x_2_*))) or
            (all of ($x*))
        )
}

rule __PUA_Block_CoinMiner64_0
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:CoinMiner64"
        threat_id = "1879048207"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "donate.v2.xmrig.com" ascii //weight: 1
        $x_1_2 = "cryptonight-monerov7" ascii //weight: 1
        $x_1_3 = "stratum+tcp://" ascii //weight: 1
        $x_1_4 = "nicehash" ascii //weight: 1
        $x_1_5 = "donate-over-proxy" ascii //weight: 1
        $x_1_6 = "{\"id\":%lld,\"jsonrpc\":\"2.0\",\"method\":\"keepalived\",\"params\":{\"id\":\"%s\"}}" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (4 of ($x*))
}

rule __PUA_Block_CoinMiner64_1
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:CoinMiner64"
        threat_id = "1879048207"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "9"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run" wide //weight: 1
        $x_1_2 = "--cpu-max-threads-hint 50 -r" wide //weight: 1
        $x_1_3 = "-o pool.minexmr.com:4444 -u " wide //weight: 1
        $x_1_4 = "ethereum-mining" wide //weight: 1
        $x_1_5 = "ethminer.exe" wide //weight: 1
        $x_1_6 = "waupdat3.exe" wide //weight: 1
        $x_1_7 = "msiexec.exe" wide //weight: 1
        $x_1_8 = "-P stratum1" wide //weight: 1
        $x_1_9 = "/xmri" wide //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_Presenoker_0
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:Presenoker"
        threat_id = "1879048251"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "http://adplus.chlbiz.com/adplus-api" ascii //weight: 1
        $x_1_2 = "http://pdapi.znyshurufa.com/city" ascii //weight: 1
        $x_1_3 = "FIDDLER" wide //weight: 1
        $x_1_4 = "WIRESHARK" wide //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_Presenoker_1
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:Presenoker"
        threat_id = "1879048251"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Created with GIMP" ascii //weight: 1
        $x_1_2 = "Goooooooooogle.UserControl1" ascii //weight: 1
        $x_1_3 = "REG ADD HKCU\\Software\\TR2 /v uni /t REG_SZ /d 1" wide //weight: 1
        $x_1_4 = "http://videocodecxvid.com/track/display.php" wide //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_Presenoker_2
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:Presenoker"
        threat_id = "1879048251"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "2"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "htagzdownload.pw" wide //weight: 1
        $x_1_2 = "space1.adminpressure.space" wide //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ALF_TrojanDownloader_O97M_Emotet_0
{
    meta:
        author = "defender2yara"
        detection_name = "!#ALF:TrojanDownloader:O97M/Emotet"
        threat_id = "1879048305"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "3"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {41 74 74 72 69 62 75 74 65 20 56 42 5f 4e 61 6d 65 20 3d 20 22 [0-16] 22 0d 0a 53 75 62 20 61 75 74 6f 6f 70 65 6e 28 29 0d 0a 4f 6e 20 45 72 72 6f 72 20 52 65 73 75 6d 65 20 4e 65 78 74 0d 0a 20 20 20 44 69 6d 20}  //weight: 1, accuracy: Low
        $x_1_2 = ".ShowWindow = True And False" ascii //weight: 1
        $x_1_3 = {2e 43 61 70 74 69 6f 6e 20 2b 20 [0-16] 2e [0-16] 2e 43 61 70 74 69 6f 6e 29 29 29}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ALF_TrojanDownloader_O97M_Donoff_0
{
    meta:
        author = "defender2yara"
        detection_name = "!#ALF:TrojanDownloader:O97M/Donoff"
        threat_id = "1879048314"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "2"
        strings_accuracy = "High"
    strings:
        $x_1_1 = ".r\" & \"\" & \"tf\"" ascii //weight: 1
        $x_1_2 = "o\" + \"rd.Applicatio\" + \"n\" +" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ALF_TrojanDownloader_O97M_Donoff_1
{
    meta:
        author = "defender2yara"
        detection_name = "!#ALF:TrojanDownloader:O97M/Donoff"
        threat_id = "1879048314"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "= \".V\"" ascii //weight: 1
        $x_1_2 = "+ \"BE\"" ascii //weight: 1
        $x_1_3 = "= Environ(\"TEMP\") &" ascii //weight: 1
        $x_1_4 = "http://connect.businesshelpa-z.com/dana/home.php" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (3 of ($x*))
}

rule __ALF_TrojanDownloader_O97M_Donoff_2
{
    meta:
        author = "defender2yara"
        detection_name = "!#ALF:TrojanDownloader:O97M/Donoff"
        threat_id = "1879048314"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "7"
        strings_accuracy = "High"
    strings:
        $x_1_1 = ") Mod 26) + 65)" ascii //weight: 1
        $x_1_2 = " - 65 + " ascii //weight: 1
        $x_1_3 = " & Chr(((" ascii //weight: 1
        $x_1_4 = "Case 65 To 90" ascii //weight: 1
        $x_1_5 = "Case 97 To 122" ascii //weight: 1
        $x_1_6 = " - 97 + " ascii //weight: 1
        $x_1_7 = ") Mod 26) + 97)" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ALF_TrojanDownloader_O97M_Donoff_3
{
    meta:
        author = "defender2yara"
        detection_name = "!#ALF:TrojanDownloader:O97M/Donoff"
        threat_id = "1879048314"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {43 61 73 65 20 41 73 63 28 22 41 22 29 20 2b 20 31 33 20 54 6f 20 41 73 63 28 22 4d 22 29 20 2b 20 31 33 0d 0a}  //weight: 1, accuracy: High
        $x_1_2 = {43 61 73 65 20 41 73 63 28 22 4e 22 29 20 2d 20 31 33 20 54 6f 20 41 73 63 28 22 5a 22 29 20 2d 20 31 33 0d 0a}  //weight: 1, accuracy: High
        $x_1_3 = {20 3d 20 31 33 20 2f 20 30 0d 0a}  //weight: 1, accuracy: High
        $x_1_4 = {2e 53 70 61 77 6e 49 6e 73 74 61 6e 63 65 5f 0d 0a}  //weight: 1, accuracy: High
        $x_1_5 = ".ShowWindow = 0" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_GameHack_0
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:GameHack"
        threat_id = "1879048430"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "20"
        strings_accuracy = "High"
    strings:
        $x_10_1 = "https://wearedevs.net" ascii //weight: 10
        $x_10_2 = "Release\\exploit-main.pdb" ascii //weight: 10
        $x_10_3 = "roblox.com" ascii //weight: 10
        $x_5_4 = "\\\\.\\pipe\\WeAreDevsPublicAPI_Lua" ascii //weight: 5
        $x_5_5 = "exploit-main.dll" ascii //weight: 5
        $x_5_6 = "rbxassetid://" ascii //weight: 5
        $x_1_7 = "os.execute" ascii //weight: 1
        $x_1_8 = "os.remove" ascii //weight: 1
        $x_1_9 = "os.rename" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_10_*) and 2 of ($x_5_*))) or
            ((2 of ($x_10_*))) or
            (all of ($x*))
        )
}

rule __PUA_Block_GameHack_1
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:GameHack"
        threat_id = "1879048430"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "taskkill /f /im explorer.exe" ascii //weight: 1
        $x_1_2 = "\\Vblak\\Desktop\\TrinityWoof\\TrinityWoof\\BSODFixed\\v1.3\\AntiDebugANDbsodprot" wide //weight: 1
        $x_1_3 = "4Cheat Engine.exe" wide //weight: 1
        $x_1_4 = "\\INF\\cum4.bat" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_2345Cn_0
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:2345Cn"
        threat_id = "1879048634"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "Execute 2345Pinyin MiniPage Task" wide //weight: 2
        $x_2_2 = {4f 00 72 00 69 00 67 00 69 00 6e 00 61 00 6c 00 46 00 69 00 6c 00 65 00 6e 00 61 00 6d 00 65 00 00 00 48 00 65 00 6c 00 70 00 65 00 72 00 5f 00 32 00 33 00 34 00 35 00 2e 00 65 00 78 00 65 00}  //weight: 2, accuracy: High
        $x_1_3 = "CommonPlatform\\Helper2345\\bin\\Win32\\Release\\pdb\\Helper_2345.pdb" ascii //weight: 1
        $x_1_4 = "helper_tray_statistic" wide //weight: 1
        $x_1_5 = "helper_2345.child_process.common" wide //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_2_*) and 3 of ($x_1_*))) or
            ((2 of ($x_2_*) and 1 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule __PUA_Block_2345Cn_1
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:2345Cn"
        threat_id = "1879048634"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "2345MiniPage" ascii //weight: 1
        $x_1_2 = "2345Pinyin" ascii //weight: 1
        $x_1_3 = "SOFTWARE\\2345.com" ascii //weight: 1
        $x_1_4 = "2345MiniPage.pdb" ascii //weight: 1
        $x_1_5 = "updater_auto" ascii //weight: 1
        $x_1_6 = "2345PCSafeBootAssistant.exe" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_2345Cn_2
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:2345Cn"
        threat_id = "1879048634"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "Execute 2345Pinyin MiniPage Task" ascii //weight: 2
        $x_2_2 = "\\bin\\Win32\\Release\\pdb\\2345PicTool.pdb" ascii //weight: 2
        $x_1_3 = "RCPic_Popup_Tool" wide //weight: 1
        $x_1_4 = "/pic_realtime/index.php" wide //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((2 of ($x_2_*) and 1 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule __PUA_Block_2345Cn_3
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:2345Cn"
        threat_id = "1879048634"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "2345MiniPage" ascii //weight: 1
        $x_1_2 = "MiniDumpWriteDump" ascii //weight: 1
        $x_1_3 = "MiniPageMain" ascii //weight: 1
        $x_1_4 = "update.minipage.2345.cc" ascii //weight: 1
        $x_1_5 = "Execute 2345Pinyin MiniPage Task" ascii //weight: 1
        $x_1_6 = "/minipage/index.php" ascii //weight: 1
        $x_1_7 = "\\2345MiniPage.pdb" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (6 of ($x*))
}

rule __PUA_Block_2345Cn_4
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:2345Cn"
        threat_id = "1879048634"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_3_1 = "Execute 2345Pinyin MiniPage Task" ascii //weight: 3
        $x_2_2 = {49 00 6e 00 74 00 65 00 72 00 6e 00 61 00 6c 00 4e 00 61 00 6d 00 65 00 00 00 32 00 33 00 34 00 35 00 50 00 69 00 63 00 53 00 76 00 63 00}  //weight: 2, accuracy: High
        $x_2_3 = "--from=pic_service" wide //weight: 2
        $x_2_4 = "\\bin\\Win32\\Release\\pdb\\2345PicSvc.pdb" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (
            ((2 of ($x_2_*))) or
            ((1 of ($x_3_*) and 1 of ($x_2_*))) or
            (all of ($x*))
        )
}

rule __PUA_Block_2345Cn_5
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:2345Cn"
        threat_id = "1879048634"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "Execute 2345Pinyin MiniPage Task" ascii //weight: 2
        $x_1_2 = {49 00 6e 00 74 00 65 00 72 00 6e 00 61 00 6c 00 4e 00 61 00 6d 00 65 00 00 00 32 00 33 00 34 00 35 00 50 00 69 00 63 00 4c 00 6f 00 61 00 64 00 65 00 72 00}  //weight: 1, accuracy: High
        $x_1_3 = "minipage_window_push" ascii //weight: 1
        $x_1_4 = ":\\zhanlue\\rcimage\\bin\\Win32\\Release\\pdb\\2345PicLoader.pdb" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_2_*) and 2 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule __PUA_Block_2345Cn_6
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:2345Cn"
        threat_id = "1879048634"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "Execute 2345Pinyin MiniPage Task" ascii //weight: 2
        $x_1_2 = {49 00 6e 00 74 00 65 00 72 00 6e 00 61 00 6c 00 4e 00 61 00 6d 00 65 00 00 00 32 00 33 00 34 00 35 00 50 00 69 00 63 00 55 00 70 00 64 00 61 00 74 00 65 00}  //weight: 1, accuracy: High
        $x_1_3 = "minipage_window_push" ascii //weight: 1
        $x_1_4 = ":\\zhanlue\\rcimage\\bin\\Win32\\Release\\pdb\\2345PicUpdate.pdb" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_2_*) and 2 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule __PUA_Block_2345Cn_7
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:2345Cn"
        threat_id = "1879048634"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_3_1 = "Execute 2345Pinyin MiniPage Task" ascii //weight: 3
        $x_2_2 = {49 00 6e 00 74 00 65 00 72 00 6e 00 61 00 6c 00 4e 00 61 00 6d 00 65 00 00 00 32 00 33 00 34 00 35 00 53 00 68 00 65 00 6c 00 6c 00 50 00 72 00 6f 00}  //weight: 2, accuracy: High
        $x_2_3 = "--isInsallSoftMgr" wide //weight: 2
        $x_2_4 = "\\Rhino\\Safe\\Bin\\Win32\\release\\pdb\\2345ShellPro.pdb" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (
            ((2 of ($x_2_*))) or
            ((1 of ($x_3_*) and 1 of ($x_2_*))) or
            (all of ($x*))
        )
}

rule __PUA_Block_2345Cn_8
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:2345Cn"
        threat_id = "1879048634"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_3_1 = "Execute 2345Pinyin MiniPage Task" ascii //weight: 3
        $x_2_2 = {49 00 6e 00 74 00 65 00 72 00 6e 00 61 00 6c 00 4e 00 61 00 6d 00 65 00 00 00 32 00 33 00 34 00 35 00 53 00 75 00 69 00 74 00 65 00}  //weight: 2, accuracy: High
        $x_2_3 = "2345com.2345Suite.Mutex" wide //weight: 2
        $x_2_4 = ":\\dllplugin\\SoftwareCollection\\bin\\release_static\\2345Suite.pdb" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (
            ((2 of ($x_2_*))) or
            ((1 of ($x_3_*) and 1 of ($x_2_*))) or
            (all of ($x*))
        )
}

rule __PUA_Block_2345Cn_9
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:2345Cn"
        threat_id = "1879048634"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "Execute 2345Pinyin MiniPage Task" ascii //weight: 2
        $x_1_2 = {49 00 6e 00 74 00 65 00 72 00 6e 00 61 00 6c 00 4e 00 61 00 6d 00 65 00 00 00 32 00 33 00 34 00 35 00 50 00 64 00 66 00 54 00 6f 00 6f 00 6c 00}  //weight: 1, accuracy: High
        $x_1_3 = "pdf2word_plug_config" wide //weight: 1
        $x_1_4 = ":\\zhanlue\\pdfconverter\\bin\\Win32\\release_static\\pdb\\2345PdfTool.pdb" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_2_*) and 2 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule __PUA_Block_2345Cn_10
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:2345Cn"
        threat_id = "1879048634"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "Execute 2345Pinyin MiniPage Task" ascii //weight: 2
        $x_1_2 = {49 00 6e 00 74 00 65 00 72 00 6e 00 61 00 6c 00 4e 00 61 00 6d 00 65 00 00 00 32 00 33 00 34 00 35 00 50 00 69 00 63 00 54 00 6f 00 6f 00 6c 00}  //weight: 1, accuracy: High
        $x_1_3 = "gRCPic_Update_Cloud_Config" wide //weight: 1
        $x_1_4 = ":\\zhanlue\\rcimage\\bin\\Win32\\Release\\pdb\\2345PicTool.pdb" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_2_*) and 2 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule __PUA_Block_2345Cn_11
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:2345Cn"
        threat_id = "1879048634"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "Execute 2345Pinyin MiniPage Task" ascii //weight: 2
        $x_1_2 = {49 00 6e 00 74 00 65 00 72 00 6e 00 61 00 6c 00 4e 00 61 00 6d 00 65 00 00 00 32 00 33 00 34 00 35 00 43 00 61 00 70 00 74 00 75 00 72 00 65 00}  //weight: 1, accuracy: High
        $x_1_3 = "RCCapture_Update_Config_Ini" wide //weight: 1
        $x_1_4 = ":\\zhanlue\\2345capture\\bin\\Win32\\Release\\pdb\\2345Capture.pdb" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_2_*) and 2 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule __PUA_Block_2345Cn_12
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:2345Cn"
        threat_id = "1879048634"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "Execute 2345Pinyin MiniPage Task" ascii //weight: 2
        $x_1_2 = {49 00 6e 00 74 00 65 00 72 00 6e 00 61 00 6c 00 4e 00 61 00 6d 00 65 00 00 00 32 00 33 00 34 00 35 00 49 00 6e 00 73 00 74 00 44 00 6c 00 6c 00}  //weight: 1, accuracy: High
        $x_1_3 = "RC::RCInstDllStat::Init" wide //weight: 1
        $x_1_4 = ":\\RhinoProtect\\Publish\\OutPut\\Bin\\Win32\\release\\pdb\\2345InstDll.pdb" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_2_*) and 2 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule __PUA_Block_2345Cn_13
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:2345Cn"
        threat_id = "1879048634"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "Execute 2345Pinyin MiniPage Task" ascii //weight: 2
        $x_1_2 = {49 00 6e 00 74 00 65 00 72 00 6e 00 61 00 6c 00 4e 00 61 00 6d 00 65 00 00 00 32 00 33 00 34 00 35 00 50 00 64 00 66 00 44 00 75 00 6d 00 70 00 65 00 72 00}  //weight: 1, accuracy: High
        $x_1_3 = "2345PdfConverter.hzv" wide //weight: 1
        $x_1_4 = ":\\zhanlue\\pdfconverter\\bin\\Win32\\release_static\\pdb\\2345PdfDumper.pdb" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_2_*) and 2 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule __PUA_Block_2345Cn_14
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:2345Cn"
        threat_id = "1879048634"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "Execute 2345Pinyin MiniPage Task" ascii //weight: 2
        $x_1_2 = {49 00 6e 00 74 00 65 00 72 00 6e 00 61 00 6c 00 4e 00 61 00 6d 00 65 00 00 00 32 00 33 00 34 00 35 00 47 00 61 00 6d 00 65 00 48 00 61 00 6c 00 6c 00}  //weight: 1, accuracy: High
        $x_1_3 = "2345GameHall_realtime_statistics" wide //weight: 1
        $x_1_4 = ":\\gamehall\\GameHall\\out\\Release\\2345GameHall.pdb" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_2_*) and 2 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule __PUA_Block_2345Cn_15
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:2345Cn"
        threat_id = "1879048634"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_3_1 = "Execute 2345Pinyin MiniPage Task" ascii //weight: 3
        $x_2_2 = {49 00 6e 00 74 00 65 00 72 00 6e 00 61 00 6c 00 4e 00 61 00 6d 00 65 00 00 00 32 00 33 00 34 00 35 00 53 00 61 00 66 00 65 00 54 00 72 00 61 00 79 00}  //weight: 2, accuracy: High
        $x_2_3 = "\\\\.\\pipe\\2345SafeCenter\\Breakpad" wide //weight: 2
        $x_2_4 = "\\Rhino\\Safe\\Bin\\Win32\\release\\pdb\\2345SafeTray.pdb" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (
            ((2 of ($x_2_*))) or
            ((1 of ($x_3_*) and 1 of ($x_2_*))) or
            (all of ($x*))
        )
}

rule __PUA_Block_2345Cn_16
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:2345Cn"
        threat_id = "1879048634"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_3_1 = "Execute 2345Pinyin MiniPage Task" ascii //weight: 3
        $x_2_2 = {49 00 6e 00 74 00 65 00 72 00 6e 00 61 00 6c 00 4e 00 61 00 6d 00 65 00 00 00 32 00 33 00 34 00 35 00 53 00 61 00 66 00 65 00 55 00 70 00 64 00 61 00 74 00 65 00}  //weight: 2, accuracy: High
        $x_2_3 = "\\\\.\\pipe\\2345SafeCenter\\Breakpad" wide //weight: 2
        $x_2_4 = "\\Rhino\\Safe\\Bin\\Win32\\release\\pdb\\2345SafeUpdate.pdb" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (
            ((2 of ($x_2_*))) or
            ((1 of ($x_3_*) and 1 of ($x_2_*))) or
            (all of ($x*))
        )
}

rule __PUA_Block_2345Cn_17
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:2345Cn"
        threat_id = "1879048634"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "Execute 2345Pinyin MiniPage Task" ascii //weight: 2
        $x_1_2 = "doctor_2345explorer.named_mutex.repairing" wide //weight: 1
        $x_1_3 = "doctor_notice_board_datas" ascii //weight: 1
        $x_1_4 = ":\\dllplugin\\Doctor\\bin\\Win32\\Release\\pdb\\Doctor_2345Explorer.pdb" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_2_*) and 2 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule __PUA_Block_2345Cn_18
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:2345Cn"
        threat_id = "1879048634"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "Execute 2345Pinyin MiniPage Task" ascii //weight: 2
        $x_1_2 = {49 00 6e 00 74 00 65 00 72 00 6e 00 61 00 6c 00 4e 00 61 00 6d 00 65 00 00 00 32 00 33 00 34 00 35 00 4f 00 43 00 52 00 4d 00 61 00 69 00 6e 00}  //weight: 1, accuracy: High
        $x_1_3 = "RCOCRConverter_Update_Config_Ini" wide //weight: 1
        $x_1_4 = ":\\zhanlue\\ocrconverter\\bin\\Win32\\Release\\pdb\\2345OCRMain.pdb" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_2_*) and 2 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule __PUA_Block_2345Cn_19
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:2345Cn"
        threat_id = "1879048634"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "Execute 2345Pinyin MiniPage Task" ascii //weight: 2
        $x_1_2 = {49 00 6e 00 74 00 65 00 72 00 6e 00 61 00 6c 00 4e 00 61 00 6d 00 65 00 00 00 32 00 33 00 34 00 35 00 4f 00 43 00 52 00 4c 00 6f 00 61 00 64 00 65 00 72 00}  //weight: 1, accuracy: High
        $x_1_3 = "start_up_times_since_last_update" wide //weight: 1
        $x_1_4 = ":\\zhanlue\\ocrconverter\\bin\\Win32\\release_static\\pdb\\2345OCRLoader.pdb" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_2_*) and 2 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule __PUA_Block_2345Cn_20
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:2345Cn"
        threat_id = "1879048634"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "Execute 2345Pinyin MiniPage Task" ascii //weight: 2
        $x_1_2 = {49 00 6e 00 74 00 65 00 72 00 6e 00 61 00 6c 00 4e 00 61 00 6d 00 65 00 00 00 32 00 33 00 34 00 35 00 4f 00 43 00 52 00 44 00 75 00 6d 00 70 00 65 00 72 00}  //weight: 1, accuracy: High
        $x_1_3 = {46 00 69 00 6c 00 65 00 44 00 65 00 73 00 63 00 72 00 69 00 70 00 74 00 69 00 6f 00 6e 00 00 00 00 00 32 00 33 00 34 00 35 00 4f 00 43 00 52 00 87 65 57 5b c6 8b 2b 52 2d 00 44 00 75 00 6d 00 70 00 0b 7a 8f 5e}  //weight: 1, accuracy: High
        $x_1_4 = ":\\zhanlue\\ocrconverter\\bin\\Win32\\release_static\\pdb\\2345OCRDumper.pdb" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_2_*) and 2 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule __PUA_Block_2345Cn_21
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:2345Cn"
        threat_id = "1879048634"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "Execute 2345Pinyin MiniPage Task" ascii //weight: 2
        $x_1_2 = {49 00 6e 00 74 00 65 00 72 00 6e 00 61 00 6c 00 4e 00 61 00 6d 00 65 00 00 00 55 00 70 00 64 00 61 00 74 00 65 00 5f 00 32 00 33 00 34 00 35 00 50 00 69 00 6e 00 79 00 69 00 6e 00}  //weight: 1, accuracy: High
        $x_1_3 = "pinyin.update_tool.process_exit.event" wide //weight: 1
        $x_1_4 = "\\UpdateProgram\\bin\\Win32\\Release\\pdb\\Update_2345Pinyin.pdb" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_2_*) and 2 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule __PUA_Block_2345Cn_22
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:2345Cn"
        threat_id = "1879048634"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "Low"
    strings:
        $x_2_1 = "Execute 2345Pinyin MiniPage Task" ascii //weight: 2
        $x_1_2 = {4f 00 72 00 69 00 67 00 69 00 6e 00 61 00 6c 00 46 00 69 00 6c 00 65 00 6e 00 61 00 6d 00 65 00 00 00 32 00 33 00 34 00 35 00 50 00 64 00 66 00 4d 00 61 00 69 00 6e 00 2e 00 65 00 78 00 65 00}  //weight: 1, accuracy: High
        $x_1_3 = "RCPdfConverter_Update_Config_Ini" wide //weight: 1
        $x_1_4 = {3a 5c 7a 68 61 6e 6c 75 65 5c 70 64 66 63 6f 6e 76 65 72 74 65 72 5c 62 69 6e 5c (78|57 69 6e) 5c 52 65 6c 65 61 73 65 5c 70 64 62 5c 32 33 34 35 50 64 66 4d 61 69 6e 2e 70 64 62}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_2_*) and 2 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule __PUA_Block_2345Cn_23
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:2345Cn"
        threat_id = "1879048634"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "Execute 2345Pinyin MiniPage Task" ascii //weight: 2
        $x_1_2 = {49 00 6e 00 74 00 65 00 72 00 6e 00 61 00 6c 00 4e 00 61 00 6d 00 65 00 00 00 55 00 70 00 64 00 61 00 74 00 65 00 5f 00 32 00 33 00 34 00 35 00 50 00 69 00 63 00 2e 00 65 00 78 00 65 00}  //weight: 1, accuracy: High
        $x_1_3 = "update_2345.named_mutex.signal" wide //weight: 1
        $x_1_4 = ":\\trunk\\CommonPlatform\\UpdateProgram\\bin\\Win32\\Release\\pdb\\Update_2345Pic.pdb" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_2_*) and 2 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule __PUA_Block_2345Cn_24
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:2345Cn"
        threat_id = "1879048634"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "Execute 2345Pinyin MiniPage Task" ascii //weight: 2
        $x_1_2 = {49 00 6e 00 74 00 65 00 72 00 6e 00 61 00 6c 00 4e 00 61 00 6d 00 65 00 00 00 32 00 33 00 34 00 35 00 53 00 46 00 52 00 65 00 70 00 61 00 69 00 72 00 46 00 63 00}  //weight: 1, accuracy: High
        $x_1_3 = "\\RhinoProtect\\Publish\\OutPut\\bin\\Win32\\Release\\pdb\\2345SafeCenterDiff.pdb" ascii //weight: 1
        $x_1_4 = "RC::RCSafeRepairStat::SendRealTimeStat" wide //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_2_*) and 2 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule __PUA_Block_2345Cn_25
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:2345Cn"
        threat_id = "1879048634"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "7"
        strings_accuracy = "High"
    strings:
        $x_4_1 = "Execute 2345Pinyin MiniPage Task" ascii //weight: 4
        $x_2_2 = {49 00 6e 00 74 00 65 00 72 00 6e 00 61 00 6c 00 4e 00 61 00 6d 00 65 00 00 00 32 00 33 00 34 00 35 00 50 00 69 00 6e 00 79 00 69 00 6e 00 57 00 69 00 7a 00 61 00 72 00 64 00}  //weight: 2, accuracy: High
        $x_2_3 = "\\bin\\Win32\\Release\\pdb\\2345PinyinWizard.pdb" ascii //weight: 2
        $x_1_4 = "2345pinyin_regist_pipe_" wide //weight: 1
        $x_1_5 = "RCPinyin_Error_Stat_Sender" wide //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_4_*) and 1 of ($x_2_*) and 1 of ($x_1_*))) or
            ((1 of ($x_4_*) and 2 of ($x_2_*))) or
            (all of ($x*))
        )
}

rule __PUA_Block_2345Cn_26
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:2345Cn"
        threat_id = "1879048634"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "Execute 2345Pinyin MiniPage Task" ascii //weight: 2
        $x_1_2 = "pdfcvt.2345.cc/help.html" wide //weight: 1
        $x_1_3 = "download.2345.cn/pdfcvt/2345PdfConverter_" wide //weight: 1
        $x_1_4 = "\\pdfconverter\\bin\\tool\\FileDown\\bin\\release_static\\2345PDFCvtInstaller.pdb" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_2_*) and 2 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule __PUA_Block_2345Cn_27
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:2345Cn"
        threat_id = "1879048634"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "Execute 2345Pinyin MiniPage Task" ascii //weight: 2
        $x_1_2 = "2345pinyin_regist_pipe_" wide //weight: 1
        $x_1_3 = "2345Pinyin_Guide_Login_Mutex" wide //weight: 1
        $x_1_4 = ":\\zhanlue\\2345input\\project\\pinyinconfig\\src\\qq_detect" wide //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_2_*) and 2 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule __PUA_Block_2345Cn_28
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:2345Cn"
        threat_id = "1879048634"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "7"
        strings_accuracy = "High"
    strings:
        $x_4_1 = "Execute 2345Pinyin MiniPage Task" ascii //weight: 4
        $x_2_2 = {49 00 6e 00 74 00 65 00 72 00 6e 00 61 00 6c 00 4e 00 61 00 6d 00 65 00 00 00 32 00 33 00 34 00 35 00 50 00 69 00 6e 00 79 00 69 00 6e 00 53 00 79 00 6d 00 62 00 6f 00 6c 00}  //weight: 2, accuracy: High
        $x_2_3 = "\\bin\\Win32\\Release\\pdb\\2345PinyinSymbol.pdb" ascii //weight: 2
        $x_1_4 = "Global\\2345PinyinServiceNotifyMonitorEvent" wide //weight: 1
        $x_1_5 = "ui/SettingUI.dui" wide //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_4_*) and 1 of ($x_2_*) and 1 of ($x_1_*))) or
            ((1 of ($x_4_*) and 2 of ($x_2_*))) or
            (all of ($x*))
        )
}

rule __PUA_Block_2345Cn_29
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:2345Cn"
        threat_id = "1879048634"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "Execute 2345Pinyin MiniPage Task" ascii //weight: 2
        $x_1_2 = {49 00 6e 00 74 00 65 00 72 00 6e 00 61 00 6c 00 4e 00 61 00 6d 00 65 00 00 00 32 00 33 00 34 00 35 00 50 00 69 00 6e 00 79 00 69 00 6e 00 55 00 70 00 64 00 61 00 74 00 65 00}  //weight: 1, accuracy: High
        $x_1_3 = "RCPinyin_Update_Skin_Push_Immediately" wide //weight: 1
        $x_1_4 = ":\\zhanlue\\2345input\\project\\pinyinupdate\\src\\" wide //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_2_*) and 2 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule __PUA_Block_2345Cn_30
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:2345Cn"
        threat_id = "1879048634"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "Low"
    strings:
        $x_3_1 = "Execute 2345Pinyin MiniPage Task" ascii //weight: 3
        $x_3_2 = {49 00 6e 00 74 00 65 00 72 00 6e 00 61 00 6c 00 4e 00 61 00 6d 00 65 00 00 00 32 00 33 00 34 00 35 00 50 00 69 00 6e 00 79 00 69 00 6e 00 53 00 76 00 63 00}  //weight: 3, accuracy: High
        $x_2_3 = "RCPinyin_Error_Stat_Sender" wide //weight: 2
        $x_1_4 = {5c 32 33 34 35 49 6e 70 75 74 44 75 5c 62 69 6e 5c 57 69 6e 33 32 5c 52 65 6c 65 61 73 65 5c 70 64 62 5c 32 33 34 35 50 69 6e 79 69 6e 53 76 63 2e 70 64 62}  //weight: 1, accuracy: Low
        $x_1_5 = "\\2345Pinyin\\new\\bin\\Win32\\Release\\pdb\\2345PinyinSvc.pdb" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_2_*) and 2 of ($x_1_*))) or
            ((1 of ($x_3_*) and 1 of ($x_1_*))) or
            ((1 of ($x_3_*) and 1 of ($x_2_*))) or
            ((2 of ($x_3_*))) or
            (all of ($x*))
        )
}

rule __PUA_Block_2345Cn_31
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:2345Cn"
        threat_id = "1879048634"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "Low"
    strings:
        $x_3_1 = "Execute 2345Pinyin MiniPage Task" ascii //weight: 3
        $x_2_2 = {49 00 6e 00 74 00 65 00 72 00 6e 00 61 00 6c 00 4e 00 61 00 6d 00 65 00 00 00 32 00 33 00 34 00 35 00 53 00 6f 00 66 00 74 00 4d 00 67 00 72 00}  //weight: 2, accuracy: High
        $x_2_3 = "RCInstallSoftMgr::InstallStat:oldVersion=%s, newVersion=%s" wide //weight: 2
        $x_2_4 = {5c 73 6f 66 74 6d 67 72 5c 6d 61 69 6e 5c 62 69 6e 5c 57 69 6e 33 32 5c 72 65 6c 65 61 73 65 5f 73 74 61 74 5c 70 64 62 5c 32 33 34 35 53 6f 66 74 4d 67 72 2e 70 64 62}  //weight: 2, accuracy: Low
    condition:
        (filesize < 20MB) and
        (
            ((2 of ($x_2_*))) or
            ((1 of ($x_3_*) and 1 of ($x_2_*))) or
            (all of ($x*))
        )
}

rule __PUA_Block_2345Cn_32
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:2345Cn"
        threat_id = "1879048634"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "Execute 2345Pinyin MiniPage Task" ascii //weight: 2
        $x_1_2 = {49 00 6e 00 74 00 65 00 72 00 6e 00 61 00 6c 00 4e 00 61 00 6d 00 65 00 00 00 32 00 33 00 34 00 35 00 50 00 69 00 6e 00 79 00 69 00 6e 00 43 00 6c 00 6f 00 75 00 64 00}  //weight: 1, accuracy: High
        $x_1_3 = "2345Pinyin_Pic_Face_Emoj_Mutex" wide //weight: 1
        $x_1_4 = ":\\zhanlue\\2345input\\project\\pinyincloud\\src\\web_business\\" wide //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_2_*) and 2 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule __PUA_Block_2345Cn_33
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:2345Cn"
        threat_id = "1879048634"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "Execute 2345Pinyin MiniPage Task" ascii //weight: 2
        $x_1_2 = "Global\\2345PCSafeServiceNotifyMonitorEvent" wide //weight: 1
        $x_1_3 = "RC::RCFileAssocDownloader::DownloadSoft" wide //weight: 1
        $x_1_4 = "\\RhinoProtect\\Publish\\OutPut\\bin\\Win32\\Release\\pdb\\2345Associate.pdb" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_2_*) and 2 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule __PUA_Block_2345Cn_34
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:2345Cn"
        threat_id = "1879048634"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_3_1 = "Execute 2345Pinyin MiniPage Task" ascii //weight: 3
        $x_2_2 = {49 00 6e 00 74 00 65 00 72 00 6e 00 61 00 6c 00 4e 00 61 00 6d 00 65 00 00 00 32 00 33 00 34 00 35 00 41 00 64 00 52 00 74 00 50 00 72 00 6f 00 74 00 65 00 63 00 74 00}  //weight: 2, accuracy: High
        $x_2_3 = ":\\rhino\\safe\\src\\adrtprotect\\adrtprotect\\rcmainapplication.cpp" wide //weight: 2
        $x_2_4 = "\\Rhino\\Safe\\Bin\\Win32\\release\\pdb\\2345AdRtProtect.pdb" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (
            ((2 of ($x_2_*))) or
            ((1 of ($x_3_*) and 1 of ($x_2_*))) or
            (all of ($x*))
        )
}

rule __PUA_Block_2345Cn_35
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:2345Cn"
        threat_id = "1879048634"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "Execute 2345Pinyin MiniPage Task" ascii //weight: 2
        $x_1_2 = {49 00 6e 00 74 00 65 00 72 00 6e 00 61 00 6c 00 4e 00 61 00 6d 00 65 00 00 00 32 00 33 00 34 00 35 00 53 00 61 00 66 00 65 00 43 00 65 00 6e 00 74 00 65 00 72 00 49 00 6e 00 73 00 74 00 61 00 6c 00 6c 00 65 00 72 00}  //weight: 1, accuracy: High
        $x_1_3 = "2345SafeCenterInstaller Start. CmdLine: %s" wide //weight: 1
        $x_1_4 = ":\\RhinoProtect\\Publish\\OutPut\\bin\\Win32\\Release\\pdb\\2345SafeCenterInstaller.pdb" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_2_*) and 2 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule __PUA_Block_2345Cn_36
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:2345Cn"
        threat_id = "1879048634"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "Execute 2345Pinyin MiniPage Task" ascii //weight: 2
        $x_1_2 = {49 00 6e 00 74 00 65 00 72 00 6e 00 61 00 6c 00 4e 00 61 00 6d 00 65 00 00 00 32 00 33 00 34 00 35 00 50 00 69 00 63 00 44 00 75 00 6d 00 70 00 65 00 72 00}  //weight: 1, accuracy: High
        $x_1_3 = "RCPic_minidump_send_history_mutex_{85F8BABA-A1DC-4F7A-AF78-EB5E2F719ABF}" wide //weight: 1
        $x_1_4 = "\\bin\\Win32\\Release\\pdb\\2345PicDumper.pdb" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_2_*) and 2 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule __PUA_Block_2345Cn_37
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:2345Cn"
        threat_id = "1879048634"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "Execute 2345Pinyin MiniPage Task" ascii //weight: 2
        $x_1_2 = {49 00 6e 00 74 00 65 00 72 00 6e 00 61 00 6c 00 4e 00 61 00 6d 00 65 00 00 00 46 00 61 00 63 00 65 00 54 00 6f 00 6f 00 6c 00 5f 00 32 00 33 00 34 00 35 00 50 00 69 00 6e 00 79 00 69 00 6e 00}  //weight: 1, accuracy: High
        $x_1_3 = "2345Pinyin_Pic_Face_Bubble_Mutex" wide //weight: 1
        $x_1_4 = ":\\zhanlue\\2345input\\project\\pinyinpicfacetool\\src\\data\\" wide //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_2_*) and 2 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule __PUA_Block_2345Cn_38
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:2345Cn"
        threat_id = "1879048634"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "6"
        strings_accuracy = "Low"
    strings:
        $x_5_1 = "Execute 2345Pinyin MiniPage Task" ascii //weight: 5
        $x_3_2 = {49 00 6e 00 74 00 65 00 72 00 6e 00 61 00 6c 00 4e 00 61 00 6d 00 65 00 00 00 32 00 33 00 34 00 35 00 50 00 69 00 6e 00 79 00 69 00 6e 00 54 00 6f 00 6f 00 6c 00}  //weight: 3, accuracy: High
        $x_3_3 = {5c 32 33 34 35 69 6e 70 75 74 44 75 5c 62 69 6e 5c 57 69 6e 33 32 5c 52 65 6c 65 61 73 65 5c 70 64 62 5c 32 33 34 35 50 69 6e 79 69 6e 54 6f 6f 6c 2e 70 64 62}  //weight: 3, accuracy: Low
        $x_1_4 = "Global\\2345PinyinServiceNotifyMonitorEvent" wide //weight: 1
        $x_1_5 = "2345PinyinTool.ust" wide //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((2 of ($x_3_*))) or
            ((1 of ($x_5_*) and 1 of ($x_1_*))) or
            ((1 of ($x_5_*) and 1 of ($x_3_*))) or
            (all of ($x*))
        )
}

rule __PUA_Block_2345Cn_39
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:2345Cn"
        threat_id = "1879048634"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "2"
        strings_accuracy = "Low"
    strings:
        $x_2_1 = "Execute 2345Pinyin MiniPage Task" wide //weight: 2
        $x_2_2 = {4f 00 72 00 69 00 67 00 69 00 6e 00 61 00 6c 00 46 00 69 00 6c 00 65 00 6e 00 61 00 6d 00 65 00 00 00 32 00 33 00 34 00 35 00 4d 00 69 00 6e 00 69 00 50 00 61 00 67 00 65 00 41 00 70 00 70 00 2e 00 64 00 6c 00 6c 00}  //weight: 2, accuracy: High
        $x_2_3 = {5c 52 43 4d 69 6e 69 50 61 67 65 [0-8] 5c 62 69 6e 5c 57 69 6e 33 32 5c 52 65 6c 65 61 73 65 5c 70 64 62 5c 4d 69 6e 69 70 61 67 65 4d 61 69 6e 2e 70 64 62}  //weight: 2, accuracy: Low
        $x_1_4 = "2345minipage-hwnd-prop-name" wide //weight: 1
        $x_1_5 = "minipage.stat" wide //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((2 of ($x_1_*))) or
            ((1 of ($x_2_*))) or
            (all of ($x*))
        )
}

rule __PUA_Block_2345Cn_40
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:2345Cn"
        threat_id = "1879048634"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "2"
        strings_accuracy = "Low"
    strings:
        $x_2_1 = "Execute 2345Pinyin MiniPage Task" wide //weight: 2
        $x_2_2 = {4f 00 72 00 69 00 67 00 69 00 6e 00 61 00 6c 00 46 00 69 00 6c 00 65 00 6e 00 61 00 6d 00 65 00 00 00 48 00 65 00 6c 00 70 00 65 00 72 00 4d 00 61 00 69 00 6e 00 2e 00 64 00 6c 00 6c 00}  //weight: 2, accuracy: High
        $x_2_3 = {5c 48 65 6c 70 65 72 32 33 34 35 [0-8] 5c 62 69 6e 5c 57 69 6e 33 32 5c 52 65 6c 65 61 73 65 5c 70 64 62 5c 48 65 6c 70 65 72 4d 61 69 6e 2e 70 64 62}  //weight: 2, accuracy: Low
        $x_1_4 = "helper_tray_statistic" wide //weight: 1
        $x_1_5 = "2345minipage-hwnd-prop-name" wide //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((2 of ($x_1_*))) or
            ((1 of ($x_2_*))) or
            (all of ($x*))
        )
}

rule __PUA_Block_2345Cn_41
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:2345Cn"
        threat_id = "1879048634"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_3_1 = "Execute 2345Pinyin MiniPage Task" ascii //weight: 3
        $x_2_2 = {49 00 6e 00 74 00 65 00 72 00 6e 00 61 00 6c 00 4e 00 61 00 6d 00 65 00 00 00 32 00 33 00 34 00 35 00 52 00 54 00 50 00 72 00 6f 00 74 00 65 00 63 00 74 00}  //weight: 2, accuracy: High
        $x_2_3 = "Global\\RCAV7E47DA93-AF41-4450-90CD-31C78125287D_RTPROTECT_MUTEX" wide //weight: 2
        $x_2_4 = "\\RhinoProtect\\Publish\\OutPut\\bin\\Win32\\Release\\pdb\\2345RTProtect.pdb" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (
            ((2 of ($x_2_*))) or
            ((1 of ($x_3_*) and 1 of ($x_2_*))) or
            (all of ($x*))
        )
}

rule __PUA_Block_2345Cn_42
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:2345Cn"
        threat_id = "1879048634"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "Execute 2345Pinyin MiniPage Task" ascii //weight: 2
        $x_1_2 = {49 00 6e 00 74 00 65 00 72 00 6e 00 61 00 6c 00 4e 00 61 00 6d 00 65 00 00 00 32 00 33 00 34 00 35 00 4f 00 43 00 52 00 55 00 70 00 64 00 61 00 74 00 65 00}  //weight: 1, accuracy: High
        $x_1_3 = "{47FF0D24-E0A5-4163-8546-DE7217D2F141}.2345ocr.checkversion.data" wide //weight: 1
        $x_1_4 = ":\\zhanlue\\ocrconverter\\bin\\Win32\\release_static\\pdb\\2345OCRUpdate.pdb" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_2_*) and 2 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule __PUA_Block_2345Cn_43
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:2345Cn"
        threat_id = "1879048634"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "Execute 2345Pinyin MiniPage Task" ascii //weight: 2
        $x_1_2 = {49 00 6e 00 74 00 65 00 72 00 6e 00 61 00 6c 00 4e 00 61 00 6d 00 65 00 00 00 32 00 33 00 34 00 35 00 50 00 64 00 66 00 4c 00 6f 00 61 00 64 00 65 00 72 00}  //weight: 1, accuracy: High
        $x_1_3 = "RCPdf_Loader_plugin_pdf2x_{B290ED24-1295-4B55-A6A7-5EBD321F473B}" wide //weight: 1
        $x_1_4 = ":\\zhanlue\\pdfconverter\\bin\\Win32\\release_static\\pdb\\2345PdfLoader.pdb" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_2_*) and 2 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule __PUA_Block_2345Cn_44
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:2345Cn"
        threat_id = "1879048634"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "Execute 2345Pinyin MiniPage Task" ascii //weight: 2
        $x_1_2 = {49 00 6e 00 74 00 65 00 72 00 6e 00 61 00 6c 00 4e 00 61 00 6d 00 65 00 00 00 32 00 33 00 34 00 35 00 50 00 64 00 66 00 55 00 70 00 64 00 61 00 74 00 65 00}  //weight: 1, accuracy: High
        $x_1_3 = "{47FF0D24-E0A5-4163-8546-DE7217D2F141}.2345pdfconverter.newversion.data" wide //weight: 1
        $x_1_4 = ":\\zhanlue\\pdfconverter\\bin\\Win32\\release_static\\pdb\\2345PdfUpdate.pdb" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_2_*) and 2 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule __PUA_Block_2345Cn_45
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:2345Cn"
        threat_id = "1879048634"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_3_1 = "Execute 2345Pinyin MiniPage Task" ascii //weight: 3
        $x_2_2 = {49 00 6e 00 74 00 65 00 72 00 6e 00 61 00 6c 00 4e 00 61 00 6d 00 65 00 00 00 32 00 33 00 34 00 35 00 52 00 74 00 50 00 72 00 6f 00 74 00 65 00 63 00 74 00 43 00 65 00 6e 00 74 00 65 00 72 00}  //weight: 2, accuracy: High
        $x_2_3 = "\\rhino\\safe\\src\\framework\\src\\framework\\src\\utils\\rcmodulethreadsync.cpp" wide //weight: 2
        $x_2_4 = "\\Rhino\\Safe\\Bin\\Win32\\release\\pdb\\2345RtProtectCenter.pdb" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (
            ((2 of ($x_2_*))) or
            ((1 of ($x_3_*) and 1 of ($x_2_*))) or
            (all of ($x*))
        )
}

rule __PUA_Block_2345Cn_46
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:2345Cn"
        threat_id = "1879048634"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_3_1 = "Execute 2345Pinyin MiniPage Task" ascii //weight: 3
        $x_2_2 = {49 00 6e 00 74 00 65 00 72 00 6e 00 61 00 6c 00 4e 00 61 00 6d 00 65 00 00 00 32 00 33 00 34 00 35 00 41 00 75 00 74 00 68 00 6f 00 72 00 69 00 74 00 79 00 50 00 72 00 6f 00 74 00 65 00 63 00 74 00}  //weight: 2, accuracy: High
        $x_2_3 = ":\\rhino\\safe\\src\\authorityprotect\\authorityprotect\\rcmainapplication.cpp" wide //weight: 2
        $x_2_4 = "\\Rhino\\Safe\\Bin\\Win32\\release\\pdb\\2345AuthorityProtect.pdb" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (
            ((2 of ($x_2_*))) or
            ((1 of ($x_3_*) and 1 of ($x_2_*))) or
            (all of ($x*))
        )
}

rule __PUA_Block_2345Cn_47
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:2345Cn"
        threat_id = "1879048634"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "13"
        strings_accuracy = "Low"
    strings:
        $x_8_1 = "Execute 2345Pinyin MiniPage Task" ascii //weight: 8
        $x_4_2 = {50 00 72 00 6f 00 64 00 75 00 63 00 74 00 4e 00 61 00 6d 00 65 00 00 00 00 00 32 00 33 00 34 00 35 00 89 5b 68 51 6b 53 eb 58 (0b 4e 7d 8f|28 57 bf 7e 89 5b c5 88 0b 7a)}  //weight: 4, accuracy: Low
        $x_4_3 = "\\Rhino\\Safe\\Install\\FileDown\\bin\\release_static\\2345SafeDownloader.pdb" ascii //weight: 4
        $x_1_4 = "RC::RCSafeDownload::PreparePostData" wide //weight: 1
        $x_1_5 = "RC::RCSafeDownload::RequireWebData" wide //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_8_*) and 1 of ($x_4_*) and 1 of ($x_1_*))) or
            ((1 of ($x_8_*) and 2 of ($x_4_*))) or
            (all of ($x*))
        )
}

rule __PUA_Block_2345Cn_48
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:2345Cn"
        threat_id = "1879048634"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "Execute 2345Pinyin MiniPage Task" ascii //weight: 2
        $x_1_2 = {49 00 6e 00 74 00 65 00 72 00 6e 00 61 00 6c 00 4e 00 61 00 6d 00 65 00 00 00 32 00 33 00 34 00 35 00 50 00 64 00 66 00 46 00 65 00 65 00 64 00 62 00 61 00 63 00 6b 00}  //weight: 1, accuracy: High
        $x_1_3 = "RCPDFConverter_minidump_generate_mutex_{354DB438-AE28-493C-B5EE-0C06923930E6}" wide //weight: 1
        $x_1_4 = ":\\zhanlue\\pdfconverter\\bin\\Win32\\release_static\\pdb\\2345PdfFeedback.pdb" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_2_*) and 2 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule __PUA_Block_2345Cn_49
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:2345Cn"
        threat_id = "1879048634"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "Low"
    strings:
        $x_2_1 = "Execute 2345Pinyin MiniPage Task" wide //weight: 2
        $x_2_2 = {4f 00 72 00 69 00 67 00 69 00 6e 00 61 00 6c 00 46 00 69 00 6c 00 65 00 6e 00 61 00 6d 00 65 00 00 00 32 00 33 00 34 00 35 00 4d 00 69 00 6e 00 69 00 50 00 61 00 67 00 65 00 2e 00 65 00 78 00 65 00}  //weight: 2, accuracy: High
        $x_2_3 = {4f 00 72 00 69 00 67 00 69 00 6e 00 61 00 6c 00 46 00 69 00 6c 00 65 00 6e 00 61 00 6d 00 65 00 00 00 32 00 33 00 34 00 35 00 42 00 6f 00 6f 00 74 00 41 00 73 00 73 00 69 00 73 00 74 00 61 00 6e 00 74 00 2e 00 65 00 78 00 65 00}  //weight: 2, accuracy: High
        $x_1_4 = {75 00 70 00 64 00 61 00 74 00 65 00 [0-2] 6d 00 69 00 6e 00 69 00 70 00 61 00 67 00 65 00 2e 00 32 00 33 00 34 00 35 00 2e 00 63 00}  //weight: 1, accuracy: Low
        $x_1_5 = "minipage.stat" wide //weight: 1
        $x_1_6 = "\\2345MiniPage.NewVersion.data" wide //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_2_*) and 3 of ($x_1_*))) or
            ((2 of ($x_2_*) and 1 of ($x_1_*))) or
            ((3 of ($x_2_*))) or
            (all of ($x*))
        )
}

rule __PUA_Block_2345Cn_50
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:2345Cn"
        threat_id = "1879048634"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "7"
        strings_accuracy = "Low"
    strings:
        $x_4_1 = "Execute 2345Pinyin MiniPage Task" ascii //weight: 4
        $x_2_2 = {49 00 6e 00 74 00 65 00 72 00 6e 00 61 00 6c 00 4e 00 61 00 6d 00 65 00 00 00 32 00 33 00 34 00 35 00 53 00 46 00 47 00 75 00 61 00 72 00 64 00}  //weight: 2, accuracy: High
        $x_2_3 = {3a 5c 52 68 69 6e 6f 50 72 6f 74 65 63 74 5c 50 75 62 6c 69 73 68 5c 4f 75 74 50 75 74 5c 62 69 6e 5c 57 69 6e 33 32 5c 52 65 6c 65 61 73 65 5c 70 64 62 5c 32 33 34 35 53 46 47 75 61 72 64 36 34 2e 70 64 62}  //weight: 2, accuracy: Low
        $x_1_4 = "{\"CrashProcessCmdLine\":\"/notify_guard\",\"CrashProcessPath\":\"C:\\\\2345SFGuard.exe" wide //weight: 1
        $x_1_5 = "/notify_desk_guard" wide //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_4_*) and 1 of ($x_2_*) and 1 of ($x_1_*))) or
            ((1 of ($x_4_*) and 2 of ($x_2_*))) or
            (all of ($x*))
        )
}

rule __PUA_Block_2345Cn_51
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:2345Cn"
        threat_id = "1879048634"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "7"
        strings_accuracy = "High"
    strings:
        $x_4_1 = "Execute 2345Pinyin MiniPage Task" ascii //weight: 4
        $x_2_2 = {49 00 6e 00 74 00 65 00 72 00 6e 00 61 00 6c 00 4e 00 61 00 6d 00 65 00 00 00 32 00 33 00 34 00 35 00 50 00 69 00 6e 00 79 00 69 00 6e 00 49 00 6e 00 73 00 74 00 61 00 6c 00 6c 00}  //weight: 2, accuracy: High
        $x_2_3 = "\\bin\\x64\\Release\\pdb\\2345PinyinInstall.pdb" ascii //weight: 2
        $x_1_4 = "Global\\2345PinyinServiceNotifyMonitorEvent" wide //weight: 1
        $x_1_5 = "{E40A71E6-5E48-4A66-8BA1-5D8CED78552D}_RCIM_GLOBLE_COMMOM_SEGMENT_SHARED" wide //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_4_*) and 1 of ($x_2_*) and 1 of ($x_1_*))) or
            ((1 of ($x_4_*) and 2 of ($x_2_*))) or
            (all of ($x*))
        )
}

rule __PUA_Block_2345Cn_52
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:2345Cn"
        threat_id = "1879048634"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "7"
        strings_accuracy = "High"
    strings:
        $x_4_1 = "Execute 2345Pinyin MiniPage Task" ascii //weight: 4
        $x_2_2 = {49 00 6e 00 74 00 65 00 72 00 6e 00 61 00 6c 00 4e 00 61 00 6d 00 65 00 00 00 32 00 33 00 34 00 35 00 50 00 69 00 6e 00 79 00 69 00 6e 00 53 00 6b 00 69 00 6e 00 55 00 74 00 69 00 6c 00}  //weight: 2, accuracy: High
        $x_2_3 = "\\bin\\Win32\\Release\\pdb\\2345PinyinSkinUtil.pdb" ascii //weight: 2
        $x_1_4 = "Global\\2345PinyinServiceNotifyMonitorEvent" wide //weight: 1
        $x_1_5 = "{E40A71E6-5E48-4A66-8BA1-5D8CED78552D}_RCIM_GLOBLE_COMMOM_SEGMENT_SHARED" wide //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_4_*) and 1 of ($x_2_*) and 1 of ($x_1_*))) or
            ((1 of ($x_4_*) and 2 of ($x_2_*))) or
            (all of ($x*))
        )
}

rule __ASRWin32ApiMacroExclusion_0
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "2"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Palisade" ascii //weight: 1
        $x_1_2 = "DTOOLS8_x86.XLL" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_1
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "SOP Return.xlsm" ascii //weight: 2
        $x_2_2 = "SOP Data BACKUP.xlsm" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_2
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "application.run(\"piputval\"" ascii //weight: 2
        $x_2_2 = "piextimeval" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_3
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "10"
        strings_accuracy = "High"
    strings:
        $x_5_1 = "C:\\Program Files (x86)\\DPW-Apps\\" ascii //weight: 5
        $x_5_2 = "pathline" ascii //weight: 5
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_4
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "Sub LB2DATA()" ascii //weight: 2
        $x_2_2 = "Sub TTTSELECTION()" ascii //weight: 2
        $x_2_3 = "Sub ptdSELECTION()" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_5
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "www.mdf-xlpages.com" ascii //weight: 1
        $x_1_2 = "www.excelabo.net" ascii //weight: 1
        $x_1_3 = "http://excel-malin.com" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_6
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "ActiveWorkbook.Worksheets(\"Notes\").Activate" ascii //weight: 2
        $x_2_2 = "Call JrnlSheet_Select" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_7
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "BOM Upload.xlsx" ascii //weight: 2
        $x_2_2 = "MsgBox \"The BOM File has been saved to \"" ascii //weight: 2
        $x_1_3 = "Sub BOM_Upload()" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_8
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "Public Sub Verketten_G()" ascii //weight: 2
        $x_2_2 = "Sub SAP_ImportG_Erzeugen()" ascii //weight: 2
        $x_2_3 = "Sub ZeileEinfugen_G()" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_9
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "2"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "name=\"asaputilitiesribbon\"" ascii //weight: 2
        $x_2_2 = "description=\"ribbon and handler for asap utilities\"" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (1 of ($x*))
}

rule __ASRWin32ApiMacroExclusion_10
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "30"
        strings_accuracy = "High"
    strings:
        $x_10_1 = {22 a9 20 22 20 26 20 59 65 61 72 28 4e 6f 77 29 20 26 20 22 2c 20 4d 55 46 47 20 42 61 6e 6b 2e 20 20 41 6c 6c 20 52 69 67 68 74 73 20 52 65 73 65 72 76 65 64 2e}  //weight: 10, accuracy: High
        $x_10_2 = "CIQTicker" ascii //weight: 10
        $x_10_3 = "RATogglePF" ascii //weight: 10
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_11
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "Sheets(\"PBR_Template\").Select" ascii //weight: 2
        $x_2_2 = "Sub expo_closePBR()" ascii //weight: 2
        $x_2_3 = "Private Sub Splits_FMT_1()" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_12
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "Set BEx1 = Application.Run(\"BExAnalyzer.xla!GetBEx\")" ascii //weight: 2
        $x_2_2 = "If InStr(lName.Name, \"BEx\")" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_13
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "software\\haver\\dlxmenu" ascii //weight: 2
        $x_2_2 = "software\\haver\\dlxranger" ascii //weight: 2
        $x_2_3 = "software\\haver\\exceldatefirst" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (2 of ($x*))
}

rule __ASRWin32ApiMacroExclusion_14
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "Public Sub PopPeteDevPwd" ascii //weight: 2
        $x_2_2 = "Public Sub ToggleProdVersion" ascii //weight: 2
        $x_2_3 = "Public Sub PopPeteBlackPwd" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_15
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "Public Function SysCfgSht()" ascii //weight: 2
        $x_2_2 = "Public Function DdCfgSht()" ascii //weight: 2
        $x_2_3 = "Public Function DMastSht()" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_16
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "HSBCnetCheck.Value" ascii //weight: 2
        $x_2_2 = "ActiveSheet.Protect (\"abernoway\")" ascii //weight: 2
        $x_2_3 = "ActiveSheet.Name = \"WPSSalary\"" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_17
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "Ereignisse deaktivieren" ascii //weight: 2
        $x_2_2 = "Bildschirmaktualisierung deaktivieren" ascii //weight: 2
        $x_2_3 = "Fehlerbehandlung einleiten" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_18
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "cnn_cases.Close: Set cnn_cases = Nothing" ascii //weight: 2
        $x_2_2 = "Function FTNSA_Inline" ascii //weight: 2
        $x_2_3 = "Private Sub cmbYear_KeyDown" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_19
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "Sub Anexar()" ascii //weight: 2
        $x_2_2 = "Attribute Anexar.VB_ProcData.VB_Invoke_Func" ascii //weight: 2
        $x_2_3 = "Windows(\"SIO_Valles.xls\").Activate" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_20
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "Private Sub cboHomeTm_Change()" ascii //weight: 2
        $x_2_2 = "Private Sub cbxCarBk_Change()" ascii //weight: 2
        $x_2_3 = "Private Sub cboLoanTm_Change()" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_21
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "Einparken Makro" ascii //weight: 2
        $x_2_2 = "Makro EDV-Nummern tauschen" ascii //weight: 2
        $x_1_3 = "ActiveWorkbook.Worksheets(\"EDV-Racos\").AutoFilter" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_22
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "2"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "C:\\Program Files\\SASHome94\\SASScratch\\bin\\YourPage.pdf" ascii //weight: 2
        $x_2_2 = "C:\\Program Files\\SASHome94\\SASScratch\\bin" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (1 of ($x*))
}

rule __ASRWin32ApiMacroExclusion_23
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "\"OCG Tracker V\" & Params.Property(\"OcgTrackerVersion\")" ascii //weight: 2
        $x_2_2 = "all data held on this system is RESTRICTED" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_24
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "Private Sub cbowcDay_Change()" ascii //weight: 2
        $x_2_2 = "Private Sub ChkSingleQueue_Change()" ascii //weight: 2
        $x_2_3 = "Private Sub lblTitle_Click()" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_25
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "@Folder(\"Binocs-API.Demand\")" ascii //weight: 2
        $x_2_2 = "Dim binocsApi As TableApiManager" ascii //weight: 2
        $x_2_3 = "Set binocsApi = newTableApiManage" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_26
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "Sub EntradasSalidas()" ascii //weight: 2
        $x_2_2 = "PvtNombre = \"pvtEntradasSalidas\"" ascii //weight: 2
        $x_2_3 = "Windows(\"Reportes_Diarios.xlsm\").Activate" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_27
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "ActiveSheet.Name = \"Byggeplads\"" ascii //weight: 2
        $x_2_2 = "ActiveSheet.Name = \"Huskeliste\"" ascii //weight: 2
        $x_2_3 = "Application.Sheets(\"Detailkalk\")" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_28
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "NombreMacro = \"Nombre de la macro \"" ascii //weight: 2
        $x_2_2 = "ms = ms & \"Sin operacion en cemex \"" ascii //weight: 2
        $x_2_3 = "Sub Modulo_Consultar_OC()" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_29
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "strCmd = puttyDirectory & \"plink.exe" ascii //weight: 1
        $x_1_2 = "Sub SSH_Command_to_Excel_PuTTY()" ascii //weight: 1
        $x_1_3 = "Dim puttyDirectory As String" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_30
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "'MsgBox \"Success: PDF converted into Text" ascii //weight: 2
        $x_2_2 = "'Application.StatusBar = \"PDF Name convertion processing..." ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_31
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "FileName = \"Official Sensitive QATRO Assessment - \" " ascii //weight: 2
        $x_2_2 = "Sub BRPValidate()" ascii //weight: 2
        $x_2_3 = "Sub Original_RecordAsylum()" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_32
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "Bastien Mensink (author of ASAP Utilities and working on it since 1999)" ascii //weight: 2
        $x_2_2 = "https://www.asap-utilities.com" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_33
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "Function StaffingStats(ByVal SiteName As String)" ascii //weight: 2
        $x_2_2 = "cnn_roster.Execute SQL" ascii //weight: 2
        $x_2_3 = "Function WeeklyEventStats()" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_34
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "body_1 = Sheets(\"Mail\").Range(\"C7\")" ascii //weight: 2
        $x_2_2 = "body = Sheets(\"Mail\").Range(\"C8\")" ascii //weight: 2
        $x_2_3 = "Application.ScreenUpdating = True" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_35
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "KPMG ChartMagic" ascii //weight: 1
        $x_1_2 = "Const KPMGUtil As String = \"KPMG_DocShare\"" ascii //weight: 1
        $x_1_3 = "ActiveChart.ApplyChartTemplate \"KPMG_Scatter\"" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_36
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "http://plantuml.com/patreon" ascii //weight: 2
        $x_2_2 = "By Chip Pearson, chip@cpearson.com, www.cpearson.com" ascii //weight: 2
        $x_2_3 = "http://www.slipstick.com" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_37
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "PvtNombre = \"pvtInventarioFisico\"" ascii //weight: 2
        $x_2_2 = "Obj.Abrir (\"CierreDiario.XLS\")" ascii //weight: 2
        $x_2_3 = "Windows(\"INV DIARIOS JCN.xlsm\").Activate" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_38
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "2"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Set client = newWebClient(\"https://\" & binocsEnvironment & \".mybinocs.com/\")" ascii //weight: 1
        $x_1_2 = "@Folder(\"Binocs-API.Connection\")" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_39
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "Application.CalculateFullRebuild" ascii //weight: 2
        $x_2_2 = "Sub ButtonRainfall_Click()" ascii //weight: 2
        $x_2_3 = "Attribute put_data1.VB_ProcData.VB_Invoke_Func" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_40
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "Private Const BFFM_SETSELECTION = WM_USER + 102" ascii //weight: 2
        $x_2_2 = "Private Const BFFM_INITIALIZED = 1" ascii //weight: 2
        $x_2_3 = "strClassName = \"XLMAIN\"" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_41
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "capture_invoiceno = 1 Then ActiveSheet.Cells(lastrow, 3)" ascii //weight: 2
        $x_2_2 = "If invoicedate = 1 Then ActiveSheet.Cells(lastrow, 4) " ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_42
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "Name = Worksheets(\"Blasmaschine\").Range(\"A3\").Value & \"DB0\"" ascii //weight: 2
        $x_2_2 = "Name = Worksheets(\"Etima\").Range(\"A3\").Value & \"DB0\"" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_43
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "Sub Clear_Consolidated_by_Commodity()" ascii //weight: 2
        $x_2_2 = "Sub Clear_Flour_Contracts_by_COPC()" ascii //weight: 2
        $x_2_3 = "Sub Clear_Flour_Contracts_by_COMM()" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_44
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "Private pAccMode As String" ascii //weight: 2
        $x_2_2 = "pAccMode = RegistryGet(\"General\", \"AccMode\")" ascii //weight: 2
        $x_2_3 = "MsgBox \"Not possible with Sheet Drill\"" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_45
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "attribute vb_name = \"modconversion\"" ascii //weight: 2
        $x_2_2 = "public const appname as string = \"euro add-in\"" ascii //weight: 2
        $x_2_3 = "private sub euro_convert_ex" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_46
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "Sub NonFinancialInfoTransfer()" ascii //weight: 2
        $x_2_2 = "Sub OtherExpenditureTransfer()" ascii //weight: 2
        $x_2_3 = "Desktop\\Invoicing\\Fostering PDF Invoices\\Aberdeen" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_47
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "8"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "Private Sub WakuKeisen" ascii //weight: 2
        $x_2_2 = "Public OraDataBase As ADODB.Connection" ascii //weight: 2
        $x_2_3 = "Private Sub Keisen" ascii //weight: 2
        $x_2_4 = "Private Sub CbbKsy_Change()" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_48
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "Attribute VB_Name = \"clsCBRMSheets\"" ascii //weight: 2
        $x_2_2 = "Global mcolCBRMSheets As colCBRMSheets" ascii //weight: 2
        $x_2_3 = "Set objCBRMSheets = New clsCBRMSheets" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_49
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "Function ProduceCatTeams(cat As String)" ascii //weight: 2
        $x_2_2 = "Private Sub cbx_Management_Click()" ascii //weight: 2
        $x_2_3 = "Function ShiftRequests_InitialSetup()" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_50
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "Public Sub syncSelection(ByVal Target As PivotTable)" ascii //weight: 2
        $x_2_2 = "If InStr(pfMain.Name, \"Region\")" ascii //weight: 2
        $x_2_3 = "InStr(pfMain.Name, \"Brand\")" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_51
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "http://zotero.org" ascii //weight: 1
        $x_1_2 = "Sub ZoteroCommand(cmd As String, bringToFront As Boolean)" ascii //weight: 1
        $x_1_3 = "Public Sub ZoteroInsertBibliography()" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_52
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_2_1 = ".PivotTables(\"ptGraphData\").RefreshTable" ascii //weight: 2
        $x_2_2 = "With .PivotTables(\"ptAuditTrail\")" ascii //weight: 2
        $x_2_3 = "ActiveWorkbook.Unprotect \"Northgateps\"" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_53
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "Public Enum FrmDblProgressLevel" ascii //weight: 2
        $x_2_2 = "utilFiles.LoadSourceFile Fpath, RawShtNm, \"_res\"" ascii //weight: 2
        $x_2_3 = "WasProt = DMastSht.ProtectContents" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_54
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "30"
        strings_accuracy = "High"
    strings:
        $x_10_1 = "B_VAT_WHT_Dtls" ascii //weight: 10
        $x_10_2 = "VatWithholdingExcelDTO.totalPayableAmount" ascii //weight: 10
        $x_10_3 = "PINNo = Worksheets(\"A_Basic_Info\").Range(\"SecA.PIN\").value" ascii //weight: 10
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_55
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "https://www.asap-utilities.com" ascii //weight: 2
        $x_2_2 = "Attribute VB_Name = \"ASAPlIlIIlllllllIlIllIlIIIIlI\"" ascii //weight: 2
        $x_1_3 = "Private Sub UserForm_Initialize()" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_56
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "Attribute VB_Name = \"PQM_Report\"" ascii //weight: 2
        $x_2_2 = "Attribute VB_Name = \"PQM_Automation\"" ascii //weight: 2
        $x_2_3 = "Set pPQMConnection = g_objApp.ActiveConnection" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_57
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "vbCritical, \"ITG Design | AddDesignPg\"" ascii //weight: 2
        $x_2_2 = "Set visMstr = visMstrs.Item(\"CKTDemark\")" ascii //weight: 2
        $x_2_3 = "vbCritical, \"ITG Design | AddXPRTPg\"" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_58
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "Set B1 = Sheets(arket).Buttons(\"OpretPensionKontoKnap\")" ascii //weight: 2
        $x_2_2 = "Sub OpretPensionKontiKnap()" ascii //weight: 2
        $x_2_3 = "Private Sub opret_pensionkonti()" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_59
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "ChemDrawExcelAddIn21.ExcelAddIn" ascii //weight: 1
        $x_1_2 = "cdxldocument" ascii //weight: 1
        $x_1_3 = "CSXL_ShowStructureDrawings" ascii //weight: 1
        $x_1_4 = "CDXLAddInProgID" ascii //weight: 1
        $x_1_5 = "CSXL_MakeNewCSWorksheet" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_60
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "oSourceBook.SaveAs sTargetPfad & \"Trafodaten_bereinigt.xlsx\"" ascii //weight: 2
        $x_2_2 = "Userform einblenden (nicht modal)" ascii //weight: 2
        $x_2_3 = "Sub Daten_bereinigen()" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_61
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "15"
        strings_accuracy = "High"
    strings:
        $x_10_1 = "https://www.asap-utilities.com" ascii //weight: 10
        $x_5_2 = "Bastien Mensink" ascii //weight: 5
        $x_5_3 = "Attribute ButtonGroupDynamic.VB_VarHelpID" ascii //weight: 5
        $x_5_4 = "Private Type SHFILEOPSTRUCT" ascii //weight: 5
    condition:
        (filesize < 20MB) and
        (
            ((3 of ($x_5_*))) or
            ((1 of ($x_10_*) and 1 of ($x_5_*))) or
            (all of ($x*))
        )
}

rule __ASRWin32ApiMacroExclusion_62
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "Private Const ModuleName As String = \"AddinReportUI\"" ascii //weight: 2
        $x_2_2 = "Sheets(\"Add-in Details\").Activate" ascii //weight: 2
        $x_2_3 = "Sub AdoptedSupportedGroup_Click()" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_63
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "8"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "ServerName = \"HKSQL-IKA\\HKSQLIKA\"" ascii //weight: 2
        $x_2_2 = "dname = \"Ikasan01\"" ascii //weight: 2
        $x_2_3 = "uName = \"SYS_IKAPRD_SQL\"" ascii //weight: 2
        $x_2_4 = "def_subject = \"Fidessa Order Report - \"" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_64
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "attribute vb_name = \"chroniclesexport\"" ascii //weight: 2
        $x_2_2 = "private const module = \"epic export macro\"" ascii //weight: 2
        $x_2_3 = "onaction = \"chroniclesexport.exportdata\"" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_65
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "ActiveWorkbook.Worksheets(\"Control\").Activate" ascii //weight: 2
        $x_2_2 = "Attribute GetMsg.VB_ProcData.VB_Invoke_Func = \" \\n14\"" ascii //weight: 2
        $x_2_3 = "GetMsg = \"JrnlLog.xls\"" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_66
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "createFXCoverageEmail.VB_ProcData.VB_Invoke_Func" ascii //weight: 2
        $x_2_2 = "createFXCoverageEmailCompliance" ascii //weight: 2
        $x_2_3 = "Please find attached the FX Coverage Report" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_67
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "Sub FazSpiegel()" ascii //weight: 2
        $x_2_2 = "Sub FazSpiegelDir(sDir)" ascii //weight: 2
        $x_2_3 = "config\\Fazspiegel.ini" ascii //weight: 2
        $x_2_4 = "MsgBox \"Bitte nutzen sie die Mustervorlage Fazspiegel.xlt\"" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (3 of ($x*))
}

rule __ASRWin32ApiMacroExclusion_68
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "Public Const Developer = \"melvilc\"" ascii //weight: 2
        $x_2_2 = "Public Const Shortcut_Name = \"DAC Portal.lnk\"" ascii //weight: 2
        $x_2_3 = "Public Const Portal_FileName = \"Portal.xlsm\"" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_69
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "Credits: http://www.dreamincode.net/code/snippet540.htm" ascii //weight: 2
        $x_2_2 = "GBR NOTE: This works, but we have no access to stdin, stdout or stderr..." ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_70
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "BloombergVersionChecker" ascii //weight: 1
        $x_1_2 = "Bloomberg.ccyreader" ascii //weight: 1
        $x_1_3 = "BB_TAX_DATA_ASSUM" ascii //weight: 1
        $x_1_4 = "BB_REV_NUM_EST_ERR_EPS" ascii //weight: 1
        $x_1_5 = "Case \"Chng in Net LongT Def Tax Liab\"" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_71
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "Sub Refresh_ACT_FCST_LMR()" ascii //weight: 2
        $x_2_2 = "accApp.docmd.openquery (\"LMR Rechnungsdaten Update Tabelle\")" ascii //weight: 2
        $x_2_3 = "uOFN.sDlgTitle = \"Datei speichern unter\"" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_72
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "Private Const m_PASSWORD As String = \"Puls003114\"" ascii //weight: 2
        $x_2_2 = "RibbonControlRefresh \"btnResetMarks\"" ascii //weight: 2
        $x_2_3 = "Set m_oRoot = GetObject(\"LDAP://RootDSE\")" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_73
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Public Const AppName = \"GT PDFMeld Toolkit\"" ascii //weight: 1
        $x_1_2 = "Const PDFBatchFile = \"RunPDFMeld.bat\"" ascii //weight: 1
        $x_1_3 = "Author : Ejaz Ahmed - ejaz.ahmed.1989@gmail.com" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_74
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "Set book = wb.Workbooks.Add(ThisWorkbook.Path & \"\\spinner.xlsm\")" ascii //weight: 2
        $x_1_2 = "Sub DoCalcTimer(jMethod As Long)" ascii //weight: 1
        $x_1_3 = "Function MicroTimer() As Double" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_75
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "BatFile = \"c:\\temp\\softlinkpromotetomaster.cmd\"" ascii //weight: 2
        $x_2_2 = "BatFile = \"c:\\temp\\softlinkbranchsetup.cmd\"" ascii //weight: 2
        $x_2_3 = "mfile, \"plink -pw build build@theta \"" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_76
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Set fd = Application.FileDialog(msoFileDialogFolderPicker)" ascii //weight: 1
        $x_1_2 = "Author: David Mosier, Neil Johnson" ascii //weight: 1
        $x_1_3 = "Public Const DAGsFile = \"DAGInfo.csv\"" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_77
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "Set SubFolder2 = SubFolder.Folders(\"NINO v2 IPT Tier 2 emails\")" ascii //weight: 2
        $x_2_2 = "Public Sub MoveEmailsToIPTArchive()" ascii //weight: 2
        $x_2_3 = "Dim Inbox As Outlook.MAPIFolder" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_78
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "Function recupere_table_utilisateurs() As Variant" ascii //weight: 2
        $x_2_2 = "Sql = \"SELECT * FROM 05_UPS_Crew \"" ascii //weight: 2
        $x_2_3 = "Sub Retrouve_analyses_non_releasees_sans_email()" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_79
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "Set thisWorksheet = ActiveWorkbook.Worksheets(\"CP Client\")" ascii //weight: 2
        $x_2_2 = "Sub transfer_binaries_to_MetaMon()" ascii //weight: 2
        $x_2_3 = "Sub transfer_binaries_to_L3_test_team()" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_80
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Set l_control = Application.CommandBars.FindControl(Tag:=\"DFWFilter\")" ascii //weight: 1
        $x_1_2 = "Set lShape = lSheet.Shapes(\"InfoA\")" ascii //weight: 1
        $x_1_3 = "InStr(1, lShape.Name, \"BEx\")" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_81
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Created by - Brochet ltd" ascii //weight: 1
        $x_1_2 = "www.brochet.co.uk" ascii //weight: 1
        $x_1_3 = "Author:Duncan Milnes - Brochet" ascii //weight: 1
        $x_1_4 = "Public Const COMPANY_NAME_SHORT As String = \"Frazer-Nash\"" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (3 of ($x*))
}

rule __ASRWin32ApiMacroExclusion_82
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "8"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "EPLAN4\\EXCEL\\XLS138B.XLS 2004-02-05" ascii //weight: 2
        $x_2_2 = "Public Anzeige_Prozent As String" ascii //weight: 2
        $x_2_3 = "Public Artikelkennung As Long" ascii //weight: 2
        $x_2_4 = "Public Merker_Artikeltyp As Long" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_83
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "Public Const Shortcut_Name = \"SSRC Portal.lnk\"" ascii //weight: 2
        $x_2_2 = "Public Const Icon_Description = \"SSRC Portal\"" ascii //weight: 2
        $x_2_3 = "Public Const Portal_FileName = \"Portal.xlsm\"" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_84
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "ActiveWorkbook.Worksheets(\"6 - Infant Feeding\")" ascii //weight: 2
        $x_2_2 = "ServiceComboBox1.AddItem \"Tongue-tie support\"" ascii //weight: 2
        $x_2_3 = "ActiveWorkbook.Worksheets(\"Outputs_SFLIFMH\")" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_85
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "Declare PtrSafe Function XLPyDLLNDims Lib \"xlwings64.dll\"" ascii //weight: 2
        $x_2_2 = "Private Declare PtrSafe Function XLPyDLLNDims Lib \"xlwings32.dll\"" ascii //weight: 2
        $x_2_3 = "xlwings_log.txt" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_86
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Sub eingabeblattFormeln()" ascii //weight: 1
        $x_1_2 = "Set ws = ThisWorkbook.Worksheets(\"Eingabe\")" ascii //weight: 1
        $x_1_3 = "safepath = Application.ActiveWorkbook.Path & \"\\MFT-N-Paten-Blatt.xlsx\"" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_87
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Private Function GenUuid(sUuid As String) As Boolean" ascii //weight: 1
        $x_1_2 = "Public Function isSAPDoc(key As String) As Boolean" ascii //weight: 1
        $x_1_3 = "Case Is = \"SAPGroup\"  ' Styles group" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_88
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "Please select a cell that is not blank or contains a validation list" ascii //weight: 2
        $x_2_2 = "Lists that contain more than 2,000 items may take additional time to sort." ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_89
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "Sub DoCalcTimer(jMethod As Long)" ascii //weight: 2
        $x_2_2 = "Set book = wb.Workbooks.Add(ThisWorkbook.Path & \"\\spinner.xlsm\")" ascii //weight: 2
        $x_2_3 = "sCalcType = \"Recalculate open workbooks: \"" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_90
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "8"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "Workbooks(\"ASAP Utilities.xlam\").Path" ascii //weight: 2
        $x_2_2 = "ASAPRibbon_Initialize(ribbon As IRibbonUI)" ascii //weight: 2
        $x_2_3 = "Application.Run \"ASAPRunProc_x64\"" ascii //weight: 2
        $x_2_4 = "www.asap-utilities.com" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_91
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "clsProperties.removeProperty \"ICX_SESSION_ID\"" ascii //weight: 2
        $x_2_2 = "ERVLET_PATH = \"http://ebsprd.homeoffice.amc.corp:80/OA_HTML/\"" ascii //weight: 2
        $x_2_3 = "Public Sub BneOnCreateProcedure()" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_92
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "Private Const PATHDEST = \"H:\\capacity\\Tool\\Data" ascii //weight: 2
        $x_2_2 = "Private Const PATHDESTDATAS = \"H:\\capacity\\Tool\\Poc_Datas" ascii //weight: 2
        $x_2_3 = "strSql = \"UpdateCapaplanningVMSize\"" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_93
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "Call populate_Globals" ascii //weight: 2
        $x_2_2 = "If tMilestones(taskCount).projUID = \"Retail Records Management Programme-184\" Then Stop" ascii //weight: 2
        $x_2_3 = "Sub link_Milestones(preID, sucID)" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_94
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "Sub PO_Cancellation_Process()" ascii //weight: 2
        $x_2_2 = "Sheets(\"PO Details\")" ascii //weight: 2
        $x_2_3 = "PO_Ads = SAPScript.Find_Adds(\"Sales order no\"): Mat_Ads = SAPScript.Find_Adds(\"Part Number\")" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_95
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "Application.StatusBar = \"Preparing for SAMP analysis\"" ascii //weight: 2
        $x_2_2 = "If UCase(VBConstants.Range(\"SAMP_RUN_DATE\").Value2) <> \"\" Then Exit Sub" ascii //weight: 2
        $x_2_3 = "Call Fix_Ribbon_MP" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_96
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Sub GenerateSFRQuery()" ascii //weight: 1
        $x_1_2 = "MsgBox \"SFR query copied to clipboard\"" ascii //weight: 1
        $x_1_3 = "sfr_link = \"http://sfr/prodAsp/scripts/MSG/sfr.asp?sfr=\"" ascii //weight: 1
        $x_1_4 = "Sub CreateSFRDescList()" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_97
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "Call Application.Run(\"CPPlusGI.CreateEdit_GICase\")" ascii //weight: 2
        $x_2_2 = "MsgBox Now & vbCrLf & \"Mitogen.EditCase()\"" ascii //weight: 2
        $x_2_3 = "End If 'GetVariable(\"EnableGeneInsight\", dDoc.Name)" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_98
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "The Shared Control Room SOCCUI is already open" ascii //weight: 2
        $x_2_2 = "This will result in changes saved in the SOCCUI" ascii //weight: 2
        $x_2_3 = "Closing this copy of the Shared Control Room SOCCUI" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_99
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Sub add_Milestones(showSlip, xlName)" ascii //weight: 1
        $x_1_2 = "Commencing Reporting" ascii //weight: 1
        $x_1_3 = "Retail Records Management Programme-184" ascii //weight: 1
        $x_1_4 = "tMilestones(taskCount)" ascii //weight: 1
        $x_1_5 = "\"Milestone Swimlane\"" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_100
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "30"
        strings_accuracy = "High"
    strings:
        $x_10_1 = "Impression du formulaire d'audit 5S pour les stocks" ascii //weight: 10
        $x_10_2 = "lettres pour affichage sur le tableau de secteur" ascii //weight: 10
        $x_10_3 = {27 20 43 68 6f 69 78 20 61 6c e9 61 74 6f 69 72 65 20 64 65 20 6c 61 20 71 75 65 73 74 69 6f 6e 20 65 6e 76 69 72 6f 6e 6e 65 6d 65 6e 74}  //weight: 10, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_101
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "Attribute VB_Name = \"DieseArbeitsmappe\"" ascii //weight: 2
        $x_2_2 = "Set oBar = Application.CommandBars.Add(\"KRONES\")" ascii //weight: 2
        $x_2_3 = "Application.CommandBars(\"KRONES\").Controls(\"Execute\").Delete" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_102
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Please upgrade Thomson Reuters Eikon Excel" ascii //weight: 1
        $x_1_2 = "Please sign in to Thomson Reuters Eikon Excel" ascii //weight: 1
        $x_1_3 = "CommandText = Array(\"SELECT * FROM [http://flow gassco no/]\")" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_103
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "Public Function LMT_GetEquivalentRating" ascii //weight: 2
        $x_2_2 = "Public Function LMT_GetPartyCreditRating" ascii //weight: 2
        $x_2_3 = "Set dbsDatabase_5AM = OpenDatabase(\"Findur_5am\", False, True, \"ODBC;\")" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_104
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "Private Const frameCaption$ = \"Impact on National Security / Infrastructure\"" ascii //weight: 2
        $x_2_2 = "Public Function FixUp_criminalityData()" ascii //weight: 2
        $x_2_3 = "Public Function FixUp_managementData()" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_105
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Set REnd = Sheets(\"NGL SDFI - IKKE R" ascii //weight: 1
        $x_1_2 = "R\").Range(\"A400\").End(xlUp).Offset(0, 3)" ascii //weight: 1
        $x_1_3 = "Set RStart = Range(\"A2\")" ascii //weight: 1
        $x_1_4 = "If WorksheetFunction.CountBlank(.Rows(i)) = 4 Then" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_106
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "2"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "WordIntegration.FillListWordtable cbProducts, \"e:\\WordTemplate\\Data\\Products.docm\"" ascii //weight: 1
        $x_1_2 = "cbProducts, \"http://compass2sites.perscorp.com/sites/1163/Data/Products.docm\"" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_107
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "ActiveWorkbook.Unprotect Password:=\"HRSSSA\"" ascii //weight: 1
        $x_1_2 = "ActiveWorkbook.SaveCopyAs strPath & \"\\HR-Employment-Form_New.xlsb\"" ascii //weight: 1
        $x_1_3 = "wsParameters.Range(\"FileName2\") = \"HRFRMGNA.csv\"" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_108
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "sTitulo = \"Selecione um arquivo DOC\"" ascii //weight: 1
        $x_1_2 = "Modelo para Unir os TRVs.docm" ascii //weight: 1
        $x_1_3 = "Set DOC = Word.Documents.Open(lPasta & \"\\UniTRVs.docm\")" ascii //weight: 1
        $x_1_4 = "Public Sub diretorio_modelo_DOC()" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_109
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "10"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "Private Sub TBDiscretion_Change()" ascii //weight: 2
        $x_2_2 = "Private Sub TBReadytoCasework_Change()" ascii //weight: 2
        $x_2_3 = "Private Sub PreBioCopy2()" ascii //weight: 2
        $x_2_4 = "Private Sub SharePerformance1()" ascii //weight: 2
        $x_2_5 = "https://www.quackit.com" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_110
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Attribute createNamedRanges.VB_ProcData.VB_Invoke_Func = " ascii //weight: 1
        $x_1_2 = "colNo = range(\"zDlgPeriods\").Columns(range(\"zDlgPeriods\").Columns.Count).Column + 1" ascii //weight: 1
        $x_1_3 = "filename = Environ$" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_111
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Dtools_GetExceptionInfoVB" ascii //weight: 1
        $x_1_2 = "Most of the calls here are simply wrappers for calling into Dtools.xll" ascii //weight: 1
        $x_1_3 = "Dtools_RiskFindInputsAndOutputs" ascii //weight: 1
        $x_1_4 = "Wrappers for Dtools Functions" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_112
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "Const XLPyDLLName As String = \"xlwings64-0.15.10.dll\"" ascii //weight: 2
        $x_2_2 = "Public Const XLWINGS_VERSION As String = \"0.15.10\"" ascii //weight: 2
        $x_2_3 = "Py.SetAttr Py.Module(\"xlwings._xlwindows\"), \"BOOK_CALLER\"" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_113
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "https://sapprd15ms.redmond.corp.microsoft.com/sap/bc/ui2/flp#Shell-home" ascii //weight: 1
        $x_1_2 = "https://www.sfc.hk/en/Regulatory-functions/Products/List-of-ESG-funds" ascii //weight: 1
        $x_1_3 = "Public Sub Selenium()" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_114
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "UPS Passages from ELN.csv" ascii //weight: 1
        $x_1_2 = "http://excel-malin.com" ascii //weight: 1
        $x_1_3 = "If nom_pc Like \"SLH*\" Then retourne_Site = \"UPS Slough\"" ascii //weight: 1
        $x_1_4 = "If nom_pc Like \"BEL*\" Then retourne_Site = \"UPS Braine\"" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_115
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "PathNameOut = Application.ActiveWorkbook.Path & \"\\01_FAUF-Fehler\\\"" ascii //weight: 2
        $x_2_2 = "opfn = \"FAUF_Fehler_\" & Right$(TMP, 2)" ascii //weight: 2
        $x_2_3 = ".Subject = \"BDE Fehlermonitor\"" ascii //weight: 2
        $x_2_4 = "CLMS(1) = \"Fehlerdatum\"" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (3 of ($x*))
}

rule __ASRWin32ApiMacroExclusion_116
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Dim ws_Zuordnung As Worksheet" ascii //weight: 1
        $x_1_2 = "Set ws_Zuordnung = ActiveWorkbook.Worksheets(\"Zuordnung\")" ascii //weight: 1
        $x_1_3 = "ws_Zuordnung.Range(\"B1\") = Date" ascii //weight: 1
        $x_1_4 = "Set res = ws_Zuordnung.Range(\"A1:A10000\")" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_117
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "MsgBox Err.Number & \" \" & Err.Description, vbCritical, \"ITG Design | AddDesignPg\"" ascii //weight: 2
        $x_2_2 = "Set visMstr = visMstrs.Item(\"TranspSite\")" ascii //weight: 2
        $x_2_3 = "Set visMstr = visMstrs.Item(\"CKTDemark\")" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_118
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Author - Prashant Deshpande" ascii //weight: 1
        $x_1_2 = "Application.ActiveWorkbook.Names.add name:=\"PopCache_GL_INTERFACE_REFERENCE7\"" ascii //weight: 1
        $x_1_3 = "CLASS:BneVBAParameter" ascii //weight: 1
        $x_1_4 = "Private Const LOG_SHEET = \"BneLog\"" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_119
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Public Sub ZoteroInsertBibliography()" ascii //weight: 1
        $x_1_2 = "Sub ZoteroCommand(cmd As String, bringToFront As Boolean)" ascii //weight: 1
        $x_1_3 = "appNames(1) = \"Zotero\"" ascii //weight: 1
        $x_1_4 = "Call ZoteroCommand(\"addEditCitation\", True)" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_120
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_3_1 = "name=\"yieldbookaddin\"" ascii //weight: 3
        $x_3_2 = "description=\"yield book excel add-in\"" ascii //weight: 3
        $x_1_3 = "\"loss scenario definition\"" ascii //weight: 1
        $x_1_4 = "\"scenario analysis function builder\"" ascii //weight: 1
        $x_1_5 = "\"py function builder\"" ascii //weight: 1
        $x_1_6 = "\"esg data\"" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_3_*) and 3 of ($x_1_*))) or
            ((2 of ($x_3_*))) or
            (all of ($x*))
        )
}

rule __ASRWin32ApiMacroExclusion_121
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "Sub CreateTeamsMCDReport(ppapp As Object, pppres As Object)" ascii //weight: 2
        $x_2_2 = "Set more = Worksheets(\"Voice Data\").Cells(counter, 1)" ascii //weight: 2
        $x_2_3 = "ActiveSheet.ChartObjects(\"CostSavingsChart\").Activate" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_122
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Public Function LoadMathTypeCommands() As Boolean" ascii //weight: 1
        $x_1_2 = "Opens the MathType Help file to a particular topic" ascii //weight: 1
        $x_1_3 = "folder = GetMathTypeDir & \":\"" ascii //weight: 1
        $x_1_4 = "logFileName = \"MT_VBA_Asserts.log\"" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_123
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "Global mcolCBRMSheets As colCBRMSheets" ascii //weight: 2
        $x_2_2 = "Len(Sheets(mstrWorksheet).Cells(lRow, mintAssetIDCol).Value)" ascii //weight: 2
        $x_2_3 = "Public Function Add(objCalItem As clsCalItem, Optional sKey As String)" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_124
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "Const SERVLET_PATH = \"http://adelphi.poise.homeoffice.local:80/oa_servlets/\"" ascii //weight: 2
        $x_2_2 = "Private Sub IVBSAXErrorHandler_ignorableWarning" ascii //weight: 2
        $x_2_3 = "Private Sub IVBSAXContentHandler_startElement" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_125
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Set vbComp = vbP.VBComponents(\"ERD_Module\")" ascii //weight: 1
        $x_1_2 = "mainFilePath = mainFilePath + \"\\ERD_Module\"" ascii //weight: 1
        $x_1_3 = "vbComp.Name = \"ERD_Module\"" ascii //weight: 1
        $x_1_4 = "On Error GoTo CreateERD" ascii //weight: 1
        $x_1_5 = "MsgBox \"Create ERD failed\"" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_126
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "cf.Top = ActivePresentation.SlideMaster.Shapes(\"chFreeze\").Top" ascii //weight: 1
        $x_1_2 = "Call update_Timeline(CDate(\"1-Nov-2016\"), 1, False, 9)" ascii //weight: 1
        $x_1_3 = "ActivePresentation.SlideMaster.Shapes(\"chFreeze\").Copy" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_127
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "tables.Add (\"SFR customer notes\")" ascii //weight: 1
        $x_1_2 = "Execute getsfr.py, which open a browser window with the SFR query" ascii //weight: 1
        $x_1_3 = "Check if SFR numbers have been imported" ascii //weight: 1
        $x_1_4 = "Set sfrSheet = Sheets(\"SFRs\")" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_128
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Range(\"C1:C\" & lastrow).FormulaR1C1 = \"Staff Payroll (SG)\"" ascii //weight: 1
        $x_1_2 = "Range(\"C1:C\" & lastrow).FormulaR1C1 = \"MANAGEMENT PAYROLL (SG)\"" ascii //weight: 1
        $x_1_3 = "Sub StaffSalEGiroPLUS()" ascii //weight: 1
        $x_1_4 = "Sub MgmtSalEGiroPLUS()" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_129
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "8"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "https://www.fortesglobal.com" ascii //weight: 2
        $x_2_2 = "http://www.fisz.nl" ascii //weight: 2
        $x_2_3 = "strLocale(SUPPORTMAILTO) = \"mailto:support@fortes.nl\"" ascii //weight: 2
        $x_2_4 = "strLocale(INSERTKEYWORDSURL) = \"inserting_principal_toolbox_ke.htm\"" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_130
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "8"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "invoice number convert in Uppar Case  end" ascii //weight: 2
        $x_2_2 = "Check PIN Format and convert in Uppar Case Start" ascii //weight: 2
        $x_2_3 = "Base on Taxable value Relevant Invoice Date" ascii //weight: 2
        $x_2_4 = "Check Relevant Invoice Date Format" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_131
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Private Type DtoolsProfileStats" ascii //weight: 1
        $x_1_2 = "rc = Dtools_GetDtoolsInstanceId()" ascii //weight: 1
        $x_1_3 = "Check if Dtools is already loaded in the Excel application" ascii //weight: 1
        $x_1_4 = "rc = Application.Evaluate(\"=DtoolsVersion()\")" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_132
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "Selection.AutoFilter field:=2, Criteria1:=criteria1_value" ascii //weight: 2
        $x_2_2 = "Selection.AutoFilter field:=3, Criteria1:=criteria2_value" ascii //weight: 2
        $x_2_3 = "Selection.AutoFilter field:=4, Criteria1:=criteria3_value" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_133
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Set BEx1 = Application.Run(\"BExAnalyzer.xla!GetBEx\")" ascii //weight: 1
        $x_1_2 = "Set l_control = Application.CommandBars.FindControl(Tag:=\"DFWFilter\")" ascii //weight: 1
        $x_1_3 = "Sheet2.Cells(17 + (2 * i), 29).Value = \"ZCMPO_COMPANY\"" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_134
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "Private Const DGI_SOURCE_ESTIMATION_SHEET_NAME = \"Effort estimations\"" ascii //weight: 2
        $x_2_2 = "Private Const DGI_ESTIMATION_SHEET_NAME = \"DGI Effort estimations\"" ascii //weight: 2
        $x_2_3 = "Private Function getDgiEstimationWorkbook" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_135
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "2"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "ActiveChart.ChartTitle.Text = \"Production / Consumption\" & \" up to \" & vZaehler * 24 & \" h\"" ascii //weight: 2
        $x_2_2 = "ActiveChart.ChartTitle.Text = \"Produktion / Verbrauch\" & \" bis zu \" & vZaehler * 24 & \" h\"" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (1 of ($x*))
}

rule __ASRWin32ApiMacroExclusion_136
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "If Not isSAPDoc(Doc.Name) Then" ascii //weight: 1
        $x_1_2 = "Sub sap_getLabel(control As IRibbonControl, ByRef returnedVal)" ascii //weight: 1
        $x_1_3 = "Case Is = \"SAPGroup1\" ' View group" ascii //weight: 1
        $x_1_4 = "Public Function isSAPDoc(key As String) As Boolean" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_137
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "myfile = ThisWorkbook.path & \"\\TXTPDF.txt\"" ascii //weight: 1
        $x_1_2 = "Dim dell_order_line_array As Variant" ascii //weight: 1
        $x_1_3 = "dellno = InStr(UCase(textline), UCase(\"Dell Order No:\"))" ascii //weight: 1
        $x_1_4 = "MsgBox \"Success: PDF converted into Text.\"" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_138
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "Set macro_sht = ThisWorkbook.Worksheets(\"Extra_Pdf_Data\")" ascii //weight: 2
        $x_2_2 = "macro_sht.Cells(i, 16) = \"Ylm10 - No Part Number\"" ascii //weight: 2
        $x_2_3 = "lst_purqty_cunt = UBound(Split(split_page(i), \"Purchase Order Quantity\")) - 1" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_139
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "11"
        strings_accuracy = "High"
    strings:
        $x_5_1 = "Developed by Michael Eifflaender / AE Software Solutions" ascii //weight: 5
        $x_2_2 = "Public tMilestones(5000) As Tmilestone" ascii //weight: 2
        $x_2_3 = "Public objPPT As Object 'PowerPoint.Application" ascii //weight: 2
        $x_2_4 = "MsgBox \"No files selected for analysis\"" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_140
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Set picolmem = picollist.Item(\"WSLDCTPPIH2\")" ascii //weight: 1
        $x_1_2 = "sTagname = Worksheets(\"Entry Sheet\").Cells(i + 4, 2).Text" ascii //weight: 1
        $x_1_3 = "Write to Seconday PI Server" ascii //weight: 1
        $x_1_4 = "srv.PIPoints(sTagname).Data.UpdateValue sValue, sTime" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_141
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Dialog.Title = \"Select ZDOCZIP1 Export Archive\"" ascii //weight: 1
        $x_1_2 = "ABDKAM - matthias.kanzler@ammann.com 03.11.2020" ascii //weight: 1
        $x_1_3 = "\\user02.ammann-group.com\\UserData\\Home\\ABD\\home02\\ABDKaM\\config\\desktop\\ZDOCZIP1_Anpassungen" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_142
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "11"
        strings_accuracy = "High"
    strings:
        $x_5_1 = "https://www.asap-utilities.com" ascii //weight: 5
        $x_2_2 = "p_sPath = Workbooks(\"ASAP Utilities.xlam\").Path" ascii //weight: 2
        $x_2_3 = "Application.Run \"'ASAP Utilities.xlam'!ASAPRunProc_x64\", lID" ascii //weight: 2
        $x_2_4 = "Sub ASAPRibbon_Initialize(ribbon As IRibbonUI)" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_143
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "8"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "Private Sub TLComboBox_Change()" ascii //weight: 2
        $x_2_2 = "Private Sub RejCaptureButton_Click()" ascii //weight: 2
        $x_2_3 = "Private Sub RejEmailTxtBox_Change()" ascii //weight: 2
        $x_1_4 = "ActiveWorkbook.Sheets(\"Productivity\").Protect Password:=\"Rameses\"" ascii //weight: 1
        $x_1_5 = "Sub wipeall()" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_144
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Global Const XLSTART_FILE_01 As String = \"meijburgFuncties.xlam\"" ascii //weight: 1
        $x_1_2 = "Global Const XLSTART_FILE_02 As String = \"DB_Storage.xlam\"" ascii //weight: 1
        $x_1_3 = "WB.Cells.Replace what:=\"mbFuncties.xlam\", Replacement:=\"MM2.0.xlam\"" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_145
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "Application.Calculation = xlCalculationAutomatic" ascii //weight: 2
        $x_2_2 = "If boolTemp <> SRActivationBlocked Then Application.CalculateFullRebuild" ascii //weight: 2
        $x_2_3 = "ThisWorkbook.Sheets(\"Input\").Cells(1, 1).Formula = \"=StorageCalc(Now)\"" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_146
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "2"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "\\stlfile01.intellig.local\\DATA\\LEGACY\\STL-ENG2\\P_Drive\\PROPOSAL\\ZSystemProp" ascii //weight: 2
        $x_2_2 = "\\wcnas01.intellig.local\\intelligrated\\Dept\\Projects" ascii //weight: 2
        $x_2_3 = "\\stlfile01\\DATA\\LEGACY\\STL-ARC\\St. Louis Legacy Project Directory" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (1 of ($x*))
}

rule __ASRWin32ApiMacroExclusion_147
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Sheets(\"PL-BS Impact\").Select" ascii //weight: 1
        $x_1_2 = "ActiveSheet.Name = \"OPEX Impact\"" ascii //weight: 1
        $x_1_3 = "currentCell = ThisWorkbook.Worksheets(\"JETEMPLATE\").Cells(activeCellRow, 11).Value" ascii //weight: 1
        $x_1_4 = "Dim NbLigne, DerLigne, InsertLigne As String" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_148
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "MsgBox \"You have selected to run the AERMOD Prime model, but the Screening Tool cannot\"" ascii //weight: 1
        $x_1_2 = "ChDrive ActiveWorkbook.path & \"\\SCREEN\\AERMODPRIME\\\"" ascii //weight: 1
        $x_1_3 = "Dim AERMODPRIMEfolder As String" ascii //weight: 1
        $x_1_4 = "AQMAU SCREENING TOOL" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_149
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Created by Doug Robbins - dkr@mvps.org" ascii //weight: 1
        $x_1_2 = "lngCount = Val(GetSetting(\"AlatGabungkan\", \"Pemakaian\", \"Hitung\"))" ascii //weight: 1
        $x_1_3 = "Set oItem = oOutlookApp.CreateItemFromTemplate(Application.StartupPath & \"\\MergeTools.oft\")" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_150
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "Public Const SUBKEY = \"SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\App Paths\\ITGDocX.exe\"" ascii //weight: 2
        $x_2_2 = "If Left(ValueName, Valuelen) = \"ITGDocXPath\" Then" ascii //weight: 2
        $x_2_3 = "Set visAddOn = Visio.Addons.Add(strAppPath & \"ITGDocX.exe\")" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_151
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Set l_control = Application.CommandBars.FindControl(Tag:=\"DFWFilter\")" ascii //weight: 1
        $x_1_2 = "Public Sub setFilterVisibility(iVisible As Boolean)" ascii //weight: 1
        $x_1_3 = "Set lShape = lSheet.Shapes(\"FilterA\")" ascii //weight: 1
        $x_1_4 = "Set lShape = lSheet.Shapes(\"InfoA\")" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_152
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "Sub subExec_psSelectInvestissement(idHypothese As String, idFonds As String)" ascii //weight: 2
        $x_2_2 = "Parameters(\"@propInvestissement\")" ascii //weight: 2
        $x_2_3 = "Parameters(\"@lbHypothese\").Value = idHypothese" ascii //weight: 2
        $x_2_4 = "Parameters(\"@lbSCPI\").Value = idFonds" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (3 of ($x*))
}

rule __ASRWin32ApiMacroExclusion_153
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "powerpointshortcutmanager_manageshortcuts" ascii //weight: 1
        $x_1_2 = "powerpointshortcutmanager_settings" ascii //weight: 1
        $x_1_3 = "powerpointshortcutmanager_visittipspage" ascii //weight: 1
        $x_1_4 = "powerpointshortcutmanager_about" ascii //weight: 1
        $x_2_5 = "description=\"shortcut manager for powerpoint\"" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (
            ((4 of ($x_1_*))) or
            ((1 of ($x_2_*) and 2 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule __ASRWin32ApiMacroExclusion_154
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Set wsth_Projet = ThisWorkbook.Sheets(\"Projets\")" ascii //weight: 1
        $x_1_2 = "Set wsth_PSP = ThisWorkbook.Sheets(\"Suivi_PSP\")" ascii //weight: 1
        $x_1_3 = "Set wsth_3P = ThisWorkbook.Sheets(\"Suivi_3P\")" ascii //weight: 1
        $x_1_4 = "newpath = Environ(\"USERPROFILE\") & \"\\DrivesMaping.xlsx\"" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_155
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "Const ReleasePath_simco1DB As String = \"\\\\wittag.net\\dfs\\groups\\Info\\servofiles\\simco\\MotorDatabase_Firmware\\\"" ascii //weight: 2
        $x_2_2 = "file.writeline (\"</MotorDatabase>\")" ascii //weight: 2
        $x_2_3 = "Const EndatFilesFolderPath As String = \"C:\\Data\\Temp\\\"" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_156
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "FilePath = \"G:\\TEAM\\Market Operations\\STOD\\OTC\\Price Database V4.xlsb\"" ascii //weight: 1
        $x_1_2 = "FileStr = \"Price Database V4.xlsb\"" ascii //weight: 1
        $x_1_3 = "MsgBox \"Please upgrade Thomson Reuters Eikon Excel.\"" ascii //weight: 1
        $x_1_4 = "Dim GFSENS, GFSOP, ECENS, ECOP As String" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_157
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Function SQL_AMOS_DB_GetSettings()" ascii //weight: 1
        $x_1_2 = "DatabaseName = \"Amos\" ' Enter your database name here" ascii //weight: 1
        $x_1_3 = "Function SQL_AMOS_DB_GetAccessLevels(strUsername As String)" ascii //weight: 1
        $x_1_4 = "SQL_AMOS_DB_Populate_SPECIAL_COND_USRFRM = \"notfound\"" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_158
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Workbooks(\"EC_List_Search.xlam\")" ascii //weight: 1
        $x_1_2 = "SOURCE: http://stackoverflow.com/questions/14738330/office-2013-excel-putinclipboard-is-different" ascii //weight: 1
        $x_1_3 = "ThisWorkbook.FollowHyperlink \"https://www.excelcampus.com/list-search-help\"" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_159
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "strHelpFile = strHelpFile & \"PItrendXL.HLP\"" ascii //weight: 1
        $x_1_2 = "Public resObj As PIXLTWIZ.ResourceStrings" ascii //weight: 1
        $x_1_3 = "Public WithEvents m_objPIArcDC As PIDATAACCESS.PIArchiveData" ascii //weight: 1
        $x_1_4 = "If InStr(aTraces(lngIndex).DataSourceName, \"PIExcelData\")" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_160
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "8"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "Attribute VB_Name = \"DieseArbeitsmappe\"" ascii //weight: 2
        $x_2_2 = "Worksheets(\"Export_SAP\").Cells.Clear" ascii //weight: 2
        $x_2_3 = "ThisWorkbook.Sheets(\"Contiform\").Unprotect" ascii //weight: 2
        $x_2_4 = "ThisWorkbook.Sheets(\"Contifeed\").Unprotect" ascii //weight: 2
        $x_2_5 = "ThisWorkbook.Sheets(\"AirCo\").Unprotect" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (4 of ($x*))
}

rule __ASRWin32ApiMacroExclusion_161
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Public Const REG_PATH = \"Software\\MIS AG\\PLAIN\\\"" ascii //weight: 1
        $x_1_2 = "Public Const C_PLAIN_VBAWKB = \"AXLC.XLA\"" ascii //weight: 1
        $x_1_3 = "OnAction = \"Mis.Plain.ActionsDrillThrough.xla!EvalPopUpActions\"" ascii //weight: 1
        $x_1_4 = "If Trim(sMDX) = \"\" Then sMDX = BuildDrillThroughMDX" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_162
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "filePath = Range(\"C3\").Value & \"\\ikoutodoke_\" & nendo & \".xlsx\"" ascii //weight: 1
        $x_1_2 = "filePath2 = ws.Cells(4, 2).Value & \"\\backup\\ikoutodoke_\" & nendo(i) & \"_bak.xlsx\"" ascii //weight: 1
        $x_1_3 = "Function get_nendo(ymd)" ascii //weight: 1
        $x_1_4 = "Dim kw1, kw2, kw3, df, de As String" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_163
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "Set ws = ThisWorkbook.Sheets(\"Roster\")" ascii //weight: 2
        $x_2_2 = "sCompare = ThisWorkbook.Sheets(\"Roster\").Range(cStart & rDaterow).Value" ascii //weight: 2
        $x_2_3 = "Me.txtStart.Value = Format(frm_DateSelect.Tag, \"dd-mmm-yyyy\")" ascii //weight: 2
        $x_2_4 = "MsgBox (\"Shift has been saved.\")" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (3 of ($x*))
}

rule __ASRWin32ApiMacroExclusion_164
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "10"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "Attribute VB_Name = \"aaaRutinesZIP\"" ascii //weight: 2
        $x_2_2 = "Dim FitZip As Variant" ascii //weight: 2
        $x_2_3 = "FitZip = CelDeNomBase(\"ZipOri\")" ascii //weight: 2
        $x_2_4 = "DescomprimirZIP FitZip, CelDeNomBase(\"DirDes\") ' \"c:\\tst\\a.zip\"" ascii //weight: 2
        $x_2_5 = "MsgBox NomZIPnEssim(FitZip, CelDeNomBase(\"num\"))" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_165
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "9"
        strings_accuracy = "High"
    strings:
        $x_3_1 = "solver32.dll" ascii //weight: 3
        $x_1_2 = "solverok" ascii //weight: 1
        $x_1_3 = "solverokdialog" ascii //weight: 1
        $x_1_4 = "solvercode" ascii //weight: 1
        $x_1_5 = "solvercalls" ascii //weight: 1
        $x_1_6 = "solversolve" ascii //weight: 1
        $x_1_7 = "solveradd" ascii //weight: 1
        $x_1_8 = "solverchange" ascii //weight: 1
        $x_1_9 = "solverdelete" ascii //weight: 1
        $x_1_10 = "solverfinish" ascii //weight: 1
        $x_1_11 = "solverget" ascii //weight: 1
        $x_1_12 = "solveroptions" ascii //weight: 1
        $x_1_13 = "solverreset" ascii //weight: 1
        $x_1_14 = "dlgsolverparameters" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((9 of ($x_1_*))) or
            ((1 of ($x_3_*) and 6 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule __ASRWin32ApiMacroExclusion_166
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "Public Const SUBKEY = \"SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\App Paths\\ITGDocX.exe\"" ascii //weight: 2
        $x_2_2 = "Visio.Addons.Item(strAppPath & \"ITGDocX.exe\").Run (\"Splash\")" ascii //weight: 2
        $x_2_3 = "Choice = MsgBox(strMsg, vbYesNo + vbExclamation, \"ITG Design\"" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_167
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "8"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "Const ApiPrefixPmtProds = \"https://sp2013.myatos.net/organization/gbu/wl/ewl/coo/Payments%20products/_api\"" ascii //weight: 2
        $x_2_2 = "https://acc-jira.worldline.com" ascii //weight: 2
        $x_2_3 = "https://challenge.pay1-test.de/calculon?rslt=" ascii //weight: 2
        $x_2_4 = "issueKey = \"E2ECD-2829\"" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_168
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Sub ExportDataObjectToXML(colRiskData As clsRiskDataCol, mfFilter As String)" ascii //weight: 1
        $x_1_2 = ".Id = LCase(riskData.MainFunctionID & \";\" & riskData.SubFunction & \";\" & currRow)" ascii //weight: 1
        $x_1_3 = "colRiskData.ResolveRisk colRiskData.Items.item(iPos)" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_169
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Public Sub ModFileTool_SetFormat(RG As Range, FG As Integer)" ascii //weight: 1
        $x_1_2 = "Private Function ck_FILENAME_XLS_J(RG As Range) As Boolean" ascii //weight: 1
        $x_1_3 = "If co_CKDATANAME = \"FEH_STATDBINF\" Then" ascii //weight: 1
        $x_1_4 = "Call addDataCkCol(Cells(myline, co_Data_CK_col))" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_170
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "software\\datastream\\datastream advance\\persistence\\powersearch" ascii //weight: 2
        $x_2_2 = "software\\datastream\\datastream advance\\misc" ascii //weight: 2
        $x_2_3 = "software\\datastream\\datastream advance\\files" ascii //weight: 2
        $x_2_4 = "http://product.datastream.com/uci/" ascii //weight: 2
        $x_2_5 = "advance for office" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (2 of ($x*))
}

rule __ASRWin32ApiMacroExclusion_171
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "ActiveSheet.Cells(lastrow, 1).Value = \"Avaya India Limited\"" ascii //weight: 2
        $x_2_2 = "ActiveSheet.Cells(lastrow, 1).Value = \"RSA2 Security & Risk Ireland Limited\"" ascii //weight: 2
        $x_2_3 = "ActiveSheet.Cells(lastrow, 1).Value = \"Pure Storage International Limited\"" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_172
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "Range(\"MAS[[Central / Local Collection]:[Collection Location]]\")" ascii //weight: 2
        $x_2_2 = "Range(\"MAS[[Local Insurer]:[Intracompany Policy / Reinsurance Agreement Number]]\")" ascii //weight: 2
        $x_2_3 = "Range(\"MAS[[Local Policy Currency]:[Local Policy Currency ROE]]\")" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_173
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Private Const workingFolder = \"C:\\Util\\freejet\\\"" ascii //weight: 1
        $x_1_2 = "Private Const freeJetFolder = \"FreeJet\\resources\\\"" ascii //weight: 1
        $x_1_3 = "executables_location = strDocuments & \"\\\" & freeJetFolder" ascii //weight: 1
        $x_1_4 = "filePath = workingFolder & bp2dimFileName & \".FSTEIN\"" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_174
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Range(3) = buildPhaseCombo.Text" ascii //weight: 1
        $x_1_2 = "device.Add \"ssdVendor\", .Range(columnMap(\"SSD Vendor\"))" ascii //weight: 1
        $x_1_3 = "device.Add \"sku\", .Range(columnMap(\"SKU\"))" ascii //weight: 1
        $x_1_4 = "Private Function rowToDict(row As ListRow, columnMap As Dictionary) As Dictionary" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_175
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Sub MuniBloomberg(cusip As String)" ascii //weight: 1
        $x_1_2 = "Set rWindows = Workbooks(addin_name).Sheets(\"Values\").Range(\"BloombergWindows\")" ascii //weight: 1
        $x_1_3 = "Sub MuniBloombergSendBond(cusip As String)" ascii //weight: 1
        $x_1_4 = "Public Sub MuniBloombergTC(masterTicketNumber As String)" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_176
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "cbb.Caption = \"FazSpiegel-Log" ascii //weight: 1
        $x_1_2 = "Application.CommandBars(\"Worksheet Menu Bar\").Controls(\"Extras\").Controls(\"FAZ Spiegel\").Delete" ascii //weight: 1
        $x_1_3 = "String2File FazConfigFile, txtInifile.Text, False" ascii //weight: 1
        $x_1_4 = "FazSpiegelAusgabe = cAusgabeStellenmarkt" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_177
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "KronesDataInterface_K443390_Blow-Moulder_Commissioning.xls" ascii //weight: 1
        $x_1_2 = "Private Const modulname = \"UF_CheckKomNoManual\"" ascii //weight: 1
        $x_1_3 = "Private Sub Txt_KomNo_AfterUpdate()" ascii //weight: 1
        $x_1_4 = "Call FormatSheetEntries(sht, rngS.Range, \"FT_WhiteStandars\", False, True)" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_178
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Set book = wb.Workbooks.Add(ThisWorkbook.Path & \"\\spinner.xlsm\")" ascii //weight: 1
        $x_1_2 = "Open secondary sheet to show spinner" ascii //weight: 1
        $x_1_3 = "Set oRng = Intersect(Selection, Selection.Parent.UsedRange" ascii //weight: 1
        $x_1_4 = "If cyFrequency Then MicroTimer = cyTicks1 / cyFrequency" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_179
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Data.TableName = \"AgInputData\"" ascii //weight: 1
        $x_1_2 = "fields.Append \"LivestockProductsAccrualAdjustment\"" ascii //weight: 1
        $x_1_3 = "fields.Append \"CropInsuranceAndDisasterProceeds\"" ascii //weight: 1
        $x_1_4 = "InvestmentInGrowingCropsAccrualAdjustment" ascii //weight: 1
        $x_1_5 = "AccumulatedDepreciationMachineryEquipment" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_180
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "10"
        strings_accuracy = "High"
    strings:
        $x_5_1 = "Public Type tMilestone" ascii //weight: 5
        $x_2_2 = "Public Sub update_Timeline(startDate, newTlPeriod, tlWeeks As Boolean, newPoolCols)" ascii //weight: 2
        $x_1_3 = "Function RDP_PRNs() As Variant" ascii //weight: 1
        $x_1_4 = "Function abbreviate_MS_Name(msName)" ascii //weight: 1
        $x_1_5 = "Public Function trimTime(date_with_time)" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_181
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "Attribute VB_Name = \"mdAdd_Edit_View\"" ascii //weight: 2
        $x_2_2 = "Set wMark = auditedSheet.Shapes(\"DraftWatermark\")" ascii //weight: 2
        $x_2_3 = "GetServerTime = getRemoteTOD(\"\\\\ni-cr-svc-dc1\")" ascii //weight: 2
        $x_2_4 = "Set dataFieldCols = newAuditSht.Columns(colParam1).Resize(ColumnSize:=numCols * 2)" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (3 of ($x*))
}

rule __ASRWin32ApiMacroExclusion_182
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "Public Const SPMSXDataFileName As String = \"FODMcommMSXData.xlsx\"" ascii //weight: 2
        $x_2_2 = "Public Const toolTitle As String = \"Spotlight - GFO Automated Comm Tool\"" ascii //weight: 2
        $x_2_3 = "Public Const LIRServerName As String = \"mbodesynapse-ondemand.Sql.azuresynapse.net\"" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_183
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Application  Name:  VoyagerPlan Diagram Print Macros" ascii //weight: 1
        $x_1_2 = "Attribute VB_Name = \"PubMacros\"" ascii //weight: 1
        $x_1_3 = "UK:12014991 - Removed SaveDocument call as it will be saved from VPRI1350.dll" ascii //weight: 1
        $x_1_4 = "Private Const mcModule As String = \"Diagram Print Macros\"" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_184
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "Public Sub sortBRBSheet(sheetSelected As Worksheet, cellSelected As Range, sortDirection As XlSortOrder)" ascii //weight: 2
        $x_2_2 = "If sheetSelected.name = \"WoW Digest\" Then" ascii //weight: 2
        $x_2_3 = "Set columnsByHeader = WorkbenchUF.annotationsApp.revenueReportColumnsByHeader" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_185
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Const SERVLET_PATH = \"http://cr-svc-fin1.pharms-services.com:8000/oa_servlets/\"" ascii //weight: 1
        $x_1_2 = "Generated:BneOAExcel" ascii //weight: 1
        $x_1_3 = "AddBneMsg BNE_ERROR, \"BneUploadBegin\", \"Couldn't Create a DOM Document\"" ascii //weight: 1
        $x_1_4 = "Const DEBUG_DOCUMENT = \"c:\\BneDebug-Document.xml\"" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_186
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "OutputTxt = \"Contract, Date, PD, LGD, dLGD.\"" ascii //weight: 1
        $x_1_2 = "Sheets(\"SAP up VS CSV\").Cells(2, 20).Value = COndi" ascii //weight: 1
        $x_1_3 = "functions.Connection.ApplicationServer = \"premsap.it.nednet.co.za\"" ascii //weight: 1
        $x_1_4 = "Set RfcCallTransaction = functions.Add(\"BBP_RFC_READ_TABLE\")" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_187
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "If mu.Caption = \"&Aspen Properties\" Then" ascii //weight: 1
        $x_1_2 = "Public g_AspenPropertiesStartupdir As String" ascii //weight: 1
        $x_1_3 = "strPath, pszTitle:=\"Select Aspen Properties working folder:\")" ascii //weight: 1
        $x_1_4 = "Set mobjHappHappIp = CreateObject(\"AspenProperties.Document.\" + g_MMVersion)" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_188
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_2_1 = ".Open \"POST\", \"http://visascrs.fco.gsi.gov.uk/UKCRS/UKCRSMenu/MENU_login.asp\"" ascii //weight: 2
        $x_2_2 = "ThisWorkbook.FollowHyperlink POISE_or_TS_Link & \"\\data analysis team\\New DA Team Structure\\WR Work Requests\\Regular\\WR1869" ascii //weight: 2
        $x_2_3 = "objOL.GetNamespace(\"MAPI\")" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_189
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "MAJ_cellule_import Sheets(\"PrG, T.P., dsDNA\")" ascii //weight: 1
        $x_1_2 = "path_db = \"\\\\NTBRAFSCL011\\dfs\\Sites\\Braine\\GTSO\\GPDI\\CCPD\\Analytics\\DB PQA\\DataBase UPS V1.0_be.accdb\"" ascii //weight: 1
        $x_1_3 = "InHostName = \"GDCSLDCAP001\"" ascii //weight: 1
        $x_1_4 = "If My_workbook.Sheets(9).Range(\"CQA_graph_list\")" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_190
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Workbooks.Open Filename:=strPerEinst & \"EINSTELLUNGEN.xlsx\"" ascii //weight: 1
        $x_1_2 = "strSQL = \"SELECT GEMEINDE FROM FU_L_GEMEINDE_ORTSTEIL\"" ascii //weight: 1
        $x_1_3 = "strDATEINew = DATUM_DATEI & \"BACKUP.MSP_Tool.xlsm\"" ascii //weight: 1
        $x_1_4 = "strDATEINewVision = DATUM_DATEI & \"newVision.MSP_Tool.xlsm\"" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_191
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "Range(\"processingDate\") = SubmitVATReturnAPI.ProcessingDate" ascii //weight: 2
        $x_2_2 = ".Range(\"chargeRefNumber\") = \"'\" & SubmitVATReturnAPI.ChargeRefNumber" ascii //weight: 2
        $x_2_3 = "Err.Raise .status, \"SubmitVATReturnAPI\", \"The VAT return was already submitted for the given period.\"" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_192
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "ThisWorkbook.Worksheets(i).Cells(1, lastcol + 1).Value = \"TotalCalculationValue" ascii //weight: 2
        $x_2_2 = "ThisWorkbook.Worksheets(i).Cells(1, lastcol + 2).Value = \"TotalInvoiceValue" ascii //weight: 2
        $x_2_3 = "ThisWorkbook.Worksheets(i).Cells(r, lastcol + 1).Value = totalsplitupvalue" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_193
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Set pvtTable = Worksheets(\"Brand SheetNameList\").Range(\"A1\").PivotTable" ascii //weight: 1
        $x_1_2 = "Set pvtTable = Worksheets(\"WHSL SheetNameList\").Range(\"A1\").PivotTable" ascii //weight: 1
        $x_1_3 = "AfterBySheetName = \"Total SheetNameList\"" ascii //weight: 1
        $x_1_4 = "Public Sub CopyData(ByVal DoorName As String)" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_194
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "myApp.Workbooks.Open Application.VBE.VBProjects(\"LsAgXLB\").FileName, False" ascii //weight: 1
        $x_1_2 = "If Wb.Name <> \"LsAgXLB.xla\" Then" ascii //weight: 1
        $x_1_3 = "Workbooks.Open Application.Workbooks(\"LsAgXLB.xla\").Path & \"\\LsAgXLB.xlam\"" ascii //weight: 1
        $x_1_4 = "ret = InStr(1, lCell.Formula, \"LsAgXLB.xla'!\")" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_195
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "to override set `JsonConverter.JsonOptions.UseDoubleForLargeNumbers = True`" ascii //weight: 1
        $x_1_2 = "https://github.com/VBA-tools/VBA-UtcConverter" ascii //weight: 1
        $x_1_3 = "Err.Raise 10001, \"JSONConverter\"" ascii //weight: 1
        $x_1_4 = "Err.Raise 10014, \"UtcConverter.ConvertToIso\", \"ISO 8601 conversion error: \"" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_196
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Please change the location of the Mapping Tool package to a directory with a shorter path." ascii //weight: 1
        $x_1_2 = "Zip_Template_Path = ThisWorkbook.Path & \"\\MappingToolPackage\\\"" ascii //weight: 1
        $x_1_3 = "Zip_Name = \"Mapping Tool Package.zip\"" ascii //weight: 1
        $x_1_4 = "If FUF_Tag_Col = FUF_Tag_Basic_Col Then" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_197
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Public goOATools As clsOATools" ascii //weight: 1
        $x_1_2 = "Public Const gcApplicationName As String = \"OA Tools\" ' Application name" ascii //weight: 1
        $x_1_3 = "Public Const gcOACoreLibFileName As String = \"OATools.xlam\"" ascii //weight: 1
        $x_1_4 = "Public Const gcOASourceExcelRibbonWorkbookFolderName = \"OAToolsMenu\"" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_198
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Call CommandBars(\"BEx Design Toolbox\").Delete" ascii //weight: 1
        $x_1_2 = "Call CommandBars(\"BEx Analysis Toolbox\").Delete" ascii //weight: 1
        $x_1_3 = "Set pAddin = CreateObject(\"com.sap.bi.et.analyzer.addin.BExConnect\")" ascii //weight: 1
        $x_1_4 = "Set GetBEx = pAddin.ExcelInterface.WorkbookBExExcelApplication(lName)" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_199
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Set tr = Workbooks.Open(\"C:\\Alocal\\Characterisation files\\TRACE1.csv\")" ascii //weight: 1
        $x_1_2 = "Set tr = Workbooks.Open(\"C:\\Alocal\\Characterisation files\\TRACE2.csv\")" ascii //weight: 1
        $x_1_3 = "tr.Worksheets(\"TRACE1\").Range(\"B4:B204\").Copy" ascii //weight: 1
        $x_1_4 = "tr.Worksheets(\"TRACE2\").Range(\"B4:B204\").Copy" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (3 of ($x*))
}

rule __ASRWin32ApiMacroExclusion_200
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Const fname = \"c:\\NotBackedUp\\wdpvs097.001\"" ascii //weight: 1
        $x_1_2 = "Print #1, \"send \" & \"c:\\NotBackedUp\\\" & \"OFFMAXIN1.csv\"" ascii //weight: 1
        $x_1_3 = "dFTP = \"/u01/app/msdpfin/data/pldata/master/\" 'KEA 5.3V Production" ascii //weight: 1
        $x_1_4 = "MsgBox (\"Unable to recognise you KEA user ID.  Process terminated.\")" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_201
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Public Const BLOOMBERG_LP_KEY As String = \"SOFTWARE\\Bloomberg L.P." ascii //weight: 1
        $x_1_2 = "BloombergUI.xla" ascii //weight: 1
        $x_1_3 = "If Application.AddIns(i).Name = \"BloombergUIPPT\" Then" ascii //weight: 1
        $x_1_4 = "CallBloombergUIMacro \"ClearComponentState\", chartControl.userData + gWorkbookName + gWorksheetName" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_202
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Public Function AtlasImport(strReportType As String)" ascii //weight: 1
        $x_1_2 = "FileSpec = \"FBIS Tactical Report\"" ascii //weight: 1
        $x_1_3 = "ExtractPath = \"\\\\poise.homeoffice.local\\data\\IND\\Shared\\Transfer\\ATLAS BAM\\Data\\\"" ascii //weight: 1
        $x_1_4 = "If AtlasImport(Sheet2.Range(\"V_SnA_ReportType\").Value) = False Then" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_203
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Set tr = Workbooks.Open(\"C:\\Alocal\\Characterisation files\\TRACE1.csv\")" ascii //weight: 1
        $x_1_2 = "wb.Sheets(\"Compiled Data\").Cells(DataEntry, 13).Value = Bandwidth" ascii //weight: 1
        $x_1_3 = "tr.Worksheets(\"TRACE1\").Range(\"B4:B204\").Copy" ascii //weight: 1
        $x_1_4 = "wb.Sheets(\"Compiled Data\").Cells(DataEntry, 1).Select" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_204
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Public Const APP_TITLE As String = \"IRESS Add-In\"" ascii //weight: 1
        $x_1_2 = "Public Sub IressAddinPreferences()" ascii //weight: 1
        $x_1_3 = "MsgBox \"Access the IRESS Add-In Help by navigating to the Excel Interface section in the IRESS Help from IRESS Pro.\"" ascii //weight: 1
        $x_1_4 = "Set iress = New DfsIress.Application" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_205
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Public Sub EuroConversionWizard()" ascii //weight: 1
        $x_1_2 = "\"EUR -> ATS\", \"EUR -> BEF\", \"EUR -> CYP\"" ascii //weight: 1
        $x_1_3 = "\"EUR -> NLG\", \"EUR -> PTE\", \"EUR -> SIT\", \"EUR -> SKK\"" ascii //weight: 1
        $x_1_4 = "If m_iTriangSet = True Then frmAdvanced.TriangPrec = m_iTriangPrec" ascii //weight: 1
        $x_1_5 = "m_iSourceCurrency = frm.SourceCurrency" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_206
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Author - Prashant Deshpande" ascii //weight: 1
        $x_1_2 = "Private Property Set IVBSAXContentHandler_documentLocator(ByVal RHS As MSXML2.IVBSAXLocator)" ascii //weight: 1
        $x_1_3 = "Private Function ConvertXSDTypeToVBAType(sXSDType As String) As String" ascii //weight: 1
        $x_1_4 = "Public Property Get Messages() As BneVBAMessages" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_207
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "rangeName = \"zDlgOutYears\"" ascii //weight: 1
        $x_1_2 = "colNo = range(\"zDlgOutYears\").Columns(range(\"zDlgOutYears\").Columns.Count).Column + 1" ascii //weight: 1
        $x_1_3 = "rowOffset = range(\"zDlgPeriods\").Rows(1).row" ascii //weight: 1
        $x_1_4 = "colNo = range(\"zDlgPeriods\").Columns(range(\"zDlgPeriods\").Columns.Count).Column + 1" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_208
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "14"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "SHEETName = \"Basic Details New Members\"" ascii //weight: 2
        $x_2_2 = "SHEETName = \"Basic Details Existing Members\"" ascii //weight: 2
        $x_2_3 = "SHEETName = \"Service History Crib Sheet\"" ascii //weight: 2
        $x_2_4 = "SHEETName = \"WPS Rate History\"" ascii //weight: 2
        $x_2_5 = "SHEETName = \"AVC History\"" ascii //weight: 2
        $x_2_6 = "SHEETName = \"Beneficiary Details\"" ascii //weight: 2
        $x_2_7 = "Sub ControlTotals" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_209
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "QUALITY MANAGEMENT\\09 Check the Checker\\prof-ormas and old sheets\\CTC Dispute-Query Resolution Proforma.docx" ascii //weight: 2
        $x_2_2 = "SentOnBehalfOfName = \"CentralOperationsQ@hmpo.gov.uk\"" ascii //weight: 2
        $x_2_3 = "To = \"roxanne.mccue@hmpo.gov.uk;shirley.robinson@hmpo.gov.uk;mark.woods@hmpo.gov.uk\"" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (2 of ($x*))
}

rule __ASRWin32ApiMacroExclusion_210
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Application.CommandBars(\"KRONES\").Controls(\"Execute\").Delete" ascii //weight: 1
        $x_1_2 = "ViewExe = Environ(\"elnrun\") + \"\\view.exe -p \" + Vorlage" ascii //weight: 1
        $x_1_3 = "ActiveWorkbook.SaveAs FileName:=Pathname + \"\\copylist_sps.xls\", FileFormat:=xlNormal" ascii //weight: 1
        $x_1_4 = "Set oBar = Application.CommandBars(\"KRONES\"" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_211
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "MyFile = ThisWorkbook.Path & \"\\AutomatedMeasurements.txt\"" ascii //weight: 1
        $x_1_2 = "Sub mycollectionprocedure()" ascii //weight: 1
        $x_1_3 = "Application.OnTime Now + TimeValue(\"00:00:02\"), \"ThisWorkbook.mycollectionprocedure\"" ascii //weight: 1
        $x_1_4 = "MsgBox (\"Invalid Filename:  Last 6 characters of filename are not x.xlsm!\")" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_212
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "webadiSheet = ActiveWorkbook.CustomDocumentProperties(Sh.CodeName & \"_WEBADI\")" ascii //weight: 1
        $x_1_2 = "Const PRODUCT_RELEASE_LABEL = \"12.0.0.0: Friday Feburary 10, 2006\"" ascii //weight: 1
        $x_1_3 = "blockAvail = ActiveWorkbook.CustomDocumentProperties(\"BLOCK\" & blockIndex)" ascii //weight: 1
        $x_1_4 = "Dim m_Ribbon As IRibbonUI" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_213
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "com.CommandText = \"spFXEXPDetailFxTransaction\"" ascii //weight: 1
        $x_1_2 = "Public Function GetFXHegdesFromDealsDetail(ByVal branchID As Long, ByVal StartDate As Date, ByVal EndDate As Date)" ascii //weight: 1
        $x_1_3 = "CommandText = \"spFXEXPGetMonthlyResult\"" ascii //weight: 1
        $x_1_4 = "\\\\stoltz\\Kvant\\Dev\\Henrik\\FX Expo\\TestPublish\\" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_214
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "Attribute sumpagetbl.VB_Description = \"Macro recorded 7/22/02 by murtha\"" ascii //weight: 2
        $x_2_2 = "If Dir(\"c:\\program files\\adobe\\acrobat 6.0\\acrobat\\acrobat.exe\", vbNormal) = \"\" Then" ascii //weight: 2
        $x_2_3 = "If Dir(\"c:\\program files\\adobe\\acrobat 6.0\\PDFMaker\\Office\\PDFMakerA.dot\", vbNormal) = \"\" Then" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_215
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "ThisWorkbook.Sheets(\"Print\").Shapes(\"pic_TR620\").Visible = False" ascii //weight: 1
        $x_1_2 = "FileContents = replace(FileContents, \"dxf_Bearing_D\", Range(\"val_Bearing_D\").value)" ascii //weight: 1
        $x_1_3 = "wb.Sheets(\"Print\").Range(\"val_TemperatureClass\")" ascii //weight: 1
        $x_1_4 = "Range(\"val_Polepairs\").value = ItemData(\"Pole pairs\")" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_216
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Umgebungs.STab_2_A = TMark_Anf_Anf + Trim(\"HRTABELLE\") + TMark_Ende" ascii //weight: 1
        $x_1_2 = "Function bwErsetzen(strEingang As String, strNEZ) As String" ascii //weight: 1
        $x_1_3 = "If Dok1.Bookmarks.Exists(\"MKARTE_TAB\") = True Then" ascii //weight: 1
        $x_1_4 = "Function SpaltenAnz(strSPTMarke As String, strSuch As String) As Integer" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_217
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "8"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "WS = \"Motor characteristics\"" ascii //weight: 2
        $x_2_2 = "Please put in the password to get to the engineering mode.\", \"Passwortabfrage / password request\", \"*****\"" ascii //weight: 2
        $x_2_3 = "Worksheets(\"Actuator characteristics\")" ascii //weight: 2
        $x_2_4 = "Attribute VB_Name = \"Kennlinienberechnung\"" ascii //weight: 2
        $x_2_5 = "Function Kennlinie_berechnen()" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (4 of ($x*))
}

rule __ASRWin32ApiMacroExclusion_218
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "http://excel-malin.com" ascii //weight: 1
        $x_1_2 = "https://www.excel-pratique.com/fr/astuces_vba/recherche-tableau-array.php" ascii //weight: 1
        $x_1_3 = "http://www.commentcamarche.net/forum/affich-31432413-importation-de-donnees-sans-doublons#9" ascii //weight: 1
        $x_1_4 = "http://akoebel.free.fr/wanadoo/cathy/vba/obj_xl_graph_series.htm" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_219
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "ThisWorkbook.Worksheets(TEMP_SHEET_NAME_COVER).Protect Password:=PROTECT_PASS" ascii //weight: 1
        $x_1_2 = "sPath = ThisWorkbook.Path & \"\\\" & \"Write.txt\"" ascii //weight: 1
        $x_1_3 = "Call ThisWorkbook.Worksheets(TEMP_SHEET_NAME_SATISFY).DeleteSatisfySkip" ascii //weight: 1
        $x_1_4 = "If (CheckValidation(oSheet, lRow, RESARCH_COLUMN_ANSWER)) Then" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_220
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "tmp = \"C:\\Program Files (x86)\\Dfm\\TELN.txt\"" ascii //weight: 1
        $x_1_2 = "If (Environ(\"UserName\") = \"PE01800853\" Or Environ(\"UserName\") = \"epeco\") Then" ascii //weight: 1
        $x_1_3 = "tmp = \"C:\\_mit\\Tools\\\" & prgName & Application.PathSeparator" ascii //weight: 1
        $x_1_4 = "vbCritical Or vbOKOnly, \"Sorry, this Application is Working ONLY from \" & tmp" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_221
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "Application.Run SolverPath & \"!SolverOk\", \"$B$26\", 2, 0, \"$B$15:$B$19\", 1, \"GRG Nonlinear\"" ascii //weight: 2
        $x_2_2 = "Application.Run SolverPath & \"!SolverReset\"" ascii //weight: 2
        $x_2_3 = "Recommended settings [https://www.microsoft.com/en-us/microsoft-365/blog/2009/03/12/excel-vba-performance-coding-best-practices/]" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_222
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Journal_name = \"UKBA 10012826 ADI \" & Format(Date, \"DDMMYY\")" ascii //weight: 1
        $x_1_2 = "Const PRODUCT_CODE_LABEL = \"8.4.1.38\"" ascii //weight: 1
        $x_1_3 = "Const PRODUCT_RELEASE_LABEL = \"8.4.1.38 Wednesday 31 January 2007\"" ascii //weight: 1
        $x_1_4 = "Public Sub CreateLayout_Overflow_200_BNE_HOFAS_2(xlapp As Application, LayoutSheet As Worksheet)" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_223
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Workbooks.Open (\"\\\\brummer.se\\bfs\\BFS-Operations\\Function sheet\\data\\function sheet static.xlsx\")" ascii //weight: 1
        $x_1_2 = "If fund = \"Talarium\" Or fund = \"FCC\" Then" ascii //weight: 1
        $x_1_3 = "Workbooks(\"function sheet data PP.xlsx\").Close (False)" ascii //weight: 1
        $x_1_4 = "path = \"\\\\brummer.se\\bfs\\BFS-Operations\\MO\\Function Sheet\\Archive\\\"" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_224
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "ThisWorkbook.FollowHyperlink Address:=\"https://www.teacherspensions.co.uk/mcrguides\"" ascii //weight: 2
        $x_2_2 = "Private Sub btnViewUI_SecB_Click()" ascii //weight: 2
        $x_2_3 = "intAns = MsgBox(prompt:=\"The contribution amounts will be generated and validated based on the member information you have provided in Section A.\"" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_225
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "9"
        strings_accuracy = "High"
    strings:
        $x_5_1 = "Developed by Michael Eifflaender / AE Software Solutions" ascii //weight: 5
        $x_1_2 = "Public tMilestones(5000) As Tmilestone" ascii //weight: 1
        $x_1_3 = "Public Function acbDoesObjExist(obj)" ascii //weight: 1
        $x_1_4 = "Public objPPT As Object 'PowerPoint.Application" ascii //weight: 1
        $x_1_5 = "Function abbreviate_MS_Name(msName)" ascii //weight: 1
        $x_1_6 = "Public Function trimTime(date_with_time)" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_5_*) and 4 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule __ASRWin32ApiMacroExclusion_226
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Public Const SUBKEY = \"SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\App Paths\\ITGDocX.exe\"" ascii //weight: 1
        $x_1_2 = "strMsg = strMsg & \"- IT Net Design App Not Installed.\"" ascii //weight: 1
        $x_1_3 = "Set visAddOn = Visio.Addons.Add(strAppPath & \"ITGDocX.exe\")" ascii //weight: 1
        $x_1_4 = "Visio.Addons.Item(strAppPath & \"ITGDocX.exe\").Run (\"DeviceSpec\")" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_227
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "cFile = MakeFileName(Worksheets(\"Semi-annual\").Range(\"Report_Period\"), \"FX_Turnover_Survey\", Worksheets(\"Semi-annual\").Range(\"Institution_Code\"), \".xls\")" ascii //weight: 1
        $x_1_2 = "If (InStr(1, n.Name, \"OBRDLUSDHKD\") >= 1) Then" ascii //weight: 1
        $x_1_3 = "ws.Cells(nRow, i).Name = \"FXC_SW7DL\" + Left(ws.Cells(cRow, i).Value, 3)" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_228
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "xAnova1 = Application.Run(GetMacroRegId(\"fnAnova1\"), inprng, outrng, grouped, labels, alpha)" ascii //weight: 2
        $x_2_2 = "xAnova1Q = Application.Run(GetMacroRegId(\"fnAnova1Q\"), inprng, outrng, grouped, labels, alpha)" ascii //weight: 2
        $x_2_3 = "xAnova2 = Application.Run(GetMacroRegId(\"fnAnova2\"), inprng, outrng, sample_rows, alpha)" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_229
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "If ActiveCell.Value = \"Company Code\"" ascii //weight: 1
        $x_1_2 = "colOrdr = Array(\"Division\", \"PRD.Hier5 Desc\", \"Material No\", \"Material Description\", \"Qty Available\", \"Company Code\", \"Plant\")" ascii //weight: 1
        $x_1_3 = "Set wr = Workbooks.Open(ThisWorkbook.Sheets(\"StockList\").Range(\"C7\"))" ascii //weight: 1
        $x_1_4 = "ActiveCell.Value = \"Material Description\"" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_230
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "oEnv.SaveVariable \"m_OATableJoinQuery\", m_OATableJoinQuery" ascii //weight: 1
        $x_1_2 = "oEnv.SaveVariable \"m_OATableName\", m_OATableName" ascii //weight: 1
        $x_1_3 = "Call MsgBox(\"OA Reports could not find named range '\" & sRangeName & \"'.\", vbOKOnly + vbExclamation, \"OA Reports\")" ascii //weight: 1
        $x_1_4 = "If Left(.ErrorTitle, Len(\"OA Editor\")) = \"OA Editor\" Then" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_231
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Private Const CDXLAddInProgID As String = \"ChemDrawExcelAddIn19.ExcelAddIn\"" ascii //weight: 1
        $x_1_2 = "CSBR-119010: Run method return null in chemdrawexcel" ascii //weight: 1
        $x_1_3 = "CSBR-128534: Saved worksheet is not recognized as a ChemOffice worksheet when reopen it" ascii //weight: 1
        $x_1_4 = "Public Sub CSXL_MakeNewCSWorksheet(ByRef bMadeSheet As Boolean)" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_232
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "BloombergUI.xla" ascii //weight: 1
        $x_1_2 = "BBPT_modUtility_XL.bas" ascii //weight: 1
        $x_1_3 = "batBloombergAutoColorType" ascii //weight: 1
        $x_1_4 = "Bloomberg\\Office Tools\\PowerTools" ascii //weight: 1
        $x_1_5 = "gAddinLoader.LoadLocally \"BloombergUIPPTMaster.ppa\"" ascii //weight: 1
        $x_1_6 = "Bloomberg API - ToolsProxy" ascii //weight: 1
        $x_1_7 = "addinPath = Application.AddIns(\"BloombergUIPPT\").path & \"\\\" & addinName" ascii //weight: 1
        $x_1_8 = "Bloomberg PowerTools" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (4 of ($x*))
}

rule __ASRWin32ApiMacroExclusion_233
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Set driver = CreateObject(\"Selenium.EdgeDriver\")" ascii //weight: 1
        $x_1_2 = "driver.Get \"https://www.tutorialspoint.com/index.htm\"" ascii //weight: 1
        $x_1_3 = "Private Driver As Selenium.EdgeDriver" ascii //weight: 1
        $x_1_4 = "river.FindElementById(\"DropDownListMSFiscalYear\").SendKeys Cells(r, 3).Value" ascii //weight: 1
        $x_1_5 = "Function Split97(sStr As Variant, sdelim As String) As Variant" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (3 of ($x*))
}

rule __ASRWin32ApiMacroExclusion_234
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "path_db = \"M:\\Sites\\Braine\\GTSO\\GPDI\\CCPD\\Analytics\\DB PQA\\DataBase UPS V1.0_be.accdb\"" ascii //weight: 1
        $x_1_2 = "If ThisWorkbook.ActiveSheet.Bouton_braine.Value = True Then site = \"BRA_UPS_T2\"" ascii //weight: 1
        $x_1_3 = "If ThisWorkbook.ActiveSheet.Bouton_slough.Value = True Then site = \"SLH_UPS_AJAX\"" ascii //weight: 1
        $x_1_4 = "Sql = \"SELECT * FROM 05_UPS_Crew \"" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_235
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "If (ShtName = \"DB\") Or (ShtName = \"TITLE\") Or (ShtName =" ascii //weight: 1
        $x_1_2 = "MyCln = r1.Find(moji, LookAt:=xlWhole, MatchCase:=True).Column" ascii //weight: 1
        $x_1_3 = "Call Worksheet_Setting(sht1, ThisWorkbook.Name, DBshtName): If sht1 Is Nothing Then Exit Sub" ascii //weight: 1
        $x_1_4 = "Dim sht1 As Excel.Worksheet: Set sht1 = ThisWorkbook.Worksheets(OUTsheet)" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_236
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "IF(COUNTA([@ID]:[@[Is the capital project within or above approved CPL?]])<=1" ascii //weight: 1
        $x_1_2 = "[@[Is the capital project included in the 10 year Capital Investment Plan? *]]" ascii //weight: 1
        $x_1_3 = "[@[Publish Est. Exp. to 30-Jun Indicator]]" ascii //weight: 1
        $x_1_4 = "[@[Estimated Total Cost ($000) *]]" ascii //weight: 1
        $x_1_5 = "[@[Estimated Financial Completion Month/Year *]]" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_237
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "Const ApiPrefixMPRel = \"https://sp2013.myatos.net/org/ewl/intproj/Projs/L7938%20-%20Merch/_api\"" ascii //weight: 2
        $x_2_2 = "method = \"GET\": query = \"/SP_TenantSettings_Current\"" ascii //weight: 2
        $x_2_3 = "method = \"GET\": query = \"/web/GetFolderByServerRelativeUrl('/organization/gbu/Fwl/ewl/coo/Payments products/IPP Governance/CR-PROJECTS/2021')\"" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_238
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Public Const SPMSXDataFileName As String = \"FODMcommMSXData.xlsx\"" ascii //weight: 1
        $x_1_2 = "Public Const myCOSMICmainURLStr As String = \"https://cosmic.crm.dynamics.com\"" ascii //weight: 1
        $x_1_3 = "Public Const myMSXmainURLStr As String = \"https://microsoftsales.crm.dynamics.com\"" ascii //weight: 1
        $x_1_4 = "Public Const newBetaWbName As String = ToolName & \"(beta).xlsm" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_239
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "MsgBox \"Please populate CDES Match Type column as per selection on Start Here tab. Please check with GSG/SOP for any clarification\"" ascii //weight: 1
        $x_1_2 = "Sheets(\"FY17Langloc\").Visible = i" ascii //weight: 1
        $x_1_3 = "Local_Nurture = Sheets(\"Marketo LM\").Range(\"C31\").Value" ascii //weight: 1
        $x_1_4 = "If Sheets(\"Database_Data\").Cells(1, i).Value = \"LeadMatchSourceName\" Then" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_240
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "8"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "Set FOri = CelDeNomBase(\"CelRefTMP\")" ascii //weight: 2
        $x_2_2 = "NomFullOri = FOri.Parent.Name" ascii //weight: 2
        $x_2_3 = "Set b = FOri.Range(FOri.Cells(PriFil - 1, PriCol), FOri.Cells(PriFil - 1, UltCol))" ascii //weight: 2
        $x_2_4 = "Set FDes = CelDeNomBase(\"CelRefRes\")" ascii //weight: 2
        $x_2_5 = "FDes.Parent.Cells.ClearContents" ascii //weight: 2
        $x_2_6 = "Set b = FDes.Range(FDes.Cells(PriFil, PriCol), FDes.Cells(UltFil, UltCol))" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (4 of ($x*))
}

rule __ASRWin32ApiMacroExclusion_241
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "C01 - Specify the financial institution as it should appear on the SMS Reports" ascii //weight: 1
        $x_1_2 = "C13 - FINANCIAL TRANSACTION FEE COLLECTION / FUNDS DISBURSEMENT" ascii //weight: 1
        $x_1_3 = "C20 - VERSION 2.3 FINANCIAL TRANSACTION / FEE RECORD" ascii //weight: 1
        $x_1_4 = "C06 - ACQUIRER ADJUSTMENT & MERCHANDISE CRED DETAIL" ascii //weight: 1
        $x_1_5 = "C17 - ADMINISTRATIVE MESSAGE 1 TRANSACTION RECORD" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_242
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "autECLPS.SendKeys \"VSRINIVASA\" & \"leaseplan1\"" ascii //weight: 1
        $x_1_2 = "Sub SetEnvDetails(EnvName As String, pwd As String, Optional usrName As String = \"VSRINIVASA\")" ascii //weight: 1
        $x_1_3 = "NolsEmulator = \"X:\\Users\\srine\\Desktop\\PC5250 Emulator icon-\" & EnvNo & \"-box.WS\"" ascii //weight: 1
        $x_1_4 = "Public Function LaunchPCOMMSession(ProfileName As String, SessionID As Integer)" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_243
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "gstrLocalDocPath = strDownloadPath & \"DATATEL\" & strLocalDocExtension" ascii //weight: 1
        $x_1_2 = "gstrLocalDataPath = strDownloadPath & \"DATATEL.TXT\"" ascii //weight: 1
        $x_1_3 = "method when the document is already saved is that it may produce an extra \"SELECT FROM DATATEL.TXT\"" ascii //weight: 1
        $x_1_4 = "I have pasted the code which modified the ODC to reference the downloaded DATATEL.TXT" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_244
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Sub suche(Datenblatt As String, Spalte As String)" ascii //weight: 1
        $x_1_2 = "Dim Merkmalcolumn As Integer, Bemerkung1column As Integer, Bemerkung2column As Integer, Parameterrow As Integer" ascii //weight: 1
        $x_1_3 = "If variable = \"CF2_70_ZUBEHOER_CONTIFORM\" Then" ascii //weight: 1
        $x_1_4 = "Public Endwert11kommission As Integer, Endwert12kommission As Integer, Endwert13kommission As Integer" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_245
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Workbooks.Open (\"\\\\brummer.se\\bfs\\BFS-Operations\\Function sheet\\data\\function sheet static.xlsx\")" ascii //weight: 1
        $x_1_2 = "Workbooks(\"function sheet static.xlsx\").Close (False" ascii //weight: 1
        $x_1_3 = "path = \"\\\\brummer.se\\bfs\\BFS-Operations\\MO\\Function Sheet\\Archive\"" ascii //weight: 1
        $x_1_4 = "Workbooks.Open (\"\\\\brummer.se\\bfs\\BFS-Operations\\function sheet\\data\\function sheet data PP.xlsx\")" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_246
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "MsgBox \"Please provide the required information.\", vbCritical, \"Order of Payment Form\"" ascii //weight: 1
        $x_1_2 = "FRMMealsBr.LBLMealsBr.Caption = \"Below is the detailed breakdown of your meals dated \"" ascii //weight: 1
        $x_1_3 = "MsgBox \"The most senior ranking personnel cannot be deleted!\", vbCritical, \"ORDER OF PAYMENT\"" ascii //weight: 1
        $x_1_4 = "Case \"56855753 Entertainment/Representation (with customers/vendors/non-cemex)\"" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_247
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "13"
        strings_accuracy = "High"
    strings:
        $x_10_1 = "Public Sub GetOSEApplication(ByRef retval As AspenOSEWorkbook.OSEApplication)" ascii //weight: 10
        $x_10_2 = "Public Sub GetASWApplication(ByRef retval As AspenOSEWorkbook.OSEApplication)" ascii //weight: 10
        $x_1_3 = "app.ExecuteCommand (\"AspenTech.ASWXL.Commands.RunCommand\")" ascii //weight: 1
        $x_1_4 = "app.ExecuteCommand (\"AspenTech.ASWXL.Commands.Excel2ModelCommand\")" ascii //weight: 1
        $x_1_5 = "app.ExecuteCommand (\"AspenTech.ASWXL.Commands.LoadSnapshotCommand\")" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_10_*) and 3 of ($x_1_*))) or
            ((2 of ($x_10_*))) or
            (all of ($x*))
        )
}

rule __ASRWin32ApiMacroExclusion_248
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Public Function calculateNewGrossAvailability(unavailabilityDictionary As Dictionary, binocsAvailabilityMng As BinocsAvailabilityManager) As Dictionary" ascii //weight: 1
        $x_1_2 = "Private pApiManager As ApiDataManager" ascii //weight: 1
        $x_1_3 = "Private Function createChunkTableRemoveDatesAndQuantityForExpertise(ByRef demandTable As Table) As Table" ascii //weight: 1
        $x_1_4 = "Public Function getEmployeeWorkRegime(employeeCode As String) As Double" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_249
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "MsgBox (\"VEHICLE / TRAILER COULD NOT BE FOUND. PLEASE SEARCH AGAIN, OR ENTER DETAILS MANUALLY.\"), vbExclamation, \"PLEASE NOTE!\"" ascii //weight: 1
        $x_1_2 = "ThisWorkbook.Sheets(\"OCT (F)\").Select" ascii //weight: 1
        $x_1_3 = "If Ship.value = \"MSM\" Or Ship.value = \"NORMANDIE\" Then" ascii //weight: 1
        $x_1_4 = "PLEASE COMPLETE ALL MANDATORY BOXES BEFORE CONTINUING. IF RECORDING A HUB SELECTION, MAKE SURE TO CONDUCT A SEARCH FOR THE VEHICLE / TRAILER REG FIRST" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_250
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "assembla.com/spaces/skabelondesign-productionteam/wiki/Genvejstaster_i_WordEngine" ascii //weight: 1
        $x_1_2 = "Case \"btnWave1\", \"btnWave2\", \"btnWave3\", \"btnWave4\", \"btnWave5\", \"btnPictureSmall\", \"btnBottomBorderShow\", \"btnBottomBorderHide\"" ascii //weight: 1
        $x_1_3 = "JAS 23/11-2012 Disabled and bCheckBoxValue return parameter added" ascii //weight: 1
        $x_1_4 = "dbgNoCheckpoints = dbgLogError Or dbgLogWarning Or dbgLogInformational Or dbgWindowProc Or dbgResources" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_251
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Set EntrySheet = ThisWorkbook.Worksheets(\"Version\")" ascii //weight: 1
        $x_1_2 = "prefix = \"INSERT INTO refdatavaluehierarchy (parentId, childId) VALUES\"" ascii //weight: 1
        $x_1_3 = "ProduceHeader filename, \"ExternalSystem reference data script\", release" ascii //weight: 1
        $x_1_4 = "prefix = \"INSERT INTO RefDataSet (RefDataSetId, RefDataSetName, RefDataSetDesc, ShortDescLength, InitialDataFileName, CreatedUserId, CreatedDateTime, LastUpdatedUserId, LastUpdatedDateTime) VALUES\"" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_252
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Sub CreateNewDoor(ByVal DoorName As String, ByVal PC_code As String, ByVal StoreName As String, ByVal AfterBySheetName As String" ascii //weight: 1
        $x_1_2 = "Sub MoveAfter(ByVal DoorName As String, ByVal AfterBySheetName As String)" ascii //weight: 1
        $x_1_3 = "arr = Array(\"Arc'Teryx\", \"Atomic\", \"PP\", \"Precor\", \"SalHG\", \"Salomon\", \"Suunto\", \"Wilson Golf\", \"Wilson Racket\", \"Wilson SG\", \"Wilson TEAM\")" ascii //weight: 1
        $x_1_4 = "Call regionCopyData(DoorName, \"E16\", \"Q124\", \"E13\", \"Q121\")" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_253
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Sub UpdateTeamOnTeamHappinessSheet(sh As Excel.Worksheet, lngSprintNr As Long, Optional bTransfer As Boolean = False)" ascii //weight: 1
        $x_1_2 = "Private Sub VerwijderRegelUitSprintPlanningSheet(sh As Excel.Worksheet, iRowEmployee As Long)" ascii //weight: 1
        $x_1_3 = "Function CountSprintPlanningSheets(Optional bExists As Boolean = True) As Long" ascii //weight: 1
        $x_1_4 = "Dim Present_hours, Availability, Available_hours, Productivity, Plannable_hours, SPPH, Plannable_storypoints As Double" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_254
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "strSourceFile = \"\\\\poise.homeoffice.local\\Data\\IND\\Shared\\Transfer\\AA Dev\\BNO\\LAL_Search_BE.xlsx\"" ascii //weight: 1
        $x_1_2 = "MsgBox \"No results found. Please check your criteria and try again.\", vbInformation, \"LAL Search Tool\"" ascii //weight: 1
        $x_1_3 = "MsgBox \"Results contain more than 2500 records. Please refine your search criteria and try again.\", vbCritical, \"LAL Search Tool\"" ascii //weight: 1
        $x_1_4 = "strPath = \"\\\\poise.homeoffice.local\\Data\\IND\\Shared\\Transfer\\AA Dev\\BNO\\Search_Audit_BE.accdb\"" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_255
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_3_1 = "this module sends a jql query to jira using the rest api and then processes the json response" ascii //weight: 3
        $x_3_2 = "updating the rows and columns in the jira extract table with the data that is returned" ascii //weight: 3
        $x_3_3 = "by c. ross mckenrick (mckencr@consultantemail.com, rmckenrick@sapient.com)" ascii //weight: 3
        $x_3_4 = "prior to displaying the form, position it in the middle of the jira extract sheet window" ascii //weight: 3
        $x_2_5 = "refreshjiraextract" ascii //weight: 2
        $x_2_6 = "jiracredentialsform" ascii //weight: 2
        $x_2_7 = "authentication error logging on to jira" ascii //weight: 2
        $x_2_8 = "authorization error logging on to jira" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (
            ((3 of ($x_2_*))) or
            ((1 of ($x_3_*) and 2 of ($x_2_*))) or
            ((2 of ($x_3_*))) or
            (all of ($x*))
        )
}

rule __ASRWin32ApiMacroExclusion_256
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "oracle hyperion smart view for office" ascii //weight: 2
        $x_2_2 = "smartview\\bin\\hstbar.xla" ascii //weight: 2
        $x_1_3 = "hstbarsmartviewpanel" ascii //weight: 1
        $x_1_4 = "hstbaraction" ascii //weight: 1
        $x_1_5 = "hstbarzoomin" ascii //weight: 1
        $x_1_6 = "hstbarzoomout" ascii //weight: 1
        $x_1_7 = "hstbarpivot" ascii //weight: 1
        $x_1_8 = "hstbarkeeponly" ascii //weight: 1
        $x_1_9 = "hstbarremoveonly" ascii //weight: 1
        $x_1_10 = "hstbarrefresh" ascii //weight: 1
        $x_1_11 = "hstbarsubmitdata" ascii //weight: 1
        $x_1_12 = "hstbarundo" ascii //weight: 1
        $x_1_13 = "hstbarredo" ascii //weight: 1
        $x_1_14 = "hstbarcopydatapoints" ascii //weight: 1
        $x_1_15 = "hstbarpastedatapoints" ascii //weight: 1
        $x_1_16 = "hstbarbiedit" ascii //weight: 1
        $x_1_17 = "hstbarpovmanager" ascii //weight: 1
        $x_1_18 = "hstbarmemberselection" ascii //weight: 1
        $x_1_19 = "hstbarfunctionbuilder" ascii //weight: 1
        $x_1_20 = "hstbaradjust" ascii //weight: 1
        $x_1_21 = "hstbarcellcomments" ascii //weight: 1
        $x_1_22 = "hstbarsupportingdetails" ascii //weight: 1
        $x_1_23 = "hstbartakeoffline" ascii //weight: 1
        $x_1_24 = "hstbarrefreshofflinedefinition" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((6 of ($x_1_*))) or
            ((1 of ($x_2_*) and 4 of ($x_1_*))) or
            ((2 of ($x_2_*) and 2 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule __ASRWin32ApiMacroExclusion_257
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "If LstActsPicked.List(list_item) = \"**INAPPROPRIATE CALL**\" Then" ascii //weight: 1
        $x_1_2 = "MsgBox \"You must select '3:What is the main ACTION type?'\"" ascii //weight: 1
        $x_1_3 = "MsgBox \"You must select '7:Do you need to FORWARD or refer this request onwards?'\"" ascii //weight: 1
        $x_1_4 = "ws_out.Cells(write_row, 5).Value = IIf(RadBranchYes, \"Processing\", (IIf(RadBranchNo, \"Query\", (IIf(RadBranchOther, \"Check\", (IIf(RadBranchOther1, \"Bail End\", \"Other\")))))))" ascii //weight: 1
        $x_1_5 = "IIf(RadFirstYes, \"Crown Court\", (IIf(RadFirstNo, \"Magistrates/Youth\", (IIf(RadFirstOther, \"Prison\", (IIf(RadFirstOther1, \"EMS Internal\", (IIf(RadFirstOther2, \"UKBA\", \"Other\")))))))))" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ASRWin32ApiMacroExclusion_258
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "qvidian.xlam" ascii //weight: 2
        $x_2_2 = "if saving a qvidian file, update the ui" ascii //weight: 2
        $x_2_3 = "leaving early (qvidian.xla or embedded)" ascii //weight: 2
        $x_2_4 = "are you sure you wish to cancel without saving changes back to qvidian?" ascii //weight: 2
        $x_2_5 = "save spreadsheet back to the qvidian document" ascii //weight: 2
        $x_2_6 = "please paste your content here, then click 'save to qvidian'" ascii //weight: 2
        $x_2_7 = "qvidianserver variable used for managing server specific user credentials" ascii //weight: 2
        $x_2_8 = "please download the correct add-ins before performing any qvidian operations" ascii //weight: 2
        $x_1_9 = "work out if the file is \"one of ours\" in terms of multi-edit" ascii //weight: 1
        $x_1_10 = "this little nasty hack is because excel is firing this event with a bad workbook" ascii //weight: 1
        $x_1_11 = "the only way i seem to be able to trap it is access the name" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((2 of ($x_2_*) and 2 of ($x_1_*))) or
            ((3 of ($x_2_*))) or
            (all of ($x*))
        )
}

rule __ASRWin32ApiMacroExclusion_259
{
    meta:
        author = "defender2yara"
        detection_name = "!#ASRWin32ApiMacroExclusion"
        threat_id = "1879048763"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "8"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "FileCopy mobjInfo.PathGkgMyParmFolder & \"EGA1C00S.xls\", mobjInfo.PathMyFolder & \"EGA1C00S.xls\"" ascii //weight: 1
        $x_1_2 = "FileCopy mobjInfo.PathGkgMyParmFolder & \"EGA1C10S.xls\", mobjInfo.PathMyFolder & \"EGA1C10S.xls\"" ascii //weight: 1
        $x_1_3 = "FileCopy mobjInfo.PathGkgMyParmFolder & \"EGA1C20S.xls\", mobjInfo.PathMyFolder & \"EGA1C20S.xls\"" ascii //weight: 1
        $x_1_4 = "FileCopy mobjInfo.PathGkgMyParmFolder & \"EGA1C30S.xls\", mobjInfo.PathMyFolder & \"EGA1C30S.xls\"" ascii //weight: 1
        $x_1_5 = "FileCopy mobjInfo.PathGkgMyParmFolder & \"EGA1C41S.xls\", mobjInfo.PathMyFolder & \"EGA1C41S.xls\"" ascii //weight: 1
        $x_1_6 = "FileCopy mobjInfo.PathGkgMyParmFolder & \"EGA1C42S.xls\", mobjInfo.PathMyFolder & \"EGA1C42S.xls\"" ascii //weight: 1
        $x_1_7 = "FileCopy mobjInfo.PathGkgMyParmFolder & \"EGA1C43S.xls\", mobjInfo.PathMyFolder & \"EGA1C43S.xls\"" ascii //weight: 1
        $x_1_8 = "FileCopy mobjInfo.PathGkgMyParmFolder & \"EGA1C44S.xls\", mobjInfo.PathMyFolder & \"EGA1C44S.xls\"" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_AskToolbar_0
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:AskToolbar"
        threat_id = "1879048837"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "pipoffers.apnpartners.com" ascii //weight: 2
        $x_1_2 = "DisplayOffer" ascii //weight: 1
        $x_1_3 = "offereula" ascii //weight: 1
        $x_1_4 = "AskToolbar" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_AskToolbar_1
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:AskToolbar"
        threat_id = "1879048837"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "apnstatic.ask.com" ascii //weight: 2
        $x_1_2 = "offerlist" ascii //weight: 1
        $x_1_3 = "OfferCast" ascii //weight: 1
        $x_1_4 = "OCPacker.pdb" ascii //weight: 1
        $x_1_5 = "APNInstaller.exe" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_AskToolbar_2
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:AskToolbar"
        threat_id = "1879048837"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "Ask Toolbar.msi" ascii //weight: 2
        $x_1_2 = "websearch.ask.com" ascii //weight: 1
        $x_1_3 = "GenericAskToolbar.dll" ascii //weight: 1
        $x_1_4 = "externalwrapper.pdb" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_2_*) and 2 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule __PUA_Block_AskToolbar_3
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:AskToolbar"
        threat_id = "1879048837"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "C:\\Jenkins\\workspace\\OC3.X\\OC\\Release\\OCPacker.pdb" ascii //weight: 1
        $x_1_2 = "Offercast" ascii //weight: 1
        $x_1_3 = "offerlist.js" ascii //weight: 1
        $x_1_4 = "Ask.com" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_AskToolbar_4
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:AskToolbar"
        threat_id = "1879048837"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "PlayFizz Installer" ascii //weight: 1
        $x_1_2 = "Installing Conduit toolbar" ascii //weight: 1
        $x_1_3 = "Ask installation finished" ascii //weight: 1
        $n_100_4 = "Uninst.exe" ascii //weight: -100
        $n_100_5 = "Uninstall.exe" ascii //weight: -100
    condition:
        (filesize < 20MB) and
        (not (any of ($n*))) and
        (all of ($x*))
}

rule __PUA_Block_AskToolbar_5
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:AskToolbar"
        threat_id = "1879048837"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Setup - CutePDF Writer" ascii //weight: 1
        $x_1_2 = "Ask Toolbar" ascii //weight: 1
        $x_1_3 = "toolbar" ascii //weight: 1
        $x_1_4 = "offereula" ascii //weight: 1
        $x_1_5 = "AskInstaller" ascii //weight: 1
        $n_100_6 = "Uninst.exe" ascii //weight: -100
        $n_100_7 = "Uninstall.exe" ascii //weight: -100
    condition:
        (filesize < 20MB) and
        (not (any of ($n*))) and
        (all of ($x*))
}

rule __PUA_Block_AskToolbar_6
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:AskToolbar"
        threat_id = "1879048837"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Exact Audio Copy" ascii //weight: 1
        $x_1_2 = "Exact Audio Copy.lnk" ascii //weight: 1
        $x_1_3 = "EAC.exe" ascii //weight: 1
        $x_1_4 = "askToolbarInstaller-1.7.0.0.exe" ascii //weight: 1
        $x_1_5 = "AskToolbar2.bmp" ascii //weight: 1
        $n_100_6 = "Uninst.exe" ascii //weight: -100
        $n_100_7 = "Uninstall.exe" ascii //weight: -100
    condition:
        (filesize < 20MB) and
        (not (any of ($n*))) and
        (all of ($x*))
}

rule __PUA_Block_AskToolbar_7
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:AskToolbar"
        threat_id = "1879048837"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "embedoffer2xtemplate.htmUT" ascii //weight: 1
        $x_1_2 = "offer2xtemplate.htmUT" ascii //weight: 1
        $x_1_3 = "offerlist.jsUT" ascii //weight: 1
        $x_1_4 = "APNInstaller.exe" ascii //weight: 1
        $x_1_5 = "Offercast - APN Install Manager" ascii //weight: 1
        $x_1_6 = "OCPacker.pdb" ascii //weight: 1
        $n_100_7 = "Uninst.exe" ascii //weight: -100
        $n_100_8 = "Uninstall.exe" ascii //weight: -100
    condition:
        (filesize < 20MB) and
        (not (any of ($n*))) and
        (all of ($x*))
}

rule __PUA_Block_DownloadSponsor_0
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:DownloadSponsor"
        threat_id = "1879048843"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "api.chip-secured-download.de" ascii //weight: 2
        $x_1_2 = "afterdl.php" ascii //weight: 1
        $x_1_3 = "DMR.pdb" ascii //weight: 1
        $x_1_4 = "agb-proxy.php" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_DownloadSponsor_1
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:DownloadSponsor"
        threat_id = "1879048843"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "CHIP Secured Installer" ascii //weight: 1
        $x_1_2 = "DMR.exe" ascii //weight: 1
        $x_1_3 = "DMR.pdb" ascii //weight: 1
        $n_100_4 = "Uninst.exe" ascii //weight: -100
        $n_100_5 = "Uninstall.exe" ascii //weight: -100
    condition:
        (filesize < 20MB) and
        (not (any of ($n*))) and
        (all of ($x*))
}

rule __PUA_Block_DownloadSponsor_2
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:DownloadSponsor"
        threat_id = "1879048843"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "api.chip-secured-download.de" ascii //weight: 2
        $x_1_2 = "uac.php" ascii //weight: 1
        $x_1_3 = "agb-proxy.php" ascii //weight: 1
        $x_1_4 = "OCSagb-branded.php" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_DownloadSponsor_3
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:DownloadSponsor"
        threat_id = "1879048843"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "api.chip-secured-download.de" ascii //weight: 2
        $x_1_2 = "afterdl.php" ascii //weight: 1
        $x_1_3 = "DMR\\obj\\Debug\\DMR.pdb" ascii //weight: 1
        $x_1_4 = "geoip.php" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_DownloadSponsor_4
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:DownloadSponsor"
        threat_id = "1879048843"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "api.chip-secured-download.de" ascii //weight: 2
        $x_1_2 = "OCSagb-branded.php" ascii //weight: 1
        $x_1_3 = "www.chip.de" ascii //weight: 1
        $x_1_4 = "agb-proxy.php" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_Linkury_0
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:Linkury"
        threat_id = "1879048846"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "stats.hkijngy.me" ascii //weight: 2
        $x_1_2 = "madmax.hkijngy.me" ascii //weight: 1
        $x_1_3 = "MaxMind.asmx" ascii //weight: 1
        $x_1_4 = "APSFRec.exe" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_Linkury_1
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:Linkury"
        threat_id = "1879048846"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "traderstruthrevealed.com" ascii //weight: 1
        $x_1_2 = "quip.exe" ascii //weight: 1
        $x_1_3 = "/images/do15.exe" ascii //weight: 1
        $x_1_4 = "wipet.exe" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_Linkury_2
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:Linkury"
        threat_id = "1879048846"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "stats.hkijngy.me" ascii //weight: 2
        $x_1_2 = "cdn.vrvrvrapp.com" ascii //weight: 1
        $x_1_3 = "StatisticsService.svc" ascii //weight: 1
        $x_1_4 = "votgui.exe" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_Linkury_3
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:Linkury"
        threat_id = "1879048846"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "hkijngy.me/StatisticsService.svc" ascii //weight: 2
        $x_1_2 = "madmax.hkijngy.me" ascii //weight: 1
        $x_1_3 = "stats.hkijngy.me" ascii //weight: 1
        $x_1_4 = "Nettrans.exe" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_Linkury_4
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:Linkury"
        threat_id = "1879048846"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "search.tube-bar.com" ascii //weight: 1
        $x_1_2 = "cloud-search.linkury.com" ascii //weight: 1
        $x_1_3 = "az290055.vo.msecnd.net" ascii //weight: 1
        $x_1_4 = "GuidCreator.dll" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_Linkury_5
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:Linkury"
        threat_id = "1879048846"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "7"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "linkury.com" ascii //weight: 2
        $x_2_2 = "sfxrar.pdb" ascii //weight: 2
        $x_1_3 = "ToolbarWindow32" ascii //weight: 1
        $x_1_4 = "Nettrans.exe" ascii //weight: 1
        $x_1_5 = "stats.hkijngy.me" ascii //weight: 1
        $x_1_6 = "createNewTask" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((2 of ($x_2_*) and 3 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule __PUA_Block_Linkury_6
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:Linkury"
        threat_id = "1879048846"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Extentions_installed" ascii //weight: 1
        $x_1_2 = "Software\\Google\\Chrome\\Extensions" ascii //weight: 1
        $x_1_3 = "stats.stuffpicks.com" ascii //weight: 1
        $x_1_4 = "Background Logic Handler" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_Linkury_7
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:Linkury"
        threat_id = "1879048846"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "set_LinkuryExeDir" ascii //weight: 1
        $x_1_2 = "LinkuryInstallationFolder" ascii //weight: 1
        $x_1_3 = "BasicLinkToOffersManagerCloudService" ascii //weight: 1
        $x_1_4 = "SmartBarName" ascii //weight: 1
        $x_1_5 = "TaskbarNotifierExePath" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_Linkury_8
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:Linkury"
        threat_id = "1879048846"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "8"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "get_BasicLinkToOffersManagerCloudService" ascii //weight: 1
        $x_1_2 = "LinkuryInstallationFolder" ascii //weight: 1
        $x_1_3 = "set_LinkuryExeDir" ascii //weight: 1
        $x_1_4 = "SetBrowserSettingsSilently" ascii //weight: 1
        $x_1_5 = "get_EncryptURL" ascii //weight: 1
        $x_1_6 = "InternetExplorer" ascii //weight: 1
        $x_1_7 = "Chrome" ascii //weight: 1
        $x_1_8 = "Firefox" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_Linkury_9
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:Linkury"
        threat_id = "1879048846"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "7"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "HostsFileMonitorLinkuryDomains" ascii //weight: 1
        $x_1_2 = "BumbleBStateStatisticsEndpoint" ascii //weight: 1
        $x_1_3 = "AdPresenterLink" ascii //weight: 1
        $x_1_4 = "get_InstallSilently" ascii //weight: 1
        $x_1_5 = "get_BasicLinkToOffersManagerCloudService" ascii //weight: 1
        $x_1_6 = "get_TaskbarNotifierExePath" ascii //weight: 1
        $x_1_7 = "get_GetBundlingApplicationsToInstallFunction" ascii //weight: 1
        $n_100_8 = "Uninst.exe" ascii //weight: -100
        $n_100_9 = "Uninstaller.exe" ascii //weight: -100
        $n_100_10 = "Uninstal.exe" ascii //weight: -100
    condition:
        (filesize < 20MB) and
        (not (any of ($n*))) and
        (all of ($x*))
}

rule __PUA_Block_DriverPack_0
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:DriverPack"
        threat_id = "1879048866"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {32 1a a5 a9 84 b2 e6 d3 1a 21 94 96 37 3d c9 d3 9d 9f 2e 02 7d c0 f8 86 52 5a 14 fd f5 1e cd d7 6f 17 d2 13 b8 39 56 4b 91 b9 a8 a4 fb 59 58 dd 5a 52 25 c3 33 f2 a2 88 57 12 e4 c1 43 cc 5e d9 b6 72 bb 26 f1 c4 20 05 16 a6 04 5b 3f bc 6d 78 42 ca 0d 8d 96 87 6f e9 6a 9b 8a 15 7e 21 c9 33 e0 45 62 0c 71 58 fd 17 8b 61 93 45 81 b9 8f 24 8f c6 49 b7 61 a4 76 22 9f 0b 5b 9e 17 49 15 8b 15}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_DriverPack_1
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:DriverPack"
        threat_id = "1879048866"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {b8 63 4a aa 73 8d 54 b8 de 0f cd 56 f7 99 be 8b 63 a4 cb 72 f2 1f bf 62 23 24 39 56 e1 f2 b3 25 cb 66 3a e8 c0 c9 37 ed df 90 b9 0e 28 c3 2d 7a 80 78 a5 a1 67 bd cc 3f 21 0b e3 5b f2 94 8a 88 60 56 b3 34 c1 b8 ea 04 88 2a b2 dc 05 d0 74 7a fd 2e 8d 85 aa 36 8a d1 8f 66 d6 7b b1 07 5f 8e dc 66 28 07 c7 c4 0a e0 c1 f4 ea 6d e2 9b 6c 40 66 05 3a d3 3c 72 a3 80 a9 82 a5 49 06 e4 53 cf 4f 2f f0 21 32}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_DriverPack_2
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:DriverPack"
        threat_id = "1879048866"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "2"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "https://drp.su/" ascii //weight: 1
        $x_1_2 = "HKCU\\\\SOFTWARE\\\\drpsu" ascii //weight: 1
        $x_1_3 = "download.drp.su/assistant/" ascii //weight: 1
        $x_1_4 = "\\\\DRPSu\\\\diagnostics\\\\drivers.json" ascii //weight: 1
        $x_1_5 = "bin/tools/DriverPack-Notifier.exe" wide //weight: 1
        $x_1_6 = "bin/tools/driverpack-wget.exe" wide //weight: 1
    condition:
        (filesize < 20MB) and
        (2 of ($x*))
}

rule __PUA_Block_NiceHashMiner_0
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:NiceHashMiner"
        threat_id = "1879048873"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "NiceHash/Excavator" ascii //weight: 1
        $x_1_2 = "excavator_cuda_ver" ascii //weight: 1
        $x_1_3 = "GPU Miner for NiceHash" ascii //weight: 1
        $x_1_4 = "QUICKMINER cpu mining enable" ascii //weight: 1
        $x_1_5 = "QUICKMINER cpu mining disable" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_NiceHashMiner_1
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:NiceHashMiner"
        threat_id = "1879048873"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "NiceHashMiner.Configs.Data" ascii //weight: 1
        $x_1_2 = "GetNiceHashApiData" ascii //weight: 1
        $x_1_3 = "get_MinerDeviceName" ascii //weight: 1
        $x_1_4 = "nicehash_credentials" ascii //weight: 1
        $x_1_5 = "NiceHashMiner.Miners" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (3 of ($x*))
}

rule __PUA_Block_Conduit_0
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:Conduit"
        threat_id = "1879048880"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Hero Fighter Install Program" ascii //weight: 1
        $x_1_2 = "HeroFighterToolbar.exe" ascii //weight: 1
        $x_1_3 = "Please support us by installing the Hero Fighter toolbar" ascii //weight: 1
        $n_100_4 = "Uninst.exe" ascii //weight: -100
        $n_100_5 = "Uninstall.exe" ascii //weight: -100
    condition:
        (filesize < 20MB) and
        (not (any of ($n*))) and
        (all of ($x*))
}

rule __PUA_Block_Conduit_1
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:Conduit"
        threat_id = "1879048880"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = "Output\\Release_32\\SPtool.pdb" ascii //weight: 1
        $x_1_2 = "Software\\SearchProtect" ascii //weight: 1
        $x_1_3 = {53 00 65 00 61 00 72 00 63 00 68 00 50 00 72 00 6f 00 74 00 65 00 63 00 74 00 5c 00 4d 00 61 00 69 00 6e 00 5c 00 72 00 65 00 70 00 5c 00 [0-15] 2e 00 62 00 69 00 6e 00}  //weight: 1, accuracy: Low
        $x_1_4 = {53 65 61 72 63 68 50 72 6f 74 65 63 74 5c 4d 61 69 6e 5c 72 65 70 5c [0-15] 2e 62 69 6e}  //weight: 1, accuracy: Low
        $x_1_5 = {43 00 3a 00 5c 00 44 00 6f 00 63 00 75 00 6d 00 65 00 6e 00 74 00 73 00 20 00 61 00 6e 00 64 00 20 00 53 00 65 00 74 00 74 00 69 00 6e 00 67 00 73 00 5c 00 [0-31] 5c 00 4c 00 6f 00 63 00 61 00 6c 00 20 00 53 00 65 00 74 00 74 00 69 00 6e 00 67 00 73 00 5c 00 41 00 70 00 70 00 6c 00 69 00 63 00 61 00 74 00 69 00 6f 00 6e 00 20 00 44 00 61 00 74 00 61 00 5c 00 53 00 65 00 61 00 72 00 63 00 68 00 50 00 72 00 6f 00 74 00 65 00 63 00 74 00}  //weight: 1, accuracy: Low
        $x_1_6 = {43 3a 5c 44 6f 63 75 6d 65 6e 74 73 20 61 6e 64 20 53 65 74 74 69 6e 67 73 5c [0-31] 5c 4c 6f 63 61 6c 20 53 65 74 74 69 6e 67 73 5c 41 70 70 6c 69 63 61 74 69 6f 6e 20 44 61 74 61 5c 53 65 61 72 63 68 50 72 6f 74 65 63 74}  //weight: 1, accuracy: Low
        $x_1_7 = {6c 00 61 00 62 00 2e 00 [0-31] 2e 00 63 00 6f 00 6d 00}  //weight: 1, accuracy: Low
        $x_1_8 = {6c 61 62 2e [0-31] 2e 63 6f 6d}  //weight: 1, accuracy: Low
        $x_1_9 = "search.conduit.com" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (5 of ($x*))
}

rule __PUA_Block_Softonic_0
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:Softonic"
        threat_id = "1879048894"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "frostwire-win.sd.en.softonic.com" ascii //weight: 2
        $x_1_2 = "universaldownloader-prefetch" ascii //weight: 1
        $x_1_3 = "SoftonicDownloader.exe" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_Keygen_0
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:Keygen"
        threat_id = "1879048898"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "keymaker by SiraX/CORE" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_MiniPopups_0
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:MiniPopups"
        threat_id = "1879048912"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "\\pop_popex\\rundll\\Release\\" ascii //weight: 1
        $x_1_2 = "XsjufQspdfttNfnpsz" ascii //weight: 1
        $x_1_3 = "RunExtention.tpi" wide //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_MiniPopups_1
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:MiniPopups"
        threat_id = "1879048912"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "2"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "AdSwitchWnd: get mini_news failed." wide //weight: 2
        $x_2_2 = "XsjufQspdfttNfnp" ascii //weight: 2
        $x_1_3 = "Static wallpaper AD: ad_resquest_num is greater than" wide //weight: 1
        $x_1_4 = "ID_TIMER_POP_24_CLOCK" wide //weight: 1
        $x_1_5 = "StaticWPAd: Request config will be delayed %d seconds" wide //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((2 of ($x_1_*))) or
            ((1 of ($x_2_*))) or
            (all of ($x*))
        )
}

rule __PUA_Block_MiniPopups_2
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:MiniPopups"
        threat_id = "1879048912"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "MasterPdfMiniNewsMainWnd" wide //weight: 1
        $x_1_2 = "SOFTWARE\\QiLu Inc.\\mininews\\lds" wide //weight: 1
        $x_1_3 = "Q360ComputerzMiniNewsMutextNameLds" wide //weight: 1
        $x_1_4 = "media.ludashi.com/n/mini?pid=%s&appver=%s&modver=%s" wide //weight: 1
        $x_1_5 = "Application Data\\ludashi\\Log\\ludashi_Mininews.log" wide //weight: 1
        $x_1_6 = "[hinter mininews quit] check other mininews process!" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (4 of ($x*))
}

rule __PUA_Block_MiniPopups_3
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:MiniPopups"
        threat_id = "1879048912"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Software\\360Safe\\Liveup" ascii //weight: 1
        $x_1_2 = "Chengdu Qilu Technology" ascii //weight: 1
        $x_1_3 = "downloader.pdb" ascii //weight: 1
        $x_1_4 = "softmgr.ludashi.com" ascii //weight: 1
        $x_1_5 = "support.exe" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_MiniPopups_4
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:MiniPopups"
        threat_id = "1879048912"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "mininews.exe" ascii //weight: 1
        $x_1_2 = "MINIPAGE_EXE" ascii //weight: 1
        $x_1_3 = "MINIPAGE=Popup" ascii //weight: 1
        $x_1_4 = "xsfaya.com" ascii //weight: 1
        $x_1_5 = "POPUP_DISPATCH_REPORT" ascii //weight: 1
        $x_1_6 = "SoftManage.exe" ascii //weight: 1
        $n_100_7 = "Uninst.exe" ascii //weight: -100
        $n_100_8 = "Uninstall.exe" ascii //weight: -100
    condition:
        (filesize < 20MB) and
        (not (any of ($n*))) and
        (all of ($x*))
}

rule __PUA_Block_MiniPopups_5
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:MiniPopups"
        threat_id = "1879048912"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "7"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "APP_MINITRAY_EXE" ascii //weight: 1
        $x_1_2 = "MINIPAGE=Popup" ascii //weight: 1
        $x_1_3 = "CMYWND_MINIPAGE" ascii //weight: 1
        $x_1_4 = "MiniPage" ascii //weight: 1
        $x_1_5 = "xsfaya.com" ascii //weight: 1
        $x_1_6 = "ywwLXY4Ez0pmCQ7k" ascii //weight: 1
        $x_1_7 = "Millicent.exe" ascii //weight: 1
        $n_100_8 = "Uninst.exe" ascii //weight: -100
        $n_100_9 = "Uninstaller.exe" ascii //weight: -100
        $n_100_10 = "Uninstal.exe" ascii //weight: -100
    condition:
        (filesize < 20MB) and
        (not (any of ($n*))) and
        (all of ($x*))
}

rule __PUA_Block_XMRig_0
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:XMRig"
        threat_id = "1879048913"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_2_1 = ".minergate.com" ascii //weight: 2
        $x_1_2 = "stratum+tcp://" ascii //weight: 1
        $x_1_3 = ".nicehash.com" ascii //weight: 1
        $x_1_4 = "{\"id\":%lld,\"jsonrpc\":\"2.0\",\"method\":\"keepalived\",\"params\":{\"id\":\"%s\"}}" ascii //weight: 1
        $x_1_5 = "affine_to_cpu" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_XMRig_1
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:XMRig"
        threat_id = "1879048913"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "nvidia" ascii //weight: 1
        $x_1_2 = "hashes_total" ascii //weight: 1
        $x_1_3 = "mem_clock" ascii //weight: 1
        $x_1_4 = "worker_id" ascii //weight: 1
        $x_1_5 = "cryptonight_extra_cpu" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_XMRig_2
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:XMRig"
        threat_id = "1879048913"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "8"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "cpu-affinity" ascii //weight: 1
        $x_1_2 = "donate-over-proxy" ascii //weight: 1
        $x_1_3 = "rig-id" ascii //weight: 1
        $x_1_4 = "nicehash" ascii //weight: 1
        $x_1_5 = "donate.v2.xmrig.com" ascii //weight: 1
        $x_1_6 = "cryptonight-monerov7" ascii //weight: 1
        $x_1_7 = "cryptonight-monerov8" ascii //weight: 1
        $x_1_8 = "cryptonight_v8" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_XMRig_3
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:XMRig"
        threat_id = "1879048913"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "8"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "XMRig 2.15.1-beta" ascii //weight: 1
        $x_1_2 = "cryptonight-lite" ascii //weight: 1
        $x_1_3 = "rig identifier for pool-side statistics" ascii //weight: 1
        $x_1_4 = "run the miner in the background" ascii //weight: 1
        $x_1_5 = "nicehash.com " ascii //weight: 1
        $x_1_6 = "cryptonightheavy" ascii //weight: 1
        $x_1_7 = "minergate.com" ascii //weight: 1
        $x_1_8 = "xmr.pool" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_XMRig_4
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:XMRig"
        threat_id = "1879048913"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "11"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "enable nicehash.com support" ascii //weight: 1
        $x_1_2 = "mining algorithm https://xmrig.com/docs/algorithms" ascii //weight: 1
        $x_1_3 = "use daemon RPC instead of pool for solo mining" ascii //weight: 1
        $x_1_4 = "path to CUDA plugin (xmrig-cuda.dll or libxmrig-cuda.so)" ascii //weight: 1
        $x_1_5 = "run the miner in the background" ascii //weight: 1
        $x_1_6 = "extra_nonce" ascii //weight: 1
        $x_1_7 = "pool_wallet" ascii //weight: 1
        $x_1_8 = "nvmlDeviceGetFanSpeed" ascii //weight: 1
        $x_1_9 = "nvmlDeviceGetTemperature" ascii //weight: 1
        $x_1_10 = "donate.ssl.xmrig.com" ascii //weight: 1
        $x_1_11 = "donate.v2.xmrig.com" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_XMRig_5
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:XMRig"
        threat_id = "1879048913"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "{\"id\":%lld,\"jsonrpc\":\"2.0\",\"method\":\"keepalived\",\"params\":{\"id\":\"%s\"}}" ascii //weight: 2
        $x_1_2 = "miner" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_XMRig_6
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:XMRig"
        threat_id = "1879048913"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "7"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "XMRig miner" ascii //weight: 1
        $x_1_2 = "AMDGPU" ascii //weight: 1
        $x_1_3 = "donate.ssl.xmrig.com" ascii //weight: 1
        $x_1_4 = "no active pools, stop mining" ascii //weight: 1
        $x_1_5 = "can't resume while on battery power" ascii //weight: 1
        $x_1_6 = "nvmlDeviceGetFanSpeed" ascii //weight: 1
        $x_1_7 = "pool_wallet" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_XMRig_7
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:XMRig"
        threat_id = "1879048913"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "8"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "URL of mining server" ascii //weight: 1
        $x_1_2 = "password for mining server" ascii //weight: 1
        $x_1_3 = "algorithm PoW variant" ascii //weight: 1
        $x_1_4 = "cryptonight" ascii //weight: 1
        $x_1_5 = "minergate.com" ascii //weight: 1
        $x_1_6 = "MapVirtualKeyW" ascii //weight: 1
        $x_1_7 = "Payload Too Large" ascii //weight: 1
        $x_1_8 = "SetWinEventHook" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_XMRig_8
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:XMRig"
        threat_id = "1879048913"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "25"
        strings_accuracy = "High"
    strings:
        $x_10_1 = "Usage: xmrig [OPTIONS]" ascii //weight: 10
        $x_1_2 = "cryptonight" ascii //weight: 1
        $x_2_3 = "cryptonight-lite" ascii //weight: 2
        $x_3_4 = "maximum CPU usage for automatic threadsmode" ascii //weight: 3
        $x_4_5 = "print hashrate report every N seconds" ascii //weight: 4
        $x_5_6 = "port for the miner API" ascii //weight: 5
        $x_6_7 = "enable nicehash/xmrig-proxy" ascii //weight: 6
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_10_*) and 1 of ($x_5_*) and 1 of ($x_4_*) and 1 of ($x_3_*) and 1 of ($x_2_*) and 1 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_6_*) and 1 of ($x_4_*) and 1 of ($x_3_*) and 1 of ($x_2_*))) or
            ((1 of ($x_10_*) and 1 of ($x_6_*) and 1 of ($x_5_*) and 1 of ($x_3_*) and 1 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_6_*) and 1 of ($x_5_*) and 1 of ($x_3_*) and 1 of ($x_2_*))) or
            ((1 of ($x_10_*) and 1 of ($x_6_*) and 1 of ($x_5_*) and 1 of ($x_4_*))) or
            (all of ($x*))
        )
}

rule __PUA_Block_XMRig_9
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:XMRig"
        threat_id = "1879048913"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "33"
        strings_accuracy = "High"
    strings:
        $x_10_1 = "Usage: xmrig" ascii //weight: 10
        $x_1_2 = "cryptonight-heavy" ascii //weight: 1
        $x_2_3 = "cryptonight-ultralite" ascii //weight: 2
        $x_2_4 = "xmr.pool" ascii //weight: 2
        $x_2_5 = "XMRig CPU miner" ascii //weight: 2
        $x_2_6 = "no active pools, stop mining" ascii //weight: 2
        $x_3_7 = "cryptonight-monero" ascii //weight: 3
        $x_3_8 = "minergate" ascii //weight: 3
        $x_4_9 = "cryptonight_turtle" ascii //weight: 4
        $x_5_10 = "cryptonight/gpu" ascii //weight: 5
        $x_6_11 = "stratum+tcp://" ascii //weight: 6
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_10_*) and 1 of ($x_5_*) and 1 of ($x_4_*) and 2 of ($x_3_*) and 4 of ($x_2_*))) or
            ((1 of ($x_10_*) and 1 of ($x_6_*) and 1 of ($x_4_*) and 2 of ($x_3_*) and 3 of ($x_2_*) and 1 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_6_*) and 1 of ($x_4_*) and 2 of ($x_3_*) and 4 of ($x_2_*))) or
            ((1 of ($x_10_*) and 1 of ($x_6_*) and 1 of ($x_5_*) and 1 of ($x_3_*) and 4 of ($x_2_*) and 1 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_6_*) and 1 of ($x_5_*) and 2 of ($x_3_*) and 3 of ($x_2_*))) or
            ((1 of ($x_10_*) and 1 of ($x_6_*) and 1 of ($x_5_*) and 1 of ($x_4_*) and 4 of ($x_2_*))) or
            ((1 of ($x_10_*) and 1 of ($x_6_*) and 1 of ($x_5_*) and 1 of ($x_4_*) and 1 of ($x_3_*) and 2 of ($x_2_*) and 1 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_6_*) and 1 of ($x_5_*) and 1 of ($x_4_*) and 1 of ($x_3_*) and 3 of ($x_2_*))) or
            ((1 of ($x_10_*) and 1 of ($x_6_*) and 1 of ($x_5_*) and 1 of ($x_4_*) and 2 of ($x_3_*) and 1 of ($x_2_*))) or
            (all of ($x*))
        )
}

rule __PUA_Block_XMRig_10
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:XMRig"
        threat_id = "1879048913"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "27"
        strings_accuracy = "High"
    strings:
        $x_10_1 = "Usage: xmrig [OPTIONS]" ascii //weight: 10
        $x_6_2 = "enable nicehash/xmrig-proxy" ascii //weight: 6
        $x_1_3 = "cryptonight" ascii //weight: 1
        $x_2_4 = "cryptonight-lite" ascii //weight: 2
        $x_2_5 = "cryptonight-light" ascii //weight: 2
        $x_3_6 = "maximum CPU usage for automatic threadsmode" ascii //weight: 3
        $x_4_7 = "print hashrate report every N seconds" ascii //weight: 4
        $x_5_8 = "port for the miner API" ascii //weight: 5
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_10_*) and 1 of ($x_5_*) and 1 of ($x_4_*) and 1 of ($x_3_*) and 2 of ($x_2_*) and 1 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_6_*) and 1 of ($x_4_*) and 1 of ($x_3_*) and 2 of ($x_2_*))) or
            ((1 of ($x_10_*) and 1 of ($x_6_*) and 1 of ($x_5_*) and 1 of ($x_3_*) and 1 of ($x_2_*) and 1 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_6_*) and 1 of ($x_5_*) and 1 of ($x_3_*) and 2 of ($x_2_*))) or
            ((1 of ($x_10_*) and 1 of ($x_6_*) and 1 of ($x_5_*) and 1 of ($x_4_*) and 1 of ($x_2_*))) or
            ((1 of ($x_10_*) and 1 of ($x_6_*) and 1 of ($x_5_*) and 1 of ($x_4_*) and 1 of ($x_3_*))) or
            (all of ($x*))
        )
}

rule __PUA_Block_LoadMoney_0
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:LoadMoney"
        threat_id = "1879048922"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "//binupdate.mail.ru" ascii //weight: 1
        $x_1_2 = "Software\\Mail.Ru\\Agent" wide //weight: 1
        $x_1_3 = "notoolbar" ascii //weight: 1
        $x_1_4 = "partner_online_url" ascii //weight: 1
        $x_1_5 = "exe.agent.mail.ru/sputnik/mailrusputnik.exe" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_LoadMoney_1
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:LoadMoney"
        threat_id = "1879048922"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {33 c9 8a 08 83 c1 ?? 8b 15 ?? ?? ?? ?? 03 55 ?? 88 0a eb 19 00 8b 4d ?? 83 c1 ?? 89 4d ?? 8b 55 ?? 3b 55 ?? 73 ?? a1 ?? ?? ?? ?? 03 45}  //weight: 1, accuracy: Low
        $x_1_2 = {33 c0 8a 02 83 c0 ?? 8b 0d ?? ?? ?? ?? 03 4d ?? 88 01 eb 1a 00 8b 45 ?? 83 c0 ?? 89 45 ?? 8b 4d ?? 3b 4d ?? 73 ?? 8b 15 ?? ?? ?? ?? 03 55}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (1 of ($x*))
}

rule __PUA_Block_uTorrent_BundleInstaller_0
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:uTorrent_BundleInstaller"
        threat_id = "1879048934"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "babylon" ascii //weight: 1
        $x_1_2 = "d2z095vexbtfvi" ascii //weight: 1
        $x_2_3 = "intellidownload" ascii //weight: 2
        $x_2_4 = "videofiledownload" ascii //weight: 2
        $x_1_5 = "StartSearcher" ascii //weight: 1
        $x_1_6 = "TorrentSearch" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_2_*) and 4 of ($x_1_*))) or
            ((2 of ($x_2_*) and 2 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule __PUA_Block_MediaDrug_0
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:MediaDrug"
        threat_id = "1879048940"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "dj-updates.com" ascii //weight: 2
        $x_1_2 = "dl-config-vkdj.txt" ascii //weight: 1
        $x_1_3 = "deksbvoubzsetup.ini" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_VrBrothers_0
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:VrBrothers"
        threat_id = "1879048947"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "MyMacro\\Runner.exe" ascii //weight: 1
        $x_1_2 = "updatemacro.exe" ascii //weight: 1
        $x_1_3 = "vrbrothers.ad" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_VrBrothers_1
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:VrBrothers"
        threat_id = "1879048947"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "soft.anjian.com" ascii //weight: 2
        $x_1_2 = "AnJianBindingInstallPC.html" ascii //weight: 1
        $x_1_3 = "uservar.ini" ascii //weight: 1
        $x_1_4 = "binding.exe" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_VrBrothers_2
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:VrBrothers"
        threat_id = "1879048947"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "7"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "mmcount.aspx" ascii //weight: 1
        $x_1_2 = "CreatePopupMenu" ascii //weight: 1
        $x_1_3 = "vrbrothers" ascii //weight: 1
        $x_1_4 = "bro_ads" ascii //weight: 1
        $x_1_5 = "zy.anjian.com" ascii //weight: 1
        $x_1_6 = "Software\\Brothers\\Server" ascii //weight: 1
        $x_1_7 = "ad.vrbrothers.com/qmacro/v9/ad-mymacro.xml" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_VrBrothers_3
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:VrBrothers"
        threat_id = "1879048947"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "7"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "bro_ads" ascii //weight: 1
        $x_1_2 = "downloadurl" ascii //weight: 1
        $x_1_3 = "ad.vrbrothers.com" ascii //weight: 1
        $x_1_4 = "down.vrbrothers.com" ascii //weight: 1
        $x_1_5 = "ad-mymacro.xml" ascii //weight: 1
        $x_1_6 = "/vrb/chkolv10.aspx" ascii //weight: 1
        $x_1_7 = "hi.vrbrothers.com/xjl/mmcount.aspx" ascii //weight: 1
        $n_100_8 = "Uninst.exe" ascii //weight: -100
        $n_100_9 = "Uninstall.exe" ascii //weight: -100
    condition:
        (filesize < 20MB) and
        (not (any of ($n*))) and
        (all of ($x*))
}

rule __PUA_Block_VrBrothers_4
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:VrBrothers"
        threat_id = "1879048947"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "soft.anjian.com/Interface/BindingPC/BindingUsing.aspx" ascii //weight: 2
        $x_2_2 = "soft.anjian.com/Include/BuildPage/ExitAdXJL.shtml" ascii //weight: 2
        $x_1_3 = "down.vrbrothers.com" ascii //weight: 1
        $x_1_4 = "ad.vrbrothers.com" ascii //weight: 1
        $x_1_5 = "hhctrl.ocx" ascii //weight: 1
        $x_1_6 = "bro_ads" ascii //weight: 1
        $x_1_7 = "Addon_soft_anjian_fo1r_addONInfo" ascii //weight: 1
        $n_100_8 = "Uninst.exe" ascii //weight: -100
        $n_100_9 = "Uninstaller.exe" ascii //weight: -100
        $n_100_10 = "Uninstal.exe" ascii //weight: -100
    condition:
        (filesize < 20MB) and
        (not (any of ($n*))) and
        (
            ((1 of ($x_2_*) and 4 of ($x_1_*))) or
            ((2 of ($x_2_*) and 2 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule __PUA_Block_Kuping_0
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:Kuping"
        threat_id = "1879048961"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = "DesktopBackground\\Shell\\Kuping\\Command" ascii //weight: 1
        $x_1_2 = {5c 6b 75 70 69 6e 67 5f 76 [0-2] 2e 65 78 65 2c 25 64}  //weight: 1, accuracy: Low
        $x_1_3 = "%s\\KpInstallTheme.exe" ascii //weight: 1
        $x_1_4 = "huayukejikuping" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_Kuping_1
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:Kuping"
        threat_id = "1879048961"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = "KPToolBarSilence.exe" ascii //weight: 1
        $x_1_2 = "UniversalMini.exe" ascii //weight: 1
        $x_1_3 = "KP4Mini.exe" ascii //weight: 1
        $x_1_4 = {68 74 74 70 3a 2f 2f [0-15] 2e 6b 75 70 69 6e 67 2e 63 63 2f}  //weight: 1, accuracy: Low
        $x_1_5 = "kplink.exe" ascii //weight: 1
        $n_10_6 = "config.0551fs.com/Public/Configs/uninstall_begin.html" ascii //weight: -10
        $n_10_7 = "config.0551fs.com/Public/Configs/uninstall_end.html" ascii //weight: -10
    condition:
        (filesize < 20MB) and
        (not (any of ($n*))) and
        (4 of ($x*))
}

rule __PUA_Block_CrawlerToolbar_0
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:CrawlerToolbar"
        threat_id = "1879048965"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "www.24x7help.org" ascii //weight: 2
        $x_1_2 = "www.websearch.com" ascii //weight: 1
        $x_1_3 = "dnl.appgraffiti.com" ascii //weight: 1
        $x_1_4 = "WebSearch.exe" ascii //weight: 1
        $x_1_5 = "Toolbar" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_CrawlerToolbar_1
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:CrawlerToolbar"
        threat_id = "1879048965"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "dnl.appgraffiti.com" ascii //weight: 2
        $x_1_2 = "AppGraffitiSetup.exe" ascii //weight: 1
        $x_1_3 = "download.rebateblast.com" ascii //weight: 1
        $x_1_4 = "RebateInformerSetup.exe" ascii //weight: 1
        $x_1_5 = "TRIAL OFFERS" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_VkDJ_BundleInstaller_0
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:VkDJ_BundleInstaller"
        threat_id = "1879048983"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "CHECKAUTOSTARTVKDJ_XP" ascii //weight: 1
        $x_1_2 = "ONYANDEXACTIVATE" ascii //weight: 1
        $x_1_3 = "V-K_D-J.exe" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_VkDJ_BundleInstaller_1
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:VkDJ_BundleInstaller"
        threat_id = "1879048983"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "7"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "DjLoader.exe" ascii //weight: 1
        $x_1_2 = "Vkontakte DJ Installer" ascii //weight: 1
        $x_1_3 = "YABROWSER" ascii //weight: 1
        $x_1_4 = "yandex.ru" ascii //weight: 1
        $x_1_5 = "soft.yandex.ru/distribution/" ascii //weight: 1
        $x_1_6 = "client.config/?app=vk_downloader&format=xml" ascii //weight: 1
        $x_1_7 = "dlg_yandex_setup_bg" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_DownloadAdmin_0
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:DownloadAdmin"
        threat_id = "1879048985"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = ".build/shared_library.dll]]" ascii //weight: 1
        $x_1_2 = "res/knockout.js]]" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_DownloadAdmin_1
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:DownloadAdmin"
        threat_id = "1879048985"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "lua-users.org" ascii //weight: 2
        $x_1_2 = "startIntegratedOffer" ascii //weight: 1
        $x_1_3 = "UACInfo.pdb" ascii //weight: 1
        $x_1_4 = "profiles.ini" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_YTDVideoDownload_0
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:YTDVideoDownload"
        threat_id = "1879048989"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Resources\\OfferPage.html" ascii //weight: 1
        $x_1_2 = "BundleConfig" ascii //weight: 1
        $x_1_3 = "OfferServiceBLL.dll" ascii //weight: 1
        $x_1_4 = "Free YouTube Downloader" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_YTDVideoDownload_1
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:YTDVideoDownload"
        threat_id = "1879048989"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Easy installation, automatically opt out from additional offers" ascii //weight: 1
        $x_1_2 = "CMFCPopupMenuBar" ascii //weight: 1
        $x_1_3 = "YoutubeDownloader" ascii //weight: 1
        $x_1_4 = "ToolbarWindow32" ascii //weight: 1
        $x_1_5 = "TOOLBAR_RESETTOOLBAR" ascii //weight: 1
        $n_100_6 = "Uninst.exe" ascii //weight: -100
        $n_100_7 = "Uninstall.exe" ascii //weight: -100
    condition:
        (filesize < 20MB) and
        (not (any of ($n*))) and
        (all of ($x*))
}

rule __PUA_Block_YTDVideoDownload_2
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:YTDVideoDownload"
        threat_id = "1879048989"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Easy installation, automatically opt out from additional offers" ascii //weight: 1
        $x_1_2 = "BCGTOOLBAR_POPUPMENU" ascii //weight: 1
        $x_1_3 = "BCGTOOLBAR_RESETTOOLBAR" ascii //weight: 1
        $x_1_4 = "Youtube Music Downloader" ascii //weight: 1
        $x_1_5 = "YouTubeDownloader" ascii //weight: 1
        $n_100_6 = "Uninst.exe" ascii //weight: -100
        $n_100_7 = "Uninstall.exe" ascii //weight: -100
    condition:
        (filesize < 20MB) and
        (not (any of ($n*))) and
        (all of ($x*))
}

rule __PUA_Block_SweetIM_0
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:SweetIM"
        threat_id = "1879049005"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "WinRAR Installer by SweetPacks" ascii //weight: 1
        $x_1_2 = "SweetIM Technologies Ltd" ascii //weight: 1
        $x_1_3 = "SweetSDM" ascii //weight: 1
        $x_1_4 = "Make SweetPacks my default search engine" ascii //weight: 1
        $n_100_5 = "Uninst.exe" ascii //weight: -100
        $n_100_6 = "Uninstall.exe" ascii //weight: -100
    condition:
        (filesize < 20MB) and
        (not (any of ($n*))) and
        (all of ($x*))
}

rule __PUA_Block_SweetIM_1
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:SweetIM"
        threat_id = "1879049005"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "PDFConverter.exe" ascii //weight: 1
        $x_1_2 = "PDFConverterInstaller.exe" ascii //weight: 1
        $x_1_3 = "babylon-offer-buttons" ascii //weight: 1
        $x_1_4 = "babylon-skip-button" ascii //weight: 1
        $x_1_5 = "FoxTab PDF Converter" ascii //weight: 1
        $x_1_6 = "offer_html.txt" ascii //weight: 1
        $n_100_7 = "Uninst.exe" ascii //weight: -100
        $n_100_8 = "Uninstall.exe" ascii //weight: -100
    condition:
        (filesize < 20MB) and
        (not (any of ($n*))) and
        (all of ($x*))
}

rule __PUA_Block_Catalina_0
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:Catalina"
        threat_id = "1879049010"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "appguid={92F8A219-E740-49D5-B785-B962AD819724}&installerargs=--make-chrome-default" wide //weight: 1
        $x_1_2 = "CatalinaGroup Update" wide //weight: 1
        $x_1_3 = "Software\\CatalinaGroup\\Update\\Clients\\{6C598730-F715-407B-A7AE-A8F10D0F8FA7}" wide //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_Catalina_1
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:Catalina"
        threat_id = "1879049010"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "3"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {61 00 70 00 70 00 67 00 75 00 69 00 64 00 3d 00 7b 00 [0-144] 7d 00 26 00 69 00 6e 00 73 00 74 00 61 00 6c 00 6c 00 65 00 72 00 61 00 72 00 67 00 73 00 3d 00 2d 00 2d 00 6d 00 61 00 6b 00 65 00 2d 00 63 00 68 00 72 00 6f 00 6d 00 65 00 2d 00 64 00 65 00 66 00 61 00 75 00 6c 00 54 00}  //weight: 1, accuracy: Low
        $x_1_2 = {61 70 70 67 75 69 64 3d 7b [0-144] 7d 26 69 6e 73 74 61 6c 6c 65 72 61 72 67 73 3d 2d 2d 6d 61 6b 65 2d 63 68 72 6f 6d 65 2d 64 65 66 61 75 6c 54}  //weight: 1, accuracy: Low
        $x_1_3 = "CatalinaGroup Update" ascii //weight: 1
        $x_1_4 = {53 00 6f 00 66 00 74 00 77 00 61 00 72 00 65 00 5c 00 43 00 61 00 74 00 61 00 6c 00 69 00 6e 00 61 00 47 00 72 00 6f 00 75 00 70 00 5c 00 55 00 70 00 64 00 61 00 74 00 65 00 5c 00 43 00 6c 00 69 00 65 00 6e 00 74 00 73 00 5c 00 7b 00 [0-144] 7d 00}  //weight: 1, accuracy: Low
        $x_1_5 = {53 6f 66 74 77 61 72 65 5c 43 61 74 61 6c 69 6e 61 47 72 6f 75 70 5c 55 70 64 61 74 65 5c 43 6c 69 65 6e 74 73 5c 7b [0-144] 7d}  //weight: 1, accuracy: Low
        $x_1_6 = "CatalinaUpdate_unsigned.pdb" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (3 of ($x*))
}

rule __PUA_Block_Downer_0
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:Downer"
        threat_id = "1879049013"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "downloader.aldtop.com" ascii //weight: 2
        $x_1_2 = "BCloseMsg.xml" ascii //weight: 1
        $x_1_3 = "UIDowner" ascii //weight: 1
        $x_1_4 = "UIDownloader\\bin\\Release\\UIDownloader.pdb" ascii //weight: 1
        $x_1_5 = "downerapi.com" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((3 of ($x_1_*))) or
            ((1 of ($x_2_*) and 1 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule __PUA_Block_Downer_1
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:Downer"
        threat_id = "1879049013"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "UIDownloader\\bin\\Release\\setup_1_237148.pdb" ascii //weight: 1
        $x_1_2 = "downloader.regeeve.com/client/debug" ascii //weight: 1
        $x_1_3 = "api.nasyeo.com/log/close" ascii //weight: 1
        $x_1_4 = "flmgr.net/win_fl_agreement.html" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_Downer_2
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:Downer"
        threat_id = "1879049013"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "3"
        strings_accuracy = "Low"
    strings:
        $x_2_1 = {68 00 74 00 74 00 70 00 [0-31] 2e 00 64 00 6f 00 77 00 6e 00 65 00 72 00 61 00 70 00 69 00 2e 00 63 00 6f 00 6d 00 2f 00 63 00 6c 00 69 00 65 00 6e 00 74 00 2f 00 64 00 65 00 62 00 75 00 67 00}  //weight: 2, accuracy: Low
        $x_2_2 = {68 74 74 70 [0-31] 2e 64 6f 77 6e 65 72 61 70 69 2e 63 6f 6d 2f 63 6c 69 65 6e 74 2f 64 65 62 75 67}  //weight: 2, accuracy: Low
        $x_2_3 = {68 00 74 00 74 00 70 00 [0-31] 2e 00 73 00 75 00 70 00 65 00 72 00 72 00 6c 00 2e 00 63 00 6e 00 2f 00 [0-15] 2e 00 68 00 74 00 6d 00 6c 00}  //weight: 2, accuracy: Low
        $x_2_4 = {68 74 74 70 [0-31] 2e 73 75 70 65 72 72 6c 2e 63 6e 2f [0-15] 2e 68 74 6d 6c}  //weight: 2, accuracy: Low
        $x_1_5 = "BCloseMsg.xml" ascii //weight: 1
        $x_1_6 = "WSoftware\\Classes\\" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_2_*) and 1 of ($x_1_*))) or
            ((2 of ($x_2_*))) or
            (all of ($x*))
        )
}

rule __PUA_Block_RDPWrap_0
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:RDPWrap"
        threat_id = "1879049016"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "RDPWInst.exe [-l|-i[-s]|-w|-u|-r]" ascii //weight: 1
        $x_1_2 = "rdpwrap.ini" ascii //weight: 1
        $x_1_3 = "RDP Wrapper Library" ascii //weight: 1
        $x_1_4 = "RDP Wrapper Update" ascii //weight: 1
        $x_1_5 = "%ProgramFiles%\\RDP Wrapper" ascii //weight: 1
        $x_1_6 = "RDPWInst.exe [-l|-i[-s][-o]|-w|-u[-k]|-r]" ascii //weight: 1
        $x_1_7 = "%SystemRoot%\\system32\\rdp" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (4 of ($x*))
}

rule __PUA_Block_FRProxy_0
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:FRProxy"
        threat_id = "1879049018"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {66 00 72 00 70 00 2f 00 63 00 6d 00 64 00 2f 00 66 00 72 00 70 00 63 00 2f 00 [0-4] 2e 00 73 00 74 00 61 00 72 00 74 00 53 00 65 00 72 00 76 00 69 00 63 00 65 00}  //weight: 1, accuracy: Low
        $x_1_2 = {66 72 70 2f 63 6d 64 2f 66 72 70 63 2f [0-4] 2e 73 74 61 72 74 53 65 72 76 69 63 65}  //weight: 1, accuracy: Low
        $x_1_3 = "ProxyProtocolVersion" ascii //weight: 1
        $x_1_4 = "AuthenticateNewWorkConns" ascii //weight: 1
        $x_1_5 = "MaxPortsPerClient" ascii //weight: 1
        $x_1_6 = {69 00 70 00 6c 00 6f 00 63 00 61 00 6c 00 5f 00 [0-15] 5f 00 66 00 69 00 6c 00 65 00 6c 00 6f 00 6f 00 70 00 62 00 61 00 63 00 6b 00 6e 00 6f 00}  //weight: 1, accuracy: Low
        $x_1_7 = {69 70 6c 6f 63 61 6c 5f [0-15] 5f 66 69 6c 65 6c 6f 6f 70 62 61 63 6b 6e 6f}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (5 of ($x*))
}

rule __PUA_Block_Playanext_0
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:Playanext"
        threat_id = "1879049050"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "PlayaNextOfferView.cpp" ascii //weight: 2
        $x_1_2 = "playa-next-offer" ascii //weight: 1
        $x_1_3 = "optionaloffer" ascii //weight: 1
        $x_1_4 = "PDF_Suite" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_2_*) and 2 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule __PUA_Block_Playanext_1
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:Playanext"
        threat_id = "1879049050"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "upclick.com" ascii //weight: 2
        $x_1_2 = "PlayaSDK LoadOffers" ascii //weight: 1
        $x_1_3 = "playa-next-offer.htm" ascii //weight: 1
        $x_1_4 = "pdfarchitect" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_2_*) and 2 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule __PUA_Block_Playanext_2
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:Playanext"
        threat_id = "1879049050"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "PlayaNext" ascii //weight: 2
        $x_1_2 = "PDFSuite2021Installer.pdb" ascii //weight: 1
        $x_1_3 = "optional-offer-consent" ascii //weight: 1
        $x_1_4 = "optionaloffer" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_Playanext_3
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:Playanext"
        threat_id = "1879049050"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "PlayaSDK.dll" ascii //weight: 1
        $x_1_2 = "PlayaPartnerId" ascii //weight: 1
        $x_1_3 = "PlayaSDK call PresentOffer" ascii //weight: 1
        $x_1_4 = "PlayaSDK call AcceptOffer" ascii //weight: 1
        $x_1_5 = "optionaloffer" ascii //weight: 1
        $n_100_6 = "Uninst.exe" ascii //weight: -100
        $n_100_7 = "Uninstaller.exe" ascii //weight: -100
        $n_100_8 = "Uninstal.exe" ascii //weight: -100
    condition:
        (filesize < 20MB) and
        (not (any of ($n*))) and
        (all of ($x*))
}

rule __PUA_Block_DownloadGuide_0
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:DownloadGuide"
        threat_id = "1879049053"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "3"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {30 2b 06 03 55 04 0a 0c ?? 53 65 63 75 72 65 20 31 30 30 30 20 55 47 20 28 68 61 66 74 75 6e 67 73 62 65 73 63 68 72 c3 a4 6e 6b 74 29 31 2d 30}  //weight: 1, accuracy: Low
        $x_1_2 = {9a 00 3d 00 01 00 43 00 6f 00 6d 00 70 00 61 00 6e 00 79 00 4e 00 61 00 6d 00 65 00 00 00 00 00 20 00 20 00 20 00 20 00}  //weight: 1, accuracy: High
        $x_1_3 = {65 00 73 00 63 00 72 00 69 00 70 00 74 00 69 00 6f 00 6e 00 00 00 00 00 53 00 6f 00 66 00 74 00 77 00 61 00 72 00 65 00 20 00 53 00 65 00 74 00 75 00 70 00 20}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_DownloadGuide_1
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:DownloadGuide"
        threat_id = "1879049053"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "software-campaign-resources-cpp.s3.amazonaws.com/test/DownloadGuide2MTagged.exe" ascii //weight: 1
        $x_1_2 = "dlg-messages.buzzrin.de" ascii //weight: 1
        $x_1_3 = "page for hidden offers" ascii //weight: 1
        $x_1_4 = "downloadAndInstallOffers" ascii //weight: 1
        $x_1_5 = "accept or drop offer" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_MediaGet_0
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:MediaGet"
        threat_id = "1879049070"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "C:\\TEMP\\mediaget-installer-tmp" ascii //weight: 1
        $x_1_2 = "mediaget.com" ascii //weight: 1
        $x_1_3 = "bundle-avast.html" ascii //weight: 1
        $x_1_4 = "bundle-safefinder-en.html" ascii //weight: 1
        $x_1_5 = "opera_installCheck" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (4 of ($x*))
}

rule __PUA_Block_MediaGet_1
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:MediaGet"
        threat_id = "1879049070"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "\\yaoffer50160\\yaoffer50160.exe" ascii //weight: 2
        $x_1_2 = "offer_size" ascii //weight: 1
        $x_1_3 = "mediaget.com" ascii //weight: 1
        $x_1_4 = "luminati_net_updater_win_mediaget_com" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_MediaGet_2
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:MediaGet"
        threat_id = "1879049070"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "13"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "offer_size" ascii //weight: 1
        $x_1_2 = "conflicting_bundles" ascii //weight: 1
        $x_1_3 = "\\yaoffer50160\\yaoffer50160.exe" ascii //weight: 1
        $x_1_4 = "Software\\Opera Software" ascii //weight: 1
        $x_10_5 = "mediaget.exe" ascii //weight: 10
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_10_*) and 3 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule __PUA_Block_MediaGet_3
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:MediaGet"
        threat_id = "1879049070"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "C:\\mediaget\\mediaget-sources-release\\release\\mediaget.pdb" ascii //weight: 2
        $x_1_2 = "mediaget.exe" ascii //weight: 1
        $x_1_3 = "tvshows" ascii //weight: 1
        $x_1_4 = "libvlc_media_player_stop" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_2_*) and 2 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule __PUA_Block_MediaGet_4
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:MediaGet"
        threat_id = "1879049070"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "conflicting_bundles" ascii //weight: 1
        $x_1_2 = "\\yaoffer50160\\yaoffer50160.exe" ascii //weight: 1
        $x_1_3 = "Software\\Opera Software" ascii //weight: 1
        $x_1_4 = "mediaget.exe" ascii //weight: 1
        $x_1_5 = "bundle.exe" ascii //weight: 1
        $x_1_6 = "YandexPackSetup.exe" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_MediaGet_5
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:MediaGet"
        threat_id = "1879049070"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "10"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "bundles" ascii //weight: 1
        $x_1_2 = "yaoffer" ascii //weight: 1
        $x_1_3 = "Opera" ascii //weight: 1
        $x_1_4 = "yandex" ascii //weight: 1
        $x_1_5 = "avast" ascii //weight: 1
        $x_1_6 = "offer_size" ascii //weight: 1
        $x_1_7 = "bundlesInstallingNow" ascii //weight: 1
        $x_1_8 = "MediaGet" ascii //weight: 1
        $x_1_9 = "mediaget-admin-proxy.exe" ascii //weight: 1
        $x_1_10 = "mediaget.com" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_MediaGet_6
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:MediaGet"
        threat_id = "1879049070"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "8"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "offer_size" ascii //weight: 1
        $x_1_2 = "no_offer" ascii //weight: 1
        $x_1_3 = "yaoffer," ascii //weight: 1
        $x_1_4 = "MediaGet installer" ascii //weight: 1
        $x_1_5 = "mediaget.exe" ascii //weight: 1
        $x_1_6 = "yaoffer" ascii //weight: 1
        $x_1_7 = "MediaGet2.exe" ascii //weight: 1
        $x_1_8 = "MediaGet" ascii //weight: 1
        $n_100_9 = "Uninst.exe" ascii //weight: -100
        $n_100_10 = "Uninstall.exe" ascii //weight: -100
    condition:
        (filesize < 20MB) and
        (not (any of ($n*))) and
        (all of ($x*))
}

rule __PUA_Block_MediaGet_7
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:MediaGet"
        threat_id = "1879049070"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_3_1 = "mediaget-installer-2/bundles/bundle.php?b=yandex" ascii //weight: 3
        $x_2_2 = "Software\\Mediaget" ascii //weight: 2
        $x_1_3 = "\\Opera\\Opera\\" ascii //weight: 1
        $x_1_4 = "profile\\opera6.ini" ascii //weight: 1
        $x_1_5 = "YANDEX_HTML" ascii //weight: 1
        $x_2_6 = "--bundle-installed__" ascii //weight: 2
        $n_100_7 = "WnUninst.exe" ascii //weight: -100
        $n_100_8 = "Uninst.exe" ascii //weight: -100
        $n_100_9 = "Uninstall.exe" ascii //weight: -100
    condition:
        (filesize < 20MB) and
        (not (any of ($n*))) and
        (
            ((2 of ($x_2_*) and 2 of ($x_1_*))) or
            ((1 of ($x_3_*) and 3 of ($x_1_*))) or
            ((1 of ($x_3_*) and 1 of ($x_2_*) and 1 of ($x_1_*))) or
            ((1 of ($x_3_*) and 2 of ($x_2_*))) or
            (all of ($x*))
        )
}

rule __PUA_Block_CrossRider_0
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:CrossRider"
        threat_id = "1879049071"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "Global\\myappLogMutex" ascii //weight: 2
        $x_2_2 = "CrossriderBackground" ascii //weight: 2
        $x_2_3 = "AVCCrossRiderLogUser" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_CrossRider_1
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:CrossRider"
        threat_id = "1879049071"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "Global\\myselfLogMutex" ascii //weight: 2
        $x_1_2 = "CrossriderApp" ascii //weight: 1
        $x_1_3 = ".?AVCCrossRiderLogUser@@" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_2_*) and 1 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule __PUA_Block_CrossRider_2
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:CrossRider"
        threat_id = "1879049071"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "Global\\myappLogMutex" ascii //weight: 2
        $x_1_2 = "AddCrossRiderSearchProvider" ascii //weight: 1
        $x_1_3 = "AVCCrossRiderLogger" ascii //weight: 1
        $x_1_4 = "Crossrider" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((3 of ($x_1_*))) or
            ((1 of ($x_2_*) and 1 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule __PUA_Block_InstallMate_0
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:InstallMate"
        threat_id = "1879049094"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "www.installmate.com" ascii //weight: 2
        $x_1_2 = "TinDel.pdb" ascii //weight: 1
        $x_1_3 = "scheduler.ini" ascii //weight: 1
        $x_1_4 = "SkipOffer" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_rescan_0
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "uFrmTB_Lollipop" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_rescan_1
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "mimikatz" wide //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_rescan_2
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {5c 53 6d 61 72 74 43 70 78 4c 69 74 65 2e 70 64 62 00}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_rescan_3
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "dll.polymorphed.dll" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_rescan_4
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "masterhackermasterhak" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_rescan_5
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {8a 04 01 3c 2b 74 25 3c 2f 74 1a 3c 3d 74 0f 3c 7e 74 04 88 07}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_rescan_6
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Max(raj) from Holiday_2" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_rescan_7
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {50 53 54 65 78 74 2e 44 4c 4c 00 44 6c 6c 43 61 6e 55 6e 6c 6f 61 64 4e 6f 77}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_rescan_8
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "d1o2o3h4k5t6t7m8c9u0p1k2i3u4t" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_rescan_9
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "2"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "WinZip 2011" ascii //weight: 1
        $x_1_2 = "RUSSIAN_CHARSET" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_rescan_10
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "2"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "user add <priv>" ascii //weight: 1
        $x_1_2 = "ZXSockProxy" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_rescan_11
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {c7 04 24 2f 00 00 00 ff 04 24 ff 04 24 58 05 0b 00 00 00 ff 34 07 58 03 c7 6a 1e 5e 83 ee 02}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_rescan_12
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {b9 08 00 00 00 33 c0 8d 7c 24 1c f3 ab ff d6 99 b9 06 00 00 00 f7 f9 03 d1 52 8d 54 24 20 52 e8}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_rescan_13
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "rundll32.exe \"%s\",TStartUp 0x22 %s" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_rescan_14
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "wsservice_crk.dll" wide //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_rescan_15
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "2"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "AVGIDSAgent.exe" ascii //weight: 1
        $x_1_2 = "AVGIDSMonitor.exe" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_rescan_16
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "4E8D9EBF-122C-42BD-A8CB-7E59C9CC08BA" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_rescan_17
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "2"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "TSCANINGFRAME" ascii //weight: 1
        $x_1_2 = "TPROCESSMANAGERFRAME" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_rescan_18
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "ServiceMain" ascii //weight: 1
        $x_1_2 = "WnNetEntry" ascii //weight: 1
        $x_1_3 = "mstationsrv.dll" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_rescan_19
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "/sync/pay/?ajax=1&go=auth&password=%s&crypt=" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_rescan_20
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "2"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {51 57 50 72 6f 74 65 63 74 2e 44 4c 4c 00 44 6c 6c 43 61 6e 55 6e 6c 6f 61 64 4e 6f 77}  //weight: 1, accuracy: High
        $x_1_2 = "QWProtectBHO" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_rescan_21
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {07 00 00 00 75 00 6e 00 70 00 5f 00 70 00 61 00 6d}  //weight: 1, accuracy: High
        $x_1_2 = {0d 00 00 00 66 00 63 00 5f 00 6d 00 6f 00 64 00 75 00 6c 00 65 00 5f 00 73 00 66 00 78}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (1 of ($x*))
}

rule __do_exhaustivehstr_rescan_22
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "c:\\users\\Public\\MicTray.log" wide //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_rescan_23
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "2"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "\\svcvmx" ascii //weight: 1
        $x_1_2 = "SVCVMX{72CE8DB0-6EB6-4C24-92E8-A07B77A229F8}" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_rescan_24
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_2_1 = {53 45 4c 45 43 54 5f 52 45 53 45 52 56 5f 53 52 56 5f 25 64 00}  //weight: 2, accuracy: High
        $x_1_2 = {73 74 6f 72 2e 63 66 67 00}  //weight: 1, accuracy: High
        $x_1_3 = {65 78 65 63 25 73 00}  //weight: 1, accuracy: High
        $x_1_4 = {68 74 74 70 3a 2f 2f 25 64 2e 63 74 72 6c 2e 25 73 00}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (
            ((3 of ($x_1_*))) or
            ((1 of ($x_2_*) and 1 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule __do_exhaustivehstr_rescan_25
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = ".thumbs.db" wide //weight: 1
        $x_1_2 = "target.lnk" wide //weight: 1
        $x_1_3 = "desktop.ini" wide //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_rescan_26
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Release\\arc_2010.pdb" ascii //weight: 1
        $x_1_2 = "Release\\new_arc.pdb" ascii //weight: 1
        $x_1_3 = "Release\\arc_2005.pdb" ascii //weight: 1
        $x_1_4 = "CPaymentForm" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (1 of ($x*))
}

rule __do_exhaustivehstr_rescan_27
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "20"
        strings_accuracy = "High"
    strings:
        $x_10_1 = "\\project\\Azure_GUI\\Debug\\Azure_GUI.pdb" ascii //weight: 10
        $x_10_2 = "hellohellohellohello" ascii //weight: 10
        $x_10_3 = "gfdertfghjkuyrtg" ascii //weight: 10
    condition:
        (filesize < 20MB) and
        (2 of ($x*))
}

rule __do_exhaustivehstr_rescan_28
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "2"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "shell setup information:" ascii //weight: 1
        $x_1_2 = "uptime: %-.2d days %-.2d hours %-.2d minutes %-.2d seconds" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_rescan_29
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "2"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {50 00 43 00 20 00 44 00 65 00 66 00 65 00 6e 00 64 00 65 00 72 00 00 00}  //weight: 1, accuracy: High
        $x_1_2 = {4e 00 6f 00 45 00 6e 00 74 00 69 00 72 00 65 00 4e 00 65 00 74 00 77 00 6f 00 72 00 6b 00 00 00}  //weight: 1, accuracy: High
        $x_1_3 = {70 00 72 00 6f 00 63 00 6b 00 69 00 6c 00 6c 00 36 00 34 00 2e 00 65 00 78 00 65 00 00 00}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (2 of ($x*))
}

rule __do_exhaustivehstr_rescan_30
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "x64.zip" ascii //weight: 1
        $x_1_2 = "x32.zip" ascii //weight: 1
        $x_1_3 = ",admin=" ascii //weight: 1
        $x_1_4 = ",guid=" ascii //weight: 1
        $x_1_5 = "\\Bypass" wide //weight: 1
        $x_1_6 = "\\guid.log" wide //weight: 1
        $x_1_7 = "ct.zip" ascii //weight: 1
        $x_1_8 = "ct.exe" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (4 of ($x*))
}

rule __do_exhaustivehstr_rescan_31
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {4d 69 63 72 6f 73 6f 66 74 20 4f 66 66 69 63 65 00 00 00 00 45 72 72 6f 20 61 6f 20 61 62 72 69 72 20 6f 20 61 72 71 75 69 76 6f 2c 6f 75 20 6f}  //weight: 1, accuracy: High
        $x_1_2 = {4d 69 63 72 6f 73 6f 66 74 20 4f 66 66 69 63 65 00 00 00 00 46 61 6c 68 61 20 61 6f 20 61 62 72 69 72 20 6f 20 61 72 71 75 69 76 6f 20 6f 75 20 6f}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (1 of ($x*))
}

rule __do_exhaustivehstr_rescan_32
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Banco Santander Brasil | Banco do juntos - Mozilla Firefox" wide //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_rescan_33
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {44 00 4c 00 4c 00 00 00 00 00 00 00 00 00 4d 5a}  //weight: 1, accuracy: High
        $x_1_2 = {53 50 4f 52 44 45 52 2e 64 6c 6c 00 57 53 43 57 72 69 74 65 4e 61 6d 65 53 70 61 63 65 4f 72 64 65 72 00 57 53 43 57 72 69 74 65 50 72 6f 76 69 64 65 72 4f 72 64 65 72 00}  //weight: 1, accuracy: High
        $x_1_3 = "Current_NameSpace_Catalog" ascii //weight: 1
        $x_1_4 = "sporder.pdb" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_rescan_34
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "2"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Windows Defender\\Real-Time Protection" wide //weight: 1
        $x_1_2 = "Notification_Suppress" wide //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_rescan_35
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {ba 94 17 40 00 8b c7 e8 13 31 00 00 8b d0 8b 06 e8 e6 31 00 00}  //weight: 1, accuracy: High
        $x_1_2 = {a3 ac 25 41 00 ba a0 17 40 00 8b c7 e8 f9 30 00 00 8b d0 8b 06 e8 cc 31 00 00}  //weight: 1, accuracy: High
        $x_1_3 = {a3 b0 25 41 00 ba ac 17 40 00 8b c7 e8 df 30 00 00 8b d0 8b 06 e8 b2 31 00 00}  //weight: 1, accuracy: High
        $x_1_4 = {a3 b4 25 41 00 ba b8 17 40 00 8b c7 e8 c5 30 00 00 8b d0 8b 06 e8 98 31 00 00 a3 b8 25 41 00 ba c4 17 40 00 8b c7}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (3 of ($x*))
}

rule __do_exhaustivehstr_rescan_36
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Advanced\\" wide //weight: 1
        $x_1_2 = "ShowSuperHidden" wide //weight: 1
        $x_1_3 = "SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\\" wide //weight: 1
        $x_1_4 = ".vbp" wide //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_rescan_37
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "15"
        strings_accuracy = "High"
    strings:
        $x_5_1 = "login=%s&password=%s" wide //weight: 5
        $x_5_2 = "&consent_accept=Grant+access+to+Box&request_token=%s" wide //weight: 5
        $x_5_3 = "login_submit=Authorizing...&dologin=1&client_id=%s" wide //weight: 5
        $x_5_4 = "box_visitor_id=%s; bv=%s; cn=%s;" wide //weight: 5
    condition:
        (filesize < 20MB) and
        (3 of ($x*))
}

rule __do_exhaustivehstr_rescan_38
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Local\\{E3893ABF-53E0-4228-9A27-1C69FB1D67C2}" wide //weight: 1
        $x_1_2 = "Local\\{1BF90DA7-B424-43bf-AEBA-ACE442A4D429}" wide //weight: 1
        $x_1_3 = "Local\\{8761A525-8891-4f1b-85AF-2BC5EB12238A}" wide //weight: 1
        $x_1_4 = "Local\\{0AB1FAA8-7B11-4291-BCCD-6669E8DD17F6}" wide //weight: 1
    condition:
        (filesize < 20MB) and
        (1 of ($x*))
}

rule __do_exhaustivehstr_rescan_39
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "MecaNet" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_rescan_40
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "RBNLDrv" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_rescan_41
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {4d 4e 4f 45 50 00 32 00 00}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_rescan_42
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "NSPStartup" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_rescan_43
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {40 67 5b 6f 4f 4e 5b 3f 75 21 00}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_rescan_44
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "\\WinBudget\\" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_rescan_45
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {00 45 4d 53 46 52 54 43 42 56 44 00}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_rescan_46
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {00 73 6e 41 67 65 6e 74 2e 64 6c 6c}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_rescan_47
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "IAOLToolBand" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_rescan_48
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {1b 4d f4 6a 08 68 00 68 c4 61 51 50 e8}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_rescan_49
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {80 f9 41 7c 0d 80 f9 4d 7f 08 0f be c9}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_rescan_50
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {85 db 74 0a 8a 06 32 c2 88 06 46 4b eb f2}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_rescan_51
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {81 3e b3 15 cf a1 74 0b 4a 4e 83 fa 04 77 f1}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_rescan_52
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "10"
        strings_accuracy = "High"
    strings:
        $x_10_1 = {0f 45 f8 08 da 89 fb 83 f9 09 0f 4e de 84 d2}  //weight: 10, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_rescan_53
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "pptx:ppsx:gsf:dt:" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_rescan_54
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {66 33 0c 42 e8 ?? ?? ?? ?? 8a d8 [0-24] 88 18}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_rescan_55
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {7d 10 8b 85 ?? ?? ?? ?? 80 b4 28 ?? ?? ?? ?? ?? eb db}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_rescan_56
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = ".?AVIEUrlCatcher@@" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_rescan_57
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "OpenCandy" wide //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_rescan_58
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {75 05 66 33 c9 eb 04 66 b9 01 00 8b 44 24 08 66 89 0d}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_rescan_59
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {f5 fe 00 00 00 c2 04 60 ff 9d e7 aa 04 60 ff 9d fb 12}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_rescan_60
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {b8 00 04 00 00 31 d2 b9 36 07 03 00 f3 ab 8b 45 0c 6a 05}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_rescan_61
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {46 61 69 6c 65 64 20 6f 6e 20 53 74 61 72 74 2c 20 25 73 00}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_rescan_62
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "2"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {2e 53 44 4b 2e 65 78 65 00}  //weight: 1, accuracy: High
        $x_1_2 = {14 16 9a 26 16 2d f9}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_rescan_63
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "2"
        strings_accuracy = "High"
    strings:
        $x_2_1 = {81 7d f0 2a 7b 5a 13 0f 85}  //weight: 2, accuracy: High
        $x_2_2 = {81 7d f4 2a 7b 5a 13 74}  //weight: 2, accuracy: High
    condition:
        (filesize < 20MB) and
        (1 of ($x*))
}

rule __do_exhaustivehstr_rescan_64
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "\\VC Project\\BypassUac\\" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_rescan_65
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "2"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "ssl32.dll" ascii //weight: 1
        $x_1_2 = "ssl64.dll" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_rescan_66
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = ".?AVCWininet_Protocol@@" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_rescan_67
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {68 21 04 00 00 68 74 83 00 00 e8 dd e8 40 00 b8 30 99 19 b6 c2 08 00}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_rescan_68
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {83 4c 24 14 ff 53 53 53 53 8d 44 24 20 50 57 c7 44 24 28 80 69 67 ff}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_rescan_69
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_10_1 = {c7 84 24 45 01 00 00 01 01 00 00 89 4e 20 66 0f 7f 46 10 66 0f 7f 06 56 e8}  //weight: 10, accuracy: High
    condition:
        (filesize < 20MB) and
        (1 of ($x*))
}

rule __do_exhaustivehstr_rescan_70
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "2"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {6a 5d 6a 20 e8}  //weight: 1, accuracy: High
        $x_1_2 = "ExcludeUpdateRgn" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_rescan_71
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_3_1 = {43 6f 6e 66 69 67 50 61 6e 65 6c 2e 63 70 6c 00 43 50 6c 41 70 70 6c 65 74 00}  //weight: 3, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_rescan_72
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {8b 4d 08 6a 00 6a 00 50 8b 45 0c 6a 01 6a 00 6a 01 68 ff 01 0f 00 50 50 51 ff 15}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_rescan_73
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "2"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "NotepadPlus" ascii //weight: 1
        $x_1_2 = "VirtualAlloc" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_rescan_74
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {8a 14 01 80 f2 9a 88 10 40 4e 75 f4}  //weight: 1, accuracy: High
        $x_1_2 = {8a 14 08 90 f2 9a 88 11 41 4e 75 f4}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (1 of ($x*))
}

rule __do_exhaustivehstr_rescan_75
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "2"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "AntiVir" wide //weight: 1
        $x_1_2 = "CData" wide //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_rescan_76
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {8d 85 84 fe ff ff 50 ff 15 ?? ?? ?? ?? 8d 4d 90 51 8d 55 fc 52 68 71 17 00 00 e8}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_rescan_77
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {0f b7 44 70 fe 33 c3 89 45 e4 3b 7d e4 7c 0f 8b 45 e4 05 ff 00 00 00 2b c7 89 45 e4 eb 03}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_rescan_78
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {56 4d 77 61 72 65 00 00 45 4d 55 4c 41 54 4f 52 00 00 00 00 56 69 72 74 75 61 6c 50 43 00}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_rescan_79
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "\\huuhwithwallet\\Debug\\huuh.pdb" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_rescan_80
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "2"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {02 c2 8a 14 31 32 d0 88 14 31}  //weight: 1, accuracy: High
        $x_1_2 = {8b 03 6a 00 81 c2 00 01 00 00 6a 00 52 50 ff 15}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_rescan_81
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {c6 45 f6 78 c6 45 f7 00 c7 44 24 0c ?? ?? ?? ?? c7 44 24 08 00 8d 45 f3 89 44 24 04}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_rescan_82
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "2"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Project1.exe" ascii //weight: 1
        $x_1_2 = "KEncryptionFuncs" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_rescan_83
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_3_1 = {85 c0 74 16 6a 32 ff d7 46 83 fe 05 72 da}  //weight: 3, accuracy: High
        $x_1_2 = "ReadOldIniFile" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_rescan_84
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {41 39 36 36 42 43 34 45 42 30 35 30 30 39 31 46 45 34 32 36 33 36 45 38 33 44 44 35 32 43 46 32 00}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_rescan_85
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "C:\\ProgramData\\updata\\spoolsv.exe" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_rescan_86
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {8d 45 f0 8b 55 fc 0f b6 54 32 ff 32 d3 e8 ?? ?? ?? ?? 8b 55 f0 8d 45 f8 e8 ?? ?? ?? ?? 46 4f 75 df}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_rescan_87
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "2"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "SetClassLongA" ascii //weight: 1
        $x_1_2 = "NtCallbackReturn" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_rescan_88
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {0f be 84 04 ?? ?? ?? ?? 35 ?? ?? ?? ?? 88 c1 8b ?? ?? ?? ?? ?? ?? 88 ?? ?? ?? ?? ?? ?? c7 ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? 8b ?? ?? ?? ?? ?? ?? 83 c0 01}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_rescan_89
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {8b 0e 88 59 ?? b9 ?? ?? ?? ?? 2b c8 8b d7 8a 1c 01 80 f3 ?? 88 18 40 4a 75 f4 57 8b ce}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_rescan_90
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {13 4d 5f 25 03 00 81 7d}  //weight: 1, accuracy: Low
        $x_1_2 = {e8 86 74 0e 05 00 81 7d ?? 52 90}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (1 of ($x*))
}

rule __do_exhaustivehstr_rescan_91
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "2"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {73 79 73 30 04 00 2e 64 6c 6c 00}  //weight: 1, accuracy: Low
        $x_1_2 = {73 79 73 30 04 00 2e 61 64 64 00}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_rescan_92
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {c6 45 f9 70 c6 45 fa 65 c6 45 fb 6e 88 5d fc c6 45 ec 73 c6 45 ed 68 c6 45 ee 65 c6 45 ef 6c c6 45 f0 6c}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_rescan_93
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "2"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {8b 4e 1c ff 75 08 41 51 50 89 46 0c e8}  //weight: 1, accuracy: High
        $x_1_2 = {6c 00 6e 00 6b 00 00 00 5c 00 2a 00 2e 00 2a 00 00 00}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_rescan_94
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = ".?AVCIEComHooker@Explorer@SpeedBit@@" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_rescan_95
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {85 c0 0f 85 fa 00 00 00 8b 4f 48 8d 77 48 8b 41 f8 85 c0 75 1b 8d 4c 24 08 c7 84 24 1c 02 00 00 ff ff ff ff}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_rescan_96
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {8b 8d 5c ff ff ff 89 41 0c c7 45 fc 7a 00 00 00 8d 55 d4 52 6a 00 ff 15 ?? ?? ?? ?? c7 45 fc 7b 00 00 00}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_rescan_97
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "2"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {ec f5 24 b0 30 a6 52 61 e3 05 9c 48 ab 9e 1e cb}  //weight: 1, accuracy: High
        $x_1_2 = {23 43 23 54 34 67 23 89 c5 a4 84 34 95 37 85 b6}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_rescan_98
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "A0E1054B-01EE-4D57-A059-4D99F339709F}" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_rescan_99
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "2"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "\\rustdesk.exe" ascii //weight: 1
        $x_1_2 = "std\\src\\io\\cursor.rs" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_rescan_100
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {8a 00 32 01 8b 4d 08 03 4d f8 88 01 8b 45 fc 40 89 45 fc 8b 45 10 03 45 14 39 45 fc 72 08 8b 45 10 89 45 f4 eb 06}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_rescan_101
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {8d 50 02 66 8b 08 83 c0 02 66 3b cf 75 f5 2b c2 d1 f8 8b c8 74 1b 8d 04 4e 66 83 78 fe 5c 74 0f 6a 5c 5a 66 89 10}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_rescan_102
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {b0 f3 b6 a8 ce c4 bc fe d6 d0 a3 ac b6 c1 c8 a1 b5 da d2 bb b8 f6 d2 aa b0 f3 b6 a8 ce c4 bc fe ca b1 b3 f6 b4 ed 21 00}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_rescan_103
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {8a 04 06 88 45 ?? 8b 45 ?? 8a 14 16 88 14 06 8b 45 ?? 8a 55 ?? 88 14 06 ff 45 ?? 81 7d}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_rescan_104
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "\\bin\\UninstallManager\\UninstallManager.pdb" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_rescan_105
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "CXSalvation::SalEnable" wide //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_rescan_106
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {52 61 77 53 6f 63 6b 65 74 33 32 2e 64 6c 6c 00 52 75 6e 00}  //weight: 1, accuracy: High
        $x_1_2 = {52 61 77 53 6f 63 6b 65 74 36 34 2e 64 6c 6c 00 52 75 6e 00}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (1 of ($x*))
}

rule __do_exhaustivehstr_rescan_107
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "2"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {68 37 7e 13 a4 e8}  //weight: 1, accuracy: High
        $x_1_2 = {68 44 6a 01 b9}  //weight: 1, accuracy: High
        $x_1_3 = {68 b3 26 b8 77}  //weight: 1, accuracy: High
        $x_1_4 = {68 ac c8 33 2e}  //weight: 1, accuracy: High
        $x_2_5 = "SNFIRNW" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (
            ((2 of ($x_1_*))) or
            ((1 of ($x_2_*))) or
            (all of ($x*))
        )
}

rule __do_exhaustivehstr_rescan_108
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "jcl.svn.sourceforge.net" wide //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_rescan_109
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {be 65 00 00 00 6a 0a e8 ?? ?? ff ff 6a 00 6a 00 6a 00 6a 08 e8 ?? ?? ff ff 6a 00 6a 02 6a 00 6a 08 e8 ?? ?? ff ff 4e 75 dc}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_rescan_110
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "curl_share_init" ascii //weight: 1
        $x_1_2 = "VirtualQuery" ascii //weight: 1
        $x_1_3 = "VirtualAlloc" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_rescan_111
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {69 6e 76 61 6c 69 64 21 00 6b 72 6e 6c 6e 2e 66 6e 72 00 50 61 74 68 00 53 6f 66 74 77 61 72 65 5c 46 6c 79 53 6b 79 5c 45 5c 49 6e 73 74 61 6c 6c}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_rescan_112
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "2"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {2e 64 6c 6c 00 53 65 72 76 69 63 65 4d 61 69 6e 00 00}  //weight: 1, accuracy: High
        $x_1_2 = {72 70 63 61 70 3a 2f 2f 00 00 00 00 45 6e 61 62 6c 65 46 69 72 65 77 61 6c 6c 00}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_rescan_113
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "2"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "YdrSupp" wide //weight: 1
        $x_1_2 = "--user-data-dir=" wide //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_rescan_114
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {65 6e 64 61 67 75 79 2e 70 64 62 00}  //weight: 1, accuracy: High
        $x_1_2 = {66 61 74 68 65 72 69 61 72 74 2e 70 64 62 00}  //weight: 1, accuracy: High
        $x_1_3 = {64 66 73 66 67 6a 66 67 64 65 73 2e 70 64 62 00}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (1 of ($x*))
}

rule __do_exhaustivehstr_rescan_115
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "2"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {6d 65 74 73 72 76 2e 64 6c 6c 00 00 52 65 66 6c 65 63 74 69 76 65 4c 6f 61 64 65 72}  //weight: 1, accuracy: High
        $x_1_2 = "_ReflectiveLoader@0" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_rescan_116
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {10 75 2b 09 1d ?? ?? ?? 10 83 65 fc 00 8d 45 ?? 50 8d 45 ?? 50 b9 ?? ?? ?? 10 e8 ?? ?? ff ff 68 ?? ?? ?? 10 e8 ?? ?? ?? 00 83 4d fc ff}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_rescan_117
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Software\\DataMngr" wide //weight: 1
        $x_1_2 = "ApproveIEAddon" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (1 of ($x*))
}

rule __do_exhaustivehstr_rescan_118
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = ".?AV?$_Ref_count@VBHOUpdaterComponentsFactory@@@std@@" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_rescan_119
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "2"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "MOD_GETSCREEN" ascii //weight: 1
        $x_1_2 = "MOD_COMPACTA_IMG" ascii //weight: 1
        $x_1_3 = "MOD_mOtherBrowser" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (2 of ($x*))
}

rule __do_exhaustivehstr_rescan_120
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "2"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "codesoft pw stealer" ascii //weight: 1
        $x_1_2 = {5c 70 77 66 69 6c 65 2e 6c 6f 67 00}  //weight: 1, accuracy: High
        $x_1_3 = {5c 6c 6f 67 65 6e 63 72 79 70 74 2e 6c 6f 67 00}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (2 of ($x*))
}

rule __do_exhaustivehstr_rescan_121
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {83 f8 01 75 08 53 68 48 50 45 00 eb db 83 f8 02}  //weight: 1, accuracy: High
        $x_1_2 = {75 27 80 7e 01 74 75 21 80 7e 02 74 75 1b 80 7e 03 70 75 15 80 7e 04 3a 75 0f 80 7e 05 2f 75 09 80 7e 06 2f}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (1 of ($x*))
}

rule __do_exhaustivehstr_rescan_122
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "santabloqdata" wide //weight: 1
        $x_1_2 = "verdebloqdata" wide //weight: 1
    condition:
        (filesize < 20MB) and
        (1 of ($x*))
}

rule __do_exhaustivehstr_rescan_123
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "]]></uri>" ascii //weight: 1
        $x_1_2 = "]]></clickurl>" ascii //weight: 1
        $x_1_3 = "degenerative+joint+disease" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_rescan_124
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {8b 4e 28 03 4d ?? 53 6a 11 68 ?? ?? ?? ?? 50 ff 75 08 89 0d ?? ?? ?? ?? ff d7}  //weight: 1, accuracy: Low
        $x_1_2 = {8b 4f 28 03 4d ?? 53 6a 11 68 ?? ?? ?? ?? 50 ff 75 08 89 0d ?? ?? ?? ?? ff d6}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (1 of ($x*))
}

rule __do_exhaustivehstr_rescan_125
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "SYSTEM\\CurrentControlSet\\Services\\%s" ascii //weight: 1
        $x_1_2 = {00 48 41 43 4b}  //weight: 1, accuracy: High
        $x_1_3 = "netsvcs_0x%" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_rescan_126
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "2"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {80 3c 03 2e 0f 94 c0 0f b6 c0 01 45 d0 43 39 fb 72 eb}  //weight: 1, accuracy: High
        $x_1_2 = {80 38 7c 0f 85 f0 02 00 00 c6 00 00 c7 05 ?? ?? 40 00 00 00 00 00 83 3d ?? ?? 40 00 02 0f 8f 9c 00 00 00}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_rescan_127
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "2"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {61 00 62 00 6f 00 75 00 74 00 3a 00 73 00 65 00 63 00 75 00 72 00 69 00 74 00 79 00 72 00 69 00 73 00 6b 00 00 00}  //weight: 1, accuracy: High
        $x_1_2 = "%s\\payform_%02d.%02d." ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_rescan_128
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "2"
        strings_accuracy = "High"
    strings:
        $x_1_1 = ".rg.ro" wide //weight: 1
        $x_1_2 = {53 00 74 00 61 00 6e 00 64 00 61 00 6c 00 6f 00 6e 00 65 00 20 00 6d 00 75 00 73 00 74 00 20 00 62 00 65 00 20 00 2e 00 65 00 78 00 65 00 00 00}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_rescan_129
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {3d a4 05 61 09 74 0e 6a 00 8b 45 08 50}  //weight: 1, accuracy: High
        $x_1_2 = {44 00 00 00 6e 00 00 00 7c 00 00 00 7f 00 00 00 91 00 00 00 00 00 90 01 00 00 50 00 00 00 50 00 00 00 10 00 00 00 10 00 00 00 20 00 9b 85 e7 e3}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (1 of ($x*))
}

rule __do_exhaustivehstr_rescan_130
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "2"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {08 b7 7a 5c 56 19 34 e0 89 08 b0 3f 5f 7f 11 d5 0a 3a 08 06 15 12 81}  //weight: 1, accuracy: High
        $x_1_2 = {2a 2a 32 49 33 20 2e 40 37 61 33 2e 20 20 20 20 34 d5 3a 48 20 2e 20 20 20 2e 34 de 36 2d 6b 34 2e 33 7b 31 2a 2b}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_rescan_131
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {73 00 68 00 65 00 6c 00 6c 00 5c 00 6f 00 70 00 65 00 6e 00 5c 00 63 00 6f 00 6d 00 6d 00 61 00 6e 00 64 00 00 00 00 00 22 00 20 00 2d 00 61 00 20 00 22 00 25 00 31 00 22 00 20 00 25 00 2a 00 00 00}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_rescan_132
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {8b 45 08 0f b6 00 8b d0 80 e2 0f 88 55 ff 24 f0 0f b6 c0 c1 e8 04 (eb ??|e9 ?? ?? ?? ??) 00 00 00 00}  //weight: 1, accuracy: Low
        $x_1_2 = {8b fa 4f 85 ff 0f 8c ?? ?? ?? ?? 47 33 ed e9 ?? ?? ?? ?? 00 00 00 00}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (1 of ($x*))
}

rule __do_exhaustivehstr_rescan_133
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "2"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {43 6f 6e 74 72 6f 6c 50 61 6e 65 6c 43 70 6c 2e 63 70 6c 00}  //weight: 1, accuracy: High
        $x_1_2 = {10 cb 43 70 6c 00 1c f2 50 73 41 50 49 00}  //weight: 1, accuracy: High
        $x_2_3 = {70 64 6c 6c 69 6e 73 74 61 6c 65 72 2e 64 6c 6c 00 69 6e 73 74 61 6c 6c 00}  //weight: 2, accuracy: High
    condition:
        (filesize < 20MB) and
        (
            ((2 of ($x_1_*))) or
            ((1 of ($x_2_*))) or
            (all of ($x*))
        )
}

rule __do_exhaustivehstr_rescan_134
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {46 74 70 50 75 74 46 69 6c 65 41 00}  //weight: 1, accuracy: High
        $x_1_2 = {52 65 67 53 65 74 56 61 6c 75 65 45 78 41 00}  //weight: 1, accuracy: High
        $x_1_3 = {53 69 7a 65 6f 66 52 65 73 6f 75 72 63 65 00}  //weight: 1, accuracy: High
        $x_1_4 = {52 74 6c 4d 6f 76 65 4d 65 6d 6f 72 79 00}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_rescan_135
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {53 00 65 00 63 00 75 00 72 00 69 00 74 00 79 00 20 00 54 00 6f 00 6f 00 6c 00 00 00 ?? ?? ?? ?? ff ff ff ff 0d 00 00 00 53 00 65 00 63 00 75 00 72 00 69 00 74 00 79 00 20 00 54 00 6f 00 6f 00 6c 00 00 00}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_rescan_136
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {fb 12 fc 0d 6c 6c ff 80 0c 00 fc a0 00 0c 6c 6c ff 6c 5c ff e0 1c 5c 01 00 15}  //weight: 1, accuracy: High
        $x_1_2 = {53 65 74 54 68 72 65 61 64 43 6f 6e 74 65 78 74 00}  //weight: 1, accuracy: High
        $x_1_3 = "WriteProcessMemory" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_rescan_137
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {2e 53 74 6f 6e 65 00}  //weight: 1, accuracy: High
        $x_1_2 = {75 f4 8b 15 38 d7 41 00 8b 0d 3c d7 41 00 89 10 8b 15 40 d7 41 00 89 48 04 66 8b 0d 44 d7 41 00 89 50 08 8b 15 a4 63 42 00 52 66 89 48 0c 8d 84 24 20 03 00 00 68 48 d7 41 00 50}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (1 of ($x*))
}

rule __do_exhaustivehstr_rescan_138
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "2"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {53 53 45 6e 67 69 6e 65 2e 64 6c 6c 00}  //weight: 1, accuracy: High
        $x_1_2 = {43 72 65 61 74 65 53 53 45 6e 67 69 6e 65 49 6e 74 65 72 66 61 63 65 00}  //weight: 1, accuracy: High
        $x_1_3 = {52 65 6c 65 61 73 65 53 53 45 6e 67 69 6e 65 49 6e 74 65 72 66 61 63 65 00}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (2 of ($x*))
}

rule __do_exhaustivehstr_rescan_139
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "NotepadPlus" ascii //weight: 1
        $x_1_2 = "sakura" wide //weight: 1
        $x_1_3 = "VirtualAlloc" ascii //weight: 1
        $x_1_4 = "DeleteFileA" ascii //weight: 1
        $x_1_5 = "CreateFileA" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (4 of ($x*))
}

rule __do_exhaustivehstr_rescan_140
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "2"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "{B70456E2-2388-4A09-AEC4-F53CF216ADAE}" ascii //weight: 1
        $x_1_2 = {53 79 73 74 65 6d 52 65 67 69 73 74 65 72 00 00}  //weight: 1, accuracy: High
        $x_1_3 = {53 75 70 65 72 41 44 2e 64 6c 6c 00}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (2 of ($x*))
}

rule __do_exhaustivehstr_rescan_141
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "2"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "Click To x: %d y: %d" ascii //weight: 2
        $x_1_2 = "invalid_scheduler_policy_key" ascii //weight: 1
        $x_1_3 = "VCWindowController" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((2 of ($x_1_*))) or
            ((1 of ($x_2_*))) or
            (all of ($x*))
        )
}

rule __do_exhaustivehstr_rescan_142
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "2"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {3c 2b 90 75 06 90 83 c2 3e 90 43 3c 2f 90 75 06 90 83 c2 3f 90 43 3c 30 90 7c 0a 3c 39 90 7f 05 04 04 03 d0 43}  //weight: 1, accuracy: High
        $x_1_2 = {3c 41 90 7c 0b 3c 5a 90 7f 06 2c 41 90 03 d0 43 3c 61 90 7c 0a 3c 7a 90 7f 05 2c 47 03 d0 43 c1 c2 06}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_rescan_143
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {8b 45 14 8b d8 c7 03 d4 01 00 00 33 c0 89 43 04 33 c0 89 43 08 33 c0 89 43 0c}  //weight: 1, accuracy: High
        $x_1_2 = {4d 00 41 00 49 00 4e 00 49 00 43 00 4f 00 4e 00 00 00 00 00 75 00 70 00 00 00}  //weight: 1, accuracy: High
        $x_1_3 = {2e 63 70 6c 00 43 50 6c 41 70 70 6c 65 74 00}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_rescan_144
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_5_1 = "TTWOBRO" wide //weight: 5
        $x_5_2 = {54 74 77 6f 62 72 6f 06 74 77 6f 62 72 6f}  //weight: 5, accuracy: High
        $x_1_3 = {55 43 61 72 72 65 67 61 6e 64 6f 00}  //weight: 1, accuracy: High
        $x_1_4 = {55 56 65 72 69 66 69 63 61 00}  //weight: 1, accuracy: High
        $x_1_5 = {55 46 75 6e 63 6f 65 73 00}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_5_*) and 1 of ($x_1_*))) or
            ((2 of ($x_5_*))) or
            (all of ($x*))
        )
}

rule __do_exhaustivehstr_rescan_145
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "2"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {64 00 65 00 66 00 61 00 75 00 6c 00 74 00 5f 00 73 00 65 00 61 00 72 00 63 00 68 00 5f 00 70 00 72 00 6f 00 76 00 69 00 64 00 65 00 72 00 00 00}  //weight: 1, accuracy: High
        $x_1_2 = "\\Release\\DefaultPack.pdb" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_rescan_146
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = "WriteProcessMemory" ascii //weight: 1
        $x_1_2 = "CreateRemoteThread" ascii //weight: 1
        $x_1_3 = "LoadResource" ascii //weight: 1
        $x_1_4 = {55 8b ec 83 c4 f0 b8 ?? ?? ?? ?? e8 ?? ?? ?? ?? e9}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_rescan_147
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {5c 55 73 65 72 73 5c 31 5c [0-64] 5c 52 61 69 6e 6d 65 74 65 72 2e 70 64 62}  //weight: 1, accuracy: Low
        $x_1_2 = "Rainmeter.ini not found" wide //weight: 1
    condition:
        (filesize < 20MB) and
        (1 of ($x*))
}

rule __do_exhaustivehstr_rescan_148
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {eb 03 8d 49 00 8a 1c 17 32 5c 29 01 41 88 1a 42 3b ce 72 f1}  //weight: 1, accuracy: Low
        $x_1_2 = {40 88 54 28 ff 3b c1 72 eb}  //weight: 1, accuracy: High
        $x_1_3 = {8d a4 24 00 00 00 00 [0-5] 8a 90 ?? ?? 00 10 32 90 ?? ?? 00 10 40 88 94 04 ?? ?? 00 00 3b c6 72}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (1 of ($x*))
}

rule __do_exhaustivehstr_rescan_149
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "2"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {7f 22 8b 45 fc 99 f7 3d ?? ?? ?? ?? 8b 45 08 03 45 fc 8a 08 32 8a ?? ?? ?? ?? 8b 55 08 03 55 fc 88 0a eb cd}  //weight: 1, accuracy: Low
        $x_1_2 = {79 08 49 81 c9 00 ff ff ff 41 8b 45 08 03 45 ?? 8a 10 32 94 8d ?? ?? ?? ?? 8b 45 08 03 45 ?? 88 10 e9}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_rescan_150
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "2"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {52 65 67 69 73 74 72 61 74 69 6f 6e 49 44 ?? ?? 53 4f 46 54 57 41 52 45 5c 4d 69 63 72 6f 73 6f 66 74 5c 57 69 6e 64 6f 77 73 5c 43 75 72 72 65 6e 74 56 65 72 73 69 6f 6e}  //weight: 1, accuracy: Low
        $x_1_2 = {f7 d8 1b c0 83 e0 f3 83 c0 0d eb 03 6a 57 58}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_rescan_151
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {8b 7d 10 85 ff 0f 84 ab 00 00 00 8b 55 0c 8a 02 88 44 35 e5 46 83 fe 03 75 e0 8a 55 e5 88 d0 c0 e8 02 88 45 e1 83 e2 03 c1 e2 04 8a 4d e6 c0 e9 04 01 ca 88 55 e2 8a 4d e6 83 e1 0f 8a 55 e7 c0 ea 06 8d 14 8a 88 55 e3 8a 55 e7 83 e2 3f 88 55 e4 31 ff}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_rescan_152
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {8b 45 fc 8a 44 18 ff 24 0f 8b 55 f8 8a 54 32 ff 80 e2 0f 32 c2 88 45 ?? 8d 45 fc e8 ?? ?? ?? ?? 8b 55 fc 8a 54 1a ff 80 e2 f0 8a 4d ?? 02 d1 88 54 18 ff}  //weight: 1, accuracy: Low
        $x_1_2 = {b8 00 00 00 00 40 3d 00 e9 a4 35 68 ?? ?? ?? ?? e8 ?? ?? ?? ?? 75 e9}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (1 of ($x*))
}

rule __do_exhaustivehstr_rescan_153
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "8"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Computador.." ascii //weight: 1
        $x_1_2 = "LoginName" ascii //weight: 1
        $x_1_3 = "Senha" ascii //weight: 1
        $x_1_4 = "javascript" ascii //weight: 1
        $x_1_5 = "about:blank" ascii //weight: 1
        $x_5_6 = "Magellan MSWHEEL" ascii //weight: 5
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_5_*) and 3 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule __do_exhaustivehstr_rescan_154
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "websafe\\WebSafePlugin.pdb" ascii //weight: 1
        $x_1_2 = "\\DataMngrUI.pdb" ascii //weight: 1
        $x_1_3 = "\\ShopperPro.pdb" ascii //weight: 1
        $x_1_4 = "Tools::IETools::`" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (1 of ($x*))
}

rule __do_exhaustivehstr_rescan_155
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "src\\unicode\\printable.rs" ascii //weight: 1
        $x_1_2 = "rust_panic" ascii //weight: 1
        $x_1_3 = "src/main.rs" ascii //weight: 1
        $x_1_4 = "ffi\\c_str.rs" ascii //weight: 1
        $x_1_5 = "str\\pattern.rs" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_rescan_156
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "SOFTWARE\\AppDataLow\\Software\\Search Protection" wide //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_rescan_157
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {28 73 6f 63 6b 73 7c 68 74 74 70 29 3d 28 5b 5e 3a 5d 2b 29 3a 28 5c 64 2b 29 00}  //weight: 1, accuracy: High
        $x_1_2 = {55 43 46 47 5f 54 48 52 45 41 44 5f 53 54 41 43 4b 5f 53 49 5a 45 00}  //weight: 1, accuracy: High
        $x_1_3 = "{\"id\": 0, \"result\": {\"data\": \"0000" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_rescan_158
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "2"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "/src/github.com/t3rm1n4l/megacmd/main.go" ascii //weight: 1
        $x_1_2 = "/src/github.com/t3rm1n4l/megacmd/client/client.go" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_rescan_159
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "2"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "ClearLock" wide //weight: 1
        $x_1_2 = "http://www.boot-land.net/" wide //weight: 1
        $x_1_3 = "IamMr.Ed!" wide //weight: 1
    condition:
        (filesize < 20MB) and
        (2 of ($x*))
}

rule __do_exhaustivehstr_rescan_160
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "CrossriderApp0051680" ascii //weight: 1
        $x_1_2 = "CrossriderApp0051682" ascii //weight: 1
        $x_1_3 = "CrossriderApp0051684" ascii //weight: 1
        $x_1_4 = ".?AVCCrossRiderLogger@@" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (1 of ($x*))
}

rule __do_exhaustivehstr_rescan_161
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {c7 45 f4 01 00 00 00 8b 45 fc 8b 55 f4 33 db 8a 5c 10 ff 03 5d f8 8b c3 33 d2 52 50 8d 45 e8 e8 ?? ?? ?? ?? 8b 45 e8 e8}  //weight: 1, accuracy: Low
        $x_1_2 = {64 ff 35 00 00 00 00 64 89 25 00 00 00 00 58 c3 e9 05 00 68}  //weight: 1, accuracy: Low
        $x_1_3 = {2e 63 61 62 00 00 ff ff ff ff 0a 00 00 00 ?? ?? ?? ?? ?? ?? 2e 63 61 62}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (1 of ($x*))
}

rule __do_exhaustivehstr_rescan_162
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "2"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "TjefCbs]PfnDvtupnUifnf" wide //weight: 1
        $x_1_2 = "tztufn43]" wide //weight: 1
        $x_1_3 = "Qsphsbn!Gjmft" wide //weight: 1
    condition:
        (filesize < 20MB) and
        (2 of ($x*))
}

rule __do_exhaustivehstr_rescan_163
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {b8 54 4c 55 00 e8 ?? 40 14 00 6a 04 58 e8 ?? 0c 13 00 56 8b f1 89 75 f0}  //weight: 1, accuracy: Low
        $x_1_2 = {68 50 61 5c 00 8d 8d 38 ff ff ff 89 5d f0 e8 0e 0c 00 00 8d 85 38 ff ff ff 50 8d 45 9c}  //weight: 1, accuracy: High
        $x_1_3 = {8b 45 90 03 c0 89 45 90 8b 45 94 03 c0 89 45 94 33 c0 8a 88 e0 16 5c 00 88 4c 05 ac 40 3a cb}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (1 of ($x*))
}

rule __do_exhaustivehstr_rescan_164
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "\\\\.\\PhysicalDrive0" ascii //weight: 1
        $x_1_2 = "dllhost.dat" wide //weight: 1
        $x_1_3 = "fsutil usn deletejournal /D" wide //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_rescan_165
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "=?ISO-8859-1?Q?" wide //weight: 1
        $x_1_2 = "vbSendMail" wide //weight: 1
        $x_1_3 = "Invalid Bcc: Recipient" wide //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_rescan_166
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {50 6a 00 6a 00 6a 1c 6a 00 ff 15 ?? ?? ?? ?? 68 04 01 00 00 8d 85 ?? ?? ?? ?? 6a 00 50 e8 ?? ?? ?? ?? 83 c4 ?? c7 85 ?? ?? ?? ?? ?? ?? ?? ?? 8d 8d ?? ?? ?? ?? c7 85 ?? ?? ?? ?? 00 00 00 00 c6 85 ?? ?? ?? ?? 00 6a 18 68}  //weight: 1, accuracy: Low
        $x_1_2 = "u_browserSettingsInstaller" ascii //weight: 1
        $x_1_3 = "home+startup" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (1 of ($x*))
}

rule __do_exhaustivehstr_rescan_167
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "2"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {8b 01 0f b6 1e 8b d0 c1 ea 18 33 d3 0f b6 59 07 c1 e0 08 0b c3 c1 e2 02 33 82 ?? ?? ?? ?? 46 89 01 8b 41 04 c1 e0 08 33 82 ?? ?? ?? ?? 4f 89 41 04}  //weight: 1, accuracy: Low
        $x_1_2 = {49 bb 00 80 c1 2a 21 4e 62 fe 49 03 cb 48 b8 bd 42 7a e5 d5 94 bf d6 48 f7 e1 48 83 c8 ff 48 c1 ea 17 48 81 fa 7f d2 ff 7f 48 0f 4f d0}  //weight: 1, accuracy: High
        $x_1_3 = "EnableEUDC" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (2 of ($x*))
}

rule __do_exhaustivehstr_rescan_168
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "2"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {6e 74 56 65 72 73 69 6f 6e 5c 70 6f 6c 69 63 00 69 65 73 5c 45 78 70 6c 6f 72 65 72 5c 52 75 6e}  //weight: 1, accuracy: High
        $x_1_2 = {25 73 73 79 73 6f 70 74 69 6f 6e 2e 69 6e 69 00 2e 74 6d 70}  //weight: 1, accuracy: High
        $x_1_3 = {41 6c 77 61 79 73 [0-10] 5c 72 75 6e 64 6c 6c 33 32 [0-8] 74 6d 70 [0-6] 2d 75 [0-6] 2d 65 00 53 48 47 65 74 46 6f 6c 64 65 72 50 61 74 68 41}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (2 of ($x*))
}

rule __do_exhaustivehstr_rescan_169
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "$__SIG&ovr=$__OVR&amigo=" wide //weight: 1
        $x_1_2 = "/notificate.php?did=" wide //weight: 1
        $x_1_3 = ".dat?did=" wide //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_rescan_170
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "2"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {6a 05 53 8d 45 b4 50 8d 45 f4 50 ff 75 fc ff 15 ?? ?? ?? ?? 83 7d bc 3c ff 75 fc 0f 84 cc 00 00 00 ff 15}  //weight: 1, accuracy: Low
        $x_1_2 = {5c 00 3f 00 3f 00 5c 00 7a 00 3a 00 5c 00 61 00 75 00 74 00 6f 00 72 00 75 00 6e 00 2e 00 69 00 6e 00 66 00 00 00 00 00 5c 00 3f 00 3f 00 5c 00 7a 00 3a 00 5c 00 61 00 75 00 74 00 6f 00 72 00 75 00 6e 00 2e 00 65 00 78 00 65 00 00 00}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_rescan_171
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "10"
        strings_accuracy = "Low"
    strings:
        $x_10_1 = {81 e1 0f 00 00 80 79 05 49 83 c9 f0 41 (8b (??) 88 4d ?? 8a 4c 38 02|8a 14 30)}  //weight: 10, accuracy: Low
        $x_10_2 = {81 e1 0f 00 00 80 79 05 49 83 c9 f0 41 8b [0-2] 88 4d ?? 8a 4c 38 02 32 cb}  //weight: 10, accuracy: Low
        $x_10_3 = {25 0f 00 00 80 79 05 48 83 c8 f0 40 88 45 ?? (8b 45 08 03 45 f8 0f b6 00 0f b6 4d ff|8a 01 8a d0)}  //weight: 10, accuracy: Low
    condition:
        (filesize < 20MB) and
        (1 of ($x*))
}

rule __do_exhaustivehstr_rescan_172
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {58 58 58 00}  //weight: 1, accuracy: High
        $x_1_2 = {58 00 58 00 53 00 30 00 53 00 00 00}  //weight: 1, accuracy: High
        $x_1_3 = {58 58 53 32 53 00}  //weight: 1, accuracy: High
        $x_1_4 = {58 58 53 33 53 00}  //weight: 1, accuracy: High
        $x_1_5 = {8b 85 44 fe ff ff 8d 8d 48 fe ff ff ba e0 45 03 10 e8 aa ff fe ff 33 c0 5a 59 59 64 89 10 68 50 45 03 10 8d 85 44 fe ff ff e8 3e 07 fd ff 8d 85 58 fe ff ff ba 07 00 00 00 e8 9a 00 fd ff 8d 85 74 fe ff ff ba 02 00 00 00 e8 36 07 fd ff}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_rescan_173
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "11"
        strings_accuracy = "High"
    strings:
        $x_5_1 = "application/jsondrives/{driveId}" ascii //weight: 5
        $x_5_2 = "sheets.googleapis.com" ascii //weight: 5
        $x_1_3 = "Go build ID: \"" ascii //weight: 1
        $x_1_4 = "GODEBUG: unknown cpu feature" ascii //weight: 1
        $x_1_5 = "Go buildinf:" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((2 of ($x_5_*) and 1 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule __do_exhaustivehstr_rescan_174
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "2"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Software\\Microsoft\\Windows\\CurrentVersion\\explorer\\Browser Helper Objects\\" ascii //weight: 1
        $x_1_2 = {31 d2 f7 f1 4e 80 c2 30 80 fa 3a 72 03 80 c2 07 88 16 09 c0 75 ea 59 5a 29 f1 29 ca 76 10 01 d1 b0 30 29 d6 eb 03 88 04 32 4a 75 fa 88 06}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_rescan_175
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "*.doc,*.docx,*.docm,*.odt,*.xls,*.xlsx,*.xlsm,*.csv,*.xlsb,*.ods,*.sxc,*.ppt,*.pptx,*.pptm,*.odp,*.dbf,*.mdb,*.ACCDA,*.ACCDB," ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_rescan_176
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "2"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = "VB.Printer" ascii //weight: 1
        $x_1_2 = "VB.Shape" ascii //weight: 1
        $x_1_3 = "RECYCLER" wide //weight: 1
        $x_1_4 = {77 73 32 5f 33 32 2e 64 6c 6c 00 00 0e 00 00 00 67 65 74 68 6f 73 74 62 79 6e 61 6d 65}  //weight: 1, accuracy: High
        $x_1_5 = {f5 6b 00 00 00 0b ?? ?? ?? ?? 31 ?? ?? f5 65 00 00 00 0b ?? ?? ?? ?? 31 ?? ?? f5 72 00 00 00 0b ?? ?? ?? ?? 31 ?? ?? f5 6e 00 00 00}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (2 of ($x*))
}

rule __do_exhaustivehstr_rescan_177
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {50 c6 85 65 ff ff ff 63 c6 85 66 ff ff ff 20 c6 85 67 ff ff ff 6e c6 85 68 ff ff ff 65 c6 85 69 ff ff ff 74 c6 85 6a ff ff ff 20 c6 85 6b ff ff ff 73 c6 85 6c ff ff ff 74 c6 85 6d ff ff ff 6f c6 85 6e ff ff ff 70 c6 85 6f ff ff ff 20 c6 85 70 ff ff ff 4d c6 85 71 ff ff ff 70 c6 85 72 ff ff ff 73 c6 85 73 ff ff ff 53 c6 85 74 ff ff ff 76 c6 85 75 ff ff ff 63 88 9d 76 ff ff ff}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_rescan_178
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {c7 44 97 04 ff ff ff ff 6a 00 57 e8 ?? ?? ?? ?? 83 c4 08 33 c9 89 4d ?? 03 05 03 05 8b df 83 eb fc 8d 5f 04 8b df 8d 5b 04 8b 0f 3b 4d ?? 0f 8f}  //weight: 1, accuracy: Low
        $x_1_2 = "Auto Adjust completed." ascii //weight: 1
        $x_1_3 = {c7 44 97 04 ff ff ff ff 6a 00 57 e8 ?? ?? ?? ?? 83 c4 08 33 c9 89 4d ?? 8d 5f 04 eb 14 8b 03 8b 50 14 52 6a 00 ff 50 18}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (1 of ($x*))
}

rule __do_exhaustivehstr_rescan_179
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "2"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {ac 8a c8 3c 0f 74 0f 66 81 7e ff cd 20 75 0a}  //weight: 1, accuracy: High
        $x_1_2 = {8a 02 88 45 ff 2c 61 42 3c 19 77 04 80 45 ff e0}  //weight: 1, accuracy: High
        $x_1_3 = {6a 05 66 c7 01 58 68 89 71 02 66 c7 41 06 50 e9}  //weight: 1, accuracy: High
        $x_1_4 = {c6 02 e9 8d 44 08 fb 89 42 01 83 eb 0c 89 5f 08 66 c7 07 58 68 89 77 02 66 c7 47 06 50 e9}  //weight: 1, accuracy: High
        $x_1_5 = {ff 76 28 66 c7 45 fc 8b ff c7 45 f0 90 90 90 90 c6 45 f4 90 ff d7}  //weight: 1, accuracy: High
        $x_1_6 = {8b 4e 24 8d 04 19 80 38 e8 75 08}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (2 of ($x*))
}

rule __do_exhaustivehstr_rescan_180
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {67 6c 75 65 3a 4c 00 6e 6f 20 4c 75 61 20 70 72 6f 67 72 61 6d 20 66 6f 75 6e 64 20 69 6e 20 25 73 00 3d 00 61 72 67 00 74 6f 6f 20 6d 61 6e 79 20 61 72 67 75 6d 65 6e 74 73 20 74 6f 20 73 63 72 69 70 74 00 63 61 6e 6e 6f 74 20 6c 6f 63 61 74 65 20 74 68 69 73 20 65 78 65 63 75 74 61 62 6c 65 00 73 72 6c 75 61 00 6e 6f 74 20 65 6e 6f 75 67 68 20 6d 65 6d 6f 72 79 20 66 6f 72 20 73 74 61 74 65}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_rescan_181
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "/rotation.im.php" wide //weight: 1
        $x_1_2 = {26 00 72 00 6f 00 74 00 69 00 64 00 3d 00 31 00 00 00}  //weight: 1, accuracy: High
        $x_1_3 = {00 00 2f 00 6e 00 6f 00 74 00 69 00 66 00 69 00 00 00}  //weight: 1, accuracy: High
        $x_1_4 = {00 00 2f 00 6e 00 6f 00 74 00 69 00 66 00 00 00}  //weight: 1, accuracy: High
        $x_1_5 = {00 00 74 00 69 00 66 00 69 00 63 00 61 00 74 00 00 00}  //weight: 1, accuracy: High
        $x_1_6 = {10 54 49 78 43 61 6d 70 61 69 67 6e 51 75 65 75 65}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (1 of ($x*))
}

rule __do_exhaustivehstr_rescan_182
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Z2VuYWthayBRY2xmfFVkb0R1cwhZS0x2fEpRQFFKVVt1cy4da250cm5laRwVaGvQAXMMdnwaGQkEFQIPDg8RBa5hc25wcmJvY1ZhXa5Za254ekpxREdZS45RQ05AQkpJdGaunWtudA==" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_rescan_183
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "{92CFC1A4E0924D909728DA95EA92EC0B}" ascii //weight: 1
        $x_1_2 = {20 2d 69 6e 73 74 61 00}  //weight: 1, accuracy: High
        $x_1_3 = "msidntld32" wide //weight: 1
        $x_1_4 = "msidntld64" wide //weight: 1
        $x_1_5 = "radardt32" wide //weight: 1
        $x_1_6 = "radardt64" wide //weight: 1
    condition:
        (filesize < 20MB) and
        (1 of ($x*))
}

rule __do_exhaustivehstr_rescan_184
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {ff ff ff ff 04 00 00 00 65 78 69 74 00}  //weight: 1, accuracy: High
        $x_1_2 = {ff ff ff ff 06 00 00 00 74 65 6c 6e 65 74 00}  //weight: 1, accuracy: High
        $x_1_3 = {ff ff ff ff 05 00 00 00 0d 0a 2f 24 20 00}  //weight: 1, accuracy: High
        $x_1_4 = "capCreateCaptureWindowA" ascii //weight: 1
        $x_1_5 = "acmDriverOpen" ascii //weight: 1
        $x_1_6 = "QueryServiceStatus" ascii //weight: 1
        $x_1_7 = "GetEnhMetaFileHeader" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (5 of ($x*))
}

rule __do_exhaustivehstr_rescan_185
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "tcrypt_cl2\\tcrypt_cl2\\Release\\s_high.pdb" ascii //weight: 1
        $x_1_2 = "tcrypt_cl2\\tcrypt_cl2\\Release\\s_low.pdb" ascii //weight: 1
        $x_1_3 = "\\tcrypt\\Release\\s_high.pdb" ascii //weight: 1
        $x_1_4 = "\\tcrypt\\Release\\s_low.pdb" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (1 of ($x*))
}

rule __do_exhaustivehstr_rescan_186
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "2"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {38 00 32 00 36 00 33 00 30 00 34 00 31 00 31 00 65 00 35 00 64 00 66 00 30 00 65 00 30 00 63 00 00 00 00 00 4b 00 65 00 72 00 6e 00 00 00 00 00 65 00 6c 00 33 00 32 00}  //weight: 1, accuracy: High
        $x_1_2 = {7b 00 35 00 35 00 46 00 31 00 35 00 34 00 43 00 30 00 2d 00 43 00 44 00 41 00 46 00 2d 00 34 00 35 00 43 00 34 00 2d 00 39 00 41 00 31 00 41 00 2d 00 00 00 38 00 35 00 32 00 46 00 46 00 35 00 31 00 46 00 39 00 35 00 31 00 45 00 00 00 00 00 7d 00}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_rescan_187
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "11"
        strings_accuracy = "High"
    strings:
        $x_10_1 = "_CorExeMain" ascii //weight: 10
        $x_1_2 = "This software is encrypted to provide copy protection." wide //weight: 1
        $x_1_3 = "CreateDecryptor" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_10_*) and 1 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule __do_exhaustivehstr_rescan_188
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "3"
        strings_accuracy = "Low"
    strings:
        $x_2_1 = {6a 0c 50 68 00 14 2d 00 03 00 8d 45}  //weight: 2, accuracy: Low
        $x_2_2 = {b8 4f 00 00 00 cd 41 66 3d 86 f3 0f 94 c0 0f b6 c0}  //weight: 2, accuracy: High
        $x_1_3 = {b9 0a 00 00 00 b8 68 58 4d 56 66 ba 58 56 ed 81 fb 68 58 4d 56 0f 94 c0 0f b6 c0}  //weight: 1, accuracy: High
        $x_1_4 = {33 c0 50 0f 01 4c 24 fe 58 c3}  //weight: 1, accuracy: High
        $x_1_5 = {68 58 4d 56 c7 85 ?? ?? ff ff 58 56 00 00}  //weight: 1, accuracy: Low
        $x_1_6 = {b9 0a 00 00 00 8b 85 ?? ?? ff ff 66 8b 95 ?? ?? ff ff ed 3b 9d ?? ?? ff ff 0f 94 c0 0f b6 c0}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (
            ((3 of ($x_1_*))) or
            ((1 of ($x_2_*) and 1 of ($x_1_*))) or
            ((2 of ($x_2_*))) or
            (all of ($x*))
        )
}

rule __do_exhaustivehstr_rescan_189
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Acesso corretamente" wide //weight: 1
        $x_1_2 = "Token corretamente" wide //weight: 1
        $x_1_3 = "Senha corretamente" wide //weight: 1
        $x_1_4 = "BarraTimer" ascii //weight: 1
        $x_1_5 = "JavaTimer" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (1 of ($x*))
}

rule __do_exhaustivehstr_rescan_190
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "7"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "MSAFD Tcpip [TCP/IP]" wide //weight: 1
        $x_1_2 = "WSCInstallProvider" ascii //weight: 1
        $x_1_3 = "WSCEnumProtocols" ascii //weight: 1
        $x_1_4 = "FindResourceA" ascii //weight: 1
        $x_1_5 = "LoadResource" ascii //weight: 1
        $x_1_6 = "WriteFile" ascii //weight: 1
        $x_1_7 = "CreateProcessA" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_rescan_191
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {66 33 45 d0 0f bf d0 52 ff 15 ?? ?? ?? ?? 8b d0 8d 4d c8 ff 15 ?? ?? ?? ?? 50 ff 15 ?? ?? ?? ?? 8b d0 8d 4d d4 ff 15}  //weight: 1, accuracy: Low
        $x_1_2 = {66 33 45 d0 0f bf c0 50 e8 ?? ?? ?? ?? 8b d0 8d 4d c8 e8 ?? ?? ?? ?? 50 e8 ?? ?? ?? ?? 8b d0 8d 4d d4 e8}  //weight: 1, accuracy: Low
        $x_1_3 = {6b 70 ff fb 12 e7 0b ?? 00 04 00 23 44 ff 2a 31 74 ff 32 04 00 48 ff 44 ff 35 4c ff 00 0c 6b 70 ff f3 ff 00 c6 1c ?? ?? 00 07 f4 01 70 70 ff 1e ?? ?? 00 0b 6b 70 ff f4 01 a9 70 70 ff 00 0a 04 72 ff 64 6c}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (1 of ($x*))
}

rule __do_exhaustivehstr_rescan_192
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {8b 78 04 0f b6 18 0f b7 ca 66 0f be 3c 0f 66 33 fb 66 33 fa bb ff 00 00 00 66 23 fb 42 66 89 3c 4e 66 3b 50 02}  //weight: 1, accuracy: High
        $x_1_2 = {8b 50 04 0f b7 f1 8a 14 32 32 10 32 d1 41 88 14 3e 66 3b 48 02}  //weight: 1, accuracy: High
        $x_1_3 = {50 68 22 a2 78 98 e8 ?? ?? ?? 00 8d 45 ?? 50 68 28 91 d0 03 53 6a 04}  //weight: 1, accuracy: Low
        $x_1_4 = {3c 61 7c 02 2c 20 c1 cf 0d 03 f8 e2 f0 81 ff 5b bc 4a 6a}  //weight: 1, accuracy: High
        $x_1_5 = {85 c0 74 39 8d 45 f4 50 8d 45 f8 50 8d 45 f0 50 ff 75 fc 89 5d f8 ff 15 ?? ?? ?? ?? 85 c0 74 14 ff 75 f4 ff 75 f8 ff 75 f0 57}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (1 of ($x*))
}

rule __do_exhaustivehstr_rescan_193
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "2"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {00 42 46 44 44 4f 53 2f 25 64 2d 25 64 00}  //weight: 1, accuracy: High
        $x_1_2 = {00 46 59 48 48 4f 53 3d 25 64 2b 25 64 28 4d 42 29 00}  //weight: 1, accuracy: High
        $x_1_3 = {00 46 59 59 4c 43 53 3d 25 64 2b 25 64 28 4d 42 29}  //weight: 1, accuracy: High
        $x_1_4 = {00 41 63 63 65 70 74 2d 4c 61 6e 67 75 61 67 65 3a 20 7a 68 2d 63 6e 0d 0a}  //weight: 1, accuracy: High
        $x_1_5 = {00 53 54 4f 50 41 54 54 41 43 4b 00}  //weight: 1, accuracy: High
        $x_1_6 = {00 52 45 54 55 52 4e 50 4f 57 45 52}  //weight: 1, accuracy: High
        $x_2_7 = {79 6f 75 20 77 69 6c 6c 20 63 61 6e 27 74 20 72 65 67 69 73 74 20 70 72 6f 67 72 61 6d 00}  //weight: 2, accuracy: High
        $x_2_8 = {b1 72 b0 65 88 4c 24 02 88 4c 24 06}  //weight: 2, accuracy: High
    condition:
        (filesize < 20MB) and
        (
            ((2 of ($x_1_*))) or
            ((1 of ($x_2_*))) or
            (all of ($x*))
        )
}

rule __do_exhaustivehstr_rescan_194
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {2e 3f 41 56 62 70 72 6f 74 65 63 74 6f 72 40 40 00}  //weight: 1, accuracy: High
        $x_1_2 = {62 00 50 00 72 00 6f 00 74 00 65 00 63 00 74 00 6f 00 72 00 46 00 6f 00 72 00 57 00 69 00 6e 00 64 00 6f 00 77 00 73 00 00 00}  //weight: 1, accuracy: High
        $x_1_3 = {2e 3f 41 56 69 6e 6a 65 63 74 6f 72 40 70 72 6f 74 65 63 74 69 6f 6e 40 40 00}  //weight: 1, accuracy: High
        $x_1_4 = {2e 3f 41 56 69 74 65 6d 5f 73 65 74 74 69 6e 67 73 40 70 72 6f 74 65 63 74 69 6f 6e 40 40 00}  //weight: 1, accuracy: High
        $x_1_5 = {5c 62 70 72 6f 74 65 63 74 2e 70 64 62 00}  //weight: 1, accuracy: High
        $x_1_6 = {2e 3f 41 56 50 72 6f 74 65 63 74 6f 72 53 65 72 76 69 63 65 40 40 00}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (1 of ($x*))
}

rule __do_exhaustivehstr_rescan_195
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "2"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {54 53 55 20 4c 6f 61 64 65 72 00}  //weight: 1, accuracy: High
        $x_1_2 = "No installer available for this Windows version" ascii //weight: 1
        $x_2_3 = "WebCake LLC.  All rights reserved." wide //weight: 2
        $x_2_4 = "api.getwebcake.com" wide //weight: 2
    condition:
        (filesize < 20MB) and
        (
            ((2 of ($x_1_*))) or
            ((1 of ($x_2_*))) or
            (all of ($x*))
        )
}

rule __do_exhaustivehstr_rescan_196
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {0f b7 41 14 03 f8 0f b7 49 06 60 8b 47 14 85 c0 74 ?? 8b 47 08 85 c0 74}  //weight: 1, accuracy: Low
        $x_1_2 = "FastMM Borland Edition (c) 2004 - 2008 Pierre le Riche / Professional Software Development" ascii //weight: 1
        $x_1_3 = {53 79 73 74 65 6d 3a 3a 44 65 6c 70 68 69 49 6e 74 65 72 66 61 63 65 3c 49 44 69 73 70 61 74 63 68 3e 00}  //weight: 1, accuracy: High
        $x_1_4 = {00 7a 78 63 7a 63 7a 78 63 00}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (1 of ($x*))
}

rule __do_exhaustivehstr_rescan_197
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "PsSetCreateProcessNotifyRoutine" ascii //weight: 1
        $x_1_2 = "ZwQuerySystemInformation" ascii //weight: 1
        $x_1_3 = "ntoskrnl.exe" ascii //weight: 1
        $x_1_4 = "PsLookupProcessByProcessId" ascii //weight: 1
        $x_1_5 = "MmIsAddressValid" ascii //weight: 1
        $x_1_6 = "KeDelayExecutionThread" ascii //weight: 1
        $x_1_7 = "PsCreateSystemThread" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (6 of ($x*))
}

rule __do_exhaustivehstr_rescan_198
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "2"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {e3 40 fe 45 fd 0f b6 45 fd 0f b6 14 38 88 55 ff 00 55 fc 0f b6 45 fc 8a 14 38 88 55 fe 0f b6 45 fd 88 14 38 0f b6 45 fc 8a 55 ff 88 14 38 8a 55 ff 02 55 fe 8a 14 3a 8b 45 f8 30 14 30 ff 45 f8 e2 c0 8a 45 fd 88 03 8a 45 fc 88 43 01}  //weight: 1, accuracy: High
        $x_1_2 = {3d c9 00 00 00 75 0f 68 a7 a7 a7 00 ff 75 10 e8 ?? ?? 00 00 eb ?? 3d ca 00 00 00 75 ?? 6a 00 ff 75 10 e8}  //weight: 1, accuracy: Low
        $x_1_3 = {d7 84 c0 78 f7 8a e0 c0 e8 04 c0 e4 04 0b d0 49 78 28 ac d7 84 c0 78 f7 8a e0 c0 e8 02 c0 e4 06 c1 e0 08 0b d0 49 78 12 ac d7 84 c0 78 f7 c1 e0 10 0b d0 89 17}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (2 of ($x*))
}

rule __do_exhaustivehstr_rescan_199
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "21"
        strings_accuracy = "Low"
    strings:
        $x_4_1 = {46 69 6c 65 4d 65 6d 2e 64 6c 6c 00 [0-3] 64 65 66 61 75 6c 74 [0-10] 2e 64 61 74}  //weight: 4, accuracy: Low
        $x_4_2 = {00 4c 6f 63 6b 2e 64 6c 6c}  //weight: 4, accuracy: High
        $x_4_3 = "NoProtectedModeBanner" ascii //weight: 4
        $x_2_4 = "ctfmon." ascii //weight: 2
        $x_2_5 = {2e 6c 6e 6b 00}  //weight: 2, accuracy: High
        $x_4_6 = "DLLMODULE" ascii //weight: 4
        $x_1_7 = "FIREFOX.EXE" ascii //weight: 1
        $x_1_8 = "CHROME.EXE" ascii //weight: 1
        $x_1_9 = "IESTART" ascii //weight: 1
        $x_10_10 = {64 ff 30 64 89 20 83 eb 01 72 07 74 0e 4b 74 22 eb 43 55 e8}  //weight: 10, accuracy: High
        $x_10_11 = {74 44 c7 04 24 28 01 00 00 8b d4 8b c3 e8}  //weight: 10, accuracy: High
    condition:
        (filesize < 20MB) and
        (
            ((4 of ($x_4_*) and 1 of ($x_2_*) and 3 of ($x_1_*))) or
            ((4 of ($x_4_*) and 2 of ($x_2_*) and 1 of ($x_1_*))) or
            ((1 of ($x_10_*) and 1 of ($x_4_*) and 2 of ($x_2_*) and 3 of ($x_1_*))) or
            ((1 of ($x_10_*) and 2 of ($x_4_*) and 3 of ($x_1_*))) or
            ((1 of ($x_10_*) and 2 of ($x_4_*) and 1 of ($x_2_*) and 1 of ($x_1_*))) or
            ((1 of ($x_10_*) and 2 of ($x_4_*) and 2 of ($x_2_*))) or
            ((1 of ($x_10_*) and 3 of ($x_4_*))) or
            ((2 of ($x_10_*) and 1 of ($x_1_*))) or
            ((2 of ($x_10_*) and 1 of ($x_2_*))) or
            ((2 of ($x_10_*) and 1 of ($x_4_*))) or
            (all of ($x*))
        )
}

rule __do_exhaustivehstr_rescan_200
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "/adspostback_server.aspx?userid=%s&source=%s" wide //weight: 1
        $x_1_2 = "/ws/reportws.asmx?wsdl" wide //weight: 1
        $x_1_3 = "/api_ajax.ashx?clientid=%s" wide //weight: 1
    condition:
        (filesize < 20MB) and
        (1 of ($x*))
}

rule __do_exhaustivehstr_rescan_201
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "9"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "ConfiguraesdeBloqueadordePopups2" ascii //weight: 1
        $x_1_2 = "OpesdaInternet1Click" ascii //weight: 1
        $x_1_3 = "SobreoInternetExplorer2" ascii //weight: 1
        $x_1_4 = "Emailsenotcias2" ascii //weight: 1
        $x_1_5 = "ChamadanaInternet2" ascii //weight: 1
        $x_1_6 = "BarradoExplorer2" ascii //weight: 1
        $x_1_7 = "Windowsupdate2" ascii //weight: 1
        $x_1_8 = "Windowsmessenger2" ascii //weight: 1
        $x_1_9 = "Google2" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_rescan_202
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "3"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {ff 37 81 c3 54 32 77 00 5b 58 85 db 0f 85 ?? ?? ?? ?? e9}  //weight: 1, accuracy: Low
        $x_1_2 = {ff 37 4e 4e 81 eb 53 32 87 00 5b 58 85 db 0f 85}  //weight: 1, accuracy: High
        $x_1_3 = {68 6f 6e 5c (4f|50) ?? 74 69 66 79 5c}  //weight: 1, accuracy: Low
        $x_1_4 = "\\eiolohon  otify\\" ascii //weight: 1
        $x_1_5 = {72 6f 6c 78 65 74 30 30 31 5c ?? 65 72 76 69 63 65 73 5c 58 68 61 72 ?? ?? ?? 63 63 65 73 73 5c}  //weight: 1, accuracy: Low
        $x_1_6 = {2e 6e 65 74 00 10 00 00 78 31 2e}  //weight: 1, accuracy: Low
        $x_1_7 = {00 6e 61 63 6c 65 64 3a 00}  //weight: 1, accuracy: High
        $x_1_8 = {6e 73 31 2e [0-16] 2e (6d 65 2e|6e)}  //weight: 1, accuracy: Low
        $x_1_9 = {6e 73 31 2e [0-16] 2e 63 6f (6d|2e)}  //weight: 1, accuracy: Low
        $x_1_10 = {6e 73 31 2e [0-16] 2e 78 79 7a}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (3 of ($x*))
}

rule __do_exhaustivehstr_rescan_203
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "com.embarcadero.AUTORUN" wide //weight: 1
        $x_1_2 = "The ID below indicates app support for Windows Vista" ascii //weight: 1
        $x_1_3 = "The ID below indicates app support for Windows 10" ascii //weight: 1
        $x_1_4 = "Embarcadero Delphi for Win32 compiler version 35.0" ascii //weight: 1
        $x_1_5 = "Office 2024" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_rescan_204
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {63 00 61 00 63 00 6c 00 73 00 2e 00 65 00 78 00 65 00 20 00 [0-64] 20 00 2f 00 74 00 20 00 2f 00 65 00 20 00 2f 00 63 00 20 00 2f 00 67 00 20 00 75 00 73 00 65 00 72 00 73 00 3a 00 66 00}  //weight: 1, accuracy: Low
        $x_1_2 = {4d 61 69 6c 42 65 65 2e 53 6d 74 70 4d 61 69 6c 00}  //weight: 1, accuracy: High
        $x_1_3 = "@alice.it;@aol.com;@att.net;@badoo.com;@bellsouth.net;" ascii //weight: 1
        $x_1_4 = "/outlook9/specs/welcomemsg/" wide //weight: 1
        $x_1_5 = {61 2e 61 2e 61 37 2e 72 65 73 6f 75 72 63 65 73 00}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_rescan_205
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "2"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "JogaMacroIE" ascii //weight: 1
        $x_1_2 = "JogaMacroChrome" ascii //weight: 1
        $x_1_3 = "JogaStandardIE" ascii //weight: 1
        $x_1_4 = "JogaStandardChrome" ascii //weight: 1
        $x_1_5 = "JogaSupervielleIE" ascii //weight: 1
        $x_1_6 = "JogaSupervielleChrome" ascii //weight: 1
        $x_1_7 = "JogaGaliciaIE" ascii //weight: 1
        $x_1_8 = "JogaGaliciaChrome" ascii //weight: 1
        $x_1_9 = "JogaCredicoopIE" ascii //weight: 1
        $x_1_10 = "JogaCredicoopChrome" ascii //weight: 1
        $x_1_11 = "JogaBBVAChrome" ascii //weight: 1
        $x_1_12 = "JogaBBVAIE" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (2 of ($x*))
}

rule __do_exhaustivehstr_rescan_206
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "2"
        strings_accuracy = "Low"
    strings:
        $x_2_1 = {c1 e9 08 32 d1 88 54 28 ff 8b 06 0f b6 44 28 ff 66 03 f8 66 69 c7 6d ce 66 05 bf 58 8b f8 43 66 ff 0c 24 75}  //weight: 2, accuracy: High
        $x_2_2 = {66 05 bf 58 0b 00 [0-6] 66 69 ?? 6d ce}  //weight: 2, accuracy: Low
        $x_2_3 = "My_M_i_niT_C_PC_lient" ascii //weight: 2
        $x_2_4 = {56 62 42 45 36 6c 35 4f 55 6a 55 4c 45 33 52 4b 43 71 45 55 50 70 67 6f 64 35 48 79 39 63 36 71 68 4e 35 6e 58 75 34 66 43 52 38 65 38 72 49 72 4f 6e 49 6a 62 5a 34 58 7a 33 5a 36 4a 66 71 52 79 64 6e 42 6d 32 43 48 2b 44 62 57 7a 36 48 00 ff ff ff ff 12 00 00 00 57 61 72 6e 4f 6e 5a 6f 6e 65 43 72 6f 73 73 69 6e 67 00 00 ff ff ff ff 12 00 00 00 57 61 72 6e 4f 6e 50 6f 73 74 52 65 64 69 72 65 63 74 00 00}  //weight: 2, accuracy: High
        $x_1_5 = {6e 65 74 73 74 61 74 20 2d 61 20 2d 6e 20 2d 70 20 74 63 70 20 7c 20 66 69 6e 64 73 74 72 20 6c 69 73 74 65 6e 69 6e 67 00}  //weight: 1, accuracy: High
        $x_1_6 = "sexme:" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((2 of ($x_1_*))) or
            ((1 of ($x_2_*))) or
            (all of ($x*))
        )
}

rule __do_exhaustivehstr_rescan_207
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {50 6f 6c 69 63 69 65 73 20 7b [0-1] 0a 09 09 09 09 09 09 4e 6f 52 65 6d 6f 76 65 20 45 78 74 20 7b [0-1] 0a 09 09 09 09 09 09 09 4e 6f 52 65 6d 6f 76 65 20 43 4c 53 49 44 20 7b [0-1] 0a 09 09 09 09 09 09 09 09 76 61 6c 20 27 25 50 4c 55 47 49 4e 5f 43 4c 53 49 44 25 27 20 3d 20 73 20 27 31 27}  //weight: 1, accuracy: Low
        $x_1_2 = "[%p:%p] E timeout inject %d" wide //weight: 1
        $x_1_3 = "mini::ini_section::get: index %d of 0..%d" wide //weight: 1
        $x_1_4 = "[%p:%p] E:%d modify navigation" wide //weight: 1
    condition:
        (filesize < 20MB) and
        (1 of ($x*))
}

rule __do_exhaustivehstr_rescan_208
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {41 49 43 34 00 00 00 00 41 49 43 35 00 00 00 00 41 49 43 36 00 00 00 00 ff ff ff ff 10 00 00 00 25 73 25 73 25 73 25 73 25 73 25 73 25 73 25 73 00 00 00 00 41 49 43 37 00 00 00 00 41 49 43 38 00 00 00 00 41 49 43 39 00 00 00 00 41 49 43 39 2e 6c 6f 6f 70 00}  //weight: 1, accuracy: High
        $x_1_2 = {62 00 00 00 ff ff ff ff 01 00 00 00 69 00 00 00 ff ff ff ff 01 00 00 00 6e 00 00 00 ff ff ff ff 01 00 00 00 2e 00 00 00 ff ff ff ff 01 00 00 00 64 00 00 00 ff ff ff ff 01 00 00 00 61 00 00 00 ff ff ff ff 01 00 00 00 74 00}  //weight: 1, accuracy: High
        $x_1_3 = {25 73 25 73 25 73 25 73 25 73 25 73 25 73 25 73 00 00 00 00 ff ff ff ff 0e 00 00 00 25 73 25 73 25 73 25 73 25 73 25 73 25 73 00 00 55}  //weight: 1, accuracy: High
        $x_1_4 = {25 73 25 73 25 73 25 73 25 73 25 73 25 73 25 73 25 73 25 73 25 73 25 73 00 00 00 00 ff ff ff ff 0a 00 00 00 25 73 25 73 25 73 25 73 25 73 00 00 55}  //weight: 1, accuracy: High
        $x_1_5 = {8b 45 f4 83 78 04 00 0f 86 ?? ?? ?? ?? 33 c0 55 68 ?? ?? ?? ?? 64 ff 30 64 89 20 0f 00 64 89 10 eb 0a e9 ?? ?? ?? ?? e8}  //weight: 1, accuracy: Low
        $x_1_6 = {6a 04 68 00 30 00 00 8b 45 fc 50 6a 00 ff 15 ?? ?? ?? ?? 89 45 f8 33 c0 55 68 ?? ?? ?? ?? 64 ff 30 64 89 20 0f 00 64 89 10 eb 0a e9 ?? ?? ?? ?? e8}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (1 of ($x*))
}

rule __do_exhaustivehstr_rescan_209
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {44 00 65 00 65 00 70 00 20 00 53 00 63 00 61 00 6e 00 00 00 43 00 75 00 73 00 74 00 6f 00 6d 00 20 00 53 00 63 00 61 00 6e 00 00 00}  //weight: 1, accuracy: High
        $x_1_2 = {2e 3f 41 56 5a 53 63 61 6e 46 72 61 6d 65 40 40 00}  //weight: 1, accuracy: High
        $x_1_3 = {2e 3f 41 56 5a 53 63 61 6e 52 65 73 75 6c 74 40 40 00}  //weight: 1, accuracy: High
        $x_1_4 = "Please click \"Auto Adjust\" button to erase all infected file" wide //weight: 1
        $x_1_5 = {47 00 75 00 61 00 72 00 64 00 53 00 6f 00 66 00 74 00 77 00 61 00 72 00 65 00 00 00}  //weight: 1, accuracy: High
        $x_1_6 = {71 00 77 00 65 00 61 00 73 00 64 00 66 00 67 00 68 00 00 00}  //weight: 1, accuracy: High
        $x_1_7 = {5c 70 72 6f 74 65 63 74 25 73 2e 65 78 65 00}  //weight: 1, accuracy: High
        $x_1_8 = {6e 67 6c 69 63 68 6b 65 69 74 2d 4d 61 6e 61 67 65 72 00}  //weight: 1, accuracy: High
        $x_1_9 = {50 00 6c 00 65 00 61 00 73 00 65 00 20 00 62 00 65 00 20 00 63 00 61 00 72 00 65 00 66 00 75 00 6c 00 20 00 77 00 68 00 69 00 6c 00 65 00 20 00 61 00 64 00 6a 00 75 00 73 00 74 00 69 00 6e 00 67 00 20 00 74 00 68 00 65 00 20 00 73 00 65 00 72 00 76 00 69 00 63 00 65 00 73 00 2e 00 00 00}  //weight: 1, accuracy: High
        $x_1_10 = {50 6a 18 6a 50 6a 16}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (1 of ($x*))
}

rule __do_exhaustivehstr_rescan_210
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = "\\ggg\\build\\Release_32\\libglib-2.0-0.pdb" ascii //weight: 1
        $x_1_2 = "nEldVBXb6WI8hhXhLJEgJ1M3" ascii //weight: 1
        $x_1_3 = {8b 45 d4 30 45 e0 30 65 e1 30 45 e2 30 65 e3 30 45 e4 30 65 e5 30 45 e6 30 65 e7 8d 45 e0 50 e8}  //weight: 1, accuracy: High
        $x_1_4 = {8b c2 8a ca c1 e8 03 80 e1 07 8a 04 30 d2 f8 24 01 88 82 ?? ?? ?? ?? 42 83 fa 40 7c e3}  //weight: 1, accuracy: Low
        $x_1_5 = {51 6a 00 6a 00 6a 14 8d 8d ?? ?? ?? ?? 51 ff b5 ?? ?? ?? ?? ff d0 85 c0 0f 84 ?? ?? ?? ?? b9 ?? ?? ?? ?? e8 ?? ?? ?? ?? 50 51}  //weight: 1, accuracy: Low
        $x_1_6 = {30 45 d8 30 65 d9 30 45 da 30 65 db 30 45 dc 30 65 dd 30 45 de 30 65 df 8d 45 d8 50 e8 03 00 8b 45}  //weight: 1, accuracy: Low
        $x_1_7 = {68 06 02 00 00 50 66 89 84 24 ?? ?? 00 00 8d 84 24 ?? ?? 00 00 50 e8 ?? ?? ?? ?? 83 c4 0c b9 ?? ?? ?? ?? e8 ?? ?? ?? ?? b9 ?? ?? ?? ?? 8b f8 e8 ?? ?? ?? ?? b9 ?? ?? ?? ?? 8b f0 e8 ?? ?? ?? ?? 8d 8c 24 ?? ?? 00 00 51 68 04 01 00 00 8d 8c 24 ?? ?? 00 00 51 57 56 50 ff 15}  //weight: 1, accuracy: Low
        $x_1_8 = {51 6a 00 6a 00 6a 14 8d 8d ?? ?? ?? ?? 51 ff b5 ?? ?? ?? ?? ff d0 85 c0 0f 84 ?? ?? ?? ?? [0-32] b9 ?? ?? ?? ?? e8 ?? ?? ?? ?? b9 ?? ?? ?? ?? 8b f0 e8 ?? ?? ?? ?? 50 56}  //weight: 1, accuracy: Low
        $x_2_9 = {50 6a 00 6a 00 6a 14 8d 85 ?? ?? ?? ?? c7 85 ?? ?? ?? ?? 01 66 00 00 50 ff b5 ?? ?? ?? ?? 66 c7 ?? ?? ?? ?? ff 08 02 c7 85 ?? ?? ?? ?? 08 00 00 00 ff 15 ?? ?? ?? ?? 85 c0 0f 84}  //weight: 2, accuracy: Low
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_1_*))) or
            ((1 of ($x_2_*))) or
            (all of ($x*))
        )
}

rule __do_exhaustivehstr_rescan_211
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {fb c7 44 24 ?? ff ff ff ff c7 44 24 07 00 c7 44 24 ?? ?? 2a}  //weight: 1, accuracy: Low
        $x_1_2 = {83 d1 ff bf ?? ?? ?? ?? 33 c7 89 44 24 20 [0-4] 89 4c 24 24 c7 44 24 18 ?? ?? ?? ?? c7 44 24 1c ff ff ff ff c7 44 24 0c}  //weight: 1, accuracy: Low
        $x_1_3 = {8b 04 81 ff 75 0c 03 45 08 ff d0}  //weight: 1, accuracy: High
        $x_1_4 = {8b 4c 24 20 8b 54 24 24 bf ?? ?? ?? ?? 33 cf be ?? ?? ?? ?? 03 ce 89 4c 24 14}  //weight: 1, accuracy: Low
        $x_1_5 = {8b 44 24 20 8b 4c 24 24 bb ?? ?? ?? ?? 33 c3 05 ?? ?? ?? ?? 89 44 24 (10|20)}  //weight: 1, accuracy: Low
        $x_1_6 = {83 d7 ff 33 f3 83 f7 00 8b c6 05 ?? ?? ?? ?? 8b cf 81 d1 06 00 81 c6}  //weight: 1, accuracy: Low
        $x_1_7 = {8b 44 24 28 8b 4c 24 2c be ?? ?? ?? ?? 33 c6 05 ?? ?? ?? ?? 89 44 24 20}  //weight: 1, accuracy: Low
        $x_1_8 = {8b 45 08 a3 ?? ?? ?? ?? 8b 45 0c a3 ?? ?? ?? ?? 8d 45 04 89 44 24 ?? 8b 44 24 ?? 8b 4c 24 ?? be ?? ?? ?? ?? 33 c6 05}  //weight: 1, accuracy: Low
        $x_1_9 = {8b 44 24 18 8b 4c 24 1c 35 ?? ?? ?? ?? 05 ?? ?? ?? ?? 89 44 24 0c}  //weight: 1, accuracy: Low
        $x_1_10 = {b3 9c 57 05 ?? 18 ce 54}  //weight: 1, accuracy: Low
        $x_1_11 = {8b 44 24 18 8b 4c 24 1c 56 57 35 ?? ?? ?? ?? 05}  //weight: 1, accuracy: Low
        $x_1_12 = {c7 44 24 68 be 0f 00 00 c7 44 24 78 3e 00 00 00}  //weight: 1, accuracy: High
        $x_1_13 = {c1 e8 09 8b 45 9c 8b 4d a4}  //weight: 1, accuracy: High
        $x_1_14 = {c7 44 24 14 ff ff ff ff c7 44 24 (08|18) ?? 03 02 02 02 bb f8 2b fe 05 ff ff c7 44 24 (0c|1c) ff ff ff ff}  //weight: 1, accuracy: Low
        $x_1_15 = {0b c2 2b c1 35 ?? ?? ?? ?? 8b 00}  //weight: 1, accuracy: Low
        $x_1_16 = {0a d0 80 f2 ?? 3a ca 0f 85}  //weight: 1, accuracy: Low
        $x_1_17 = {8b 44 24 20 8b 4c 24 24 35 ?? ?? ?? ?? 05}  //weight: 1, accuracy: Low
        $x_1_18 = {ff ff ff ff c7 44 24 (1c|20) ?? ?? ?? ff c7 44 24 (20|24) ff ff ff ff 13 00 c7 44 24 (20|24)}  //weight: 1, accuracy: Low
        $x_1_19 = {c7 45 fc ff ff ff ff c7 45 f8 ?? ?? ?? ff c7 45 fc ff ff ff ff}  //weight: 1, accuracy: Low
        $x_1_20 = {0f 84 1e 00 00 00 8b 45 f0 8b 75 f4 33 c2 03 c1}  //weight: 1, accuracy: High
        $x_1_21 = {39 02 8b 45 fc 0f 86 36 00 00 00 29 08 e9 31 00 00 00 80 38 00 8b 45 fc 0f 84 23 00 00 00}  //weight: 1, accuracy: High
        $x_1_22 = {ff d0 89 44 24 18 47 81 ff 00 10 00 00 0f 82 d8 ff ff ff}  //weight: 1, accuracy: High
        $x_1_23 = {d6 22 00 00 c7 45 fc 00 00 00 00 81 35 ?? ?? ?? ?? 82 1f 00 00 8b 45 fc 81 1d ?? ?? ?? ?? a2 68 00 00}  //weight: 1, accuracy: Low
        $x_1_24 = {48 75 73 73 2e 63 6f 6d 00 3f 54 68 72 65 61 64 41 40 40 59 47 58 4b 40 5a}  //weight: 1, accuracy: High
        $x_1_25 = {66 03 c2 66 8b 55 ?? 66 33 c1 66 3b d0 0f 82}  //weight: 1, accuracy: Low
        $x_1_26 = {02 d0 8a c2 2a c1 (04|2c) ?? 00 45}  //weight: 1, accuracy: Low
        $x_1_27 = {5f 5b 3b c1 0f 85 17 00 00 00 3b f2 0f 85 0f 00 00 00 a1 ?? ?? ?? ?? 8b 4d 10 89 01 e9 16 00 00 00}  //weight: 1, accuracy: Low
        $x_1_28 = {2a ca 32 c1 8a 4c 24 ?? 34 ?? 3a c8}  //weight: 1, accuracy: Low
        $x_1_29 = {8b 5d 08 02 45 0c 2a c2 8b 55 ?? 2c ?? 88 04 1a}  //weight: 1, accuracy: Low
        $x_1_30 = {d2 e2 0f b6 4c 24 ?? f6 ea 3a c8}  //weight: 1, accuracy: Low
        $x_1_31 = {66 8b 4c 24 10 66 c1 e0 ?? 66 2b c6 66 3b c8}  //weight: 1, accuracy: Low
        $x_1_32 = {d2 e2 8a 4c 24 ?? 22 c2 34 ?? 3a c8}  //weight: 1, accuracy: Low
        $x_1_33 = {d2 e0 8a 4c 24 ?? ?? ?? 04 ?? 3a c8}  //weight: 1, accuracy: Low
        $x_1_34 = {0f b7 c0 99 f7 f9 66 8b 44 24 ?? 33 d7 66 3b c2}  //weight: 1, accuracy: Low
        $x_1_35 = {32 c1 8a 4c 24 ?? 2c ?? 3a c8}  //weight: 1, accuracy: Low
        $x_1_36 = {f6 e9 8a 4c 24 ?? 2c ?? 3a c8}  //weight: 1, accuracy: Low
        $x_1_37 = {99 f7 f9 8a 44 24 ?? 80 f2 4b 3a c2}  //weight: 1, accuracy: Low
        $x_1_38 = {8a 4c 24 10 0c ?? 04 ?? 3a}  //weight: 1, accuracy: Low
        $x_1_39 = {66 0b c2 66 8b 54 24 ?? 66 33 c1 66 3b d0}  //weight: 1, accuracy: Low
        $x_1_40 = {02 c1 8a 4c 24 ?? 04 ?? 3a c8}  //weight: 1, accuracy: Low
        $x_1_41 = {99 f7 fb 0f b7 54 24 ?? 0f b7 c0 03 d0}  //weight: 1, accuracy: Low
        $x_1_42 = {02 d0 8a c2 2a c1 2c ?? 00 45 ff}  //weight: 1, accuracy: Low
        $x_1_43 = {f7 f9 8a 4c 24 ?? [0-3] 34 ?? 3a c8}  //weight: 1, accuracy: Low
        $x_1_44 = {66 23 c2 66 2b c6 66 3b c8}  //weight: 1, accuracy: High
        $x_1_45 = {66 2b c7 66 33 c6 66 3b c8}  //weight: 1, accuracy: High
        $x_1_46 = {33 d0 89 54 24 ?? 8b 54 24 ?? 2b d1 33 d0}  //weight: 1, accuracy: Low
        $x_1_47 = {8a 4c 24 13 f6 ea 34 ?? 3a c8}  //weight: 1, accuracy: Low
        $x_1_48 = {33 c8 88 4c 24 ?? 8b 44 24 ?? 33 c6 03 c3}  //weight: 1, accuracy: Low
        $x_1_49 = {8a 55 ff 24 ?? 2c ?? 3a d0}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (1 of ($x*))
}

rule __do_exhaustivehstr_rescan_212
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_rescan"
        threat_id = "1879049102"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {00 02 00 00 8d 85 ?? ?? ff ff 50 8d 85 ?? ?? ff ff 50 ff 15 ?? ?? ?? ?? 8d 85 ?? ?? ff ff b9 ?? ?? ?? ?? 50 e8 ?? ?? ?? ?? 50 8d 85 ?? ?? ff ff 68 00 02 00 00 50 e8 ?? ?? ?? ?? 83 c4 10 [0-16] 8d 85 ?? ?? ff ff 50 03 02 02 02 56 56 57 57 53 53 ff 15 ?? ?? ?? ?? ff 15}  //weight: 1, accuracy: Low
        $x_1_2 = {8a 4c 17 0c 8b c2 83 e0 03 32 4c 38 04 32 0c 38 88 0c 1a 42 3b d6 72 e8 8d 45 ?? 50 e8}  //weight: 1, accuracy: Low
        $x_1_3 = {80 38 30 0f 85 ?? ?? ?? ?? 0f b6 40 01 84 c0 0f 85 ?? ?? ?? ?? 8b de b9 ?? ?? ?? ?? 89 9d ?? ?? ?? ?? e8}  //weight: 1, accuracy: Low
        $x_1_4 = {68 3c 01 00 00 0f 42 d8 c7 85 ?? ?? ?? ?? 00 00 00 00 8d 85 ?? ?? ?? ?? 6a 00 50 e8 ?? ?? ?? ?? 83 c4 0c c7 85 ?? ?? ?? ?? 00 00 00 00 8d 85 ?? ?? ?? ?? 50 ff 15 ?? ?? ?? ?? 50 ff 15}  //weight: 1, accuracy: Low
        $x_1_5 = {68 00 00 00 f0 6a 01 68 ?? ?? ?? ?? 6a 00 8d 8d ?? ?? ?? ?? 51 ff d0 85 c0 0f 84 ?? ?? ?? ?? 68 ff 01 00 00}  //weight: 1, accuracy: Low
        $x_1_6 = {6a 00 51 57 56 53 ff d0 8d 44 24 ?? c7 44 24 ?? 00 00 00 00 8d 1c 3e c7 44 24 ?? 00 00 00 00 50 8d 54 24 ?? 8b cb e8}  //weight: 1, accuracy: Low
        $x_1_7 = {00 02 00 00 8d 85 ?? ?? ?? ?? 50 8d 85 ?? ?? ?? ?? 50 ff 15 ?? ?? ?? ?? 8d 85 ?? ?? ?? ?? b9 ?? ?? ?? ?? 50 e8 ?? ?? ?? ?? 50 8d 85 ?? ?? ?? ?? 68 00 02 00 00 50 e8 ?? ?? ?? ?? 68 ff 02 00 00 8d 85 ?? ?? ?? ?? c6 85 ?? ?? ?? ?? 00 57 50 e8 ?? ?? ?? ?? 83 c4 1c 8d 85 ?? ?? ?? ?? 57 50 68 ?? ?? ?? ?? ff 15 ?? ?? ?? ?? 8d 85 ?? ?? ?? ?? 50 57 57 ff 15 ?? ?? ?? ?? ff 15}  //weight: 1, accuracy: Low
        $x_1_8 = {00 02 00 00 8d 85 ?? ?? ?? ?? 50 8d 85 ?? ?? ?? ?? 50 ff 15 ?? ?? ?? ?? 8d 85 ?? ?? ?? ?? b9 ?? ?? ?? ?? 50 e8 ?? ?? ?? ?? 50 8d 85 ?? ?? ?? ?? 68 00 02 00 00 50 e8 ?? ?? ?? ?? 83 c4 10 ff 15 ?? ?? ?? ?? b9 ?? ?? ?? ?? e8 ?? ?? ?? ?? b9 ?? ?? ?? ?? 8b f0 e8}  //weight: 1, accuracy: Low
        $x_1_9 = {00 02 00 00 8d 44 24 ?? 50 8d 44 24 ?? 50 ff 15 ?? ?? ?? ?? 8d 44 24 ?? b9 ?? ?? ?? ?? 50 e8 ?? ?? ?? ?? 50 8d 84 24 ?? ?? ?? ?? 68 00 02 00 00 50 e8 ?? ?? ?? ?? 83 c4 10 8d 84 24 ?? ?? ?? ?? 50 57 57 ff 15 ?? ?? ?? ?? ff 15}  //weight: 1, accuracy: Low
        $x_1_10 = {8b 06 8b 4e 04 6a 00 6a 00 8b 40 28 51 03 c1 ff d0 83 7e 08 00 74 ?? 57 33 ff 39 7e 0c}  //weight: 1, accuracy: Low
        $x_1_11 = {66 8b 04 57 8b 7d ?? 66 83 f0 ?? 66 3b 07 8b 7d ?? 75 10 8d 46 ff 3b d0 74 1e 83 45 ?? 02 42 3b d6 7c dd 33 d2 ff 45 ?? 81 c1 ?? ?? ?? ?? 81 f9 ?? ?? ?? ?? 7c}  //weight: 1, accuracy: Low
        $x_1_12 = {6a 01 6a 26 50 (53|57) ff 15 ?? ?? ?? ?? 6a 08 5a 8d 4c 24 ?? e8 ?? ?? ?? ?? [0-8] c6 84 24 ?? ?? ?? ?? 0e 83 78 14 08 72 ?? 8b 00}  //weight: 1, accuracy: Low
        $x_1_13 = {8a 54 07 0c 8b c8 83 e1 03 32 54 39 04 32 14 39 88 14 18 40 3b c6 72 e8}  //weight: 1, accuracy: High
        $x_1_14 = {8a 54 06 0c 8b c8 83 e1 03 32 54 31 04 32 14 31 88 14 18 40 3b c7 72 e8}  //weight: 1, accuracy: High
        $x_1_15 = {8b d3 8b c8 e8 ?? ?? ?? ?? 6a 02 6a 00 6a 00 57 ff d0 eb 06 8d 9b 00 00 00 00 68 00 20 00 00 8d 85 ?? ?? ?? ?? 6a 00 50 e8}  //weight: 1, accuracy: Low
        $x_1_16 = {68 03 80 00 00 89 5d ?? ff 15 ?? ?? ?? ?? 83 ec 0c 8b ce e8 ?? ?? ?? ?? 8b 4d ?? 89 87 ?? ?? ?? ?? 85 c9 75 0c b9 ?? ?? ?? ?? e8}  //weight: 1, accuracy: Low
        $x_1_17 = "..\\public\\shortcuts\\shortcuts_manager.cc" ascii //weight: 1
        $x_1_18 = {68 00 00 20 00 6a 00 50 e8 ?? ?? ?? ?? 8b 4c 24 ?? 8d 44 24 ?? 83 c4 0c 8b d6 50 e8 ?? ?? ?? ?? 8b 4c 24 ?? 83 c4 04 e8 ?? ?? ?? ?? 8b f0 85 f6 (74 ??|0f 84 ?? ?? ?? ??) b9 ?? ?? ?? ?? e8 ?? ?? ?? ?? 8b d0 8b ce e8 ?? ?? ?? ?? 85 c0 74 0c 6a 00 ff d0}  //weight: 1, accuracy: Low
        $x_1_19 = {8b 73 08 33 73 04 33 33 56 e8 ?? ?? ?? ?? 8b f8 8b d6 53 8b cf e8}  //weight: 1, accuracy: Low
        $x_1_20 = {81 3a 2f 00 69 00 74 0b 46 8d 14 71 66 39 02 75 ef eb 05 e8}  //weight: 1, accuracy: High
        $x_1_21 = {8b ca 81 e1 03 00 00 80 79 05 49 83 c9 fc 41 8a 44 17 0c 32 44 39 04 32 04 39 88 04 1a 42 3b d6 7c de}  //weight: 1, accuracy: High
        $x_1_22 = "\\WinSAP\\Release\\WinSAP.pdb" ascii //weight: 1
        $x_1_23 = "\\out\\Release\\extension.pdb" ascii //weight: 1
        $x_1_24 = {54 00 6f 00 6f 00 6c 00 65 00 61 00 74 00 00 00}  //weight: 1, accuracy: High
        $x_1_25 = {68 00 00 20 00 e8 ?? ?? ?? ?? 83 c4 04 89 85 ?? ?? ?? ?? 85 c0 0f 84 ?? ?? ?? ?? 68 00 00 20 00 6a 00 50 e8 ?? ?? ?? ?? 8b 8d ?? ?? ?? ?? 8d 85 ?? ?? ?? ?? 50 8b d6 e8 ?? ?? ?? ?? 8b 8d ?? ?? ?? ?? 83 c4 10 e8 ?? ?? ?? ?? 8b f0 85 f6 0f 84 ?? ?? ?? ?? b9 ?? ?? ?? ?? e8 ?? ?? ?? ?? 8b d0 8b ce e8 ?? ?? ?? ?? 85 c0 74 ?? 6a 00 ff d0}  //weight: 1, accuracy: Low
        $x_1_26 = {8b d6 8b c8 e8 ?? ?? ?? ?? 8d 8d ?? ?? ?? ?? 51 57 57 ff d0 ff 15 ?? ?? ?? ?? 85 c0 b9 01 00 00 00 0f 45 f9}  //weight: 1, accuracy: Low
        $x_1_27 = {8b d6 8b c8 e8 ?? ?? ?? ?? 6a 00 6a 00 6a 00 6a 00 6a 00 ff d0 89 44 24 ?? 85 c0 0f 84 ?? ?? ?? ?? 6a 00 68 00 00 00 04 6a 00 6a 00 53 50 ff 15}  //weight: 1, accuracy: Low
        $x_1_28 = {8b 06 8b 56 04 6a 00 6a 00 8b 40 28 52 03 c2 ff d0 [0-1] 8b ?? 04 85 ?? 74}  //weight: 1, accuracy: Low
        $x_1_29 = {00 52 75 6e 64 6c 6c 33 32 5f 44 6f 00}  //weight: 1, accuracy: High
        $x_1_30 = {76 00 69 00 73 00 69 00 74 00 2e 00 69 00 74 00 68 00 65 00 6d 00 65 00 73 00 2e 00 69 00 6e 00 73 00 74 00 61 00 6c 00 6c 00 00 00}  //weight: 1, accuracy: High
        $x_1_31 = {57 00 69 00 c7 05 ?? ?? ?? ?? 6e 00 53 00 c7 05 ?? ?? ?? ?? 41 00 50 00 c7 05 ?? ?? ?? ?? 53 00 76 00 c7 05 ?? ?? ?? ?? 63 00 00 00 e8 ?? ?? ?? ?? 68 ?? ?? ?? ?? 56 e8}  //weight: 1, accuracy: Low
        $x_1_32 = "Global\\GUID(414F2597-07D2-423B-BF1B-3A8D98BFC3B5)" wide //weight: 1
        $x_1_33 = "%s_ALLOWDEL_%x" wide //weight: 1
        $x_1_34 = {83 7e 14 10 8b 56 10 72 04 8b 06 eb 02 8b c6 83 7e 14 10 72 02 8b 36 6a 00 6a 00 53 57 52 50 56 ff d1 b0 01 eb 02 32 c0}  //weight: 1, accuracy: High
        $x_1_35 = {8d 48 28 8b d6 8b f3 39 19 74 01 46 81 c1 74 02 00 00 4a 75 f2}  //weight: 1, accuracy: High
        $x_1_36 = {83 f8 01 74 05 83 f8 02 74 44 8d 45 f8 50 8d 45 f4 50 6a 00 6a 00 ff d3 83 f8 ff 75 0c 81 7d f8 47 27 00 00 75}  //weight: 1, accuracy: High
        $x_1_37 = {53 6a 26 50 53 ff 15 4f 00 b9 ?? ?? ?? ?? e8 ?? ?? ?? ?? 50 53 53 ff 15 ?? ?? ?? ?? 89 44 24 ?? ff 15 ?? ?? ?? ?? 3d b7 00 00 00 0f 84 ?? ?? ?? ?? 33 c0 68 06 02 00 00 66 89 84 24 ?? ?? ?? ?? 8d 84 24 ?? ?? ?? ?? 53 50 e8}  //weight: 1, accuracy: Low
        $x_1_38 = {84 c0 74 0d e8 ?? ?? ?? ?? 6a 02 59 85 c0 0f 44 f1 8b ce e8 ?? ?? ?? ?? e8 ?? ?? ?? ?? 68 ?? ?? ?? ?? ff 15 ?? ?? ?? ?? b9 ?? ?? ?? ?? e8}  //weight: 1, accuracy: Low
        $x_1_39 = {5c 63 68 6e 73 65 72 76 65 72 2e 70 64 62 00}  //weight: 1, accuracy: High
        $x_1_40 = {44 00 43 00 c7 85 ?? ?? ?? ?? 37 00 34 00 c7 85 ?? ?? ?? ?? 43 00 44 00 c7 85 ?? ?? ?? ?? 35 00 2d 00}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (1 of ($x*))
}

rule __PUA_Block_2345Browser_0
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:2345Browser"
        threat_id = "1879049127"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_3_1 = "Execute 2345Pinyin MiniPage Task" ascii //weight: 3
        $x_2_2 = {50 00 72 00 6f 00 64 00 75 00 63 00 74 00 4e 00 61 00 6d 00 65 00 00 00 00 00 32 00 33 00 34 00 35 00 a0 52 1f 90 4f 6d c8 89 68 56}  //weight: 2, accuracy: High
        $x_2_3 = "2345explorer_light_installer_statistics" wide //weight: 2
        $x_2_4 = "\\LightInstPackage\\bin\\release_static\\LightInstPackage.pdb" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (
            ((2 of ($x_2_*))) or
            ((1 of ($x_3_*) and 1 of ($x_2_*))) or
            (all of ($x*))
        )
}

rule __PUA_Block_2345Browser_1
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:2345Browser"
        threat_id = "1879049127"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "Low"
    strings:
        $x_2_1 = "Execute 2345Pinyin MiniPage Task" ascii //weight: 2
        $x_1_2 = {49 00 6e 00 74 00 65 00 72 00 6e 00 61 00 6c 00 4e 00 61 00 6d 00 65 00 00 00 55 00 70 00 64 00 61 00 74 00 65 00 5f 00 32 00 33 00 34 00 35 00 45 00 78 00 70 00 6c 00 6f 00 72 00 65 00 72 00 2e 00 65 00 78 00 65 00}  //weight: 1, accuracy: High
        $x_1_3 = {75 00 70 00 64 00 61 00 74 00 65 00 5f 00 32 00 33 00 34 00 35 00 [0-16] 2e 00 6e 00 61 00 6d 00 65 00 64 00 5f 00 6d 00 75 00 74 00 65 00 78 00 2e 00 73 00 69 00 67 00 6e 00 61 00 6c 00}  //weight: 1, accuracy: Low
        $x_1_4 = "\\bin\\Win32\\Release\\pdb\\Update_2345Explorer.pdb" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_2_*) and 2 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule __PUA_Block_2345Browser_2
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:2345Browser"
        threat_id = "1879049127"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_3_1 = "Execute 2345Pinyin MiniPage Task" ascii //weight: 3
        $x_2_2 = {50 00 72 00 6f 00 64 00 75 00 63 00 74 00 4e 00 61 00 6d 00 65 00 00 00 00 00 32 00 33 00 34 00 35 00 a0 52 1f 90 4f 6d c8 89 68 56}  //weight: 2, accuracy: High
        $x_2_3 = {50 00 72 00 6f 00 64 00 75 00 63 00 74 00 4e 00 61 00 6d 00 65 00 00 00 00 00 32 00 33 00 34 00 35 00 af 7e c0 51 48 72 a8 63 7f 5e 05 53}  //weight: 2, accuracy: High
        $x_2_4 = "RC::RCSoftwareInstall::InstallPCSafe" wide //weight: 2
        $x_2_5 = "\\pack\\2345pack\\2345pack.jifen.2345explorer_safe\\2345ExplorerSafe\\bin\\release_static\\2345ExplorerSafe.pdb" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (
            ((2 of ($x_2_*))) or
            ((1 of ($x_3_*) and 1 of ($x_2_*))) or
            (all of ($x*))
        )
}

rule __PUA_Block_YandexBundler_0
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:YandexBundler"
        threat_id = "1879049136"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "AzTorrent.exe" ascii //weight: 1
        $x_1_2 = "\\downloader.exe --partner 351895  --distr /quiet /msicl" ascii //weight: 1
        $x_1_3 = "By Installing Yandex Software you help AzTorrent" ascii //weight: 1
        $x_1_4 = "Yandex desktop software" ascii //weight: 1
        $x_1_5 = "Yandex.Browser" ascii //weight: 1
        $x_1_6 = "AzTorrent Torrent File" ascii //weight: 1
        $n_100_7 = "Uninst.exe" ascii //weight: -100
        $n_100_8 = "Uninstall.exe" ascii //weight: -100
    condition:
        (filesize < 20MB) and
        (not (any of ($n*))) and
        (all of ($x*))
}

rule __PUA_Block_CheatEngine_0
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:CheatEngine"
        threat_id = "1879049137"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "cheatengine.org" ascii //weight: 2
        $x_1_2 = "d1zlukw2pqueen.cloudfront" ascii //weight: 1
        $x_1_3 = "Offer" ascii //weight: 1
        $x_1_4 = "opera.exe" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_Qjwmonkey_0
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:Qjwmonkey"
        threat_id = "1879049158"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_4_1 = "Data\\GlobalMgr.db" ascii //weight: 4
        $x_2_2 = "http://cdn.zry97.com/youxi" wide //weight: 2
        $x_1_3 = "DownLoadFrame_splash" wide //weight: 1
        $x_1_4 = "zhudongfangyu.exe" wide //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_4_*) and 2 of ($x_1_*))) or
            ((1 of ($x_4_*) and 1 of ($x_2_*))) or
            (all of ($x*))
        )
}

rule __PUA_Block_Qjwmonkey_1
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:Qjwmonkey"
        threat_id = "1879049158"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "w.nanweng.cn" ascii //weight: 1
        $x_1_2 = "InsDeft.xml" ascii //weight: 1
        $x_1_3 = "E:\\123.pdb" ascii //weight: 1
        $n_100_4 = "Uninst.exe" ascii //weight: -100
        $n_100_5 = "Uninstaller.exe" ascii //weight: -100
        $n_100_6 = "Uninstal.exe" ascii //weight: -100
    condition:
        (filesize < 20MB) and
        (not (any of ($n*))) and
        (all of ($x*))
}

rule __PUA_Block_Qjwmonkey_2
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:Qjwmonkey"
        threat_id = "1879049158"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "sjq.fss8.cn" ascii //weight: 2
        $x_1_2 = "He Fei Yun Biao Xin Xi Ke Ji You Xian Gong Si" ascii //weight: 1
        $x_1_3 = "/api/task/report" ascii //weight: 1
        $x_1_4 = "MenuPopup" ascii //weight: 1
        $x_1_5 = "http_proxy" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_2_*) and 3 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule __PUA_Block_Qjwmonkey_3
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:Qjwmonkey"
        threat_id = "1879049158"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "@1_360.exe" ascii //weight: 1
        $x_1_2 = "2345Explorer.exe" ascii //weight: 1
        $x_1_3 = "qianying010203.11exe" ascii //weight: 1
        $x_1_4 = "data.goosai.com" wide //weight: 1
        $x_1_5 = "http://cdn.zry97.com/youxi/index_" wide //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_GuaGua_0
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:GuaGua"
        threat_id = "1879049168"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "guagua" ascii //weight: 1
        $x_1_2 = "GuaGua-Service" ascii //weight: 1
        $x_1_3 = "ResideClient.exe" ascii //weight: 1
        $x_1_4 = "ResideClient" ascii //weight: 1
        $n_100_5 = "Uninst.exe" ascii //weight: -100
        $n_100_6 = "Uninstall.exe" ascii //weight: -100
    condition:
        (filesize < 20MB) and
        (not (any of ($n*))) and
        (all of ($x*))
}

rule __PUA_Block_GuaGua_1
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:GuaGua"
        threat_id = "1879049168"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Leba99Dat" ascii //weight: 1
        $x_1_2 = "Leba99.exe" ascii //weight: 1
        $x_1_3 = "leba99 Main Wnd" ascii //weight: 1
        $x_1_4 = "leba99room" ascii //weight: 1
        $x_1_5 = "LEBA99" ascii //weight: 1
        $n_100_6 = "Uninst.exe" ascii //weight: -100
        $n_100_7 = "Uninstall.exe" ascii //weight: -100
    condition:
        (filesize < 20MB) and
        (not (any of ($n*))) and
        (all of ($x*))
}

rule __PUA_Block_GuaGua_2
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:GuaGua"
        threat_id = "1879049168"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "CGuaGuaMsgBoxDlg" ascii //weight: 1
        $x_1_2 = "GuaGuaPath" ascii //weight: 1
        $x_1_3 = "guagua_setup.exe" ascii //weight: 1
        $x_1_4 = "GUAGUAACOUNTID" ascii //weight: 1
        $x_1_5 = "GuaGua.exe" ascii //weight: 1
        $n_100_6 = "Uninst.exe" ascii //weight: -100
        $n_100_7 = "Uninstall.exe" ascii //weight: -100
    condition:
        (filesize < 20MB) and
        (not (any of ($n*))) and
        (all of ($x*))
}

rule __PUA_Block_GuaGua_3
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:GuaGua"
        threat_id = "1879049168"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "pingguo_release" ascii //weight: 1
        $x_1_2 = "pingguo55.exe" ascii //weight: 1
        $x_1_3 = "pingguo55" ascii //weight: 1
        $x_1_4 = "pingguo.exe" ascii //weight: 1
        $x_1_5 = "guagua_dance_setup.exe" ascii //weight: 1
        $n_100_6 = "Uninst.exe" ascii //weight: -100
        $n_100_7 = "Uninstall.exe" ascii //weight: -100
    condition:
        (filesize < 20MB) and
        (not (any of ($n*))) and
        (all of ($x*))
}

rule __PUA_Block_GuaGua_4
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:GuaGua"
        threat_id = "1879049168"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "ResideClient" ascii //weight: 1
        $x_1_2 = "ResideClient Version 1.0" ascii //weight: 1
        $x_1_3 = "ResideClient.exe" ascii //weight: 1
        $x_1_4 = "GuaGua-Service" ascii //weight: 1
        $x_1_5 = "Guagua" ascii //weight: 1
        $n_100_6 = "Uninst.exe" ascii //weight: -100
        $n_100_7 = "Uninstall.exe" ascii //weight: -100
    condition:
        (filesize < 20MB) and
        (not (any of ($n*))) and
        (all of ($x*))
}

rule __PUA_Block_GuaGua_5
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:GuaGua"
        threat_id = "1879049168"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "GuaGua-Service" ascii //weight: 1
        $x_1_2 = "sc delete GuaGua-Service" ascii //weight: 1
        $x_1_3 = "net start GuaGua-Service" ascii //weight: 1
        $x_1_4 = "ResideClient.exe" ascii //weight: 1
        $n_100_5 = "Uninst.exe" ascii //weight: -100
        $n_100_6 = "Uninstall.exe" ascii //weight: -100
    condition:
        (filesize < 20MB) and
        (not (any of ($n*))) and
        (all of ($x*))
}

rule __PUA_Block_GuaGua_6
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:GuaGua"
        threat_id = "1879049168"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "LT.ServiceClient" ascii //weight: 1
        $x_1_2 = "LT.ServiceClient.exe" ascii //weight: 1
        $x_1_3 = "LT.ServiceClient.Main.resources" ascii //weight: 1
        $x_1_4 = "LT.ServiceClient.g.resources" ascii //weight: 1
        $n_100_5 = "Uninst.exe" ascii //weight: -100
        $n_100_6 = "Uninstall.exe" ascii //weight: -100
    condition:
        (filesize < 20MB) and
        (not (any of ($n*))) and
        (all of ($x*))
}

rule __PUA_Block_Rostpay_0
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:Rostpay"
        threat_id = "1879049169"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "offer:shown" ascii //weight: 1
        $x_1_2 = "offer:accepted" ascii //weight: 1
        $x_1_3 = "offer:declined" ascii //weight: 1
        $x_1_4 = "brightdata.com" ascii //weight: 1
        $x_1_5 = "ZipSoft.exe" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_Rostpay_1
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:Rostpay"
        threat_id = "1879049169"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "offer:shown" ascii //weight: 1
        $x_1_2 = "offer:accepted" ascii //weight: 1
        $x_1_3 = "offer:declined" ascii //weight: 1
        $x_1_4 = "DriverHub.exe" ascii //weight: 1
        $x_1_5 = "ROSTPAY LTD." ascii //weight: 1
        $x_1_6 = "drvhuboffer" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_Rostpay_2
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:Rostpay"
        threat_id = "1879049169"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "7"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "offer:shown" ascii //weight: 2
        $x_1_2 = "offer:accepted" ascii //weight: 1
        $x_1_3 = "offer:declined" ascii //weight: 1
        $x_1_4 = "Yandex Games" ascii //weight: 1
        $x_1_5 = "SOFTWARE\\Opera Software" ascii //weight: 1
        $x_1_6 = "SOFTWARE\\AVAST" ascii //weight: 1
        $x_1_7 = "/silent /run" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_2_*) and 5 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule __PUA_Block_Rostpay_3
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:Rostpay"
        threat_id = "1879049169"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "13"
        strings_accuracy = "High"
    strings:
        $x_5_1 = "ROSTPAY LTD" ascii //weight: 5
        $x_3_2 = "DriverHub.exe" ascii //weight: 3
        $x_2_3 = "cs_aff=drvhuboffer" ascii //weight: 2
        $x_1_4 = "offer:shown" ascii //weight: 1
        $x_1_5 = "offer:accepted" ascii //weight: 1
        $x_1_6 = "offer:declined" ascii //weight: 1
        $x_1_7 = "OperaGXDownloader.exe" ascii //weight: 1
        $x_1_8 = "AvastDownloader.exe" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_5_*) and 1 of ($x_3_*) and 5 of ($x_1_*))) or
            ((1 of ($x_5_*) and 1 of ($x_3_*) and 1 of ($x_2_*) and 3 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule __PUA_Block_Rostpay_4
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:Rostpay"
        threat_id = "1879049169"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "8"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "pr.install" ascii //weight: 1
        $x_1_2 = "pr.download" ascii //weight: 1
        $x_1_3 = "pr.prepare" ascii //weight: 1
        $x_1_4 = "pr.complete" ascii //weight: 1
        $x_1_5 = "ProxymaData" ascii //weight: 1
        $x_1_6 = "DllHelperInstaller" ascii //weight: 1
        $x_1_7 = "ShowNextOffer" ascii //weight: 1
        $x_1_8 = "DllHelper.exe" ascii //weight: 1
        $n_100_9 = "Uninst.exe" ascii //weight: -100
        $n_100_10 = "Uninstall.exe" ascii //weight: -100
    condition:
        (filesize < 20MB) and
        (not (any of ($n*))) and
        (all of ($x*))
}

rule __PUA_Block_Rostpay_5
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:Rostpay"
        threat_id = "1879049169"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "8"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "offer:shown" ascii //weight: 1
        $x_1_2 = "offer:accepted" ascii //weight: 1
        $x_1_3 = "offer:declined" ascii //weight: 1
        $x_1_4 = "yandex.ru" ascii //weight: 1
        $x_1_5 = "AvastPersistentStorage" ascii //weight: 1
        $x_1_6 = "Avast Antivirus" ascii //weight: 1
        $x_1_7 = "Wargaming.net\\GameCenter\\appMain" ascii //weight: 1
        $x_1_8 = "DriverHubInstaller.exe" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_Rostpay_6
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:Rostpay"
        threat_id = "1879049169"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "8"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "api.az-partners.net/apps/zipsoft-2/offers" ascii //weight: 1
        $x_1_2 = "api.az-partners.net/apps/zipsoft/offers" ascii //weight: 1
        $x_1_3 = "zipsoft.ru/info/my_soft_autofill" ascii //weight: 1
        $x_1_4 = "Offer_in_soft_accepted" ascii //weight: 1
        $x_1_5 = "Offer_in_soft_declined" ascii //weight: 1
        $x_1_6 = "get_Offer" ascii //weight: 1
        $x_1_7 = "InstallOffer" ascii //weight: 1
        $x_1_8 = "PreOfferInstalled" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_Rostpay_7
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:Rostpay"
        threat_id = "1879049169"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "9"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "api.az-partners.net" ascii //weight: 1
        $x_1_2 = "offer:shown" ascii //weight: 1
        $x_1_3 = "offer:accepted" ascii //weight: 1
        $x_1_4 = "offer:declined" ascii //weight: 1
        $x_1_5 = "/silent /run" ascii //weight: 1
        $x_1_6 = "Yandex\\YandexBrowser" ascii //weight: 1
        $x_1_7 = "\\Uninstall\\Avast Antivirus" ascii //weight: 1
        $x_1_8 = "OperaDownloader.exe" ascii //weight: 1
        $x_1_9 = "Wargaming.net\\GameCenter\\appMain" ascii //weight: 1
        $x_1_10 = "DriverHubInstaller.exe" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (9 of ($x*))
}

rule __PUA_Block_InboxToolbar_0
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:InboxToolbar"
        threat_id = "1879049175"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Maps Toolbar Powered by Inbox" ascii //weight: 1
        $x_1_2 = "24x7Help" ascii //weight: 1
        $x_1_3 = "PC Power Speed" ascii //weight: 1
        $x_1_4 = "Online Vault" ascii //weight: 1
        $x_1_5 = "AppGraffiti" ascii //weight: 1
        $n_100_6 = "Uninst.exe" ascii //weight: -100
        $n_100_7 = "Uninstall.exe" ascii //weight: -100
    condition:
        (filesize < 20MB) and
        (not (any of ($n*))) and
        (all of ($x*))
}

rule __PUA_Block_InboxToolbar_1
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:InboxToolbar"
        threat_id = "1879049175"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Inbox EmailNotifier Toolbar" ascii //weight: 1
        $x_1_2 = "24x7Help" ascii //weight: 1
        $x_1_3 = "PC Power Speed" ascii //weight: 1
        $x_1_4 = "Online Vault" ascii //weight: 1
        $x_1_5 = "Get Cash Back with Free RebateInformer" ascii //weight: 1
        $n_100_6 = "Uninst.exe" ascii //weight: -100
        $n_100_7 = "Uninstall.exe" ascii //weight: -100
    condition:
        (filesize < 20MB) and
        (not (any of ($n*))) and
        (all of ($x*))
}

rule __PUA_Block_InboxToolbar_2
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:InboxToolbar"
        threat_id = "1879049175"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Inbox Toolbar" ascii //weight: 1
        $x_1_2 = "Inbox Public Transport Toolbar" ascii //weight: 1
        $x_1_3 = "24x7Help" ascii //weight: 1
        $x_1_4 = "PC Power Speed" ascii //weight: 1
        $x_1_5 = "Get Cash Back with Free RebateInformer" ascii //weight: 1
        $x_1_6 = "AppGraffiti" ascii //weight: 1
        $n_100_7 = "Uninst.exe" ascii //weight: -100
        $n_100_8 = "Uninstall.exe" ascii //weight: -100
    condition:
        (filesize < 20MB) and
        (not (any of ($n*))) and
        (all of ($x*))
}

rule __PUA_Block_Comscore_Bundler_0
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:Comscore_Bundler"
        threat_id = "1879049184"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "rk_setup.exe" ascii //weight: 1
        $x_1_2 = "free-auto-clicker.com" ascii //weight: 1
        $x_1_3 = "securestudies.com" ascii //weight: 1
        $x_1_4 = "FreeAutoClicker" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_Comscore_Bundler_1
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:Comscore_Bundler"
        threat_id = "1879049184"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "pgware.com/downloads/" ascii //weight: 1
        $x_1_2 = "FREERKBANNER" ascii //weight: 1
        $x_1_3 = "RUNRKVERIFY" ascii //weight: 1
        $x_1_4 = "rkinstaller.exe" ascii //weight: 1
        $x_1_5 = "\\PGWARE\\Throttle" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_Comscore_Bundler_2
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:Comscore_Bundler"
        threat_id = "1879049184"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "PremierOpinion" ascii //weight: 1
        $x_1_2 = "installOffer" ascii //weight: 1
        $x_1_3 = "ContentI3.exe" ascii //weight: 1
        $x_1_4 = "SOFTWARE\\InstallUnion" ascii //weight: 1
        $x_1_5 = "dlsft.com/download.php" ascii //weight: 1
        $x_1_6 = "post.securestudies.com" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_Sepdot_0
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:Sepdot"
        threat_id = "1879049198"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "aTube" ascii //weight: 2
        $x_1_2 = "optionalPage" ascii //weight: 1
        $x_1_3 = "DotSetup" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_Sepdot_1
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:Sepdot"
        threat_id = "1879049198"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "dobreprogramy" ascii //weight: 2
        $x_1_2 = "optionalPage" ascii //weight: 1
        $x_1_3 = "DotSetup" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_Sepdot_2
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:Sepdot"
        threat_id = "1879049198"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "d2v0zetgu6hotv.cloudfront.net" ascii //weight: 2
        $x_1_2 = "build/il/v6.75.50.095.57" ascii //weight: 1
        $x_1_3 = "\\PowerISO.chm" ascii //weight: 1
        $x_1_4 = "unknowndll.pdb" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_Sepdot_3
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:Sepdot"
        threat_id = "1879049198"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "DotSetup Installer" ascii //weight: 1
        $x_1_2 = "DotSetupSDK" ascii //weight: 1
        $x_1_3 = "DotSetup.Installation.Packages" ascii //weight: 1
        $x_1_4 = "opera.exe" ascii //weight: 1
        $x_1_5 = "FIREFOX.EXE" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_Sepdot_4
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:Sepdot"
        threat_id = "1879049198"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "7"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "GetChromeexe" ascii //weight: 1
        $x_1_2 = "GetIEExe" ascii //weight: 1
        $x_1_3 = "GetEdgeExe" ascii //weight: 1
        $x_1_4 = "GetOperaEXE" ascii //weight: 1
        $x_1_5 = "GetFirefoxExe" ascii //weight: 1
        $x_2_6 = "Baixaki_Setup.exe" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_Sepdot_5
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:Sepdot"
        threat_id = "1879049198"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "7"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "CoolROM_Setup.exe" ascii //weight: 1
        $x_1_2 = "DotSetupSDK" ascii //weight: 1
        $x_1_3 = "DownloadURL" ascii //weight: 1
        $x_1_4 = "FrmOptionalPage" ascii //weight: 1
        $x_1_5 = "ACCEPT" ascii //weight: 1
        $x_1_6 = "DECLINE" ascii //weight: 1
        $x_1_7 = "SKIP ALL" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_ICBundler_0
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:ICBundler"
        threat_id = "1879049203"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "7"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "OfferInstaller.exe" ascii //weight: 1
        $x_1_2 = "GenericSetup.exe" ascii //weight: 1
        $x_1_3 = "OfferOffline" ascii //weight: 1
        $x_1_4 = "profiles.ini" ascii //weight: 1
        $x_1_5 = "Opera" ascii //weight: 1
        $x_1_6 = "Yandex" ascii //weight: 1
        $x_1_7 = "GetBrowserData" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_ICBundler_1
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:ICBundler"
        threat_id = "1879049203"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "9"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "OfferServiceBLL.Service" ascii //weight: 1
        $x_1_2 = "get_OfferInstallData" ascii //weight: 1
        $x_1_3 = "get_OfferMetadata" ascii //weight: 1
        $x_1_4 = "GetInstantBundleMessageId" ascii //weight: 1
        $x_1_5 = "get_OfferId" ascii //weight: 1
        $x_1_6 = "OfferAccepted" ascii //weight: 1
        $x_1_7 = "<OfferCheckedAppendToDownloadUrl>k__BackingField" ascii //weight: 1
        $x_1_8 = "get_OfferCheckedCommandLine" ascii //weight: 1
        $x_1_9 = "set_AcceptButton" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_Yantai_0
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:Yantai"
        threat_id = "1879049207"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "2"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "SOFTWARE\\kaola" ascii //weight: 1
        $x_1_2 = "tjkaola.sulang.com" ascii //weight: 1
        $x_1_3 = "hao123JuziBrowser\\hao123Juzi.exe" ascii //weight: 1
        $x_1_4 = "SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\kaola" ascii //weight: 1
        $n_100_5 = "lijiuninstall.png" ascii //weight: -100
    condition:
        (filesize < 20MB) and
        (not (any of ($n*))) and
        (2 of ($x*))
}

rule __PUA_Block_WebWatcher_0
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:WebWatcher"
        threat_id = "1879049212"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "WebWatcherMacEULA.rtf" ascii //weight: 1
        $x_1_2 = "@Awareness Technologiesd" ascii //weight: 1
        $x_1_3 = "CAWInstaller: RemoveChromeExtension" ascii //weight: 1
        $x_1_4 = "AWInstaller.pdb" ascii //weight: 1
        $x_1_5 = "data.webwatcherdata.com" ascii //weight: 1
        $x_1_6 = "Release DlpHook\\Proxy.pdb" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (3 of ($x*))
}

rule __PUA_Block_WebWatcher_1
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:WebWatcher"
        threat_id = "1879049212"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "webwatchernow" ascii //weight: 1
        $x_1_2 = "AWInstaller.pdb" ascii //weight: 1
        $x_1_3 = "svc.webwatcherdata.com/v51/Dlp.asmx" ascii //weight: 1
        $x_1_4 = "WebWatcherMacEULA.rtf" ascii //weight: 1
        $x_1_5 = "65b3fde2-0625-4aa9-b153-6777a6b6795a" ascii //weight: 1
        $x_1_6 = "?SendHttpRequest@CProxy@@CAKPBGG0PAPAEPAKPAXK20PAPAPBGHHH@Z" ascii //weight: 1
        $n_100_7 = "Uninst.exe" ascii //weight: -100
        $n_100_8 = "Uninstaller.exe" ascii //weight: -100
        $n_100_9 = "Uninstal.exe" ascii //weight: -100
    condition:
        (filesize < 20MB) and
        (not (any of ($n*))) and
        (all of ($x*))
}

rule __PUA_Block_WebWatcher_2
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:WebWatcher"
        threat_id = "1879049212"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "6"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = "GetUserObjectInformationA" ascii //weight: 1
        $x_1_2 = "GetUserDefaultLCID" ascii //weight: 1
        $x_1_3 = "FireFox Monitor" ascii //weight: 1
        $x_1_4 = {75 00 73 00 65 00 72 00 5f 00 70 00 72 00 65 00 66 00 [0-18] 78 00 70 00 69 00 6e 00 73 00 74 00 61 00 6c 00 6c 00 2e 00 73 00 69 00 67 00 6e 00 61 00 74 00 75 00 72 00 65 00 73 00 2e 00 72 00 65 00 71 00 75 00 69 00 72 00 65 00 64 00}  //weight: 1, accuracy: Low
        $x_1_5 = {75 73 65 72 5f 70 72 65 66 [0-18] 78 70 69 6e 73 74 61 6c 6c 2e 73 69 67 6e 61 74 75 72 65 73 2e 72 65 71 75 69 72 65 64}  //weight: 1, accuracy: Low
        $x_1_6 = {75 00 73 00 65 00 72 00 5f 00 70 00 72 00 65 00 66 00 [0-18] 65 00 78 00 74 00 65 00 6e 00 73 00 69 00 6f 00 6e 00 73 00 2e 00 62 00 6f 00 6f 00 74 00 73 00 74 00 72 00 61 00 70 00 70 00 65 00 64 00 41 00 64 00 64 00 6f 00 6e 00 73 00}  //weight: 1, accuracy: Low
        $x_1_7 = {75 73 65 72 5f 70 72 65 66 [0-18] 65 78 74 65 6e 73 69 6f 6e 73 2e 62 6f 6f 74 73 74 72 61 70 70 65 64 41 64 64 6f 6e 73}  //weight: 1, accuracy: Low
        $x_1_8 = "Records all websites visited and captures Hotmail, Yahoo! Mail" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (6 of ($x*))
}

rule __PUA_Block_InstallBrain_0
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:InstallBrain"
        threat_id = "1879049218"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "7"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "get_component_url" ascii //weight: 1
        $x_1_2 = "is_component_offered" ascii //weight: 1
        $x_1_3 = "is_component_accepted" ascii //weight: 1
        $x_1_4 = "is_component_installed" ascii //weight: 1
        $x_1_5 = "get_count_offer_pages" ascii //weight: 1
        $x_1_6 = "page_offer" ascii //weight: 1
        $x_1_7 = "set_component_crypted" ascii //weight: 1
        $x_1_8 = "decrypt_component_file" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (7 of ($x*))
}

rule __PUA_Block_PassShow_0
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:PassShow"
        threat_id = "1879049254"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "2"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Usage: ophcrack" ascii //weight: 1
        $x_1_2 = "Cracks Windows passwords with Rainbow tables" ascii //weight: 1
        $x_1_3 = "reading the SAM file" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (2 of ($x*))
}

rule __PUA_Block_PassShow_1
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:PassShow"
        threat_id = "1879049254"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "abe2869f-9b47-4cd9-a358-c22904dba7f7" wide //weight: 1
        $x_1_2 = "KeePass csv file" wide //weight: 1
        $x_1_3 = "WebBrowserPassView" wide //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_PassShow_2
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:PassShow"
        threat_id = "1879049254"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "32"
        strings_accuracy = "High"
    strings:
        $x_5_1 = "WebBrowserPassView.pdb" ascii //weight: 5
        $x_5_2 = "020202020202020202020202020202020202020.pdb" ascii //weight: 5
        $x_20_3 = "WebBrowserPassView.exe" wide //weight: 20
        $x_2_4 = "Opera\\Opera7\\profile\\wand.dat" wide //weight: 2
        $x_2_5 = "Opera Software\\Opera Stable\\Login Data" wide //weight: 2
        $x_2_6 = "YandexBrowser\\User Data\\Default\\Login Data" ascii //weight: 2
        $x_2_7 = "Google\\Chrome\\User Data" ascii //weight: 2
        $x_1_8 = "LoadPasswordsIE" wide //weight: 1
        $x_1_9 = "LoadPasswordsFirefox" wide //weight: 1
        $x_1_10 = "LoadPasswordsChrome" wide //weight: 1
        $x_1_11 = "LoadPasswordsOpera" wide //weight: 1
        $x_1_12 = "LoadPasswordsSafari" wide //weight: 1
        $x_1_13 = "LoadPasswordsSeaMonkey" wide //weight: 1
        $x_1_14 = "LoadPasswordsYandex" wide //weight: 1
        $x_1_15 = "LoadPasswordsVivaldi" wide //weight: 1
        $x_1_16 = "UseFirefoxProfileFolder" wide //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_20_*) and 2 of ($x_2_*) and 8 of ($x_1_*))) or
            ((1 of ($x_20_*) and 3 of ($x_2_*) and 6 of ($x_1_*))) or
            ((1 of ($x_20_*) and 4 of ($x_2_*) and 4 of ($x_1_*))) or
            ((1 of ($x_20_*) and 1 of ($x_5_*) and 7 of ($x_1_*))) or
            ((1 of ($x_20_*) and 1 of ($x_5_*) and 1 of ($x_2_*) and 5 of ($x_1_*))) or
            ((1 of ($x_20_*) and 1 of ($x_5_*) and 2 of ($x_2_*) and 3 of ($x_1_*))) or
            ((1 of ($x_20_*) and 1 of ($x_5_*) and 3 of ($x_2_*) and 1 of ($x_1_*))) or
            ((1 of ($x_20_*) and 1 of ($x_5_*) and 4 of ($x_2_*))) or
            ((1 of ($x_20_*) and 2 of ($x_5_*) and 2 of ($x_1_*))) or
            ((1 of ($x_20_*) and 2 of ($x_5_*) and 1 of ($x_2_*))) or
            (all of ($x*))
        )
}

rule __PUA_Block_PassShow_3
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:PassShow"
        threat_id = "1879049254"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "26"
        strings_accuracy = "High"
    strings:
        $x_20_1 = "WebBrowserPassView" ascii //weight: 20
        $x_5_2 = "WebBrowserPassView.pdb" ascii //weight: 5
        $x_1_3 = "LoadPasswordsIE" wide //weight: 1
        $x_1_4 = "LoadPasswordsFirefox" wide //weight: 1
        $x_1_5 = "LoadPasswordsChrome" wide //weight: 1
        $x_1_6 = "LoadPasswordsOpera" wide //weight: 1
        $x_1_7 = "LoadPasswordsSafari" wide //weight: 1
        $x_1_8 = "LoadPasswordsSeaMonkey" wide //weight: 1
        $x_1_9 = "LoadPasswordsYandex" wide //weight: 1
        $x_1_10 = "LoadPasswordsVivaldi" wide //weight: 1
        $x_1_11 = "UseFirefoxProfileFolder" wide //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_20_*) and 6 of ($x_1_*))) or
            ((1 of ($x_20_*) and 1 of ($x_5_*) and 1 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule __PUA_Block_BitComet_0
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:BitComet"
        threat_id = "1879049256"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "bitcomet.com/en/privacy-policy" wide //weight: 1
        $x_1_2 = "/tmp/bitcomet-ipc-connection" wide //weight: 1
        $x_1_3 = "BitComet.exe" wide //weight: 1
        $x_1_4 = "IDR_DLL_BITCOMET_RES" wide //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_FileZilla_BundleInstaller_0
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:FileZilla_BundleInstaller"
        threat_id = "1879049276"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "https://offers.filezilla-project.org/offer.php?v=" wide //weight: 1
        $x_1_2 = "Please consider this optional offer" wide //weight: 1
        $x_1_3 = "Software\\FileZilla Client" wide //weight: 1
        $x_1_4 = {43 00 6f 00 6d 00 70 00 61 00 6e 00 79 00 4e 00 61 00 6d 00 65 00 00 00 00 00 54 00 69 00 6d 00 20 00 4b 00 6f 00 73 00 73 00 65 00}  //weight: 1, accuracy: High
        $x_1_5 = {46 00 69 00 6c 00 65 00 44 00 65 00 73 00 63 00 72 00 69 00 70 00 74 00 69 00 6f 00 6e 00 00 00 00 00 46 00 69 00 6c 00 65 00 5a 00 69 00 6c 00 6c 00 61 00 20 00 46 00 54 00 50 00 20 00 43 00 6c 00 69 00 65 00 6e 00 74 00}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_FileZilla_BundleInstaller_1
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:FileZilla_BundleInstaller"
        threat_id = "1879049276"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "FileZilla_3.63.2_win32-setup.exe" ascii //weight: 1
        $x_1_2 = "filezilla-project.org/download" ascii //weight: 1
        $x_1_3 = "Tim Kosse" ascii //weight: 1
        $x_1_4 = "FileZilla FTP Client" ascii //weight: 1
        $x_1_5 = "offer-enabled installer" ascii //weight: 1
        $x_1_6 = "PlayaNext LLC" ascii //weight: 1
        $x_1_7 = "playanext.com" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (6 of ($x*))
}

rule __PUA_Block_PornTool_0
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:PornTool"
        threat_id = "1879049277"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "By  Sex8.CC" ascii //weight: 1
        $x_1_2 = "1room.cc" ascii //weight: 1
        $x_2_3 = "yogaseba.com" ascii //weight: 2
        $x_1_4 = "ToolBars" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_2_*) and 2 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule __PUA_Block_PornTool_1
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:PornTool"
        threat_id = "1879049277"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Sex8.CC" ascii //weight: 1
        $x_1_2 = "Browser_Control" ascii //weight: 1
        $x_1_3 = "CWebBrowser2" ascii //weight: 1
        $x_1_4 = "1room.cc" ascii //weight: 1
        $x_1_5 = "yogaseba.com" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_PornTool_2
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:PornTool"
        threat_id = "1879049277"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "download.re58.cn" ascii //weight: 1
        $x_1_2 = "d.re71.cn" ascii //weight: 1
        $x_1_3 = "cj.guagua.cn" ascii //weight: 1
        $x_1_4 = "guagua_dance_setup.exe" ascii //weight: 1
        $x_1_5 = "GirlShow.exe" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_PornTool_3
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:PornTool"
        threat_id = "1879049277"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "GetActiveWindow" ascii //weight: 1
        $x_1_2 = "GetUserObjectInformationA" ascii //weight: 1
        $x_1_3 = "Sex8.CC" ascii //weight: 1
        $x_1_4 = "Browser_Control" ascii //weight: 1
        $x_1_5 = "CWebBrowser2" ascii //weight: 1
        $x_1_6 = "url8.cc" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_PornTool_4
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:PornTool"
        threat_id = "1879049277"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "cjtype" ascii //weight: 1
        $x_1_2 = "showproduct" ascii //weight: 1
        $x_1_3 = "mobileconnect" ascii //weight: 1
        $x_1_4 = "guagua.cn" ascii //weight: 1
        $x_1_5 = "ResideClient.exe" ascii //weight: 1
        $n_100_6 = "Uninst.exe" ascii //weight: -100
        $n_100_7 = "Uninstall.exe" ascii //weight: -100
    condition:
        (filesize < 20MB) and
        (not (any of ($n*))) and
        (all of ($x*))
}

rule __Exploit_Java_PrevalentPattern_0
{
    meta:
        author = "defender2yara"
        detection_name = "!#Exploit:Java/PrevalentPattern"
        threat_id = "1879049307"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "153615BC3ABB59B73A123612361515A0" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __Exploit_Java_PrevalentPattern_1
{
    meta:
        author = "defender2yara"
        detection_name = "!#Exploit:Java/PrevalentPattern"
        threat_id = "1879049307"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "124CBB592AB7B6B64B2A2B12B64B2AB8B0" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __Exploit_Java_PrevalentPattern_2
{
    meta:
        author = "defender2yara"
        detection_name = "!#Exploit:Java/PrevalentPattern"
        threat_id = "1879049307"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "1536190332B6B6B8B83A123612361515A0" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __Exploit_Java_PrevalentPattern_3
{
    meta:
        author = "defender2yara"
        detection_name = "!#Exploit:Java/PrevalentPattern"
        threat_id = "1879049307"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "1904321903322AB62D2CB82AB62D2CB8A7" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __Exploit_Java_PrevalentPattern_4
{
    meta:
        author = "defender2yara"
        detection_name = "!#Exploit:Java/PrevalentPattern"
        threat_id = "1879049307"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "19B619B6B8BB59B712B8B612B6B6B657A7" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __Exploit_Java_PrevalentPattern_5
{
    meta:
        author = "defender2yara"
        detection_name = "!#Exploit:Java/PrevalentPattern"
        threat_id = "1879049307"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "5911105459111054591110545911105459" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __Exploit_Java_PrevalentPattern_6
{
    meta:
        author = "defender2yara"
        detection_name = "!#Exploit:Java/PrevalentPattern"
        threat_id = "1879049307"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "BB59B719B62D1C32B8046092B6B63A84A7" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __Exploit_Java_PrevalentPattern_7
{
    meta:
        author = "defender2yara"
        detection_name = "!#Exploit:Java/PrevalentPattern"
        threat_id = "1879049307"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "153619B619073203BDB63A123612361515A0" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __Exploit_Java_PrevalentPattern_8
{
    meta:
        author = "defender2yara"
        detection_name = "!#Exploit:Java/PrevalentPattern"
        threat_id = "1879049307"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "153619B619073203BDB63A133613361515A0" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __Exploit_Java_PrevalentPattern_9
{
    meta:
        author = "defender2yara"
        detection_name = "!#Exploit:Java/PrevalentPattern"
        threat_id = "1879049307"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "15362DBB5919B7B63AB83A123612361515A0" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __Exploit_Java_PrevalentPattern_10
{
    meta:
        author = "defender2yara"
        detection_name = "!#Exploit:Java/PrevalentPattern"
        threat_id = "1879049307"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "15362DBB5919B7B63AB83A133613361515A0" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __Exploit_Java_PrevalentPattern_11
{
    meta:
        author = "defender2yara"
        detection_name = "!#Exploit:Java/PrevalentPattern"
        threat_id = "1879049307"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "2A2BB52AB72A12B52A12B52A12B52A2CB5B1" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __Exploit_Java_PrevalentPattern_12
{
    meta:
        author = "defender2yara"
        detection_name = "!#Exploit:Java/PrevalentPattern"
        threat_id = "1879049307"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "2C1D2B051D68051D680560B610B8915484A7" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __Exploit_Java_PrevalentPattern_13
{
    meta:
        author = "defender2yara"
        detection_name = "!#Exploit:Java/PrevalentPattern"
        threat_id = "1879049307"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "59B65FB65B57B65FB6B65AB65F645A3E4D36" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __Exploit_Java_PrevalentPattern_14
{
    meta:
        author = "defender2yara"
        detection_name = "!#Exploit:Java/PrevalentPattern"
        threat_id = "1879049307"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "B215B21533B282B2649154B20460B38415A7" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __Exploit_Java_PrevalentPattern_15
{
    meta:
        author = "defender2yara"
        detection_name = "!#Exploit:Java/PrevalentPattern"
        threat_id = "1879049307"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "BB592AB6BC045958105F59BE04645B3E4C3D" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __Exploit_Java_PrevalentPattern_16
{
    meta:
        author = "defender2yara"
        detection_name = "!#Exploit:Java/PrevalentPattern"
        threat_id = "1879049307"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "15362B2AB63A113615116836123612361515A0" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __Exploit_Java_PrevalentPattern_17
{
    meta:
        author = "defender2yara"
        detection_name = "!#Exploit:Java/PrevalentPattern"
        threat_id = "1879049307"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "2DB83A2A2B190319BEB8B6572A2B04B63A19B0" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __Exploit_Java_PrevalentPattern_18
{
    meta:
        author = "defender2yara"
        detection_name = "!#Exploit:Java/PrevalentPattern"
        threat_id = "1879049307"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "59B719B612B6B63ABB59B719B612B6B63ABB59" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __Exploit_Java_PrevalentPattern_19
{
    meta:
        author = "defender2yara"
        detection_name = "!#Exploit:Java/PrevalentPattern"
        threat_id = "1879049307"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "01B00000000000000000000000000000000000BF" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __Exploit_Java_PrevalentPattern_20
{
    meta:
        author = "defender2yara"
        detection_name = "!#Exploit:Java/PrevalentPattern"
        threat_id = "1879049307"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "04BD4C2B032A53BB5913B82BB74D2CB62CB6C0B0" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __Exploit_Java_PrevalentPattern_21
{
    meta:
        author = "defender2yara"
        detection_name = "!#Exploit:Java/PrevalentPattern"
        threat_id = "1879049307"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "04BD4D2C032B53BB5913122CB74E2DB62DB6C0B0" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __Exploit_Java_PrevalentPattern_22
{
    meta:
        author = "defender2yara"
        detection_name = "!#Exploit:Java/PrevalentPattern"
        threat_id = "1879049307"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "1015B8B83619B8141587B86BB810B8B6578415A7" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __Exploit_Java_PrevalentPattern_23
{
    meta:
        author = "defender2yara"
        detection_name = "!#Exploit:Java/PrevalentPattern"
        threat_id = "1879049307"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "1536190332B8B6033203BDB63A123612361515A0" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __Exploit_Java_PrevalentPattern_24
{
    meta:
        author = "defender2yara"
        detection_name = "!#Exploit:Java/PrevalentPattern"
        threat_id = "1879049307"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "1536190332B8B6033203BDB63A133613361515A0" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __Exploit_Java_PrevalentPattern_25
{
    meta:
        author = "defender2yara"
        detection_name = "!#Exploit:Java/PrevalentPattern"
        threat_id = "1879049307"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "15361904321903322AB61919B8123612361515A0" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __Exploit_Java_PrevalentPattern_26
{
    meta:
        author = "defender2yara"
        detection_name = "!#Exploit:Java/PrevalentPattern"
        threat_id = "1879049307"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "15361904321903322AB61919B8133613361515A0" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __Exploit_Java_PrevalentPattern_27
{
    meta:
        author = "defender2yara"
        detection_name = "!#Exploit:Java/PrevalentPattern"
        threat_id = "1879049307"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "BB59B71919B6046432B612B6B63A19B83A19B6A7" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __Exploit_Java_PrevalentPattern_28
{
    meta:
        author = "defender2yara"
        detection_name = "!#Exploit:Java/PrevalentPattern"
        threat_id = "1879049307"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "2AB72A12B52A12B52A12B52A12B52A12B52A12B5B1" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __Exploit_Java_PrevalentPattern_29
{
    meta:
        author = "defender2yara"
        detection_name = "!#Exploit:Java/PrevalentPattern"
        threat_id = "1879049307"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "2B1D2A1DB61C82925F5A1C8292107E923D55841D9B" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __Exploit_Java_PrevalentPattern_30
{
    meta:
        author = "defender2yara"
        detection_name = "!#Exploit:Java/PrevalentPattern"
        threat_id = "1879049307"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "2B1D2A1DB61C82925F5A1C8292107E923D55841DA7" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __Exploit_Java_PrevalentPattern_31
{
    meta:
        author = "defender2yara"
        detection_name = "!#Exploit:Java/PrevalentPattern"
        threat_id = "1879049307"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "591110545911105459111054591110545911105459" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __Exploit_Java_PrevalentPattern_32
{
    meta:
        author = "defender2yara"
        detection_name = "!#Exploit:Java/PrevalentPattern"
        threat_id = "1879049307"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "BB59B72C19B6046432B612B8B6B63A19B83A19B6A7" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __Exploit_Java_PrevalentPattern_33
{
    meta:
        author = "defender2yara"
        detection_name = "!#Exploit:Java/PrevalentPattern"
        threat_id = "1879049307"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "03135359041353B62A05BD59032B5359042C53B657B1" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __Exploit_Java_PrevalentPattern_34
{
    meta:
        author = "defender2yara"
        detection_name = "!#Exploit:Java/PrevalentPattern"
        threat_id = "1879049307"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "2B1C056C2A1CB610B807782A1C0460B610B860915484" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __Exploit_Java_PrevalentPattern_35
{
    meta:
        author = "defender2yara"
        detection_name = "!#Exploit:Java/PrevalentPattern"
        threat_id = "1879049307"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "B2B8B204BD5903B2B8B853B62AB804BD59032B53B6B0" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __Exploit_Java_PrevalentPattern_36
{
    meta:
        author = "defender2yara"
        detection_name = "!#Exploit:Java/PrevalentPattern"
        threat_id = "1879049307"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "B2B8BB59B2B8B7B2B6B604BD5903B2B8B853B62AB804" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __Exploit_Java_PrevalentPattern_37
{
    meta:
        author = "defender2yara"
        detection_name = "!#Exploit:Java/PrevalentPattern"
        threat_id = "1879049307"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "BB59B7121212121212B6B6B6B6B6B8B6B8B62AB6B6B0" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __Exploit_Java_PrevalentPattern_38
{
    meta:
        author = "defender2yara"
        detection_name = "!#Exploit:Java/PrevalentPattern"
        threat_id = "1879049307"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "C4C4C4B619103204BD59031353B6C413C413C4C4C4A0" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __Exploit_Java_PrevalentPattern_39
{
    meta:
        author = "defender2yara"
        detection_name = "!#Exploit:Java/PrevalentPattern"
        threat_id = "1879049307"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "1136190332B6B6B8B83A19190332B83A192B2CB81510A0" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __Exploit_Java_PrevalentPattern_40
{
    meta:
        author = "defender2yara"
        detection_name = "!#Exploit:Java/PrevalentPattern"
        threat_id = "1879049307"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "2B1C056C2A1C0460B610B807782A1CB610B860915484A7" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __Exploit_Java_PrevalentPattern_41
{
    meta:
        author = "defender2yara"
        detection_name = "!#Exploit:Java/PrevalentPattern"
        threat_id = "1879049307"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "2B1C056C2A1CB610B807782A1C0460B610B860915484A7" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __Exploit_Java_PrevalentPattern_42
{
    meta:
        author = "defender2yara"
        detection_name = "!#Exploit:Java/PrevalentPattern"
        threat_id = "1879049307"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "572C15B65A155A2A5FB6158282925582827E923684159C" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __Exploit_Java_PrevalentPattern_43
{
    meta:
        author = "defender2yara"
        detection_name = "!#Exploit:Java/PrevalentPattern"
        threat_id = "1879049307"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "C4C4191032B8C4191032B8C4191032B8C413C413C4C4C4A0" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __Exploit_Java_PrevalentPattern_44
{
    meta:
        author = "defender2yara"
        detection_name = "!#Exploit:Java/PrevalentPattern"
        threat_id = "1879049307"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "2AB72A12B52A12B52A12B52A12B52A12B52A12B5124C124DB1" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __Exploit_Java_PrevalentPattern_45
{
    meta:
        author = "defender2yara"
        detection_name = "!#Exploit:Java/PrevalentPattern"
        threat_id = "1879049307"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "59111054591110545911105459111054591110545911105459" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __Exploit_Java_PrevalentPattern_46
{
    meta:
        author = "defender2yara"
        detection_name = "!#Exploit:Java/PrevalentPattern"
        threat_id = "1879049307"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "841905BB59B713B8B6191532B613B8B62AB6B653B819B657A7" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __Exploit_Java_PrevalentPattern_47
{
    meta:
        author = "defender2yara"
        detection_name = "!#Exploit:Java/PrevalentPattern"
        threat_id = "1879049307"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "BB59B719B619B619B6B63A1919B632B83ABB5919B73A11BC3A" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __Exploit_Java_PrevalentPattern_48
{
    meta:
        author = "defender2yara"
        detection_name = "!#Exploit:Java/PrevalentPattern"
        threat_id = "1879049307"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "1536191905BD59031910325359041953B6C03A133613361515A0" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __Exploit_Java_PrevalentPattern_49
{
    meta:
        author = "defender2yara"
        detection_name = "!#Exploit:Java/PrevalentPattern"
        threat_id = "1879049307"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "153619B619083205BD5903135359041353B63A133613361515A0" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __Exploit_Java_PrevalentPattern_50
{
    meta:
        author = "defender2yara"
        detection_name = "!#Exploit:Java/PrevalentPattern"
        threat_id = "1879049307"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "190332B6B6B8B83A19190332B83A192B2CB8BB59B7BF3A19B6B1" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __Exploit_Java_PrevalentPattern_51
{
    meta:
        author = "defender2yara"
        detection_name = "!#Exploit:Java/PrevalentPattern"
        threat_id = "1879049307"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "1915BB59B712B8B62A1505681504600568B6B6B6B8B6548415A7" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __Exploit_Java_PrevalentPattern_52
{
    meta:
        author = "defender2yara"
        detection_name = "!#Exploit:Java/PrevalentPattern"
        threat_id = "1879049307"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "C4C4191905BD59031910325359041953B6C0C413C413C4C4C4A0" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __Exploit_Java_PrevalentPattern_53
{
    meta:
        author = "defender2yara"
        detection_name = "!#Exploit:Java/PrevalentPattern"
        threat_id = "1879049307"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "C4C4C419103203BDB6C4C40103BDB6C4C4B6C413C413C4C4C4A0" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __Exploit_Java_PrevalentPattern_54
{
    meta:
        author = "defender2yara"
        detection_name = "!#Exploit:Java/PrevalentPattern"
        threat_id = "1879049307"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "000000000000000000000000B257000000000000000000000000A7" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __Exploit_Java_PrevalentPattern_55
{
    meta:
        author = "defender2yara"
        detection_name = "!#Exploit:Java/PrevalentPattern"
        threat_id = "1879049307"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "133A133A10B83613B8B83615056C3613B8B8B813B8B857B82AB4C7" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __Exploit_Java_PrevalentPattern_56
{
    meta:
        author = "defender2yara"
        detection_name = "!#Exploit:Java/PrevalentPattern"
        threat_id = "1879049307"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "1536191906BD590312535904015359050153B63A123612361515A0" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __Exploit_Java_PrevalentPattern_57
{
    meta:
        author = "defender2yara"
        detection_name = "!#Exploit:Java/PrevalentPattern"
        threat_id = "1879049307"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "1536191906BD590312535904015359050153B657123612361515A0" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __Exploit_Java_PrevalentPattern_58
{
    meta:
        author = "defender2yara"
        detection_name = "!#Exploit:Java/PrevalentPattern"
        threat_id = "1879049307"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "1536191906BD590313535904015359050153B63A133613361515A0" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __Exploit_Java_PrevalentPattern_59
{
    meta:
        author = "defender2yara"
        detection_name = "!#Exploit:Java/PrevalentPattern"
        threat_id = "1879049307"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "1536191906BD590313535904015359050153B657133613361515A0" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __Exploit_Java_PrevalentPattern_60
{
    meta:
        author = "defender2yara"
        detection_name = "!#Exploit:Java/PrevalentPattern"
        threat_id = "1879049307"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "1536B8B8B805BD5903B25359041353B62A19B657123612361515A0" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __Exploit_Java_PrevalentPattern_61
{
    meta:
        author = "defender2yara"
        detection_name = "!#Exploit:Java/PrevalentPattern"
        threat_id = "1879049307"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "1536B8B8B805BD5903B25359041353B62A19B657133613361515A0" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __Exploit_Java_PrevalentPattern_62
{
    meta:
        author = "defender2yara"
        detection_name = "!#Exploit:Java/PrevalentPattern"
        threat_id = "1879049307"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "2B1D1D0860B6B8362CBB5915156C92B7B6B6571D08603E1D2BB6A1" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __Exploit_Java_PrevalentPattern_63
{
    meta:
        author = "defender2yara"
        detection_name = "!#Exploit:Java/PrevalentPattern"
        threat_id = "1879049307"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "2AB6B805BD5903135359041353B62A05BD59032B5359042C53B657B1" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __Exploit_Java_PrevalentPattern_64
{
    meta:
        author = "defender2yara"
        detection_name = "!#Exploit:Java/PrevalentPattern"
        threat_id = "1879049307"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "B22CB6B6BB592CB6B73A1212B6B83A19B63ABB5919B73AB83A15BC3A" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __Exploit_Java_PrevalentPattern_65
{
    meta:
        author = "defender2yara"
        detection_name = "!#Exploit:Java/PrevalentPattern"
        threat_id = "1879049307"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "B83A19B83A190332C0C03A1904321903322AB62D2CB82AB62D2CB8A7" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __Exploit_Java_PrevalentPattern_66
{
    meta:
        author = "defender2yara"
        detection_name = "!#Exploit:Java/PrevalentPattern"
        threat_id = "1879049307"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "014CB82AB8B64DB82AB6B84EB83A19B83A190332C0C03AB8123ABB59B7" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __Exploit_Java_PrevalentPattern_67
{
    meta:
        author = "defender2yara"
        detection_name = "!#Exploit:Java/PrevalentPattern"
        threat_id = "1879049307"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "05BD3A19032B5319042C53BB592A12B71219B73A19B619B6C02D19B6B1" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __Exploit_Java_PrevalentPattern_68
{
    meta:
        author = "defender2yara"
        detection_name = "!#Exploit:Java/PrevalentPattern"
        threat_id = "1879049307"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "2A2A12B62A12B6B6BB592A12B6B74CBB59B74D083E2B031DB6B8361136" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __Exploit_Java_PrevalentPattern_69
{
    meta:
        author = "defender2yara"
        detection_name = "!#Exploit:Java/PrevalentPattern"
        threat_id = "1879049307"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "BB5903010101B73A19BB59B7B6BB591912010101B73A19012D01B657A7" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __Exploit_Java_PrevalentPattern_70
{
    meta:
        author = "defender2yara"
        detection_name = "!#Exploit:Java/PrevalentPattern"
        threat_id = "1879049307"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "153619B619063206BD590313535904195359051953B63A123612361515A0" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __Exploit_Java_PrevalentPattern_71
{
    meta:
        author = "defender2yara"
        detection_name = "!#Exploit:Java/PrevalentPattern"
        threat_id = "1879049307"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "153619B619063206BD590313535904195359051953B63A133613361515A0" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __Exploit_Java_PrevalentPattern_72
{
    meta:
        author = "defender2yara"
        detection_name = "!#Exploit:Java/PrevalentPattern"
        threat_id = "1879049307"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "19B619B619B6BB59B719B619B6B63A19B8193A19B60460B8593A3A1957A7" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __Exploit_Java_PrevalentPattern_73
{
    meta:
        author = "defender2yara"
        detection_name = "!#Exploit:Java/PrevalentPattern"
        threat_id = "1879049307"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "BB59B72AB4B62AB4B62AB4B62AB4B6B604BD59032B53B74D2CB62CB6C0B0" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __Exploit_Java_PrevalentPattern_74
{
    meta:
        author = "defender2yara"
        detection_name = "!#Exploit:Java/PrevalentPattern"
        threat_id = "1879049307"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "10545911105459111054591110545911105459111054591110545911105459" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __Exploit_Java_PrevalentPattern_75
{
    meta:
        author = "defender2yara"
        detection_name = "!#Exploit:Java/PrevalentPattern"
        threat_id = "1879049307"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "12B312B3BB59B7B2B612B6B2B612B6B6B3BB59B7B2B612B6B2B612B6B6B3B1" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __Exploit_Java_PrevalentPattern_76
{
    meta:
        author = "defender2yara"
        detection_name = "!#Exploit:Java/PrevalentPattern"
        threat_id = "1879049307"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "5319B61219B63A04BD3A1903BB59BB59B712B8B612B6B6B753191919B657A7" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __Exploit_Java_PrevalentPattern_77
{
    meta:
        author = "defender2yara"
        detection_name = "!#Exploit:Java/PrevalentPattern"
        threat_id = "1879049307"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "B6B84EB83A19B83A190332C0C03A1904321903322AB62D2CB82AB62D2CB8A7" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __Exploit_Java_PrevalentPattern_78
{
    meta:
        author = "defender2yara"
        detection_name = "!#Exploit:Java/PrevalentPattern"
        threat_id = "1879049307"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "C4C4C419103204BD59031353B6C4C40104BD5903B253B6C413C413C4C4C4A0" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __Exploit_Java_PrevalentPattern_79
{
    meta:
        author = "defender2yara"
        detection_name = "!#Exploit:Java/PrevalentPattern"
        threat_id = "1879049307"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "2A1DB810B8077836152A1D0460B810B860361510641170362B1D056C15915484" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __Exploit_Java_PrevalentPattern_80
{
    meta:
        author = "defender2yara"
        detection_name = "!#Exploit:Java/PrevalentPattern"
        threat_id = "1879049307"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "B84E2A2DB8B83A190332B6B6B8B83A19190332B83A192B2CB8BB59B7BF4E2DB6B1" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __Exploit_Java_PrevalentPattern_81
{
    meta:
        author = "defender2yara"
        detection_name = "!#Exploit:Java/PrevalentPattern"
        threat_id = "1879049307"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "C4C4C4C404BD590306BD5903C453590401535905195353B6C0C413C413C4C4C4A0" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __Exploit_Java_PrevalentPattern_82
{
    meta:
        author = "defender2yara"
        detection_name = "!#Exploit:Java/PrevalentPattern"
        threat_id = "1879049307"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "014CB82AB8B64DB82AB6B84EB83A19B83A190332C0C03AB83AB83A19B8B63A190332" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __Exploit_Java_PrevalentPattern_83
{
    meta:
        author = "defender2yara"
        detection_name = "!#Exploit:Java/PrevalentPattern"
        threat_id = "1879049307"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "5319B61219B63A04BD3A1903BB59BB59B7121212B6B8B612B6B6B753191919B657A7" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __Exploit_Java_PrevalentPattern_84
{
    meta:
        author = "defender2yara"
        detection_name = "!#Exploit:Java/PrevalentPattern"
        threat_id = "1879049307"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "05BD3A190303B85319042CB853B8B8B805BD5903B25359041353B62A19B6572B2D19B8A7" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __Exploit_Java_PrevalentPattern_85
{
    meta:
        author = "defender2yara"
        detection_name = "!#Exploit:Java/PrevalentPattern"
        threat_id = "1879049307"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "15362AB6B805BD5903135359041353B62A05BD59032B5359042C53B657123612361515A0" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __Exploit_Java_PrevalentPattern_86
{
    meta:
        author = "defender2yara"
        detection_name = "!#Exploit:Java/PrevalentPattern"
        threat_id = "1879049307"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "545911105459111054591110545911105459111054591110545911105459111054591110" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __Exploit_Java_PrevalentPattern_87
{
    meta:
        author = "defender2yara"
        detection_name = "!#Exploit:Java/PrevalentPattern"
        threat_id = "1879049307"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "5319B61219B63A04BD3A1903BB59BB59B7121212B6B8B6121212B6B6B6B753191919B657A7" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __Exploit_Java_PrevalentPattern_88
{
    meta:
        author = "defender2yara"
        detection_name = "!#Exploit:Java/PrevalentPattern"
        threat_id = "1879049307"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "C4C4C4C404BD590307BD5903C4535904C4535905191032535906C45353B6C413C413C4C4C4A0" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __Exploit_Java_PrevalentPattern_89
{
    meta:
        author = "defender2yara"
        detection_name = "!#Exploit:Java/PrevalentPattern"
        threat_id = "1879049307"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "5319B61219B63A04BD3A121212B63A1903BB59BB59B719B8B6121212B6B6B6B753191919B657A7" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __Exploit_Java_PrevalentPattern_90
{
    meta:
        author = "defender2yara"
        detection_name = "!#Exploit:Java/PrevalentPattern"
        threat_id = "1879049307"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "C4C4C419103205BD5903135359041353B6C4C40105BD5903C45359041353B6C413C413C4C4C4A0" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __Exploit_Java_PrevalentPattern_91
{
    meta:
        author = "defender2yara"
        detection_name = "!#Exploit:Java/PrevalentPattern"
        threat_id = "1879049307"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "1919033204BD59030153B63A19B6B805BD5903135359041353B61905BD59032B5359042C53B657A7" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __Exploit_Java_PrevalentPattern_92
{
    meta:
        author = "defender2yara"
        detection_name = "!#Exploit:Java/PrevalentPattern"
        threat_id = "1879049307"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "11BC4C033D124EBB59BB59BB59B712B6B62DB6B6B7B6B73ABB59BB59BB59B712B8B612B6B6B711B73A" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __Exploit_Java_PrevalentPattern_93
{
    meta:
        author = "defender2yara"
        detection_name = "!#Exploit:Java/PrevalentPattern"
        threat_id = "1879049307"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "1536B81312B63A1904B61901B6C03AB83A19B8190319BEB63A01191919B8B13A19B6123612361515A0" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __Exploit_Java_PrevalentPattern_94
{
    meta:
        author = "defender2yara"
        detection_name = "!#Exploit:Java/PrevalentPattern"
        threat_id = "1879049307"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "2A122B032BBE2CB63A19B657191205BD5903125359041253B63A190105BD59032D5359041253B657B1" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __Exploit_Java_PrevalentPattern_95
{
    meta:
        author = "defender2yara"
        detection_name = "!#Exploit:Java/PrevalentPattern"
        threat_id = "1879049307"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "B84C2BB84D2CB6C04E2D0432B82D0332C003323A123A2AB2B63A2AB2B63A1919B83A123A191912B8A7" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __Exploit_Java_PrevalentPattern_96
{
    meta:
        author = "defender2yara"
        detection_name = "!#Exploit:Java/PrevalentPattern"
        threat_id = "1879049307"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "043C11BC4D033E123ABB59BB59BB59B712B6B619B6B6B7B6B73ABB59BB59BB59B712B8B612B6B6B711B73A" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __Exploit_Java_PrevalentPattern_97
{
    meta:
        author = "defender2yara"
        detection_name = "!#Exploit:Java/PrevalentPattern"
        threat_id = "1879049307"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "06BD590319B6535904B853590504BD5903135353B6C03A191904BD5903B853B6C03A19B63A012D2C19B8A7" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __Exploit_Java_PrevalentPattern_98
{
    meta:
        author = "defender2yara"
        detection_name = "!#Exploit:Java/PrevalentPattern"
        threat_id = "1879049307"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "073C11BC4D033E123ABB59BB59BB59B712B6B619B6B6B7B6B73ABB59BB59BB59B712B8B612B6B6B711B73A" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __Exploit_Java_PrevalentPattern_99
{
    meta:
        author = "defender2yara"
        detection_name = "!#Exploit:Java/PrevalentPattern"
        threat_id = "1879049307"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "2AB704BD590305BD59032B5359042C53533A04BD3A190313532DB6121212B6B612B619B63A192D19B63AB1" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __Exploit_Java_PrevalentPattern_100
{
    meta:
        author = "defender2yara"
        detection_name = "!#Exploit:Java/PrevalentPattern"
        threat_id = "1879049307"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "B8B52A11B8B52A11B8B52A11B8B52A11B8B52A11B8B52A11B8B52A11B8B52A11B8B52A11B8B52A11B8B5B1" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __Exploit_Java_PrevalentPattern_101
{
    meta:
        author = "defender2yara"
        detection_name = "!#Exploit:Java/PrevalentPattern"
        threat_id = "1879049307"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "2DB6B83ABB5912B73A03BD3ABB59B73A19BB59B7B6BB59BB591919B719B73A2A12190319BE19B63A19B6C03AA7" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __Exploit_Java_PrevalentPattern_102
{
    meta:
        author = "defender2yara"
        detection_name = "!#Exploit:Java/PrevalentPattern"
        threat_id = "1879049307"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "C4C4C419103206BD59031353590413535905C453B6C406BD5903C453590413535905C453B6C413C413C4C4C4A0" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __Exploit_Java_PrevalentPattern_103
{
    meta:
        author = "defender2yara"
        detection_name = "!#Exploit:Java/PrevalentPattern"
        threat_id = "1879049307"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "073C11BC4D033E123ABB59BB59BB59B712B6B619B6B6B7B6B73ABB59BB59BB59B7121212B6B8B612B6B6B711B73A" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __Exploit_Java_PrevalentPattern_104
{
    meta:
        author = "defender2yara"
        detection_name = "!#Exploit:Java/PrevalentPattern"
        threat_id = "1879049307"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "B8B52A11B8B52A11B8B52A11B8B52A11B8B52A11B8B52A11B8B52A11B8B52A11B8B52A11B8B52A11B8B52A11B8B5B1" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __Exploit_Java_PrevalentPattern_105
{
    meta:
        author = "defender2yara"
        detection_name = "!#Exploit:Java/PrevalentPattern"
        threat_id = "1879049307"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "073C11BC4D033E123ABB59BB59BB59B712B6B619B6B6B7B6B73ABB59BB59BB59B7121212B6B8B6121212B6B6B6B711B73A" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __Exploit_Java_PrevalentPattern_106
{
    meta:
        author = "defender2yara"
        detection_name = "!#Exploit:Java/PrevalentPattern"
        threat_id = "1879049307"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "BB59131204BDB74EBB59B73A19BB59B7B6BB59BB59BB592BB703BDB719B73ABB5904BD59031953B73A2A132C2D19B72DB6B1" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __Exploit_Java_PrevalentPattern_107
{
    meta:
        author = "defender2yara"
        detection_name = "!#Exploit:Java/PrevalentPattern"
        threat_id = "1879049307"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "053C11BC4D033E0336123ABB59BB59BB59B712B6B619B6B6B7B6B73ABB59BB59BB59B7121212B6B8B6121212B6B6B6B711B73A" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __Exploit_Java_PrevalentPattern_108
{
    meta:
        author = "defender2yara"
        detection_name = "!#Exploit:Java/PrevalentPattern"
        threat_id = "1879049307"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "073C11BC4D033E0336123ABB59BB59BB59B712B6B619B6B6B7B6B73ABB59BB59BB59B7121212B6B8B6121212B6B6B6B711B73A" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __Exploit_Java_PrevalentPattern_109
{
    meta:
        author = "defender2yara"
        detection_name = "!#Exploit:Java/PrevalentPattern"
        threat_id = "1879049307"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "124CBB59B712B64D014E013A2A12B63A2CBB5912B719B612B612B612B6B6B9572ABB5904BD59032C12B953B7B52A2AB4B657A7" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __Exploit_Java_PrevalentPattern_110
{
    meta:
        author = "defender2yara"
        detection_name = "!#Exploit:Java/PrevalentPattern"
        threat_id = "1879049307"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "19B8B606323A190106BD590319B6535904B853590504BD5903135353B6C03A191904BD5903B853B6C03A19B63A012D2C19B8A7" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __Exploit_Java_PrevalentPattern_111
{
    meta:
        author = "defender2yara"
        detection_name = "!#Exploit:Java/PrevalentPattern"
        threat_id = "1879049307"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "B8B52A11B8B52A11B8B52A11B8B52A11B8B52A11B8B52A11B8B52A11B8B52A11B8B52A11B8B52A11B8B52A11B8B52A11B8B5B1" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __Exploit_Java_PrevalentPattern_112
{
    meta:
        author = "defender2yara"
        detection_name = "!#Exploit:Java/PrevalentPattern"
        threat_id = "1879049307"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "1449013A143928186B2818676F185C0F63396B492A00000000000000000000000028186B2818676F185C0F63396B492AB4593AC6" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __Exploit_Java_PrevalentPattern_113
{
    meta:
        author = "defender2yara"
        detection_name = "!#Exploit:Java/PrevalentPattern"
        threat_id = "1879049307"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "BB59B712B62DB6B6B6B83ABB5912B73A03BD3ABB59B73A19BB59B7B6BB59BB591919B719B73A2A12190319BE19B63A19B6C03AA7" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __Exploit_Java_PrevalentPattern_114
{
    meta:
        author = "defender2yara"
        detection_name = "!#Exploit:Java/PrevalentPattern"
        threat_id = "1879049307"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "C4C4C419103206BD590313535904135359051353B6C4C40106BD5903135359041353590504BD5903135353B6C413C413C4C4C4A0" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __Exploit_Java_PrevalentPattern_115
{
    meta:
        author = "defender2yara"
        detection_name = "!#Exploit:Java/PrevalentPattern"
        threat_id = "1879049307"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "B8B52A11B8B52A11B8B52A11B8B52A11B8B52A11B8B52A11B8B52A11B8B52A11B8B52A11B8B52A11B8B52A11B8B52A11B8B52A11B8B5B1" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __Exploit_Java_PrevalentPattern_116
{
    meta:
        author = "defender2yara"
        detection_name = "!#Exploit:Java/PrevalentPattern"
        threat_id = "1879049307"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "00000000001449013A143928186B2818676F185C0F63396B492A00000000000000000000000028186B2818676F185C0F63396B492AB4593AC6" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __Exploit_Java_PrevalentPattern_117
{
    meta:
        author = "defender2yara"
        detection_name = "!#Exploit:Java/PrevalentPattern"
        threat_id = "1879049307"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "C4C4C4C404BD590307BD5903C453590419535905191032535906C45353B6C4C4C404BD590305BD5903C4535904015353B6C413C413C4C4C4A0" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __Exploit_Java_PrevalentPattern_118
{
    meta:
        author = "defender2yara"
        detection_name = "!#Exploit:Java/PrevalentPattern"
        threat_id = "1879049307"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "C4C4C4C404BD590307BD5903C4535904C4535905191032535906C45353B6C4C4C404BD590305BD5903C4535904015353B6C413C413C4C4C4A0" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __Exploit_Java_PrevalentPattern_119
{
    meta:
        author = "defender2yara"
        detection_name = "!#Exploit:Java/PrevalentPattern"
        threat_id = "1879049307"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "BD590303BD53B63A19B8B606323A190106BD590319B6535904B853590504BD5903135353B6C03A191904BD5903B853B6C03A19B63A012D2C19B8A7" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __Exploit_Java_PrevalentPattern_120
{
    meta:
        author = "defender2yara"
        detection_name = "!#Exploit:Java/PrevalentPattern"
        threat_id = "1879049307"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "B8B63A1903321904BD590303BD53B63A19B8B606323A190106BD590319B6535904B853590504BD5903135353B6C03A191904BD5903B853B6C03A19B63A012D2C19B8A7" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __Exploit_Java_PrevalentPattern_121
{
    meta:
        author = "defender2yara"
        detection_name = "!#Exploit:Java/PrevalentPattern"
        threat_id = "1879049307"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "014CB82AB8B64DB82AB6B84EB83A19B83A190332C0C03AB81312B63A1904B61901B6C03AB83A19B8190319BEB63A012D2C19B8B13A19B61904321903322AB62D2CB82AB62D2CB8A7" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __Exploit_Java_PrevalentPattern_122
{
    meta:
        author = "defender2yara"
        detection_name = "!#Exploit:Java/PrevalentPattern"
        threat_id = "1879049307"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "53590503BD53B63A19B8B63A1903321904BD590303BD53B63A19B8B606323A190106BD590319B6535904B853590504BD5903135353B6C03A191904BD5903B853B6C03A19B63A012D2C19B8A7" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __Exploit_Java_PrevalentPattern_123
{
    meta:
        author = "defender2yara"
        detection_name = "!#Exploit:Java/PrevalentPattern"
        threat_id = "1879049307"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "06BD590313535904B853590503BD53B63A19B8B63A1903321904BD590303BD53B63A19B8B606323A190106BD590319B6535904B853590504BD5903135353B6C03A191904BD5903B853B6C03A19B63A012D2C19B8A7" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __Exploit_Java_PrevalentPattern_124
{
    meta:
        author = "defender2yara"
        detection_name = "!#Exploit:Java/PrevalentPattern"
        threat_id = "1879049307"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "C4C4C4C404BD590306BD5903C453590419535905C45353B6C4C4C404BD590303BD53B6C4C419103206BD590313535904135359051353B6C4C40106BD5903C45359041353590505BD590313535904C45353B6C413C413C4C4C4A0" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __Exploit_Java_PrevalentPattern_125
{
    meta:
        author = "defender2yara"
        detection_name = "!#Exploit:Java/PrevalentPattern"
        threat_id = "1879049307"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "C4C4C4C404BD590306BD5903C4535904C4535905C45353B6C4C4C404BD590303BD53B6C4C419103206BD590313535904135359051353B6C4C40106BD5903C45359041353590505BD590313535904C45353B6C413C413C4C4C4A0" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __Exploit_Java_PrevalentPattern_126
{
    meta:
        author = "defender2yara"
        detection_name = "!#Exploit:Java/PrevalentPattern"
        threat_id = "1879049307"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "C4C4C419103206BD590313535904135359051353B6C4C40106BD5903C45359041353590504BD5903C45353B6C4C419103206BD59031353590413535905C453B6C4C4C406BD5903C4535904191032535905C453B6C413C413C4C4C4A0" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __Exploit_Java_PrevalentPattern_127
{
    meta:
        author = "defender2yara"
        detection_name = "!#Exploit:Java/PrevalentPattern"
        threat_id = "1879049307"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "033C10BD590312535904125359051253590612535907125359081253591012535910125359101253591012535910125359101253591012535910125359101253591012535910125359101253591012535910125359101253591012535910125359101253" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __Exploit_Java_PrevalentPattern_128
{
    meta:
        author = "defender2yara"
        detection_name = "!#Exploit:Java/PrevalentPattern"
        threat_id = "1879049307"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "033C11BD590312535904125359051253590612535907125359081253591012535910125359101253591012535910125359101253591012535910125359101253591012535910125359101253591012535910125359101253591012535910125359101253" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __Exploit_Java_PrevalentPattern_129
{
    meta:
        author = "defender2yara"
        detection_name = "!#Exploit:Java/PrevalentPattern"
        threat_id = "1879049307"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "10105459101054591010545910105459101054591010545910105459101054591010545910105459101054591010545910105459101054591010545910105459101054591010545910105459101054591010545910105459101054591010545910105459" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __Exploit_Java_PrevalentPattern_130
{
    meta:
        author = "defender2yara"
        detection_name = "!#Exploit:Java/PrevalentPattern"
        threat_id = "1879049307"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "153610BC5903105559041055590510555906105559071055590810555910105559101055591010555910105559101055591010555910105559101055591010553ABB5919B7B83A10BC590310555904105559051055590610555907105559081055591010" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __Exploit_Java_PrevalentPattern_131
{
    meta:
        author = "defender2yara"
        detection_name = "!#Exploit:Java/PrevalentPattern"
        threat_id = "1879049307"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "59111054591110545911105459111054591110545911105459111054591110545911105459111054591110545911105459111054591110545911105459111054591110545911105459111054591110545911105459111054591110545911105459111054" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __Exploit_Java_PrevalentPattern_132
{
    meta:
        author = "defender2yara"
        detection_name = "!#Exploit:Java/PrevalentPattern"
        threat_id = "1879049307"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "59B719B612B6B63ABB59B719B612B6B63ABB59B719B612B6B63ABB59B719B612B6B63ABB59B719B612B6B63ABB59B719B612B6B63ABB59B719B612B6B63A1319B63A1904B61901B6C03AB83A19B8190319BEB63A012D2C19B8B13A19B61904321903322AB62D2CB82AB62D2CB8A7" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __Exploit_Java_PrevalentPattern_133
{
    meta:
        author = "defender2yara"
        detection_name = "!#Exploit:Java/PrevalentPattern"
        threat_id = "1879049307"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "014CB82AB8B64DB82AB6B84EB83A19B83A190332C0C03AB83AB83A19B8B63A19033206BD590313535904B853590503BD53B63A19B8B63A1903321904BD590303BD53B63A19B8B606323A190106BD590319B6535904B853590504BD5903135353B6C03A191904BD5903B853B6C03A19B63A012D2C19B8A7" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_BabylonToolbar_0
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:BabylonToolbar"
        threat_id = "1879049318"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "FTWARE\\BabylonTool" ascii //weight: 1
        $x_1_2 = "www.babylon.com/redirects/download.cgi?type=7318" ascii //weight: 1
        $x_1_3 = "Install Babylon Toolbar - RECOMMENDED" ascii //weight: 1
        $x_1_4 = "C:\\Projects\\LightInstaller\\trunc\\Release\\LightInstaller.pdb" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_OpenCandy_0
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:OpenCandy"
        threat_id = "1879049322"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "2"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = "api.opencandy.com" ascii //weight: 1
        $x_1_2 = {4f 43 50 52 44 [0-4] 4f 70 65 6e 43 61 6e 64 79 31}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_OpenCandy_1
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:OpenCandy"
        threat_id = "1879049322"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "opencandy.com" ascii //weight: 2
        $x_1_2 = "OCExecuteOffer" ascii //weight: 1
        $x_1_3 = "OCGetOfferType" ascii //weight: 1
        $x_1_4 = "OCSetupHlp" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_OpenCandy_2
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:OpenCandy"
        threat_id = "1879049322"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "opencandy.com" ascii //weight: 2
        $x_1_2 = "OpenCandy offers" ascii //weight: 1
        $x_1_3 = "OCOffer" ascii //weight: 1
        $x_1_4 = "SOFTWARE\\OpenCandy\\sdk" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_OpenCandy_3
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:OpenCandy"
        threat_id = "1879049322"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "opencandy.com" ascii //weight: 1
        $x_1_2 = "get_offers" ascii //weight: 1
        $x_1_3 = "OfferSkipped" ascii //weight: 1
        $x_1_4 = "circular_offers" ascii //weight: 1
        $x_1_5 = "OCSetupHlp.dll" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_OpenCandy_4
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:OpenCandy"
        threat_id = "1879049322"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "7"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "api.opencandy.com" ascii //weight: 1
        $x_1_2 = "OCSetupHlp.dll" ascii //weight: 1
        $x_1_3 = "OpenCandyDLL" ascii //weight: 1
        $x_1_4 = "OCOffer" ascii //weight: 1
        $x_1_5 = "get_offers" ascii //weight: 1
        $x_1_6 = "OfferSkipped" ascii //weight: 1
        $x_1_7 = "track_offer_install_started" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_OpenCandy_5
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:OpenCandy"
        threat_id = "1879049322"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "OCSetupHlp.dll" ascii //weight: 2
        $x_1_2 = "OpenCandy Inc" ascii //weight: 1
        $x_1_3 = "get_offers" ascii //weight: 1
        $x_1_4 = "OCGetOfferState" ascii //weight: 1
        $x_1_5 = "OCSetOfferData" ascii //weight: 1
        $x_1_6 = "OCAPIUnitTest" ascii //weight: 1
        $x_1_7 = "OpenCandy_Why_Is_This_Here" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((6 of ($x_1_*))) or
            ((1 of ($x_2_*) and 4 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule __PUA_Block_OpenCandy_6
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:OpenCandy"
        threat_id = "1879049322"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "8"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "OpenCandy" ascii //weight: 1
        $x_1_2 = "api.opencandy.com" ascii //weight: 1
        $x_1_3 = "OCSetupHlp.dll" ascii //weight: 1
        $x_1_4 = "stats.opencandy.com" ascii //weight: 1
        $x_1_5 = "ADDLYRICS.NET" ascii //weight: 1
        $x_1_6 = "get_offers" ascii //weight: 1
        $x_1_7 = "offerhidden" ascii //weight: 1
        $x_1_8 = "GetOfferType" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_OpenCandy_7
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:OpenCandy"
        threat_id = "1879049322"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "PDFCreator.exe" ascii //weight: 1
        $x_1_2 = "easyas.co.za" ascii //weight: 1
        $x_1_3 = "PDFCreator_setup_sql.exe" ascii //weight: 1
        $x_1_4 = "C:\\eZ-Az!" ascii //weight: 1
        $x_1_5 = "PDFInstall.exe" ascii //weight: 1
        $x_1_6 = "pdfsetup.exe" ascii //weight: 1
        $n_100_7 = "Uninst.exe" ascii //weight: -100
        $n_100_8 = "Uninstall.exe" ascii //weight: -100
    condition:
        (filesize < 20MB) and
        (not (any of ($n*))) and
        (all of ($x*))
}

rule __PUA_Block_OpenCandy_8
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:OpenCandy"
        threat_id = "1879049322"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "7"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "SfxSetup.exe" ascii //weight: 1
        $x_1_2 = "OpenCandy offer" ascii //weight: 1
        $x_2_3 = "OCSetupHlp.dll" ascii //weight: 2
        $x_1_4 = "GenuineIntelAuthenticAMDCentaurHauls" ascii //weight: 1
        $x_1_5 = "http://www.allmyapps.com" ascii //weight: 1
        $x_1_6 = "SOFTWARE\\OpenCandy\\sdk" wide //weight: 1
        $x_1_7 = "CANDYRX" ascii //weight: 1
        $n_100_8 = "WnUninst.exe" ascii //weight: -100
        $n_100_9 = "Uninst.exe" ascii //weight: -100
        $n_100_10 = "Uninstall.exe" ascii //weight: -100
    condition:
        (filesize < 20MB) and
        (not (any of ($n*))) and
        (
            ((1 of ($x_2_*) and 5 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule __PUA_Block_FlashHelper_0
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:FlashHelper"
        threat_id = "1879049324"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "8"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "FlashHelperService.exe" ascii //weight: 1
        $x_1_2 = "flashplayerax_install_cn.exe" ascii //weight: 1
        $x_1_3 = "pepflashplayer" ascii //weight: 1
        $x_1_4 = "Macromedia" ascii //weight: 1
        $x_1_5 = "lopen_mini_time" ascii //weight: 1
        $x_1_6 = "FlashHelperMini" ascii //weight: 1
        $x_1_7 = "tongji.flash.cn" ascii //weight: 1
        $x_1_8 = "mini.ffnews.cn" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_XMRStak_0
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:XMRStak"
        threat_id = "1879049329"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "wallet_address" ascii //weight: 1
        $x_1_2 = "pool_password" ascii //weight: 1
        $x_1_3 = "nicehash_nonce" ascii //weight: 1
        $x_1_4 = "Pool-side hashes" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_XMRStak_1
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:XMRStak"
        threat_id = "1879049329"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "3"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = "ethminer.exe" ascii //weight: 1
        $x_1_2 = "NvOptimusEnablementCuda" ascii //weight: 1
        $x_1_3 = {4c 6f 63 61 6c 5c 7b [0-37] 7d 2d 6f 6e 63 65 2d 66 6c 61 67}  //weight: 1, accuracy: Low
        $x_2_4 = "xmrstak_start_backend" ascii //weight: 2
        $x_1_5 = "C:/Users/Austin Felipe/Documents/Projetos/miner/xmrstak/backend/nvidia/nvcc_code/cuda_extra.cu" ascii //weight: 1
        $x_1_6 = {00 78 6d 72 73 74 61 6b 5f 63 75 64 61 5f 62 61 63 6b 65 6e 64}  //weight: 1, accuracy: High
        $x_3_7 = "C:\\Users\\MAIN\\xmr-stak-dep-build\\libmicrohttpd" ascii //weight: 3
    condition:
        (filesize < 20MB) and
        (
            ((3 of ($x_1_*))) or
            ((1 of ($x_2_*) and 1 of ($x_1_*))) or
            ((1 of ($x_3_*))) or
            (all of ($x*))
        )
}

rule __PUA_ML_Blocked_PullUpdate_0
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:ML:Blocked:PullUpdate"
        threat_id = "1879049359"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "163932:1:0:4.11.0.49145" ascii //weight: 1
        $x_1_2 = "prompt.exe" wide //weight: 1
        $x_1_3 = "SmartAssembly" wide //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_HaoZip_0
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:HaoZip"
        threat_id = "1879049364"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "9"
        strings_accuracy = "High"
    strings:
        $x_4_1 = "Execute 2345Pinyin MiniPage Task" wide //weight: 4
        $x_4_2 = "2345MiniPage.exe" wide //weight: 4
        $x_4_3 = {49 00 6e 00 74 00 65 00 72 00 6e 00 61 00 6c 00 4e 00 61 00 6d 00 65 00 00 00 48 00 61 00 6f 00 5a 00 69 00 70 00}  //weight: 4, accuracy: High
        $x_4_4 = "HaoZip_Startup_ShowMsg" wide //weight: 4
        $x_1_5 = {50 00 72 00 6f 00 64 00 75 00 63 00 74 00 4e 00 61 00 6d 00 65 00 00 00 00 00 68 00 61 00 6f 00 7a 00 69 00 70 00 2e 00 32 00 33 00 34 00 35 00 2e 00 63 00 63 00 28 00 48 00 61 00 6f 00 5a 00 69 00 70 00 29 00}  //weight: 1, accuracy: High
        $x_1_6 = {50 00 72 00 6f 00 64 00 75 00 63 00 74 00 4e 00 61 00 6d 00 65 00 00 00 00 00 48 00 61 00 6f 00 5a 00 69 00 70 00 28 00 48 00 61 00 6f 00 5a 00 69 00 70 00 29 00}  //weight: 1, accuracy: High
        $x_1_7 = {7d 59 8b 53 08 ff 48 00 61 00 6f 00 5a 00 69 00 70 00 09 ff}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (
            ((2 of ($x_4_*) and 1 of ($x_1_*))) or
            ((3 of ($x_4_*))) or
            (all of ($x*))
        )
}

rule __PUA_Block_HaoZip_1
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:HaoZip"
        threat_id = "1879049364"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "Low"
    strings:
        $x_2_1 = "Execute 2345Pinyin MiniPage Task" ascii //weight: 2
        $x_1_2 = {49 00 6e 00 74 00 65 00 72 00 6e 00 61 00 6c 00 4e 00 61 00 6d 00 65 00 00 00 48 00 61 00 6f 00 5a 00 69 00 70 00 53 00 76 00 63 00}  //weight: 1, accuracy: High
        $x_1_3 = "ALL APPLICATION PACKAGES" wide //weight: 1
        $x_1_4 = {5c 72 63 7a 69 70 5c 62 69 6e 5c (57 69 6e|78) 5c 72 65 6c 65 61 73 65 5c 70 64 62 5c 48 61 6f 5a 69 70 53 76 63 2e 70 64 62}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_2_*) and 2 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule __PUA_Block_HaoZip_2
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:HaoZip"
        threat_id = "1879049364"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "Execute 2345Pinyin MiniPage Task" ascii //weight: 2
        $x_1_2 = {49 00 6e 00 74 00 65 00 72 00 6e 00 61 00 6c 00 4e 00 61 00 6d 00 65 00 00 00 55 00 70 00 64 00 61 00 74 00 65 00 5f 00 48 00 61 00 6f 00 5a 00 69 00 70 00 2e 00 65 00 78 00 65 00}  //weight: 1, accuracy: High
        $x_1_3 = "haozip.update_tool.process_exit.event" wide //weight: 1
        $x_1_4 = "minipage_action_results" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_2_*) and 2 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule __PUA_Block_HaoZip_3
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:HaoZip"
        threat_id = "1879049364"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "Low"
    strings:
        $x_2_1 = "Execute 2345Pinyin MiniPage Task" ascii //weight: 2
        $x_1_2 = {49 00 6e 00 74 00 65 00 72 00 6e 00 61 00 6c 00 4e 00 61 00 6d 00 65 00 00 00 48 00 61 00 6f 00 5a 00 69 00 70 00 43 00 44 00}  //weight: 1, accuracy: High
        $x_1_3 = "{HaoZip-FD563F4F-D70D-43bc-ADAB-DF871F89BC42}" wide //weight: 1
        $x_1_4 = {5c 72 63 7a 69 70 5c 62 69 6e 5c (57 69 6e|78) 5c 72 65 6c 65 61 73 65 5c 70 64 62 5c 48 61 6f 5a 69 70 43 44 2e 70 64 62}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_2_*) and 2 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule __PUA_Block_HaoZip_4
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:HaoZip"
        threat_id = "1879049364"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "Low"
    strings:
        $x_3_1 = "Execute 2345Pinyin MiniPage Task" ascii //weight: 3
        $x_2_2 = {49 00 6e 00 74 00 65 00 72 00 6e 00 61 00 6c 00 4e 00 61 00 6d 00 65 00 00 00 48 00 61 00 6f 00 5a 00 69 00 70 00 4c 00 6f 00 61 00 64 00 65 00 72 00}  //weight: 2, accuracy: High
        $x_2_3 = "Lang language module failed, Please reinstall HaoZip!" wide //weight: 2
        $x_2_4 = {5c 72 63 7a 69 70 5c 62 69 6e 5c (57 69 6e|78) 5c 72 65 6c 65 61 73 65 5c 70 64 62 5c 48 61 6f 5a 69 70 4c 6f 61 64 65 72 2e 70 64 62}  //weight: 2, accuracy: Low
    condition:
        (filesize < 20MB) and
        (
            ((2 of ($x_2_*))) or
            ((1 of ($x_3_*) and 1 of ($x_2_*))) or
            (all of ($x*))
        )
}

rule __PUA_Block_WildRigMulti_0
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:WildRigMulti"
        threat_id = "1879049376"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "Low"
    strings:
        $x_5_1 = {49 8b d1 80 32 ?? 41 ff c0 48 8d 52}  //weight: 5, accuracy: Low
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_OpenInstaller_0
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:OpenInstaller"
        threat_id = "1879049377"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "9"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "CancelOfferThreads" ascii //weight: 1
        $x_1_2 = "PageOffer" ascii //weight: 1
        $x_1_3 = "shownOffers" ascii //weight: 1
        $x_1_4 = "preparedOffers" ascii //weight: 1
        $x_1_5 = "IsOfferThreadRunning" ascii //weight: 1
        $x_1_6 = "disableDynamicOffers" ascii //weight: 1
        $x_1_7 = "err.cloins.com" ascii //weight: 1
        $x_1_8 = "st.cloins.com" ascii //weight: 1
        $x_1_9 = "afterdawn.com" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_OnePlatform_0
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:OnePlatform"
        threat_id = "1879049396"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "8"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "di7e1j5f1plfo" ascii //weight: 2
        $x_1_2 = "afxwin2.in" ascii //weight: 1
        $x_1_3 = "filecore.cpp" ascii //weight: 1
        $x_1_4 = "TOOLBAR_POPUPMENU" ascii //weight: 1
        $x_1_5 = "AFX_WM_AFTER_TASKBAR_ACTIVATE" ascii //weight: 1
        $x_1_6 = "AppWizard-Generated" ascii //weight: 1
        $x_1_7 = "Quick Access Toolbar" ascii //weight: 1
        $x_1_8 = "Skip All" ascii //weight: 1
        $x_1_9 = "Decline" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((8 of ($x_1_*))) or
            ((1 of ($x_2_*) and 6 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule __do_exhaustivehstr_64bit_rescan_0
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_64bit_rescan"
        threat_id = "1879049400"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {5c 44 69 73 61 62 6c 65 5f 57 69 6e 64 6f 77 73 75 70 64 61 74 65 2e 70 64 62 00}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_64bit_rescan_1
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_64bit_rescan"
        threat_id = "1879049400"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "c:\\users\\Public\\MicTray.log" wide //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_64bit_rescan_2
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_64bit_rescan"
        threat_id = "1879049400"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "%LOCALAPPDATA%\\ThumbsCache.db" wide //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_64bit_rescan_3
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_64bit_rescan"
        threat_id = "1879049400"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "2"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "PuttyConfigBox" wide //weight: 1
        $x_1_2 = "SumatraPDF" wide //weight: 1
        $x_1_3 = "rundll32.exe" wide //weight: 1
    condition:
        (filesize < 20MB) and
        (2 of ($x*))
}

rule __do_exhaustivehstr_64bit_rescan_4
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_64bit_rescan"
        threat_id = "1879049400"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {00 43 61 6e 6e 6f 74 20 63 61 6c 6c 20 63 6f 6e 6e 65 63 74 20 6f 6e 20 55 4e 42 4f 55 4e 44 20 73 6f 63 6b 65 74 20 69 6e 20 72 65 6e 64 65 7a 76 6f 75 73 20 63 6f 6e 6e 65 63 74 69 6f 6e 20 73 65 74 75 70 00}  //weight: 1, accuracy: High
        $x_1_2 = {00 4c 69 73 74 65 6e 2f 61 63 63 65 70 74 20 69 73 20 6e 6f 74 20 73 75 70 70 6f 72 74 65 64 20 69 6e 20 72 65 6e 64 65 7a 6f 75 73 20 63 6f 6e 6e 65 63 74 69 6f 6e 20 73 65 74 75 70 00}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (1 of ($x*))
}

rule __do_exhaustivehstr_64bit_rescan_5
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_64bit_rescan"
        threat_id = "1879049400"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = ".shell" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_64bit_rescan_6
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_64bit_rescan"
        threat_id = "1879049400"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Soldier.dll" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_64bit_rescan_7
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_64bit_rescan"
        threat_id = "1879049400"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {48 8b 49 18 48 3b 0d 40 fa 00 00}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_64bit_rescan_8
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_64bit_rescan"
        threat_id = "1879049400"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "{INJECTDATA}" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_64bit_rescan_9
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_64bit_rescan"
        threat_id = "1879049400"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {00 73 69 64 65 6c 6f 61 64 2e 70 64 62 00 00 00 00}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_64bit_rescan_10
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_64bit_rescan"
        threat_id = "1879049400"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "NUITKA_ONEFILE_PARENT" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_64bit_rescan_11
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_64bit_rescan"
        threat_id = "1879049400"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {63 68 61 74 67 70 74 2e 70 64 62 00 09 00 00 00 28 00 00 00 28}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_64bit_rescan_12
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_64bit_rescan"
        threat_id = "1879049400"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "2"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "AntiVir" wide //weight: 1
        $x_1_2 = "CData" wide //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_64bit_rescan_13
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_64bit_rescan"
        threat_id = "1879049400"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "failed to run taskkill for PID !" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_64bit_rescan_14
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_64bit_rescan"
        threat_id = "1879049400"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "DeviceIoControl" ascii //weight: 2
        $x_1_2 = ".blf" ascii //weight: 1
        $x_1_3 = "LOG:" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_2_*) and 1 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule __do_exhaustivehstr_64bit_rescan_15
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_64bit_rescan"
        threat_id = "1879049400"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {43 00 6f 00 75 00 70 00 6f 00 6f 00 6e 00 53 00 65 00 72 00 76 00 69 00 63 00 65 00 36 00 34 00 00 00}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_64bit_rescan_16
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_64bit_rescan"
        threat_id = "1879049400"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "src\\keylogger.rs" ascii //weight: 1
        $x_1_2 = "keylogger_file" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (1 of ($x*))
}

rule __do_exhaustivehstr_64bit_rescan_17
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_64bit_rescan"
        threat_id = "1879049400"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Connection closed or error occurred." ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_64bit_rescan_18
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_64bit_rescan"
        threat_id = "1879049400"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {53 61 6d 65 47 61 6d 65 2e 65 78 65 00 48 65 6c 6c 6f 57 6f 72 6c 64}  //weight: 1, accuracy: High
        $x_1_2 = "jelus RAT" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (1 of ($x*))
}

rule __do_exhaustivehstr_64bit_rescan_19
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_64bit_rescan"
        threat_id = "1879049400"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "FlutterWindows_WindowManager_Initialize" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_64bit_rescan_20
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_64bit_rescan"
        threat_id = "1879049400"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Ntoskrnl" ascii //weight: 1
        $x_1_2 = "FltMgr" ascii //weight: 1
        $x_1_3 = "Netio" ascii //weight: 1
        $x_1_4 = "CrashDmp" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (3 of ($x*))
}

rule __do_exhaustivehstr_64bit_rescan_21
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_64bit_rescan"
        threat_id = "1879049400"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "2"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Go buildinf" ascii //weight: 1
        $x_1_2 = "github.com/hackirby/skuld" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_64bit_rescan_22
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_64bit_rescan"
        threat_id = "1879049400"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {c7 84 24 69 02 00 00 01 01 00 00 66 0f ef c0 48 8d b4 24 b0 05 00 00 66 0f 7f 46 20 66 0f 7f 46 10 66 0f 7f 06 48 89 f1 e8}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_64bit_rescan_23
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_64bit_rescan"
        threat_id = "1879049400"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Schannel" ascii //weight: 1
        $x_1_2 = "DecryptMessage" ascii //weight: 1
        $x_1_3 = "ServiceMain" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_64bit_rescan_24
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_64bit_rescan"
        threat_id = "1879049400"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = ".?AVCWininet_Protocol@@" ascii //weight: 1
        $x_1_2 = "CMS_ContentInfo" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (1 of ($x*))
}

rule __do_exhaustivehstr_64bit_rescan_25
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_64bit_rescan"
        threat_id = "1879049400"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {44 8b c3 39 9d 40 02 00 00 76 ?? 4c 8b cb 4c 8d 15 ?? ?? ?? ?? b8 ?? ?? ?? ?? 41 f7 e8 c1 fa ?? 8b c2 c1 e8 1f 03 d0}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_64bit_rescan_26
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_64bit_rescan"
        threat_id = "1879049400"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {65 6e 64 00 6e 74 6f 73 6b 72 6e 6c 2e 65 78 65 ?? ?? ?? ?? ?? ?? ?? ?? ?? 40 75 4e 74 41 64 64 41 74 6f 6d 2e 62 61 73 69 63 5f 73 74 72 69 6e 67}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_64bit_rescan_27
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_64bit_rescan"
        threat_id = "1879049400"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "downloadexporter" ascii //weight: 1
        $x_1_2 = "shellsleepslice" ascii //weight: 1
        $x_1_3 = "upload %v=%v," ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_64bit_rescan_28
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_64bit_rescan"
        threat_id = "1879049400"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "| Out-File -Encoding unicode" ascii //weight: 1
        $x_1_2 = "cmd_type" ascii //weight: 1
        $x_1_3 = "cmd_body" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_64bit_rescan_29
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_64bit_rescan"
        threat_id = "1879049400"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Go buildinf:" ascii //weight: 1
        $x_1_2 = "yggdrasil-network" ascii //weight: 1
        $x_1_3 = "kbinani/screenshot" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_64bit_rescan_30
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_64bit_rescan"
        threat_id = "1879049400"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "C:\\Users\\1975\\Downloads\\TechnicalDirector\\SumatraPDF.exe" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_64bit_rescan_31
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_64bit_rescan"
        threat_id = "1879049400"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "\\thent-team\\ie\\Binaries\\Content" ascii //weight: 1
        $x_1_2 = {67 00 65 00 74 00 6d 00 70 00 6f 00 66 00 66 00 65 00 72 00 00 00}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (1 of ($x*))
}

rule __do_exhaustivehstr_64bit_rescan_32
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_64bit_rescan"
        threat_id = "1879049400"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {4e 74 43 6c 6f 73 65 00 4e 74 51 75 65 72 79 49 6e 66 6f 72 6d 61 74 69 6f 6e 46 69 6c 65 00 4e 74 52 65 61 64 46 69 6c 65}  //weight: 1, accuracy: High
        $x_1_2 = {50 00 4e 00 47 00 61 00 00 00 50 00 4e 00 47 00 62 00}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (1 of ($x*))
}

rule __do_exhaustivehstr_64bit_rescan_33
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_64bit_rescan"
        threat_id = "1879049400"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "2"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "\\MeshAgent\\MeshAgent\\Release\\MeshService64.pdb" ascii //weight: 1
        $x_1_2 = "MeshCentralRoot" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_64bit_rescan_34
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_64bit_rescan"
        threat_id = "1879049400"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "UltraVNC" ascii //weight: 1
        $x_1_2 = "VNC authentication" ascii //weight: 1
        $x_1_3 = "vncviewer.exe" ascii //weight: 1
        $x_1_4 = "https://www.uvnc.com" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (3 of ($x*))
}

rule __do_exhaustivehstr_64bit_rescan_35
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_64bit_rescan"
        threat_id = "1879049400"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "2"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Go buildinf" ascii //weight: 1
        $x_1_2 = "github.com/moond4rk/hackbrowserdata/cmd/hack-browser-data" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_64bit_rescan_36
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_64bit_rescan"
        threat_id = "1879049400"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_3_1 = "yourdllfinal.dll" ascii //weight: 3
        $x_1_2 = "Go build ID: \"" ascii //weight: 1
        $x_1_3 = "GODEBUG: unknown cpu feature" ascii //weight: 1
        $x_1_4 = "Go buildinf:" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_3_*) and 1 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule __do_exhaustivehstr_64bit_rescan_37
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_64bit_rescan"
        threat_id = "1879049400"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "[Chrome::Protector::IsValidLibraryToLoadA]" wide //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_64bit_rescan_38
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_64bit_rescan"
        threat_id = "1879049400"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Go buildinf:" ascii //weight: 1
        $x_1_2 = "PRI * HTTP/2.0" ascii //weight: 1
        $x_1_3 = "application/binary" ascii //weight: 1
        $x_1_4 = "Request-Stream not implemented." ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_64bit_rescan_39
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_64bit_rescan"
        threat_id = "1879049400"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "200"
        strings_accuracy = "High"
    strings:
        $x_100_1 = "Release 0.76 (without embedded help)" wide //weight: 100
        $x_100_2 = "name=\"PuTTY\"" ascii //weight: 100
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_64bit_rescan_40
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_64bit_rescan"
        threat_id = "1879049400"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "2023 UltraVNC team members" wide //weight: 1
        $x_1_2 = "UltraVNC" wide //weight: 1
        $x_1_3 = "vncviewer.exe" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_64bit_rescan_41
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_64bit_rescan"
        threat_id = "1879049400"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {42 79 74 65 73 01 05 43 61 75 73 65 01 05 43 68 64 69 72 01 05 43 68 6d 6f 64 01 05 43 68 6f 77 6e 01 05 43 6c 61 73 73 01 05 43 6c 6f 63 6b 01 05 43 6c 6f 6e 65 01 05 43 6c 6f 73 65 01 05 43 6f 65 66 66 01 05 43 75 72 76 65 09 05 43 75 72 76 65 01 05 45 6d 70 74 79 01 05}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_64bit_rescan_42
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_64bit_rescan"
        threat_id = "1879049400"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "ffmpeg.dll" ascii //weight: 1
        $x_1_2 = "avcodec_parameters_to_context" ascii //weight: 1
        $x_1_3 = "avcodec_receive_frame" ascii //weight: 1
        $x_1_4 = "avcodec_send_packet" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_64bit_rescan_43
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_64bit_rescan"
        threat_id = "1879049400"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {4c 64 72 44 6c 6c 2e 64 6c 6c 00 44 6c 6c 52 65 67 69 73 74 65 72 53 65 72 76 65 72 00 (41|2d|5a) [0-36] 00}  //weight: 1, accuracy: Low
        $x_1_2 = {4c 64 72 44 6c 6c 2e 64 6c 6c 00 (41|2d|5a) [0-36] 00 44 6c 6c 52 65 67 69 73 74 65 72 53 65 72 76 65 72 00}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (1 of ($x*))
}

rule __do_exhaustivehstr_64bit_rescan_44
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_64bit_rescan"
        threat_id = "1879049400"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "minkernel\\crts\\ucrt\\src\\appcrt\\misc\\signal.cpp" ascii //weight: 1
        $x_1_2 = "SizeofResource" ascii //weight: 1
        $x_1_3 = "FindResourceW" ascii //weight: 1
        $x_1_4 = "installer.pdb" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (3 of ($x*))
}

rule __do_exhaustivehstr_64bit_rescan_45
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_64bit_rescan"
        threat_id = "1879049400"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "200"
        strings_accuracy = "High"
    strings:
        $x_100_1 = "\\\\.\\pipe\\SumatraPDFLogger" wide //weight: 100
        $x_100_2 = "SumatraWgDefaultWinClass" wide //weight: 100
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_64bit_rescan_46
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_64bit_rescan"
        threat_id = "1879049400"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "library\\std\\src\\sys\\windows\\net.rs" ascii //weight: 1
        $x_1_2 = "library\\std\\src\\sys_common\\net.rs" ascii //weight: 1
        $x_1_3 = "library\\std\\src\\io\\readbuf.rs" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_64bit_rescan_47
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_64bit_rescan"
        threat_id = "1879049400"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {50 6f 6c 69 63 69 65 73 20 7b [0-1] 0a 09 09 09 09 09 09 4e 6f 52 65 6d 6f 76 65 20 45 78 74 20 7b [0-1] 0a 09 09 09 09 09 09 09 4e 6f 52 65 6d 6f 76 65 20 43 4c 53 49 44 20 7b [0-1] 0a 09 09 09 09 09 09 09 09 76 61 6c 20 27 25 50 4c 55 47 49 4e 5f 43 4c 53 49 44 25 27 20 3d 20 73 20 27 31 27}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_64bit_rescan_48
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_64bit_rescan"
        threat_id = "1879049400"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Mingw-w64 runtime failure:" ascii //weight: 1
        $x_1_2 = "GNU AS 2.44" ascii //weight: 1
        $x_1_3 = "GCC: (MinGW-W64 x86_64-ucrt-posix-seh, built by Brecht Sanders, r2) 14.2.0" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_64bit_rescan_49
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_64bit_rescan"
        threat_id = "1879049400"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "8"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "bcrypt.dll" ascii //weight: 1
        $x_1_2 = "FindFirstFile" ascii //weight: 1
        $x_1_3 = "FindNextFile" ascii //weight: 1
        $x_1_4 = "IsDebuggerPresent" ascii //weight: 1
        $x_1_5 = "GetLocaleInfo" ascii //weight: 1
        $x_1_6 = "GetSystemTimePreciseAsFileTime" ascii //weight: 1
        $x_1_7 = "GetTempPath2" ascii //weight: 1
        $x_1_8 = "MGF1" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_64bit_rescan_50
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_64bit_rescan"
        threat_id = "1879049400"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "2"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "[Monitor::InjectorMonitor::CreateMonitoringEvents]" wide //weight: 1
        $x_1_2 = ".?AVExtension@Preferences@Json@SpeedBit@@" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_64bit_rescan_51
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_64bit_rescan"
        threat_id = "1879049400"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "VirtualQuery failed for %d bytes at address %p" ascii //weight: 1
        $x_1_2 = "VirtualProtect failed with code 0x%x" ascii //weight: 1
        $x_1_3 = "Unknown pseudo relocation protocol version %d" ascii //weight: 1
        $x_1_4 = "%d bit pseudo relocation at %p out of range, targeting %p, yielding the value %p." ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (3 of ($x*))
}

rule __do_exhaustivehstr_64bit_rescan_52
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_64bit_rescan"
        threat_id = "1879049400"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Windows XP 64-bit Edition Version 2003 or newer should be used." ascii //weight: 1
        $x_1_2 = "Please verify that both the operating system and the processor support Intel(R) AVX2, BMI, LZCNT, HLE, RTM and FMA instructions." ascii //weight: 1
        $x_1_3 = {ba 90 fa 00 00 41 b8 01 00 00 00 ff d0 48 85 c0}  //weight: 1, accuracy: High
        $x_1_4 = {44 89 c8 45 89 c1 41 29 c1 41 83 f9 01 74}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_64bit_rescan_53
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_64bit_rescan"
        threat_id = "1879049400"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {07 2a 73 74 72 69 6e 67 00 07 72 75 6e 74 69 6d 65 00 07 2a 75 69 6e 74 31 36 00 07 2a 75 69 6e 74 33 32 00 07 2a 75 69 6e 74 36 34 00 07 2a 5b 5d 75 69 6e 74 00 07 70 74 72 53 69 7a 65 ?? 07 66 75 6e 63 6f 66 66 00 07 66 69 6c 65 74 61 62 00 07 63 6f 76 63 74 72 73 00 07 68 61 73 6d 61 69 6e 00 07 74 79 70 65 6d 61 70 00 07 74 65 78 74 4f 66 66 00 07 6e 61 6d 65 4f 66 66 00 07 73 72 63 46 75 6e 63 00 07 6e 70 63 64 61 74 61 00 07 73 74 61 72 74 50 43 00 07 73 74 61 72 74 53 50 00 07 69 73 45 6d 70 74 79 00 07 74 61 6b 65 41 6c 6c 00 07 6f 62 6a 42 61 73 65 00 07 70 75 73 68 41 6c 6c 04 03 70 6f 70 30 14 00 00 00 07 77 61 69 74 69 6e 67 00 07 72 75 6e 6e 69 6e 67 00 07 7a 6f 6d 62 69 65}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_exhaustivehstr_64bit_rescan_54
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_64bit_rescan"
        threat_id = "1879049400"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "[%p:%p] inject %d change URL to '%.1024s~'" wide //weight: 1
        $x_1_2 = "R INI-file:encrypted INI-enc:new(BASE64X|META)x64" wide //weight: 1
        $x_1_3 = "[%p:%p] E timeout injecting content" wide //weight: 1
    condition:
        (filesize < 20MB) and
        (1 of ($x*))
}

rule __do_exhaustivehstr_64bit_rescan_55
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_64bit_rescan"
        threat_id = "1879049400"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Microsoft.Identity.dll" ascii //weight: 1
        $x_1_2 = "C:\\Windows\\System32\\npmproxy.dll.DllCanUnloadNow" ascii //weight: 1
        $x_1_3 = "C:\\Windows\\System32\\npmproxy.dll.DllGetClassObject" ascii //weight: 1
        $x_1_4 = "C:\\Windows\\System32\\npmproxy.dll.DllRegisterServer" ascii //weight: 1
        $x_1_5 = "C:\\Windows\\System32\\npmproxy.dll.DllUnregisterServer" ascii //weight: 1
        $x_1_6 = "C:\\Windows\\System32\\npmproxy.dll.GetProxyDllInfo" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (3 of ($x*))
}

rule __do_exhaustivehstr_64bit_rescan_56
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_64bit_rescan"
        threat_id = "1879049400"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {43 8a 44 0b 0c 49 8b ca 49 ff c2 83 e1 03 42 32 44 01 04 42 32 04 01 41 88 01 49 ff c1 48 ff ca 75 de}  //weight: 1, accuracy: High
        $x_1_2 = {02 14 08 48 ff c1 49 3b ca 72 ?? 49 8b cc 48 39 4d ?? 76 ?? 48 8d 45 ?? 48 83 7d ?? 10 48 0f 43 45 ?? 30 14 08 48 ff c1}  //weight: 1, accuracy: Low
        $x_1_3 = {8b c2 25 03 00 00 80 7d 07 ff c8 83 c8 fc ff c0 48 63 c8 43 0f b6 44 01 0c 49 ff c0 32 44 31 04 ff c2 32 04 31 41 88 40 ff 48 ff cb 75 d2}  //weight: 1, accuracy: High
        $x_1_4 = {41 b8 0b 00 00 00 48 8d 15 ?? ?? ?? ?? 48 8d 4d ?? e8 ?? ?? ?? ?? 48 c7 45 ?? 07 00 00 00 48 89 7d ?? 66 89 7c 24 ?? 48 8d 0d ?? ?? ?? ?? e8 ?? ?? ?? ?? 66 83 38 00 75 05}  //weight: 1, accuracy: Low
        $x_1_5 = {48 8d 83 fa fe ff 7f 48 85 c0 74 12 0f b6 04 0a 84 c0 74 0a 88 01 48 ff c1 48 ff cb 75 e2 48 85 db 75 03 48 ff c9}  //weight: 1, accuracy: High
        $x_1_6 = {2f 00 6a 00 73 00 61 00 64 00 6b 00 62 00 77 00 64 00 66 00 67 00 3f 00 75 00 3d 00 25 00 73 00 26 00 61 00 3d 00 25 00 73 00 00 00}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (1 of ($x*))
}

rule __do_exhaustivehstr_64bit_rescan_57
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_64bit_rescan"
        threat_id = "1879049400"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "109"
        strings_accuracy = "High"
    strings:
        $x_100_1 = "ServiceMain" ascii //weight: 100
        $x_1_2 = "cJSONUtils_AddPatchToArray" ascii //weight: 1
        $x_1_3 = "cJSONUtils_ApplyPatches" ascii //weight: 1
        $x_1_4 = "cJSONUtils_ApplyPatchesCaseSensitive" ascii //weight: 1
        $x_1_5 = "cJSONUtils_FindPointerFromObjectTo" ascii //weight: 1
        $x_1_6 = "cJSONUtils_GenerateMergePatch" ascii //weight: 1
        $x_1_7 = "cJSONUtils_GenerateMergePatchCaseSensitive" ascii //weight: 1
        $x_1_8 = "cJSONUtils_GeneratePatches" ascii //weight: 1
        $x_1_9 = "cJSONUtils_GeneratePatchesCaseSensitive" ascii //weight: 1
        $x_1_10 = "cJSONUtils_GetPointer" ascii //weight: 1
        $x_1_11 = "cJSONUtils_GetPointerCaseSensitive" ascii //weight: 1
        $x_1_12 = "cJSONUtils_MergePatch" ascii //weight: 1
        $x_1_13 = "cJSONUtils_MergePatchCaseSensitive" ascii //weight: 1
        $x_1_14 = "cJSONUtils_SortObject" ascii //weight: 1
        $x_1_15 = "cJSONUtils_SortObjectCaseSensitive" ascii //weight: 1
        $x_1_16 = "cJSON_AddArrayToObject" ascii //weight: 1
        $x_1_17 = "cJSON_AddBoolToObject" ascii //weight: 1
        $x_1_18 = "cJSON_AddFalseToObject" ascii //weight: 1
        $x_1_19 = "cJSON_AddItemReferenceToArray" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_100_*) and 9 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule __do_exhaustivehstr_64bit_rescan_58
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_exhaustivehstr_64bit_rescan"
        threat_id = "1879049400"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "10"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Cannot create implicit closure in AOT!" ascii //weight: 1
        $x_1_2 = "Cannot create snapshots on an AOT runtime." ascii //weight: 1
        $x_1_3 = "%s: Cannot compile on an AOT runtime." ascii //weight: 1
        $x_1_4 = "This VM was built without support for AOT compilation." ascii //weight: 1
        $x_1_5 = "JIT app snapshots cannot be taken from an AOT runtime" ascii //weight: 1
        $x_1_6 = "No obfuscation map to save on an AOT runtime." ascii //weight: 1
        $x_1_7 = "%s: All classes are already finalized in AOT runtime." ascii //weight: 1
        $x_1_8 = "Dart_Precompile" ascii //weight: 1
        $x_1_9 = "Dart_PrepareToAbort" ascii //weight: 1
        $x_1_10 = "Dart_PropagateError" ascii //weight: 1
        $x_1_11 = "Dart_ReThrowException" ascii //weight: 1
        $x_1_12 = "Dart_RecordTimelineEvent" ascii //weight: 1
        $x_1_13 = "Dart_RegisterHeapSamplingCallback" ascii //weight: 1
        $x_1_14 = "Dart_RegisterIsolateServiceRequestCallback" ascii //weight: 1
        $x_1_15 = "Dart_RegisterRootServiceRequestCallback" ascii //weight: 1
        $x_1_16 = "Dart_ReportSurvivingAllocations" ascii //weight: 1
        $x_1_17 = "Dart_ScopeAllocate" ascii //weight: 1
        $x_1_18 = "Dart_SendPortGetId" ascii //weight: 1
        $x_1_19 = "Dart_ServiceSendDataEvent" ascii //weight: 1
        $x_1_20 = "Dart_SetBooleanReturnValue" ascii //weight: 1
        $x_1_21 = "Dart_SetCurrentUserTag" ascii //weight: 1
        $x_1_22 = "Dart_SetDartLibrarySourcesKernel" ascii //weight: 1
        $x_1_23 = "Dart_SetDeferredLoadHandler" ascii //weight: 1
        $x_1_24 = "Dart_SetDoubleReturnValue" ascii //weight: 1
        $x_1_25 = "Dart_SetDwarfStackTraceFootnoteCallback" ascii //weight: 1
        $x_1_26 = "Dart_SetEmbedderInformationCallback" ascii //weight: 1
        $x_1_27 = "Dart_SetEnabledTimelineCategory" ascii //weight: 1
        $x_1_28 = "Dart_SetEnvironmentCallback" ascii //weight: 1
        $x_1_29 = "Dart_SetFfiNativeResolver" ascii //weight: 1
        $x_1_30 = "Dart_SetFileModifiedCallback" ascii //weight: 1
        $x_1_31 = "Dart_SetHeapSamplingPeriod" ascii //weight: 1
        $x_1_32 = "Dart_SetIntegerReturnValue" ascii //weight: 1
        $x_1_33 = "Dart_SetLibraryTagHandler" ascii //weight: 1
        $x_1_34 = "Dart_SetMessageNotifyCallback" ascii //weight: 1
        $x_1_35 = "Dart_SetNativeInstanceField" ascii //weight: 1
        $x_1_36 = "Dart_SetNativeResolver" ascii //weight: 1
        $x_1_37 = "Dart_SetPausedOnExit" ascii //weight: 1
        $x_1_38 = "Dart_SetPausedOnStart" ascii //weight: 1
        $x_1_39 = "Dart_SetPerformanceMode" ascii //weight: 1
        $x_1_40 = "Dart_SetPersistentHandle" ascii //weight: 1
        $x_1_41 = "Dart_SetReturnValue" ascii //weight: 1
        $x_1_42 = "Dart_SetRootLibrary" ascii //weight: 1
        $x_1_43 = "Dart_SetServiceStreamCallbacks" ascii //weight: 1
        $x_1_44 = "Dart_SetShouldPauseOnExit" ascii //weight: 1
        $x_1_45 = "Dart_SetShouldPauseOnStart" ascii //weight: 1
        $x_1_46 = "Dart_SetStickyError" ascii //weight: 1
        $x_1_47 = "Dart_SetThreadName" ascii //weight: 1
        $x_1_48 = "Dart_SetTimelineRecorderCallback" ascii //weight: 1
        $x_1_49 = "Dart_SetVMFlags" ascii //weight: 1
        $x_1_50 = "Dart_SetWeakHandleReturnValue" ascii //weight: 1
        $x_1_51 = "Dart_ShouldPauseOnExit" ascii //weight: 1
        $x_1_52 = "Dart_ShouldPauseOnStart" ascii //weight: 1
        $x_1_53 = "Dart_ShutdownIsolate" ascii //weight: 1
        $x_1_54 = "Dart_SortClasses" ascii //weight: 1
        $x_1_55 = "Dart_StartProfiling" ascii //weight: 1
        $x_1_56 = "Dart_StopProfiling" ascii //weight: 1
        $x_1_57 = "Dart_StringGetProperties" ascii //weight: 1
        $x_1_58 = "Dart_StringLength" ascii //weight: 1
        $x_1_59 = "Dart_StringStorageSize" ascii //weight: 1
        $x_1_60 = "Dart_StringToCString" ascii //weight: 1
        $x_1_61 = "Dart_StringToLatin1" ascii //weight: 1
        $x_1_62 = "Dart_StringToUTF16" ascii //weight: 1
        $x_1_63 = "Dart_StringToUTF8" ascii //weight: 1
        $x_1_64 = "Dart_ThreadDisableProfiling" ascii //weight: 1
        $x_1_65 = "Dart_ThreadEnableProfiling" ascii //weight: 1
        $x_1_66 = "Dart_TypedDataAcquireData" ascii //weight: 1
        $x_1_67 = "Dart_TypedDataReleaseData" ascii //weight: 1
        $x_1_68 = "Dart_UpdateExternalSize" ascii //weight: 1
        $x_1_69 = "Dart_UpdateFinalizableExternalSize" ascii //weight: 1
        $x_1_70 = "Dart_VersionString" ascii //weight: 1
        $x_1_71 = "Dart_WaitForEvent" ascii //weight: 1
        $x_1_72 = "Dart_WriteHeapSnapshot" ascii //weight: 1
        $x_1_73 = "Dart_WriteProfileToTimeline" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (10 of ($x*))
}

rule __PUA_Block_lolMiner_0
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:lolMiner"
        threat_id = "1879049415"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "lolMiner does not know what to do" ascii //weight: 1
        $x_1_2 = "Bitcoin" ascii //weight: 1
        $x_1_3 = "Exchange Coin" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_lolMiner_1
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:lolMiner"
        threat_id = "1879049415"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "About lolMinerGUI" wide //weight: 2
        $x_2_2 = "\\lolMinerGUI\\x64\\Release\\lolMinerGUI.pdb" ascii //weight: 2
        $x_1_3 = "OCs will not been applied. Run as Administrator" wide //weight: 1
        $x_1_4 = "MCLK lower than 5000 will only apply to Ampere and ADA" wide //weight: 1
        $x_1_5 = "lolminer.exe -a ALGO -p POOL -u WALLET.WORKERNAME" wide //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_2_*) and 2 of ($x_1_*))) or
            ((2 of ($x_2_*))) or
            (all of ($x*))
        )
}

rule __PUA_Block_TelamonBundler_0
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:TelamonBundler"
        threat_id = "1879049416"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "\\tt-sciter-installer.pdb" ascii //weight: 1
        $x_1_2 = "yandex_offer" ascii //weight: 1
        $x_1_3 = "yandex_partner_id" ascii //weight: 1
        $x_1_4 = "installer_yandex_offer" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_TelamonBundler_1
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:TelamonBundler"
        threat_id = "1879049416"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Software\\Telamon" ascii //weight: 1
        $x_1_2 = "Offer_Yandex End" ascii //weight: 1
        $x_1_3 = "Offer_Yandex Begin" ascii //weight: 1
        $x_1_4 = "uidcreator.exe" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_PremiumInstaller_0
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:PremiumInstaller"
        threat_id = "1879049441"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "install.oinstaller2.com" ascii //weight: 2
        $x_1_2 = "Player-Chrome.exe" ascii //weight: 1
        $x_1_3 = "offer" ascii //weight: 1
        $x_1_4 = "Loader_Resized.pdb" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_ShopperPro_0
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:ShopperPro"
        threat_id = "1879049463"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "jsdrv.pdb" ascii //weight: 1
        $x_2_2 = "repjs.shopper-pro.com" ascii //weight: 2
        $x_1_3 = "SOFTWARE\\ShopperPro\\JsDriver" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_FormatFactoryBundler_0
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:FormatFactoryBundler"
        threat_id = "1879049468"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Resources\\OfferPage.html" ascii //weight: 1
        $x_1_2 = "BundleConfig" ascii //weight: 1
        $x_1_3 = "OfferServiceBLL.dll" ascii //weight: 1
        $x_1_4 = "Format Factory" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __FOPEX_Deep_Analysis_VMM_Grow_0
{
    meta:
        author = "defender2yara"
        detection_name = "!#FOPEX:Deep_Analysis_VMM_Grow"
        threat_id = "1879049514"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "7"
        strings_accuracy = "Low"
    strings:
        $x_3_1 = {89 08 c6 45 ?? 6e c6 45 ?? 74 c6 45 ?? 64 c6 45 ?? 6c c6 45 ?? 6c c6 45 ?? 00 c6 45 ?? 61 c6 45 ?? 64 c6 45 ?? 76 c6 45 ?? 61 c6 45 ?? 70 c6 45 ?? 69 c6 45 ?? 33 c6 45 ?? 32 c6 45 ?? 00}  //weight: 3, accuracy: Low
        $x_4_2 = {68 ff 1f 7c c9 [0-24] 68 31 74 bc 7f}  //weight: 4, accuracy: Low
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_ML_Blocked_Youxun_0
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:ML:Blocked:Youxun"
        threat_id = "1879049516"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "ScreenSaver\\HideTime.ini" ascii //weight: 1
        $x_1_2 = "ScreenSaver\\DTime.dat" ascii //weight: 1
        $x_1_3 = "paperaz.screen.ddLives.com/count.do" ascii //weight: 1
        $x_1_4 = "screen.ddLives.com/screen/lock.ini" ascii //weight: 1
        $x_1_5 = "kuwanTemp\\kuwan\\trunk\\src\\ScreenSaver\\Release\\ScreenSaver.pdb" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (4 of ($x*))
}

rule __PUA_Block_CpuMulti_0
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:CpuMulti"
        threat_id = "1879049557"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "7"
        strings_accuracy = "High"
    strings:
        $x_3_1 = "cpuminer-multi" ascii //weight: 3
        $x_2_2 = "cpuminer-conf.json" ascii //weight: 2
        $x_1_3 = "Tanguy Pruvot" ascii //weight: 1
        $x_1_4 = "username:password pair for mining server" ascii //weight: 1
        $x_1_5 = "coinbase-addr" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_3_*) and 1 of ($x_2_*) and 2 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule __do_deep_rescan_0
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_deep_rescan"
        threat_id = "1879049585"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "2"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {8b 4d f4 8b 5d fc 8b 0c 99 8b 5d 0c 03 cf 89 5d f8 8b 5d f8 8a 1b 3a 19}  //weight: 1, accuracy: High
        $x_1_2 = {8b 5d f8 8a 5b 01 88 5d 0b 3a 59 01}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_deep_rescan_1
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_deep_rescan"
        threat_id = "1879049585"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {33 d2 6a 05 5f f7 f7 8b f9 33 fe}  //weight: 1, accuracy: High
        $x_1_2 = {e9 06 00 00 00 81 00 aa 9b 78 ff}  //weight: 1, accuracy: High
        $x_1_3 = {66 89 45 e8 6a 10 58 66 89 45 ea 8d 45 c8}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (1 of ($x*))
}

rule __do_deep_rescan_2
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_deep_rescan"
        threat_id = "1879049585"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "d%evirDlacisyhP\\.\\\\" ascii //weight: 1
        $x_1_2 = "q&d%=diu&?" ascii //weight: 1
        $x_1_3 = "&s%=ltt&d%=diu&etadpu=epyTputes" ascii //weight: 1
        $x_1_4 = "tsoh\\cte\\srevird" ascii //weight: 1
        $x_1_5 = "sys.s%\\s%" wide //weight: 1
    condition:
        (filesize < 20MB) and
        (4 of ($x*))
}

rule __do_deep_rescan_3
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_deep_rescan"
        threat_id = "1879049585"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "http://psynergi.dk/data" ascii //weight: 1
        $x_1_2 = "http://kubusse.ru/data" ascii //weight: 1
        $x_1_3 = "http://s-elisa.ru/data" ascii //weight: 1
        $x_1_4 = "http://eda.ru/data" ascii //weight: 1
        $x_1_5 = "http://vesterm.freehostia.com" ascii //weight: 1
        $x_1_6 = ".x10hosting.com" ascii //weight: 1
        $x_1_7 = ".awardspace.com" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (3 of ($x*))
}

rule __do_deep_rescan_4
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_deep_rescan"
        threat_id = "1879049585"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {98 89 04 10 dc e8 6a 43 dc}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_deep_rescan_5
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_deep_rescan"
        threat_id = "1879049585"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {a7 6e 19 a6 03 00 c7 45}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_deep_rescan_6
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_deep_rescan"
        threat_id = "1879049585"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "2"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {c7 04 24 72 6f 74 65 e8}  //weight: 1, accuracy: High
        $x_1_2 = "hVirt" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_deep_rescan_7
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_deep_rescan"
        threat_id = "1879049585"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {b8 00 04 00 00 31 d2 b9 36 07 03 00 f3 ab 8b 45 0c 6a 05}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_deep_rescan_8
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_deep_rescan"
        threat_id = "1879049585"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {00 6d 52 43 34 [0-7] 6d 52 75 6e 50 45 00}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_deep_rescan_9
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_deep_rescan"
        threat_id = "1879049585"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {f9 f5 0f 82 ?? ?? ?? ?? 81 06 00 81 ?? ?? ?? 00 00}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_deep_rescan_10
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_deep_rescan"
        threat_id = "1879049585"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {8b 44 24 3c 3b 44 24 (24|20) 0f 85 ?? ?? 00 00}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_deep_rescan_11
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_deep_rescan"
        threat_id = "1879049585"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {8b 5c 24 08 81 fb ?? ?? ?? ?? eb ?? ?? [0-4] e9 ff 34 24 e8}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_deep_rescan_12
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_deep_rescan"
        threat_id = "1879049585"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {67 6f 76 6e 2d 61 76 61 73 74 21 00}  //weight: 1, accuracy: High
        $x_1_2 = {77 64 73 75 78 2e 64 6c 6c 00}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (1 of ($x*))
}

rule __do_deep_rescan_13
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_deep_rescan"
        threat_id = "1879049585"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {79 fc fc 31 c9 89 c8 31 d2 f6 35 ?? ?? ?? ?? 86 e0 30 e4 02 80 ?? ?? ?? ?? 02 81 ?? ?? ?? ?? 00 05}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_deep_rescan_14
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_deep_rescan"
        threat_id = "1879049585"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {81 6d fc 30 00 00 00 f7 55 fc 83 6d fc ff ff 75 d8 ff 75 fc ff 75 f4 8d ?? 58 fe ff ff}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_deep_rescan_15
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_deep_rescan"
        threat_id = "1879049585"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {83 c0 0c 33 d2 52 50 8b 44 24 ?? 99 03 04 ?? 13 54 ?? 04 83 c4 08 89 44 24}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_deep_rescan_16
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_deep_rescan"
        threat_id = "1879049585"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Considered\\Otherwise\\Instances.pdb" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_deep_rescan_17
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_deep_rescan"
        threat_id = "1879049585"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {33 c0 64 8b 40 30 56 85 c0 78 0c 8b 40 0c 8b 70 1c ad 8b 40 08 eb 09 8b 40 34 83 c0 7c 8b 40 3c 5e c3}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_deep_rescan_18
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_deep_rescan"
        threat_id = "1879049585"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {68 62 67 8d a4 ff 75 ?? e8 ?? ?? ?? ?? 50 6a 00 68 2e 64 6c 6c 68 65 6c 33 32 68 6b 65 72 6e 54 ff d0}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_deep_rescan_19
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_deep_rescan"
        threat_id = "1879049585"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {81 6d fc 30 00 00 00 [0-5] f7 55 fc [0-5] ff 75 d8 ff 75 fc ff 75 f4 8d ?? 58 fe ff ff ?? e8}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_deep_rescan_20
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_deep_rescan"
        threat_id = "1879049585"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {46 83 c7 04 81 fe ?? ?? ?? ?? 75 ?? 81 c7 ?? ?? ?? ?? 01 d7 50 58 ff e7 60 00 be 00 00 00 00 bf 00 00 00 00 ba 00 00 00 00}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_deep_rescan_21
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_deep_rescan"
        threat_id = "1879049585"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "10"
        strings_accuracy = "Low"
    strings:
        $x_10_1 = {ff 37 00 00 [0-32] (7d|0f 8d) [0-32] 7f 02 00 00 [0-32] (7d|0f 8d) [0-32] 7f [0-32] (7f|0f 8f)}  //weight: 10, accuracy: Low
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_deep_rescan_22
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_deep_rescan"
        threat_id = "1879049585"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {ac 3c 41 72 06 3c 5a 77 02 04 20 aa e2 f2 81 7d ?? 6b 65 72 6e 75 c7 81 7d ?? 65 6c 33 32 75 be 81 7d ?? 2e 64 6c 6c 75}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_deep_rescan_23
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_deep_rescan"
        threat_id = "1879049585"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "!TEnigmaProtectorLoader" ascii //weight: 1
        $x_1_2 = "OLLYDBG" ascii //weight: 1
        $x_1_3 = "vmware" ascii //weight: 1
        $x_1_4 = "sandbox" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_deep_rescan_24
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_deep_rescan"
        threat_id = "1879049585"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {81 ed 05 10 40 00 8a 9d ?? ?? ?? ?? 84 db 74 13 81 c4 ?? ?? ?? ?? 2d ?? ?? ?? ?? 89 85 ?? 12 40 00 eb 19 c7 85 ?? 14 40 00 22 22 22 22 c7 85 ?? 14 40 00 33 33 33 33}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_deep_rescan_25
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_deep_rescan"
        threat_id = "1879049585"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {90 83 ec 7c 8b 94 24 90 00 00 00 c7 44 24 74 00 00 00 00 c6 44 24 73 00 8b ac 24 9c 00 00 00 8d 42 04 89 44 24 78 b8 01 00 00 00 0f b6 4a 02 89 c3 d3 e3 89 d9 49 89 4c 24 6c 0f b6 4a 01 d3 e0}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_deep_rescan_26
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_deep_rescan"
        threat_id = "1879049585"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {ba 04 00 00 00 b8 ?? ?? ?? ?? e8 ?? ?? ?? ?? ff 75 ?? 8d 45 fc ba 09 00 00 00 e8 ?? ?? ?? ?? 8b 55 fc 8b 83 ?? ?? 00 00 e8 ?? ?? ?? ?? 8d 4d ?? ba ?? ?? ?? ?? b8 ?? ?? ?? ?? e8 ?? ?? ?? ?? b2 01}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_deep_rescan_27
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_deep_rescan"
        threat_id = "1879049585"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {58 ff d0 40 e8 00 00 00 00 2d ?? ?? ?? ?? 01 04 24 ff 14 24 2d ?? ?? ?? ?? 83 7d f4 00 75 05}  //weight: 1, accuracy: Low
        $x_1_2 = {58 ff d0 40 e8 00 00 00 00 2d ?? ?? ?? ?? 01 04 24 8b 04 24 ff d0 2d ?? ?? ?? ?? 83 7d f4 00 75 05}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (1 of ($x*))
}

rule __do_deep_rescan_28
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_deep_rescan"
        threat_id = "1879049585"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {02 00 00 10 75 03 00 81 7d}  //weight: 1, accuracy: Low
        $x_1_2 = {02 00 00 10 74 03 00 81 7d}  //weight: 1, accuracy: Low
        $x_1_3 = {ff ff 02 00 00 10 75 04 00 81 bd}  //weight: 1, accuracy: Low
        $x_1_4 = {ff ff 02 00 00 10 74 04 00 81 bd}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (1 of ($x*))
}

rule __do_deep_rescan_29
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_deep_rescan"
        threat_id = "1879049585"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "2"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {68 9b 5b 14 fb}  //weight: 1, accuracy: High
        $x_1_2 = {68 bc 0c c6 73}  //weight: 1, accuracy: High
        $x_1_3 = {68 66 53 02 42}  //weight: 1, accuracy: High
        $x_1_4 = {68 ab 68 03 f4}  //weight: 1, accuracy: High
        $x_1_5 = {68 5e c4 f7 ee}  //weight: 1, accuracy: High
        $x_1_6 = {68 13 71 0b b1}  //weight: 1, accuracy: High
        $x_1_7 = {68 b6 ff 24 33}  //weight: 1, accuracy: High
        $x_1_8 = {68 c1 2e d8 f1}  //weight: 1, accuracy: High
        $x_1_9 = {68 f7 d2 6c 79}  //weight: 1, accuracy: High
        $x_1_10 = {35 82 fa 50 4b}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (2 of ($x*))
}

rule __do_deep_rescan_30
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_deep_rescan"
        threat_id = "1879049585"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_2_1 = {8d 18 43 81 3b 72 73 72 63 74}  //weight: 2, accuracy: High
        $x_1_2 = {66 c7 45 fc 63 74 c6 45 fe 00 60 8d 45 ec 50}  //weight: 1, accuracy: High
        $x_1_3 = {c7 45 f0 56 69 72 74 c7 45 f4 75 61 6c 41}  //weight: 1, accuracy: High
        $x_1_4 = {55 89 e5 83 ec 20 c7 45 e0 56 69 72 74 c7 45 e4 75 61 6c 41}  //weight: 1, accuracy: High
        $x_1_5 = {c7 45 fc 00 00 00 00 60 8b 75 08 03 76 3c 0f b7 56 06 4a}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (
            ((3 of ($x_1_*))) or
            ((1 of ($x_2_*) and 1 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule __do_deep_rescan_31
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_deep_rescan"
        threat_id = "1879049585"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "21"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {8b 4f 28 8b c6 3b c1 72 ?? 8b 45 ?? 8b 4f 04}  //weight: 1, accuracy: Low
        $x_1_2 = {8b 4e 28 8b c7 3b c1 72 ?? 8b 45 ?? 8b 4e 04}  //weight: 1, accuracy: Low
        $x_10_3 = {53 00 45 00 4c 00 46 00 55 00 50 00 44 00 41 00 54 00 45 00 00 00}  //weight: 10, accuracy: High
        $x_10_4 = {2f 00 53 00 45 00 52 00 56 00 49 00 43 00 45 00 00 00}  //weight: 10, accuracy: High
    condition:
        (filesize < 20MB) and
        (
            ((2 of ($x_10_*) and 1 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule __do_deep_rescan_32
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_deep_rescan"
        threat_id = "1879049585"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {c9 c2 10 00 0f 85 ?? ?? ff ff 05 00 8b ?? ?? 81}  //weight: 1, accuracy: Low
        $x_1_2 = {c9 c2 0c 00 0f 85 ?? ?? ff ff 05 00 8b ?? ?? 81}  //weight: 1, accuracy: Low
        $x_1_3 = {c9 c2 14 00 0f 85 ?? ?? ff ff 05 00 8b ?? ?? 81}  //weight: 1, accuracy: Low
        $x_1_4 = {c9 c2 1c 00 0f 85 ?? ?? ff ff 05 00 8b ?? ?? 81}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (1 of ($x*))
}

rule __do_deep_rescan_33
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_deep_rescan"
        threat_id = "1879049585"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "2"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {42 00 44 00 41 00 54 00 41 00 00 00}  //weight: 1, accuracy: High
        $x_1_2 = {00 42 44 41 54 41 00}  //weight: 1, accuracy: High
        $x_2_3 = {50 68 24 27 00 00 e8 [0-64] 51 68 2e 27 00 00 e8}  //weight: 2, accuracy: Low
        $x_2_4 = {8d 44 24 14 50 68 1a 27 00 00 e8}  //weight: 2, accuracy: High
        $x_2_5 = {50 6a 65 e8 ?? ?? ?? ?? 8d 4c 24 ?? 8b d1 [0-64] 51 6a 66 e8 ?? ?? ?? ?? 8b 54 24}  //weight: 2, accuracy: Low
        $x_2_6 = {c6 02 00 c7 44 24 2c 01 00 00 00 50 6a 64 e8 ?? ?? ?? ?? 8b 4c 24 24 8b 54 24 20}  //weight: 2, accuracy: Low
    condition:
        (filesize < 20MB) and
        (
            ((2 of ($x_1_*))) or
            ((1 of ($x_2_*))) or
            (all of ($x*))
        )
}

rule __do_deep_rescan_34
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_deep_rescan"
        threat_id = "1879049585"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {43 c1 ea 08 47 83 ff 04 75 0a ba ?? ?? ?? ?? bf 00 00 00 00 81 fb ?? ?? ?? ?? 72 dd 15 00 33 ?? ba ?? ?? ?? ?? 33 ff bb ?? ?? ?? ?? 83 ?? 00 75 02 28 13}  //weight: 1, accuracy: Low
        $x_1_2 = {28 13 43 c1 ea 08 41 83 f9 04 75 0a ba ?? ?? ?? ?? b9 00 00 00 00 81 fb ?? ?? ?? 00 72 e2 07 00 33 c9 ba}  //weight: 1, accuracy: Low
        $x_1_3 = {83 f8 00 75 02 28 11 41 c1 ea 08 47 83 ff 04 75 0a ba ?? ?? ?? ?? bf 00 00 00 00 81 f9 ?? ?? ?? 00 72 dd 0e 00 33 c0 ba ?? ?? ?? ?? 33 ff b9 ?? ?? ?? 00}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (1 of ($x*))
}

rule __PUA_Block_DownloadStudio_0
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:DownloadStudio"
        threat_id = "1879049638"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "7"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "offers" ascii //weight: 1
        $x_1_2 = "ShowPage" ascii //weight: 1
        $x_1_3 = "opera.com" ascii //weight: 1
        $x_1_4 = "open-magnet-uri" ascii //weight: 1
        $x_1_5 = "add-torrent" ascii //weight: 1
        $x_1_6 = "application/x-bittorrent" ascii //weight: 1
        $x_1_7 = "dstudio.exe" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __HSTR_MSIL_AgentTesla_AQ_MTB_0
{
    meta:
        author = "defender2yara"
        detection_name = "!#HSTR:MSIL/AgentTesla.AQ!MTB"
        threat_id = "1879049645"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "\\stub\\eopyEx\\achiyMe{\\Ochii_ui\\objnReleqsw\\kilo." ascii //weight: 1
        $x_1_2 = "lpNwwFiluNsme" ascii //weight: 1
        $x_1_3 = "Rxadbbjxctdrrty" ascii //weight: 1
        $x_1_4 = "ddgrstufes.exe" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __HSTR_MSIL_AgentTesla_AQ_MTB_1
{
    meta:
        author = "defender2yara"
        detection_name = "!#HSTR:MSIL/AgentTesla.AQ!MTB"
        threat_id = "1879049645"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "FFXIV_Nexus_Progress.My.Resources" ascii //weight: 1
        $x_1_2 = "FFXIV_Nexus_Progress.Main.resources" ascii //weight: 1
        $x_1_3 = "FFXIV_Nexus_Progress.Resources.resources" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __HSTR_MSIL_AgentTesla_AQ_MTB_2
{
    meta:
        author = "defender2yara"
        detection_name = "!#HSTR:MSIL/AgentTesla.AQ!MTB"
        threat_id = "1879049645"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "bRFYQZtYcKxrmWGUtgMnONlwENGr" ascii //weight: 1
        $x_1_2 = "RudawCore.Properties.Resources.resources" ascii //weight: 1
        $x_1_3 = "rQQvWVULPLYukNJh" ascii //weight: 1
        $x_1_4 = "SQUFqxTccskDSBWGUhEs" ascii //weight: 1
        $x_1_5 = "srnyjejnetdnrtsgxzgdtjzjdg" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __HSTR_MSIL_AgentTesla_AQ_MTB_3
{
    meta:
        author = "defender2yara"
        detection_name = "!#HSTR:MSIL/AgentTesla.AQ!MTB"
        threat_id = "1879049645"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = "x7a5cvwr934eqyz#Sys" ascii //weight: 1
        $x_1_2 = "23102790C6CFDB2C5199B5A457888E149EA42B8AC37E64F723B7928313F03F26" ascii //weight: 1
        $x_1_3 = {6f 75 72 63 [0-3] 6f 52 65}  //weight: 1, accuracy: Low
        $x_1_4 = "System.Runtime.InteropServices" ascii //weight: 1
        $x_1_5 = "System.Runtime.CompilerServices" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __HSTR_MSIL_AgentTesla_AQ_MTB_4
{
    meta:
        author = "defender2yara"
        detection_name = "!#HSTR:MSIL/AgentTesla.AQ!MTB"
        threat_id = "1879049645"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "QuantumChessIT2.frmMainMenu.resources" ascii //weight: 1
        $x_1_2 = "QuantumChessIT2.Game.resources" ascii //weight: 1
        $x_1_3 = "QuantumChessIT2.Resources.resources" ascii //weight: 1
        $x_1_4 = "QuantumChessIT2.PictureForm.resources" ascii //weight: 1
        $x_1_5 = "QuantumChessIT2.PlayMenu.resources" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __HSTR_MSIL_AgentTesla_AQ_MTB_5
{
    meta:
        author = "defender2yara"
        detection_name = "!#HSTR:MSIL/AgentTesla.AQ!MTB"
        threat_id = "1879049645"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "8"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "HuJinguang;Zeje" ascii //weight: 1
        $x_1_2 = "CxFlatUI.Properties.Resources.resources" ascii //weight: 1
        $x_1_3 = "IsDebuggerPresent" ascii //weight: 1
        $x_1_4 = "SetBasePasswordChar" ascii //weight: 1
        $x_1_5 = "CxFlatUI.USGFI.resources" ascii //weight: 1
        $x_1_6 = "CreateDecryptor" ascii //weight: 1
        $x_1_7 = "FromBase64String" ascii //weight: 1
        $x_1_8 = "TransformFinalBlock" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __HSTR_MSIL_AgentTesla_AQ_MTB_6
{
    meta:
        author = "defender2yara"
        detection_name = "!#HSTR:MSIL/AgentTesla.AQ!MTB"
        threat_id = "1879049645"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "11"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "DirectX.Direct3DX.UserInterface.FormGame.resources" ascii //weight: 1
        $x_1_2 = "DirectX.Direct3DX.Properties.Resources.resources" ascii //weight: 1
        $x_5_3 = "___a___bcc" ascii //weight: 5
        $x_1_4 = "NotImplementedException" ascii //weight: 1
        $x_1_5 = "Remove" ascii //weight: 1
        $x_1_6 = "eSoldierDirection" ascii //weight: 1
        $x_1_7 = "FromBase64String" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __HSTR_MSIL_AgentTesla_AQ_MTB_7
{
    meta:
        author = "defender2yara"
        detection_name = "!#HSTR:MSIL/AgentTesla.AQ!MTB"
        threat_id = "1879049645"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "7"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "GeneratedCodeAttribute" ascii //weight: 1
        $x_1_2 = "System.CodeDom.Compiler" ascii //weight: 1
        $x_1_3 = "EditorBrowsableAttribute" ascii //weight: 1
        $x_1_4 = "EditorBrowsableState" ascii //weight: 1
        $x_1_5 = "Johann.mainWin.resources" ascii //weight: 1
        $x_1_6 = "Friedrich.Properties.Resources.resources" ascii //weight: 1
        $x_1_7 = "System.Globalization" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __HSTR_MSIL_AgentTesla_AQ_MTB_8
{
    meta:
        author = "defender2yara"
        detection_name = "!#HSTR:MSIL/AgentTesla.AQ!MTB"
        threat_id = "1879049645"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "7"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "8B2255985E673FF783ABF50371E814AF5E147070FF73AB12E24943C9DEF8E31C" ascii //weight: 1
        $x_1_2 = "0F3A76B82299DF663A01D54FC89F4E17BA13B400DF4272E48B3ECDB700CBE96D" ascii //weight: 1
        $x_1_3 = "CreateDecryptor" ascii //weight: 1
        $x_1_4 = "Append" ascii //weight: 1
        $x_1_5 = "LoadComponent" ascii //weight: 1
        $x_1_6 = "MoveNext" ascii //weight: 1
        $x_1_7 = "page1.baml" wide //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __HSTR_MSIL_AgentTesla_AQ_MTB_9
{
    meta:
        author = "defender2yara"
        detection_name = "!#HSTR:MSIL/AgentTesla.AQ!MTB"
        threat_id = "1879049645"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "6"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = "Paint1.CustomColorDialog.resources" ascii //weight: 1
        $x_1_2 = "Paint1.Form1.resources" ascii //weight: 1
        $x_1_3 = "PaintIt.Main.resources" ascii //weight: 1
        $x_1_4 = "PaintIt.Properties.Resources.resources" ascii //weight: 1
        $x_1_5 = "PaintIt.ScreenOverlay.resources" ascii //weight: 1
        $x_1_6 = {0a 00 00 19 8d ?? ?? ?? 01 0a 19 8d ?? ?? ?? 01 25 16 7e ?? ?? ?? 04 a2 25 17 7e ?? ?? ?? 04 a2 25 18 72 ?? ?? ?? 70 a2 0a 02 06 28 ?? ?? ?? 06}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __HSTR_MSIL_AgentTesla_AQ_MTB_10
{
    meta:
        author = "defender2yara"
        detection_name = "!#HSTR:MSIL/AgentTesla.AQ!MTB"
        threat_id = "1879049645"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = "get_lYFVNtRELZyuIoFvGmvrpbudsgDGbJKr" ascii //weight: 1
        $x_1_2 = {43 3a 5c 55 73 65 72 73 5c 41 64 6d 69 6e 69 73 74 72 61 74 6f 72 5c 44 65 73 6b 74 6f 70 5c 43 6c 69 65 6e 74 5c 54 65 6d 70 5c 53 50 53 67 6b 42 76 4f 58 45 5c 73 72 63 5c 6f 62 6a 5c 78 38 36 5c 44 65 62 75 67 5c [0-15] 2e 70 64 62}  //weight: 1, accuracy: Low
        $x_1_3 = "Questions.dat" wide //weight: 1
        $x_1_4 = "lYFVNtRELZyuIoFvGmvrpbudsgDGbJKr" wide //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __HSTR_MSIL_AgentTesla_AQ_MTB_11
{
    meta:
        author = "defender2yara"
        detection_name = "!#HSTR:MSIL/AgentTesla.AQ!MTB"
        threat_id = "1879049645"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "!cQCBEQABgACIgACIgACIgACIgA" ascii //weight: 1
        $x_1_2 = "!QIvZmbJRXYtJ3bGJXZi1WdO5ibvlGdhpXasFmYvx2Ru0WZ0NXeTVCA" ascii //weight: 1
        $x_1_3 = "!4GAvBQaAMHAyBQZAYFAgAQeAwGAiBQbAUGAzBwcAEEABAACAgDA" ascii //weight: 1
        $x_1_4 = "!QYAQHAyBQYAAHATB" ascii //weight: 1
        $x_1_5 = "!gbA8GApBAdAEGAsBwcA4GAhBgcAQFA" ascii //weight: 1
        $x_1_6 = "MathQuiz.Properties.Resources" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __HSTR_MSIL_AgentTesla_AQ_MTB_12
{
    meta:
        author = "defender2yara"
        detection_name = "!#HSTR:MSIL/AgentTesla.AQ!MTB"
        threat_id = "1879049645"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "10"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = "ChessAnalyser.Satellite.Properties.Resources.resources" ascii //weight: 1
        $x_1_2 = "ChessAnalyser.Satellite.Properties" ascii //weight: 1
        $x_1_3 = "ChessAnalyser.Explorer.Rules" ascii //weight: 1
        $x_1_4 = "ChessAnalyser.Satellite.PGN.Downloaders" ascii //weight: 1
        $x_1_5 = "System.Collections.IEnumerator.Reset" ascii //weight: 1
        $x_5_6 = {06 0b 06 fe [0-4] 06 73 [0-3] 0a 73 [0-3] 0a 0c 08 6f [0-3] 0a 00}  //weight: 5, accuracy: Low
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __HSTR_MSIL_AgentTesla_AQ_MTB_13
{
    meta:
        author = "defender2yara"
        detection_name = "!#HSTR:MSIL/AgentTesla.AQ!MTB"
        threat_id = "1879049645"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "DebuggerHiddenAttribute" ascii //weight: 1
        $x_1_2 = "AccessedThroughPropertyAttribute" ascii //weight: 1
        $x_1_3 = "86736.resources" ascii //weight: 1
        $x_1_4 = "CKkBLHhBdpbztWMvOgAdTmXMtuRv" ascii //weight: 1
        $x_1_5 = "30AF00CEC6888BB0281307C66E8F9F0798914EE70BBBD16B7146A74F2CCE80AF" wide //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __HSTR_MSIL_AgentTesla_AQ_MTB_14
{
    meta:
        author = "defender2yara"
        detection_name = "!#HSTR:MSIL/AgentTesla.AQ!MTB"
        threat_id = "1879049645"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "7"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = "MSACCESS.Form1.resources" ascii //weight: 1
        $x_1_2 = "MSACCESS.o_programie.resources" ascii //weight: 1
        $x_1_3 = "MSACCESS.RGBFilter.resources" ascii //weight: 1
        $x_1_4 = "MSACCESS.Properties.Resources.resources" ascii //weight: 1
        $x_1_5 = "MSACCESS.BQPaint.resources" ascii //weight: 1
        $x_1_6 = "MSACCESS.new_file_window.resources" ascii //weight: 1
        $x_1_7 = {00 03 2c 0b 02 7b ?? ?? ?? 04 14 fe 03 2b 01 16 0a 06 2c 0e 00 02 7b ?? ?? ?? 04 6f ?? ?? ?? 0a 00 00 02 03 28 ?? ?? ?? 0a 00 2a}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __HSTR_MSIL_AgentTesla_AQ_MTB_15
{
    meta:
        author = "defender2yara"
        detection_name = "!#HSTR:MSIL/AgentTesla.AQ!MTB"
        threat_id = "1879049645"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "8"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "WorldOne.CConsole.resources" ascii //weight: 1
        $x_1_2 = "WorldOne.frmGame.resources" ascii //weight: 1
        $x_1_3 = "WorldOne.Instructions.resources" ascii //weight: 1
        $x_1_4 = "WorldOne.Resources.resources" ascii //weight: 1
        $x_1_5 = "WorldOne.StartScreen.resources" ascii //weight: 1
        $x_1_6 = "WorldOne.Store.resources" ascii //weight: 1
        $x_1_7 = "WorldOne.WaveEditor.resources" ascii //weight: 1
        $x_1_8 = "WorldOne.WaveReward.resources" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __HSTR_MSIL_AgentTesla_AQ_MTB_16
{
    meta:
        author = "defender2yara"
        detection_name = "!#HSTR:MSIL/AgentTesla.AQ!MTB"
        threat_id = "1879049645"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "8"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "GeneratedCodeAttribute" ascii //weight: 1
        $x_1_2 = "System.CodeDom.Compiler" ascii //weight: 1
        $x_1_3 = "EditorBrowsableAttribute" ascii //weight: 1
        $x_1_4 = "EditorBrowsableState" ascii //weight: 1
        $x_1_5 = "STAThreadAttribute" ascii //weight: 1
        $x_1_6 = "DebuggerHiddenAttribute" ascii //weight: 1
        $x_1_7 = "1FD669A634C50CC70FEAD8606A558CE6FFBC5D95414990DA7281CA25D385CB5B" ascii //weight: 1
        $x_1_8 = "WindowsApplication1.Resources.resources" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __HSTR_MSIL_AgentTesla_AQ_MTB_17
{
    meta:
        author = "defender2yara"
        detection_name = "!#HSTR:MSIL/AgentTesla.AQ!MTB"
        threat_id = "1879049645"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "8"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {1f 3f 61 0d 38 ?? ?? ?? 00 11 04 1f 3a 61 13 04 38 ?? ?? ?? 00 11 05 1f 3b 61}  //weight: 1, accuracy: Low
        $x_1_2 = {26 1f f3 13 06 38 ?? ?? ?? ff 1f 25 28 ?? ?? ?? 06 13 05 1f 2e 28 01 06}  //weight: 1, accuracy: Low
        $x_1_3 = "QUIZ_GAME.My.Resources" ascii //weight: 1
        $x_1_4 = "QUIZ_GAME.AboutBox1.resources" ascii //weight: 1
        $x_1_5 = "QUIZ_GAME.db.resources" ascii //weight: 1
        $x_1_6 = "QUIZ_GAME.Game.resources" ascii //weight: 1
        $x_1_7 = "QUIZ_GAME.Resources.resources" ascii //weight: 1
        $x_1_8 = "QUIZ_GAME.MainMenu.resources" ascii //weight: 1
        $x_1_9 = "TransformFinalBlock" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (8 of ($x*))
}

rule __HSTR_MSIL_AgentTesla_AQ_MTB_18
{
    meta:
        author = "defender2yara"
        detection_name = "!#HSTR:MSIL/AgentTesla.AQ!MTB"
        threat_id = "1879049645"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "14"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "minesweeper.PictureRes.resources" ascii //weight: 2
        $x_2_2 = "minesweeper.Resources.resources" ascii //weight: 2
        $x_2_3 = "minesweeper.Form1.resources" ascii //weight: 2
        $x_1_4 = "BitConverter" ascii //weight: 1
        $x_1_5 = "SpecialDirectoriesProxy" ascii //weight: 1
        $x_1_6 = "HideModuleNameAttribute" ascii //weight: 1
        $x_1_7 = "addedHandlerLockObject" ascii //weight: 1
        $x_1_8 = "add_Load" ascii //weight: 1
        $x_1_9 = "Create__Instance__" ascii //weight: 1
        $x_1_10 = "Dispose__Instance__" ascii //weight: 1
        $x_1_11 = "ShutdownMode" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __HSTR_MSIL_AgentTesla_AQ_MTB_19
{
    meta:
        author = "defender2yara"
        detection_name = "!#HSTR:MSIL/AgentTesla.AQ!MTB"
        threat_id = "1879049645"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "15"
        strings_accuracy = "High"
    strings:
        $x_5_1 = "7F26B23B4C626A1DD0675DD38139727DFA5EE4A7D6E3864D4018200AA4979847" ascii //weight: 5
        $x_5_2 = "326ff38b49154e7cbdc623b79ec84609.Resources.resources" ascii //weight: 5
        $x_1_3 = "AssemblyProductAttribute" ascii //weight: 1
        $x_1_4 = "AssemblyCopyrightAttribute" ascii //weight: 1
        $x_1_5 = "AssemblyCompanyAttribute" ascii //weight: 1
        $x_1_6 = "RuntimeCompatibilityAttribute" ascii //weight: 1
        $x_1_7 = "System.Runtime.Versioning" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __HSTR_MSIL_AgentTesla_AQ_MTB_20
{
    meta:
        author = "defender2yara"
        detection_name = "!#HSTR:MSIL/AgentTesla.AQ!MTB"
        threat_id = "1879049645"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "14"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "FromBase64String" ascii //weight: 1
        $x_1_2 = "Stopwatch" ascii //weight: 1
        $x_1_3 = "AppDomain" ascii //weight: 1
        $x_1_4 = "MovingStars.Form1.resources" ascii //weight: 1
        $x_1_5 = "test3GUIModalForm.modalForm.resources" ascii //weight: 1
        $x_1_6 = "Planets.frmMain.resources" ascii //weight: 1
        $x_1_7 = "MovingStars.Properties.Resources.resources" ascii //weight: 1
        $x_1_8 = "Concat" ascii //weight: 1
        $x_1_9 = "GetObject" ascii //weight: 1
        $x_1_10 = "get_ReadMe" ascii //weight: 1
        $x_1_11 = "Replace" ascii //weight: 1
        $x_1_12 = "Convert" ascii //weight: 1
        $x_1_13 = "ReadKey" ascii //weight: 1
        $x_1_14 = "ConsoleKey" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __HSTR_MSIL_AgentTesla_AQ_MTB_21
{
    meta:
        author = "defender2yara"
        detection_name = "!#HSTR:MSIL/AgentTesla.AQ!MTB"
        threat_id = "1879049645"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "10"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "System.CodeDom.Compiler" ascii //weight: 1
        $x_1_2 = "DebuggerNonUserCodeAttribute" ascii //weight: 1
        $x_1_3 = "EditorBrowsableAttribute" ascii //weight: 1
        $x_1_4 = "EditorBrowsableState" ascii //weight: 1
        $x_1_5 = "agecalculator.RateServiceWebReference" ascii //weight: 1
        $x_1_6 = "agecalculator.Form1.resources" ascii //weight: 1
        $x_1_7 = "agecalculator.Properties.Resources.resources" ascii //weight: 1
        $x_1_8 = "LoadServiceCodes" ascii //weight: 1
        $x_1_9 = "ParseRatesResponseMessage" ascii //weight: 1
        $x_1_10 = "FromBase64String" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __HSTR_MSIL_AgentTesla_AQ_MTB_22
{
    meta:
        author = "defender2yara"
        detection_name = "!#HSTR:MSIL/AgentTesla.AQ!MTB"
        threat_id = "1879049645"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "9"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = "HotelManagementUI.System_" ascii //weight: 1
        $x_1_2 = "FormMain_Load" ascii //weight: 1
        $x_1_3 = "set_PasswordChar" ascii //weight: 1
        $x_1_4 = "HotelManagementUI.System_.FormPsModify.resources" ascii //weight: 1
        $x_1_5 = "HotelManagementUI.Roomer.FormRoomer.resources" ascii //weight: 1
        $x_1_6 = "HotelManagementUI.v1.resources" ascii //weight: 1
        $x_1_7 = "FromBase64String" ascii //weight: 1
        $x_1_8 = "ReverseString" ascii //weight: 1
        $x_1_9 = {00 16 0d 00 06 07 16 20 ?? ?? ?? 00 6f ?? ?? ?? 0a 0d 09 16 fe 02 13 04 11 04 2c 0c 00 08 07 16 09 6f ?? ?? ?? 0a 00 00 00 09 16 fe 02 13 05 11 05 2d d0 08 6f ?? ?? ?? 0a 13 06}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __HSTR_MSIL_AgentTesla_AQ_MTB_23
{
    meta:
        author = "defender2yara"
        detection_name = "!#HSTR:MSIL/AgentTesla.AQ!MTB"
        threat_id = "1879049645"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "9"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Kachou.FormKachou.resources" ascii //weight: 1
        $x_1_2 = "Nokorimono.MainForm.resources" ascii //weight: 1
        $x_1_3 = "Koketsu.MDIParent1.resources" ascii //weight: 1
        $x_1_4 = "Koketsu.MDIParent2.resources" ascii //weight: 1
        $x_1_5 = "Koketsu.MDIParent3.resources" ascii //weight: 1
        $x_1_6 = "Koketsu.MDIParent4.resources" ascii //weight: 1
        $x_1_7 = "Koketsu.MDIParent5.resources" ascii //weight: 1
        $x_1_8 = "Koketsu.Properties.Resources.resources" ascii //weight: 1
        $x_1_9 = "get_cccccccccccccccccccccccccccccccccccc" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __HSTR_MSIL_AgentTesla_AQ_MTB_24
{
    meta:
        author = "defender2yara"
        detection_name = "!#HSTR:MSIL/AgentTesla.AQ!MTB"
        threat_id = "1879049645"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "9"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "DebuggerNonUserCodeAttribute" ascii //weight: 1
        $x_1_2 = "CompilerGeneratedAttribute" ascii //weight: 1
        $x_1_3 = "EditorBrowsableAttribute" ascii //weight: 1
        $x_1_4 = "EditorBrowsableState" ascii //weight: 1
        $x_1_5 = "DebuggerBrowsableAttribute" ascii //weight: 1
        $x_1_6 = "DebuggerBrowsableState" ascii //weight: 1
        $x_1_7 = "BirdHuntingGame.Forms.GameOptionsForm.resources" ascii //weight: 1
        $x_1_8 = "BirdHuntingGame.Forms.PlayGameForm.resources" ascii //weight: 1
        $x_1_9 = "BirdHuntingGame.Properties.Resources.resources" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __HSTR_MSIL_AgentTesla_AQ_MTB_25
{
    meta:
        author = "defender2yara"
        detection_name = "!#HSTR:MSIL/AgentTesla.AQ!MTB"
        threat_id = "1879049645"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "4C816952BA53CC361D8E45BD833338DC6427E4A5D5F06EBAD5351FD46439A15A" ascii //weight: 1
        $x_1_2 = "Alkoholkonsumverhinderungsmaschinen.GameForm.resources" ascii //weight: 1
        $x_1_3 = "Alkoholkonsumverhinderungsmaschinen.HighScoresForm.resources" ascii //weight: 1
        $x_1_4 = "Alkoholkonsumverhinderungsmaschinen.MainMenuForm.resources" ascii //weight: 1
        $x_1_5 = "Alkoholkonsumverhinderungsmaschinen.Properties.Resources.resources" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __HSTR_MSIL_AgentTesla_AQ_MTB_26
{
    meta:
        author = "defender2yara"
        detection_name = "!#HSTR:MSIL/AgentTesla.AQ!MTB"
        threat_id = "1879049645"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "13"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "GoogleTakeoutImageDownloader.Propertie" ascii //weight: 1
        $x_1_2 = "GoogleTakeoutImageDownloader.Form1.resources" ascii //weight: 1
        $x_1_3 = "GoogleTakeoutImageDownloader.Properties.Resources.resources" ascii //weight: 1
        $x_1_4 = "MemoryStream" ascii //weight: 1
        $x_1_5 = "ReadByte" ascii //weight: 1
        $x_1_6 = "IDownloadProgressNotifier" ascii //weight: 1
        $x_1_7 = "DownloadFile" ascii //weight: 1
        $x_1_8 = "OnDownloadFinish" ascii //weight: 1
        $x_1_9 = "StartDownload" ascii //weight: 1
        $x_1_10 = "CreateDirectory" ascii //weight: 1
        $x_1_11 = "DirectoryInfo" ascii //weight: 1
        $x_1_12 = "Encoding" ascii //weight: 1
        $x_1_13 = "FromBase64String" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __HSTR_MSIL_AgentTesla_AQ_MTB_27
{
    meta:
        author = "defender2yara"
        detection_name = "!#HSTR:MSIL/AgentTesla.AQ!MTB"
        threat_id = "1879049645"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "8"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = "System.Runtime.InteropServices" ascii //weight: 1
        $x_1_2 = "System.Runtime.CompilerServices" ascii //weight: 1
        $x_1_3 = "SMC.Utilities.RSG.Random" ascii //weight: 1
        $x_1_4 = "System.Resources" ascii //weight: 1
        $x_1_5 = "SMC.Utilities.RSG.Properties.Resources.resources" ascii //weight: 1
        $x_1_6 = "SMC.Utilities.RSG.Properties" ascii //weight: 1
        $x_1_7 = "GalSrpyytoYowNdZBrIZAlOYXognmcGesEg" ascii //weight: 1
        $x_5_8 = "84716D38618DAC432C67D399FAD9FEB8D459D640609C9F5D15ACB686833B4F1B" ascii //weight: 5
        $x_1_9 = {06 00 00 06 0b 07 2d f2 02 7b ?? ?? ?? 04 6f ?? ?? ?? 06 00 2a}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (
            ((8 of ($x_1_*))) or
            ((1 of ($x_5_*) and 3 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule __HSTR_MSIL_AgentTesla_AQ_MTB_28
{
    meta:
        author = "defender2yara"
        detection_name = "!#HSTR:MSIL/AgentTesla.AQ!MTB"
        threat_id = "1879049645"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "8"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {06 0a 1f 1e 0b 16 0c 2b 0e 20 ?? ?? ?? 00 28 ?? ?? ?? 0a 08 17 58 0c 08 07 32 ee}  //weight: 1, accuracy: Low
        $x_1_2 = "KVLC media player, VideoLAN and x264 are registered trademarks from VideoLAN" ascii //weight: 1
        $x_1_3 = "WindowsFormsApp1.Form1.resources" ascii //weight: 1
        $x_1_4 = "WindowsFormsApp1.Properties.Resources.resources" ascii //weight: 1
        $x_1_5 = "3System.Resources.Tools.StronglyTypedResourceBuilder" ascii //weight: 1
        $x_1_6 = "set_KeepAlive" ascii //weight: 1
        $x_1_7 = "set_AllowAutoRedirect" ascii //weight: 1
        $x_1_8 = "set_UnsafeAuthenticatedConnectionSharing" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __HSTR_MSIL_AgentTesla_AQ_MTB_29
{
    meta:
        author = "defender2yara"
        detection_name = "!#HSTR:MSIL/AgentTesla.AQ!MTB"
        threat_id = "1879049645"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "9"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "faApinwfdUvy1QlFB6AYdm5M5sYiLpwn6" ascii //weight: 1
        $x_1_2 = "Escape_Room_Game.Form1.resources" ascii //weight: 1
        $x_1_3 = "Escape_Room_Game.intro.resources" ascii //weight: 1
        $x_1_4 = "Escape_Room_Game.MDIParent1.resources" ascii //weight: 1
        $x_1_5 = "Escape_Room_Game.MDIParent2.resources" ascii //weight: 1
        $x_1_6 = "Escape_Room_Game.Resources.resources" ascii //weight: 1
        $x_1_7 = "Escape_Room_Game.play.resources" ascii //weight: 1
        $x_1_8 = "Escape_Room_Game.start.resources" ascii //weight: 1
        $x_1_9 = "Escape_Room_Game.userlogin.resources" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __HSTR_MSIL_AgentTesla_AQ_MTB_30
{
    meta:
        author = "defender2yara"
        detection_name = "!#HSTR:MSIL/AgentTesla.AQ!MTB"
        threat_id = "1879049645"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "11"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = "FlappyBird.Form1.resources" ascii //weight: 1
        $x_1_2 = "Life.LifeUI.resources" ascii //weight: 1
        $x_1_3 = "HelicopterShooting.MainGame.resources" ascii //weight: 1
        $x_1_4 = "Triangulation.UI.MainForm.resources" ascii //weight: 1
        $x_1_5 = "HelicopterShooting.FormMain.resources" ascii //weight: 1
        $x_1_6 = "Triangulation.Core.Properties.Resources.resources" ascii //weight: 1
        $x_1_7 = "get_sssss" ascii //weight: 1
        $x_1_8 = "TimeZoneInfoComparer" ascii //weight: 1
        $x_1_9 = {46 6f 72 6d 31 5f 4c 6f 61 64 00 4c 69 66 65 55 49 5f 4c 6f 61 64}  //weight: 1, accuracy: High
        $x_1_10 = "sdfsdfs111" wide //weight: 1
        $x_1_11 = {0d 09 16 fe 02 13 04 11 04 2c 0c 00 08 07 16 09 6f ?? ?? ?? 0a}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __HSTR_MSIL_AgentTesla_AQ_MTB_31
{
    meta:
        author = "defender2yara"
        detection_name = "!#HSTR:MSIL/AgentTesla.AQ!MTB"
        threat_id = "1879049645"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "10"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "MathGenerator.Generators.SimpleEquation" ascii //weight: 1
        $x_1_2 = "MathGenerator.Generators.SimpleEquation.Models" ascii //weight: 1
        $x_1_3 = "MathGenerator.Models" ascii //weight: 1
        $x_1_4 = "MathGenerator.Generators.Models" ascii //weight: 1
        $x_1_5 = "FromBase64CharArray" ascii //weight: 1
        $x_1_6 = "System.Runtime.InteropServices" ascii //weight: 1
        $x_1_7 = "System.Runtime.CompilerServices" ascii //weight: 1
        $x_1_8 = "System.Resources" ascii //weight: 1
        $x_1_9 = "Overwolf.Form1.resources" ascii //weight: 1
        $x_1_10 = "Overwolf.Properties.Resources.resources" ascii //weight: 1
        $x_1_11 = "B42.exe" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (10 of ($x*))
}

rule __HSTR_MSIL_AgentTesla_AQ_MTB_32
{
    meta:
        author = "defender2yara"
        detection_name = "!#HSTR:MSIL/AgentTesla.AQ!MTB"
        threat_id = "1879049645"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "12"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = "The_Gasp.Form1.resources" ascii //weight: 1
        $x_2_2 = "The_Gasp.SplashScreen1.resources" ascii //weight: 2
        $x_1_3 = "The_Gasp.Form2.resources" ascii //weight: 1
        $x_1_4 = "The_Gasp.Form3.resources" ascii //weight: 1
        $x_1_5 = "The_Gasp.Form4.resources" ascii //weight: 1
        $x_2_6 = "The_Gasp.aide.resources" ascii //weight: 2
        $x_1_7 = "The_Gasp.CardBackDialog.resources" ascii //weight: 1
        $x_1_8 = "The_Gasp.DealAgainDialog.resources" ascii //weight: 1
        $x_1_9 = "The_Gasp.OptionsDialog.resources" ascii //weight: 1
        $x_1_10 = "The_Gasp.Resources.resources" ascii //weight: 1
        $x_1_11 = {0a 02 02 fe 06 1d 00 00 06 73 ?? ?? ?? 0a 28 ?? ?? ?? 0a 02 28 ?? ?? ?? 06}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (
            ((2 of ($x_2_*) and 8 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule __HSTR_MSIL_AgentTesla_AQ_MTB_33
{
    meta:
        author = "defender2yara"
        detection_name = "!#HSTR:MSIL/AgentTesla.AQ!MTB"
        threat_id = "1879049645"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "13"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "TelegramDesktop.Form1.resources" ascii //weight: 1
        $x_1_2 = "TelegramDesktop.frmCategories.resources" ascii //weight: 1
        $x_1_3 = "TelegramDesktop.frmHangman.resources" ascii //weight: 1
        $x_1_4 = "TelegramDesktop.frmStartMenu.resources" ascii //weight: 1
        $x_1_5 = "TelegramDesktop.Resources.resources" ascii //weight: 1
        $x_1_6 = "m_Form1" ascii //weight: 1
        $x_1_7 = "m_frmCategories" ascii //weight: 1
        $x_1_8 = "m_frmHangman" ascii //weight: 1
        $x_1_9 = "m_frmStartMenu" ascii //weight: 1
        $x_1_10 = "Create__Instance__" ascii //weight: 1
        $x_1_11 = "numofenemiesspawned" ascii //weight: 1
        $x_1_12 = "numofenemiesinround" ascii //weight: 1
        $x_1_13 = "frmHangman_Load" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __HSTR_MSIL_AgentTesla_AQ_MTB_34
{
    meta:
        author = "defender2yara"
        detection_name = "!#HSTR:MSIL/AgentTesla.AQ!MTB"
        threat_id = "1879049645"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "16"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "CipherMode" ascii //weight: 1
        $x_1_2 = "System.Security.Cryptography" ascii //weight: 1
        $x_1_3 = "TripleDESCryptoServiceProvider" ascii //weight: 1
        $x_1_4 = "Encoding" ascii //weight: 1
        $x_1_5 = "XmlSchemaObjectCollection" ascii //weight: 1
        $x_1_6 = "XmlSchemaParticle" ascii //weight: 1
        $x_1_7 = "XmlSchemaSequence" ascii //weight: 1
        $x_1_8 = "XmlSchemaSet" ascii //weight: 1
        $x_1_9 = "XmlRootAttribute" ascii //weight: 1
        $x_1_10 = "System.Xml.Serialization" ascii //weight: 1
        $x_1_11 = "set_SchemaSerializationMode" ascii //weight: 1
        $x_1_12 = "Clone" ascii //weight: 1
        $x_1_13 = "WriteXmlSchema" ascii //weight: 1
        $x_1_14 = "3System.Resources.Tools.StronglyTypedResourceBuilder" ascii //weight: 1
        $x_1_15 = "Copyright" ascii //weight: 1
        $x_1_16 = "Radu Martin, 2017" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __HSTR_MSIL_AgentTesla_AQ_MTB_35
{
    meta:
        author = "defender2yara"
        detection_name = "!#HSTR:MSIL/AgentTesla.AQ!MTB"
        threat_id = "1879049645"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "12"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = "Microsoft.VisualBasic.ApplicationServices" ascii //weight: 1
        $x_1_2 = "System.Runtime.InteropServices" ascii //weight: 1
        $x_1_3 = "Microsoft.VisualBasic.CompilerServices" ascii //weight: 1
        $x_1_4 = "System.Runtime.CompilerServices" ascii //weight: 1
        $x_1_5 = "System.Resources" ascii //weight: 1
        $x_1_6 = "game.My.Resources" ascii //weight: 1
        $x_1_7 = "game.Game.resources" ascii //weight: 1
        $x_1_8 = "game.Resources.resources" ascii //weight: 1
        $x_1_9 = "game.MainMenu.resources" ascii //weight: 1
        $x_1_10 = "game.InstructionsMenu.resources" ascii //weight: 1
        $x_1_11 = "FromBase64String" ascii //weight: 1
        $x_1_12 = {0a 2b 00 06 2a 4f 00 00 28 ?? ?? ?? 06 72 [0-3] 70 7e ?? ?? ?? 04 6f ?? ?? ?? 0a 28 [0-3] 0a 0b 07 74 [0-3] 01}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __HSTR_MSIL_AgentTesla_AQ_MTB_36
{
    meta:
        author = "defender2yara"
        detection_name = "!#HSTR:MSIL/AgentTesla.AQ!MTB"
        threat_id = "1879049645"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "IWshShell2" ascii //weight: 1
        $x_1_2 = "ECF14B92DFF0A1117EC5D501E880C46DF528CDFE1E4FF10DBDCD54DCA3592FE3" ascii //weight: 1
        $x_1_3 = "605F46E2BF165B77EA7233A34BCE9C2B7051BC92548F59FBED19B6EE118CA16F" ascii //weight: 1
        $x_1_4 = "aV4.Properties.Resources.resources" ascii //weight: 1
        $x_1_5 = "hBu.Properties.Resources.resources" ascii //weight: 1
        $x_2_6 = "E9DB8F4DCEC110AA3BE5CD4183769C2BE007ECBC5F7CBEF14AC1AB32D7BF9AC2" ascii //weight: 2
        $x_2_7 = "dAtt]TMute" ascii //weight: 2
        $x_2_8 = "!Thnx progrfr cannoy%be run%nn DOS rtde." ascii //weight: 2
        $x_2_9 = "Systjr.Collehyions.Gjseric" ascii //weight: 2
    condition:
        (filesize < 20MB) and
        (
            ((4 of ($x_1_*))) or
            ((1 of ($x_2_*) and 2 of ($x_1_*))) or
            ((2 of ($x_2_*))) or
            (all of ($x*))
        )
}

rule __HSTR_MSIL_AgentTesla_AQ_MTB_37
{
    meta:
        author = "defender2yara"
        detection_name = "!#HSTR:MSIL/AgentTesla.AQ!MTB"
        threat_id = "1879049645"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "10"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {41 70 70 44 6f 6d 61 69 6e 00 67 65 74 5f 43 75 72 72 65 6e 74 44 6f 6d 61 69 6e}  //weight: 1, accuracy: High
        $x_1_2 = {46 72 6f 6d 42 61 73 65 36 34 43 68 61 72 41 72 72 61 79 00 4c 6f 61 64 00 41 73 73 65 6d 62 6c 79}  //weight: 1, accuracy: High
        $x_1_3 = {00 46 72 6f 6d 42 61 73 65 36 34 43 68 61 72 41 72 72 61 79 00 4c 6f 61 64}  //weight: 1, accuracy: High
        $x_3_4 = "Pool.frmJatekosNyer.resources" ascii //weight: 3
        $x_1_5 = "Pool.frmMenu.resources" ascii //weight: 1
        $x_1_6 = "Pool.frmPontok.resources" ascii //weight: 1
        $x_1_7 = "HelicopterShooting.MainGame.resources" ascii //weight: 1
        $x_1_8 = "HelicopterShooting.FormMain.resources" ascii //weight: 1
        $x_1_9 = "HelicopterShooting.Properties.Resources.resources" ascii //weight: 1
        $x_1_10 = "SnakeGameWinForms.SnakeGame.resources" ascii //weight: 1
        $x_1_11 = {04 a2 25 18 72 ?? ?? ?? 70 a2 25 19 72 ?? ?? ?? 70 a2 25 1a 72 ?? ?? ?? 70 a2 0a 12 00 06 8e 69 18 59 28}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (
            ((10 of ($x_1_*))) or
            ((1 of ($x_3_*) and 7 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule __HSTR_MSIL_AgentTesla_AQ_MTB_38
{
    meta:
        author = "defender2yara"
        detection_name = "!#HSTR:MSIL/AgentTesla.AQ!MTB"
        threat_id = "1879049645"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "13"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = "System.Runtime.InteropServices" ascii //weight: 1
        $x_1_2 = "System.Runtime.CompilerServices" ascii //weight: 1
        $x_1_3 = "System.Resources" ascii //weight: 1
        $x_1_4 = "DiceRoller.Form1.resources" ascii //weight: 1
        $x_1_5 = "DiceRoller.Properties.Resources.resources" ascii //weight: 1
        $x_1_6 = "DiceRoller.Properties" ascii //weight: 1
        $x_1_7 = "get_IncludeProperties" ascii //weight: 1
        $x_1_8 = "set_IncludeProperties" ascii //weight: 1
        $x_1_9 = "get_CanAccessMissingProperties" ascii //weight: 1
        $x_1_10 = "set_CanAccessMissingProperties" ascii //weight: 1
        $x_1_11 = "get_CanAlterProperties" ascii //weight: 1
        $x_1_12 = "set_CanAlterProperties" ascii //weight: 1
        $x_1_13 = {0b 2b 00 07 2a 4f 00 00 28 ?? ?? ?? 06 72 ?? ?? ?? 70 7e ?? ?? ?? 04 6f ?? ?? ?? 0a 0a 06 74 ?? ?? ?? 01}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __HSTR_MSIL_AgentTesla_AQ_MTB_39
{
    meta:
        author = "defender2yara"
        detection_name = "!#HSTR:MSIL/AgentTesla.AQ!MTB"
        threat_id = "1879049645"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "9"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "beerparlourbillingsystem.Database.resources" ascii //weight: 1
        $x_1_2 = "beerparlourbillingsystem.adduser.resources" ascii //weight: 1
        $x_1_3 = "beerparlourbillingsystem.addproduct.resources" ascii //weight: 1
        $x_1_4 = "beerparlourbillingsystem.billing.resources" ascii //weight: 1
        $x_1_5 = "beerparlourbillingsystem.Login.resources" ascii //weight: 1
        $x_1_6 = "beerparlourbillingsystem.Splashscreen.resources" ascii //weight: 1
        $x_1_7 = "beerparlourbillingsystem.main.resources" ascii //weight: 1
        $x_1_8 = "beerparlourbillingsystem.Resources.resources" ascii //weight: 1
        $x_1_9 = "beerparlourbillingsystem.receipt.resources" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __HSTR_MSIL_AgentTesla_AQ_MTB_40
{
    meta:
        author = "defender2yara"
        detection_name = "!#HSTR:MSIL/AgentTesla.AQ!MTB"
        threat_id = "1879049645"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "10"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = "Scale_Detect.frmDeleteUser.resources" ascii //weight: 1
        $x_1_2 = "Scale_Detect.Resources.resources" ascii //weight: 1
        $x_1_3 = "Scale_Detect.frmMotorEdit.resources" ascii //weight: 1
        $x_1_4 = "Scale_Detect.frmNonMotorEdit.resources" ascii //weight: 1
        $x_1_5 = "Scale_Detect.FrmDataManagement.resources" ascii //weight: 1
        $x_1_6 = "Scale_Detect.frmMotorReport.resources" ascii //weight: 1
        $x_1_7 = "Scale_Detect.frmNonMotorReport.resources" ascii //weight: 1
        $x_1_8 = "Scale_Detect.frmAbout.resources" ascii //weight: 1
        $x_1_9 = "Password has been succesfully Changed" wide //weight: 1
        $x_1_10 = {de 02 00 dc 00 28 ?? ?? ?? 06 02 6f ?? ?? ?? 0a 00 2a 2f 00 28 ?? ?? ?? 0a 28 ?? ?? ?? 0a 00}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __HSTR_MSIL_AgentTesla_AQ_MTB_41
{
    meta:
        author = "defender2yara"
        detection_name = "!#HSTR:MSIL/AgentTesla.AQ!MTB"
        threat_id = "1879049645"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "17"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "AppDomain" ascii //weight: 1
        $x_1_2 = "GeneratedCodeAttribute" ascii //weight: 1
        $x_1_3 = "System.CodeDom.Compiler" ascii //weight: 1
        $x_1_4 = "ApplicationSettingsBase" ascii //weight: 1
        $x_1_5 = "System.Configuration" ascii //weight: 1
        $x_1_6 = "DebuggerHiddenAttribute" ascii //weight: 1
        $x_1_7 = "DebuggerNonUserCodeAttribute" ascii //weight: 1
        $x_1_8 = "ReadByte" ascii //weight: 1
        $x_1_9 = "BlockCopy" ascii //weight: 1
        $x_1_10 = "Synchronized" ascii //weight: 1
        $x_1_11 = "System.Security.Cryptography" ascii //weight: 1
        $x_1_12 = "3System.Resources.Tools.StronglyTypedResourceBuilder" ascii //weight: 1
        $x_5_13 = "Werbeagentur.Properties.Resources.resources" ascii //weight: 5
        $x_5_14 = "gin_rummy.Properties.Resources.resources" ascii //weight: 5
        $x_5_15 = "Maze.Properties.Resources.resources" ascii //weight: 5
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_5_*) and 12 of ($x_1_*))) or
            ((2 of ($x_5_*) and 7 of ($x_1_*))) or
            ((3 of ($x_5_*) and 2 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule __HSTR_MSIL_AgentTesla_AQ_MTB_42
{
    meta:
        author = "defender2yara"
        detection_name = "!#HSTR:MSIL/AgentTesla.AQ!MTB"
        threat_id = "1879049645"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "16"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "CleanChessBoardPieces" ascii //weight: 1
        $x_1_2 = "GenerateChessPieces" ascii //weight: 1
        $x_1_3 = "chessPieces" ascii //weight: 1
        $x_1_4 = "PrintPieces" ascii //weight: 1
        $x_1_5 = "pieces" ascii //weight: 1
        $x_1_6 = "System.Runtime.InteropServices" ascii //weight: 1
        $x_1_7 = "System.Runtime.CompilerServices" ascii //weight: 1
        $x_1_8 = "PrintGameReferences" ascii //weight: 1
        $x_1_9 = "System.Resources" ascii //weight: 1
        $x_1_10 = "SMC.Utilities.RSG.Properties.Resources.resources" ascii //weight: 1
        $x_1_11 = "SMC.Utilities.RSG.Properties" ascii //weight: 1
        $x_1_12 = "setRandomLocation" ascii //weight: 1
        $x_1_13 = "DuplicateGlobalControlBlockException" ascii //weight: 1
        $x_1_14 = "A library from generating random strings based on a simple pattern language." ascii //weight: 1
        $x_1_15 = "System.Security.Cryptography" ascii //weight: 1
        $x_1_16 = "UpdateChessPieceLocation" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __HSTR_MSIL_AgentTesla_AQ_MTB_43
{
    meta:
        author = "defender2yara"
        detection_name = "!#HSTR:MSIL/AgentTesla.AQ!MTB"
        threat_id = "1879049645"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "12"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Imaginer.malheureux" wide //weight: 1
        $x_1_2 = "CarParking.CarDetails.resources" ascii //weight: 1
        $x_1_3 = "CarParking.frmCarInventory.resources" ascii //weight: 1
        $x_1_4 = "CarParking.Load.resources" ascii //weight: 1
        $x_1_5 = "CarParking.MainSystem.resources" ascii //weight: 1
        $x_1_6 = "CarParking.Resources.resources" ascii //weight: 1
        $x_1_7 = "CarParking.ParkingSlots.resources" ascii //weight: 1
        $x_1_8 = "CarParking.Services.resources" ascii //weight: 1
        $x_1_9 = "CarParking.Sign_Up.resources" ascii //weight: 1
        $x_1_10 = "CarParking.ViewOperations.resources" ascii //weight: 1
        $x_1_11 = "CarParking.ViewVehicels.resources" ascii //weight: 1
        $x_1_12 = "F.g.resources" ascii //weight: 1
        $x_1_13 = "ALL VEHICLES ARE PARKED AT OWNERS RISK!!!" wide //weight: 1
    condition:
        (filesize < 20MB) and
        (12 of ($x*))
}

rule __HSTR_MSIL_AgentTesla_AQ_MTB_44
{
    meta:
        author = "defender2yara"
        detection_name = "!#HSTR:MSIL/AgentTesla.AQ!MTB"
        threat_id = "1879049645"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "13"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = "rbAdmin_CheckedChanged_1" ascii //weight: 1
        $x_1_2 = "rbDoctor_CheckedChanged_1" ascii //weight: 1
        $x_1_3 = "rbReceptionist_CheckedChanged_1" ascii //weight: 1
        $x_1_4 = "remove_PatientRowChanged" ascii //weight: 1
        $x_1_5 = "FromBase64String" ascii //weight: 1
        $x_1_6 = "TimeZoneInfoComparer" ascii //weight: 1
        $x_1_7 = "SWE2_Project1.Login.resources" ascii //weight: 1
        $x_1_8 = "SWE2_Project1.Admin.resources" ascii //weight: 1
        $x_1_9 = "SWE2_Project1.Doctor.resources" ascii //weight: 1
        $x_1_10 = "SWE2_Project1.Properties.Resources.resources" ascii //weight: 1
        $x_1_11 = "SWE2_Project1.Receptionist.resources" ascii //weight: 1
        $x_1_12 = "SWE2_Project1.DBDataSetTableAdapters" ascii //weight: 1
        $x_1_13 = {53 00 57 00 45 00 32 00 5f 00 50 00 72 00 6f 00 6a 00 65 00 63 00 74 00 31 00 2e 00 50 00 72 00 6f 00 70 00 65 00 72 00 74 00 69 00 65 00 73 00 2e 00 52 00 65 00 73 00 6f 00 75 00 72 00 63 00 65 00 73 00 [0-5] 73 00 73 00 73 00 73 00 73 00}  //weight: 1, accuracy: Low
        $x_1_14 = "get_ssss" ascii //weight: 1
        $x_1_15 = {00 52 65 6d 6f 76 65 00 [0-15] 2e 65 78 65 00 73}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (13 of ($x*))
}

rule __HSTR_MSIL_AgentTesla_AQ_MTB_45
{
    meta:
        author = "defender2yara"
        detection_name = "!#HSTR:MSIL/AgentTesla.AQ!MTB"
        threat_id = "1879049645"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "16"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "TimeStamp_Prefixer.Dialog1.resources" ascii //weight: 1
        $x_1_2 = "TimeStamp_Prefixer.FrmViewer.resources" ascii //weight: 1
        $x_1_3 = "TimeStamp_Prefixer.LaunchBar.resources" ascii //weight: 1
        $x_1_4 = "TimeStamp_Prefixer.LoadImageFolderDialog.resources" ascii //weight: 1
        $x_1_5 = "TimeStamp_Prefixer.Main_Screen.resources" ascii //weight: 1
        $x_1_6 = "TimeStamp_Prefixer.Resources.resources" ascii //weight: 1
        $x_1_7 = "TimeStamp_Prefixer.SetSpeedDialog.resources" ascii //weight: 1
        $x_1_8 = "TimeStamp_Prefixer.ThreadController.resources" ascii //weight: 1
        $x_1_9 = "get_StartupPath" ascii //weight: 1
        $x_1_10 = "add_Shutdown" ascii //weight: 1
        $x_1_11 = "DeleteDirectory" ascii //weight: 1
        $x_1_12 = "RunWorkerAsync" ascii //weight: 1
        $x_1_13 = "remove_RunWorkerCompleted" ascii //weight: 1
        $x_1_14 = "add_DoWork" ascii //weight: 1
        $x_1_15 = "get_KeyCode" ascii //weight: 1
        $x_1_16 = {00 52 65 6d 6f 76 65 41 74 00 67 65 74 5f 49 6e 76 6f 6b 65 52 65 71 75 69 72 65 64 00}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __HSTR_MSIL_AgentTesla_AQ_MTB_46
{
    meta:
        author = "defender2yara"
        detection_name = "!#HSTR:MSIL/AgentTesla.AQ!MTB"
        threat_id = "1879049645"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "14"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Room_Painter.frm_Floor_Area.resources" ascii //weight: 1
        $x_1_2 = "Room_Painter.Form3.resources" ascii //weight: 1
        $x_1_3 = "Room_Painter.lblform.resources" ascii //weight: 1
        $x_1_4 = "Room_Painter.frm_Main.resources" ascii //weight: 1
        $x_1_5 = "Room_Painter.Resources.resources" ascii //weight: 1
        $x_1_6 = "Room_Painter.Painter.resources" ascii //weight: 1
        $x_1_7 = "Room_Painter.frm_Paint_Requirements.resources" ascii //weight: 1
        $x_1_8 = "Room_Painter.frmPresentacion.resources" ascii //weight: 1
        $x_1_9 = "Room_Painter.frmPrincipal.resources" ascii //weight: 1
        $x_1_10 = "Room_Painter.frm_Room_Volume.resources" ascii //weight: 1
        $x_1_11 = {43 72 65 61 74 65 5f 5f 49 6e 73 74 61 6e 63 65 5f 5f 00 54 00 49 6e 73 74 61 6e 63 65 00 44 69 73 70 6f 73 65 5f 5f 49 6e 73 74 61 6e 63 65 5f 5f}  //weight: 1, accuracy: High
        $x_1_12 = {43 68 72 57 00 43 6f 6e 76 65 72 73 69 6f 6e 73 00 47 65 74 44 6f 6d 61 69 6e 00 43 6f 6e 76 65 72 74 00 46 72 6f 6d 42 61 73 65 36 34 53 74 72 69 6e 67}  //weight: 1, accuracy: High
        $x_1_13 = {54 6f 49 6e 74 65 67 65 72 00 73 65 74 5f 50 61 73 73 77 6f 72 64 43 68 61 72}  //weight: 1, accuracy: High
        $x_1_14 = "chkRellenarFigura" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __HSTR_MSIL_AgentTesla_AQ_MTB_47
{
    meta:
        author = "defender2yara"
        detection_name = "!#HSTR:MSIL/AgentTesla.AQ!MTB"
        threat_id = "1879049645"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "13"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = "System.Runtime.InteropServices" ascii //weight: 1
        $x_1_2 = "Microsoft.VisualBasic.CompilerServices" ascii //weight: 1
        $x_1_3 = "System.Runtime.CompilerServices" ascii //weight: 1
        $x_1_4 = "System.Resources" ascii //weight: 1
        $x_1_5 = "MiniGameCSharp.PlayingGame.resources" ascii //weight: 1
        $x_1_6 = "MiniGameCSharp.HighScore.resources" ascii //weight: 1
        $x_1_7 = "MiniGameCSharp.frmMain.resources" ascii //weight: 1
        $x_1_8 = "MiniGameCSharp.Instruction.resources" ascii //weight: 1
        $x_1_9 = "OneGame.Properties.Resources.resources" ascii //weight: 1
        $x_1_10 = "System.Security.Cryptography" ascii //weight: 1
        $x_1_11 = {43 3a 5c 55 73 65 72 73 5c 41 64 6d 69 6e 69 73 74 72 61 74 6f 72 5c 44 65 73 6b 74 6f 70 5c 43 6c 69 65 6e 74 5c 54 65 6d 70 5c [0-15] 5c 73 72 63 5c 6f 62 6a 5c 78 38 36 5c 44 65 62 75 67 5c [0-31] 2e 70 64 62}  //weight: 1, accuracy: Low
        $x_1_12 = "Playtomic Xamarin / Mono.NET / C# tests" wide //weight: 1
        $x_1_13 = "http://test.1g.io:3000" wide //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __HSTR_MSIL_AgentTesla_AQ_MTB_48
{
    meta:
        author = "defender2yara"
        detection_name = "!#HSTR:MSIL/AgentTesla.AQ!MTB"
        threat_id = "1879049645"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "10"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "79A808BA4DFD5F8BB5887B67A8A1FC0CD008C303599717668A52CA77566FB9F5" ascii //weight: 1
        $x_1_2 = "7BD30E8FAE12540FE11EFDDE9409E1EB10388F27708815D04C3A4911FB81BA08" ascii //weight: 1
        $x_1_3 = "SMartStorageManager.AdminManager.FormAdminManage.resources" ascii //weight: 1
        $x_1_4 = "SMartStorageManager.AdminManager.FormModifyPwd.resources" ascii //weight: 1
        $x_1_5 = "SMartStorageManager.FormLogQuery.resources" ascii //weight: 1
        $x_1_6 = "SMartStorageManager.Product.FormInvertoryManage.resources" ascii //weight: 1
        $x_1_7 = "SMartStorageManager.Product.FormProductManage.resources" ascii //weight: 1
        $x_1_8 = "SMartStorageManager.Product.FormProductStorage.resources" ascii //weight: 1
        $x_1_9 = "SMartStorageManager.Product.FormSaleStatistics.resources" ascii //weight: 1
        $x_1_10 = "SMartStorageManager.Properties.Resources.resources" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __HSTR_MSIL_AgentTesla_AQ_MTB_49
{
    meta:
        author = "defender2yara"
        detection_name = "!#HSTR:MSIL/AgentTesla.AQ!MTB"
        threat_id = "1879049645"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "11"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "CheckRemoteDebuggerPresent" ascii //weight: 1
        $x_1_2 = "Karna.Windows.UI.Design" ascii //weight: 1
        $x_1_3 = "10B5CBAA6375A87DB8E84B2F3DDAEC22CE5208C13B65B52AF597CE0EBF894936" ascii //weight: 1
        $x_1_4 = "12C9E3E130C6A84690E3AEF5BBD27AF7900FBECB4075560BD54B20C9343E7F0B" ascii //weight: 1
        $x_1_5 = "3B0E4842B28D6B39EC725A6459FB943F5F1D658F4D0EE991004DD50F2C182F31" ascii //weight: 1
        $x_1_6 = "718588828B0428D818C6ECDFDB3D90977541F7A4BA5F6D564C385E3C63BA0D86" ascii //weight: 1
        $x_1_7 = "93E3180BDBAEA876D1DDDEFA6750E2BB37FA10B4F110324553C20A2262AD1F3A" ascii //weight: 1
        $x_1_8 = "AE9B3682169A3675432CCF6733006BA8871C7D4AB232A70EC6AD5E45701C2D2A" ascii //weight: 1
        $x_1_9 = "E9AEF7A76621FCEDDDC8D440A05D6BC70EFD101C1A69DAA11C03ADB36C85FC0C" ascii //weight: 1
        $x_1_10 = {73 65 74 5f 4d 79 50 72 6f 70 65 72 74 79 00 4d 5f 5f 5f 5f 5f 5f 5f 5f 5f 5f 00 69 6f}  //weight: 1, accuracy: High
        $x_1_11 = {73 65 74 5f 50 61 73 73 77 6f 72 64 00 55 73 65 72 6e 61 6d 65 00 50 61 73 73 77 6f 72 64 00 52 65 73 6f 75 72 63 65 73 00 73 69 6d 73 69 6d 2e 50 72 6f 70 65 72 74 69 65 73}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __HSTR_MSIL_AgentTesla_AQ_MTB_50
{
    meta:
        author = "defender2yara"
        detection_name = "!#HSTR:MSIL/AgentTesla.AQ!MTB"
        threat_id = "1879049645"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "22"
        strings_accuracy = "High"
    strings:
        $x_20_1 = "!Whiv puoguam#caqnow bh rxn ln GOS#moge." ascii //weight: 20
        $x_20_2 = "This p}ogram nannot me run tn DOS xode." ascii //weight: 20
        $x_20_3 = ")This pzwoziu canno|(jm(zun in LW[(uwde." ascii //weight: 20
        $x_20_4 = "!Thiy&vrogram&ignnot bk&xun in JUY mode." ascii //weight: 20
        $x_20_5 = "1dxis progrq}0cannot bu0" ascii //weight: 20
        $x_20_6 = "rogram7zxnnot b|7" ascii //weight: 20
        $x_1_7 = "un in [fj mode" ascii //weight: 1
        $x_1_8 = "un in DOc0}ode." ascii //weight: 1
        $x_1_9 = ".NUdVramework<fursion=v4>E" ascii //weight: 1
        $x_1_10 = "System.Runtime.InteropServices" ascii //weight: 1
        $x_1_11 = "System.Runtime.ConstrainedExecution" ascii //weight: 1
        $x_1_12 = "System.Runtime.Serialization" ascii //weight: 1
        $x_1_13 = "#Broj" ascii //weight: 1
        $x_1_14 = "Syszks.Windo}y4Forms" ascii //weight: 1
        $x_1_15 = "kkxtel32.drr" ascii //weight: 1
        $x_1_16 = ".rsrk" ascii //weight: 1
        $x_20_17 = "stem8\\esou|mes.Ro}ourco\\eade|6 mscy|lib" ascii //weight: 20
        $x_20_18 = "TokexGb77a?m5619=>e089-]ystew8Reso" ascii //weight: 20
        $x_1_19 = "un in [fj mode.$$!$" ascii //weight: 1
        $x_1_20 = "Pus}icKeyTo|vn" ascii //weight: 1
        $x_1_21 = "em.Collvttions.Gv" ascii //weight: 1
        $x_20_22 = "1program1tannot bv1run in U" ascii //weight: 20
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_20_*) and 2 of ($x_1_*))) or
            ((2 of ($x_20_*))) or
            (all of ($x*))
        )
}

rule __HSTR_MSIL_AgentTesla_AQ_MTB_51
{
    meta:
        author = "defender2yara"
        detection_name = "!#HSTR:MSIL/AgentTesla.AQ!MTB"
        threat_id = "1879049645"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "19"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Databricks.Properties.Resources.resources" ascii //weight: 1
        $x_1_2 = "IsDebuggerPresent" ascii //weight: 1
        $x_1_3 = "LoadKnownTypeWithoutVersionCheck" ascii //weight: 1
        $x_1_4 = "EnginePathEnvironmentVariableName" ascii //weight: 1
        $x_1_5 = "GetFallbackEngineSourceCodeDirectory" ascii //weight: 1
        $x_1_6 = "GetDatabricksSolutionFilePath" ascii //weight: 1
        $x_1_7 = "GetExecutableDirectory" ascii //weight: 1
        $x_1_8 = "IsDatabricksPathEnvironmentVariableAvailable" ascii //weight: 1
        $x_1_9 = "GetDatabricksInstalledDirectory" ascii //weight: 1
        $x_1_10 = "copyToLocalFolderForExecution" ascii //weight: 1
        $x_1_11 = "TryToCopyDependencyFile" ascii //weight: 1
        $x_1_12 = "RunBaseMethodWithAttribute" ascii //weight: 1
        $x_1_13 = "RunThisClassMethodWithAttribute" ascii //weight: 1
        $x_1_14 = "StartedFromNCrunch" ascii //weight: 1
        $x_1_15 = "StartedFromProgramMain" ascii //weight: 1
        $x_1_16 = "ConvertFirstCharacterToUpperCase" ascii //weight: 1
        $x_1_17 = "ContentLoaderAlreadyExistsItIsOnlyAllowedToSetBeforeTheAppStarts" ascii //weight: 1
        $x_1_18 = "FromBase64String" ascii //weight: 1
        $x_1_19 = "Databricks.Commands" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __HSTR_MSIL_AgentTesla_AQ_MTB_52
{
    meta:
        author = "defender2yara"
        detection_name = "!#HSTR:MSIL/AgentTesla.AQ!MTB"
        threat_id = "1879049645"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "17"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = "LMS_DB_Project.Form1.resources" ascii //weight: 1
        $x_1_2 = "Main_Library.Card.resources" ascii //weight: 1
        $x_1_3 = "Library_Main.Detail.resources" ascii //weight: 1
        $x_1_4 = "Main_Library.AdminMain.resources" ascii //weight: 1
        $x_1_5 = "Main_Library.BorrowReturn.resources" ascii //weight: 1
        $x_1_6 = "Library_Main.Member.resources" ascii //weight: 1
        $x_1_7 = "Main_Library.Reader.resources" ascii //weight: 1
        $x_1_8 = "Library_Main.Manager.resources" ascii //weight: 1
        $x_1_9 = "LMS_DB_Project.AddBorrower.resources" ascii //weight: 1
        $x_1_10 = "Main_Library.Properties.Resources.resources" ascii //weight: 1
        $x_1_11 = "Main_Library.sdefsdfsdfsfs.resources" ascii //weight: 1
        $x_1_12 = "LMS_DB_Project.Search_Books.resources" ascii //weight: 1
        $x_1_13 = "LMS_DB_Project.Book_Loans.resources" ascii //weight: 1
        $x_1_14 = "Main_Library.Insert.resources" ascii //weight: 1
        $x_1_15 = "Library_Main.Library.resources" ascii //weight: 1
        $x_1_16 = "http://i.imgur.com/" wide //weight: 1
        $x_1_17 = {0a 19 9a 0a 06 14 03 6f [0-3] 0a 5f 00 00 28 [0-3] 06 6f ?? ?? ?? 06 72 ?? ?? ?? 70 72 ?? ?? ?? 70 6f ?? ?? ?? 0a 28 ?? ?? ?? 06 28 ?? ?? ?? 0a 6f ?? ?? ?? 0a 16 9a 6f}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __HSTR_MSIL_AgentTesla_AQ_MTB_53
{
    meta:
        author = "defender2yara"
        detection_name = "!#HSTR:MSIL/AgentTesla.AQ!MTB"
        threat_id = "1879049645"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "0687D2A7EB4BA5F2E1E19364D835E166C88CEE78A0D4B5F3595038F95590EBD6" ascii //weight: 1
        $x_1_2 = "A03AD5BAE70450DBAA934A56D0539433D7287CE2B47082359F2C0BBE1E1EC2D9" ascii //weight: 1
        $x_1_3 = "A63BBDBAF4C231B9CB79CDC5D5E1F81EEA738704E1965CDD7ED2869A03E75196" ascii //weight: 1
        $x_1_4 = "7192385C3C0605DE55BB9476CE1D90748190ECB32A8EED7F5207B30CF6A1FE89" ascii //weight: 1
        $x_1_5 = "41E3C8E39036A771E3EF34DC68C62A34ABC84451976BB540FA99055B968BD3A2" ascii //weight: 1
        $x_1_6 = "40A3370F023617B472ADE56C6E860A4AAAE33103DAFE35A6A66CC8E5F6EE2E25" ascii //weight: 1
        $x_1_7 = "5FE8B688B4BAA774D5928C9EE3590CB4730BB64EAC0D5D582B04CED4F6FC4206" ascii //weight: 1
        $x_1_8 = "1DDF6DCED6038DAB5BE483278DA05097F39245FD77DE4B7C13EEE3A0D7E1B56A" ascii //weight: 1
        $x_1_9 = "ChessGameSemestr.EndGameForm.resources" ascii //weight: 1
        $x_1_10 = "WindowGameChess.PawnUnderPromotion.resources" ascii //weight: 1
        $x_1_11 = "WindowGameChess.Properties.Resources.resources" ascii //weight: 1
        $x_1_12 = "ChessGameSemestr.CustomMessageBox.resources" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (6 of ($x*))
}

rule __HSTR_MSIL_AgentTesla_AQ_MTB_54
{
    meta:
        author = "defender2yara"
        detection_name = "!#HSTR:MSIL/AgentTesla.AQ!MTB"
        threat_id = "1879049645"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "15"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "WindowsFormsApp1.Properties.Resources" wide //weight: 1
        $x_1_2 = "{11111-22222-20001-00001}" wide //weight: 1
        $x_1_3 = "{11111-22222-20001-00002}" wide //weight: 1
        $x_1_4 = "{11111-22222-30001-00001}" wide //weight: 1
        $x_1_5 = "{11111-22222-30001-00002}" wide //weight: 1
        $x_1_6 = "{11111-22222-40001-00001}" wide //weight: 1
        $x_1_7 = "{11111-22222-40001-00002}" wide //weight: 1
        $x_1_8 = "{11111-22222-50001-00001}" wide //weight: 1
        $x_1_9 = "{11111-22222-50001-00002}" wide //weight: 1
        $x_1_10 = "GetDelegateForFunctionPointer" wide //weight: 1
        $x_1_11 = "file:///" wide //weight: 1
        $x_1_12 = {57 00 72 00 69 00 74 00 65 00 20 00 00 11 50 00 72 00 6f 00 63 00 65 00 73 00 73 00 20}  //weight: 1, accuracy: High
        $x_1_13 = {0b 4f 00 70 00 65 00 6e 00 20 00 00 0f 50 00 72 00 6f 00 63 00 65 00 73 00 73}  //weight: 1, accuracy: High
        $x_1_14 = {48 00 61 00 6e 00 64 00 6c 00 65 00 00 0f 6b 00 65 00 72 00 6e 00 65 00 6c 00 20 00 00 0d 33 00 32 00 2e 00 64 00 6c 00 6c 00}  //weight: 1, accuracy: High
        $x_1_15 = {56 00 69 00 72 00 74 00 75 00 61 00 6c 00 20 00 00 0b 41 00 6c 00 6c 00 6f 00 63}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __HSTR_MSIL_AgentTesla_AQ_MTB_55
{
    meta:
        author = "defender2yara"
        detection_name = "!#HSTR:MSIL/AgentTesla.AQ!MTB"
        threat_id = "1879049645"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "18"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = "Folder_Protector.Chnge_Pwd.resources" ascii //weight: 1
        $x_1_2 = "Folder_Protector.Main_Screen.resources" ascii //weight: 1
        $x_1_3 = "Folder_Protector.ResultsForm.resources" ascii //weight: 1
        $x_1_4 = "Folder_Protector.Set_Mail_Settings.resources" ascii //weight: 1
        $x_1_5 = "Folder_Protector.SyncherForm.resources" ascii //weight: 1
        $x_1_6 = "Folder_Protector.Validasi.resources" ascii //weight: 1
        $x_1_7 = "Folder_Protector.Welcome.resources" ascii //weight: 1
        $x_1_8 = "m_Chnge_Pwd" ascii //weight: 1
        $x_1_9 = "m_Set_Scheduled_Time" ascii //weight: 1
        $x_1_10 = "Hkey_Local_Machine\\Software\\VB Folder Protect" wide //weight: 1
        $x_1_11 = "C:\\AppLocker.log" wide //weight: 1
        $x_1_12 = "C:\\Locker Folder" wide //weight: 1
        $x_1_13 = "Force Backup Operation" wide //weight: 1
        $x_1_14 = "Sending Shutdown Notification Email" wide //weight: 1
        $x_1_15 = {5c 00 41 00 75 00 74 00 6f 00 55 00 70 00 64 00 61 00 74 00 65 00 2e 00 65 00 78 00 65 00 [0-5] 0b 66 00 6f 00 72 00 63 00 65 00}  //weight: 1, accuracy: Low
        $x_1_16 = {43 72 65 61 74 65 49 6e 73 74 61 6e 63 65 00 50 72 6f 6a 65 63 74 44 61 74 61}  //weight: 1, accuracy: High
        $x_1_17 = {52 65 6d 6f 76 65 00 43 72 65 61 74 65 5f 5f 49 6e 73 74 61 6e 63 65 5f 5f 00 49 6e 73 74 61 6e 63 65 00 43 6f 6d 70 6f 6e 65 6e 74 00 44 69 73 70 6f 73 65 00 44 69 73 70 6f 73 65 5f 5f 49 6e 73 74 61 6e 63 65 5f 5f}  //weight: 1, accuracy: High
        $x_1_18 = {67 65 74 5f 53 65 6c 65 63 74 65 64 50 61 74 68 00 53 65 61 72 63 68 00 [0-63] 00 52 65 6d 6f 76 65 41 63 63 65 73 73 52 75 6c 65}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __HSTR_MSIL_AgentTesla_AQ_MTB_56
{
    meta:
        author = "defender2yara"
        detection_name = "!#HSTR:MSIL/AgentTesla.AQ!MTB"
        threat_id = "1879049645"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "19"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Gadz.Tetris.Desktop.About.resources" ascii //weight: 1
        $x_1_2 = "Gadz.Tetris.Desktop.GameOver.resources" ascii //weight: 1
        $x_1_3 = "Gadz.Tetris.Desktop.Help.resources" ascii //weight: 1
        $x_1_4 = "Gadz.Tetris.Desktop.Choose.resources" ascii //weight: 1
        $x_1_5 = "Gadz.Tetris.Desktop.MDIParent1.resources" ascii //weight: 1
        $x_1_6 = "Gadz.Tetris.Desktop.Play.resources" ascii //weight: 1
        $x_1_7 = "Gadz.Tetris.Desktop.Properties.Resources.resources" ascii //weight: 1
        $x_1_8 = "Gadz.Tetris.Desktop.Imagens.BACKGROUND_TETRIS.png" ascii //weight: 1
        $x_1_9 = "Gadz.Tetris.Desktop.Imagens.BG_FADED.png" ascii //weight: 1
        $x_1_10 = "Gadz.Tetris.Desktop.Imagens.block_blue.png" ascii //weight: 1
        $x_1_11 = "Gadz.Tetris.Desktop.Imagens.BLOCK_CLASSIC.png" ascii //weight: 1
        $x_1_12 = "Gadz.Tetris.Desktop.Imagens.BLOCK_CLASSIC_FADED.png" ascii //weight: 1
        $x_1_13 = "Gadz.Tetris.Desktop.Imagens.block_cyan.png" ascii //weight: 1
        $x_1_14 = "Gadz.Tetris.Desktop.Imagens.block_green.png" ascii //weight: 1
        $x_1_15 = "Gadz.Tetris.Desktop.Imagens.block_orange.png" ascii //weight: 1
        $x_1_16 = "Gadz.Tetris.Desktop.Imagens.block_purple.png" ascii //weight: 1
        $x_1_17 = "Gadz.Tetris.Desktop.Imagens.block_red.png" ascii //weight: 1
        $x_1_18 = "Gadz.Tetris.Desktop.Imagens.block_yellow.png" ascii //weight: 1
        $x_1_19 = "Gadz.Tetris.Desktop.Imagens.GAME_OVER_LAYER.png" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __HSTR_MSIL_AgentTesla_AQ_MTB_57
{
    meta:
        author = "defender2yara"
        detection_name = "!#HSTR:MSIL/AgentTesla.AQ!MTB"
        threat_id = "1879049645"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "28"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = "Online_Shopping_Management_System.DAL" ascii //weight: 1
        $x_1_2 = "Online_Shopping_Management_System.BL" ascii //weight: 1
        $x_1_3 = "CachedCrystalReport_ALL_PRDCTS" ascii //weight: 1
        $x_1_4 = "CachedCrystalReport_All_CAT" ascii //weight: 1
        $x_1_5 = "CachedCrystalReport_SNGL_PRDCT" ascii //weight: 1
        $x_1_6 = "Online_Shopping_Management_System.RPRT" ascii //weight: 1
        $x_1_7 = "CrystalDecisions.ReportSource" ascii //weight: 1
        $x_1_8 = "Online_Shopping_Management_System.PL.SHOW_PIC.resources" ascii //weight: 1
        $x_1_9 = "Online_Shopping_Management_System.RPRT.PRNT_SNGL_PRD.resources" ascii //weight: 1
        $x_1_10 = "Online_Shopping_Management_System.PL.Main_FRM.resources" ascii //weight: 1
        $x_1_11 = "Online_Shopping_Management_System.PL.FRM_LOGIN.resources" ascii //weight: 1
        $x_1_12 = "Online_Shopping_Management_System.PL.FRM_ADD_USER.resources" ascii //weight: 1
        $x_1_13 = "Online_Shopping_Management_System.PL.FRM_ORDERS.resources" ascii //weight: 1
        $x_1_14 = "Online_Shopping_Management_System.PL.FRM_VIEW_PRODCTS.resources" ascii //weight: 1
        $x_1_15 = "Online_Shopping_Management_System.PL.FRM_ADD_PRODUCT.resources" ascii //weight: 1
        $x_1_16 = "Online_Shopping_Management_System.PL.FRM_BELLS_MNGMNT.resources" ascii //weight: 1
        $x_1_17 = "Online_Shopping_Management_System.PL.FRM_USERS_MNGMNT.resources" ascii //weight: 1
        $x_1_18 = "Online_Shopping_Management_System.PL.FRM_CUST_VIEW.resources" ascii //weight: 1
        $x_1_19 = "Online_Shopping_Management_System.PL.FRM_Restore.resources" ascii //weight: 1
        $x_1_20 = "Online_Shopping_Management_System.PL.FRM_Turning_Refunding.resources" ascii //weight: 1
        $x_1_21 = "Online_Shopping_Management_System.PL.FRM_BackUp.resources" ascii //weight: 1
        $x_1_22 = "Online_Shopping_Management_System.PL.Frm_NU_Cusromer.resources" ascii //weight: 1
        $x_1_23 = "Online_Shopping_Management_System.Properties.Resources.resources" ascii //weight: 1
        $x_1_24 = "Online_Shopping_Management_System.PL.FRM_Settings.resources" ascii //weight: 1
        $x_1_25 = "Online_Shopping_Management_System.PL.FRM_CAT_Mngmnt.resources" ascii //weight: 1
        $x_1_26 = "Online_Shopping_Management_System.PL.Prdct_Mngmnt.resources" ascii //weight: 1
        $x_1_27 = "Online_Shopping_Management_System.PL.FRM_Delivery_Boy.resources" ascii //weight: 1
        $x_1_28 = {0a 06 0b 2b 00 07 2a 3f 00 00 28 ?? ?? ?? 06 6f ?? ?? ?? 06 72 ?? ?? ?? 70 72 ?? ?? ?? 70 6f ?? ?? ?? 0a 28 ?? ?? ?? 06 28 ?? ?? ?? 06}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __Adware_Win32_GameVance_0
{
    meta:
        author = "defender2yara"
        detection_name = "!#Adware:Win32/GameVance"
        threat_id = "1879049673"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "epicplay" ascii //weight: 1
        $x_1_2 = "freeworkz" ascii //weight: 1
        $x_1_3 = "rivalgaming" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (1 of ($x*))
}

rule __Adware_Win32_GameVance_1
{
    meta:
        author = "defender2yara"
        detection_name = "!#Adware:Win32/GameVance"
        threat_id = "1879049673"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "fwtlIE.dll" ascii //weight: 1
        $x_1_2 = "Freeworkz Tournament" ascii //weight: 1
        $x_1_3 = "freeworkz.com" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __Adware_Win32_GameVance_2
{
    meta:
        author = "defender2yara"
        detection_name = "!#Adware:Win32/GameVance"
        threat_id = "1879049673"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "AppDataLow\\lplaytl" ascii //weight: 1
        $x_1_2 = "lptlf.dll" ascii //weight: 1
        $x_1_3 = "LivingPlay Tournament" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __Adware_Win32_GameVance_3
{
    meta:
        author = "defender2yara"
        detection_name = "!#Adware:Win32/GameVance"
        threat_id = "1879049673"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "epicPlayGames.dll" ascii //weight: 1
        $x_1_2 = "epic_play_mtx_cfgthr" ascii //weight: 1
        $x_1_3 = "client_update.exe" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __Adware_Win32_GameVance_4
{
    meta:
        author = "defender2yara"
        detection_name = "!#Adware:Win32/GameVance"
        threat_id = "1879049673"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "RivalGamingData" ascii //weight: 1
        $x_1_2 = "RivalGaming.xpt" ascii //weight: 1
        $x_1_3 = "rivalgaming_setup_started" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __Adware_Win32_GameVance_5
{
    meta:
        author = "defender2yara"
        detection_name = "!#Adware:Win32/GameVance"
        threat_id = "1879049673"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "FreeWorkz.DLL" ascii //weight: 1
        $x_1_2 = "laPlugins\\npFreeWorkzDisplay" ascii //weight: 1
        $x_1_3 = "freeworkz_update.exe" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __Adware_Win32_GameVance_6
{
    meta:
        author = "defender2yara"
        detection_name = "!#Adware:Win32/GameVance"
        threat_id = "1879049673"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = ".gamevance.com" ascii //weight: 1
        $x_1_2 = "arsgrs_wm_" ascii //weight: 1
        $x_1_3 = "\\GameVance\\PopupClient" ascii //weight: 1
        $x_1_4 = "FindBrowserWindow" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __Adware_Win32_GameVance_7
{
    meta:
        author = "defender2yara"
        detection_name = "!#Adware:Win32/GameVance"
        threat_id = "1879049673"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "EpicPlay Games Extension" ascii //weight: 1
        $x_1_2 = "epicPlayGames.dll" ascii //weight: 1
        $x_1_3 = "AppDataLow\\ePlayConf" ascii //weight: 1
        $x_1_4 = "epicplay.com" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (1 of ($x*))
}

rule __Adware_Win32_GameVance_8
{
    meta:
        author = "defender2yara"
        detection_name = "!#Adware:Win32/GameVance"
        threat_id = "1879049673"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "3"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {eb ff ff 56 69 72 74 04 00 3e 81 bd}  //weight: 1, accuracy: Low
        $x_1_2 = {eb ff ff 75 61 6c 51 04 00 3e 81 bd}  //weight: 1, accuracy: Low
        $x_1_3 = {f4 ff ff 2e 72 73 72 04 00 3e 81 bd}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __Adware_Win32_GameVance_9
{
    meta:
        author = "defender2yara"
        detection_name = "!#Adware:Win32/GameVance"
        threat_id = "1879049673"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "RivalGaming.xpt" ascii //weight: 1
        $x_1_2 = "mitex_cfg_trci" ascii //weight: 1
        $x_1_3 = {6d 69 6e 67 2e 63 6f 6d 00}  //weight: 1, accuracy: High
        $x_1_4 = ".fusionload" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __Adware_Win32_GameVance_10
{
    meta:
        author = "defender2yara"
        detection_name = "!#Adware:Win32/GameVance"
        threat_id = "1879049673"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "2"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "epicHost.dll" ascii //weight: 1
        $x_1_2 = "eplay_wndtitle_string" ascii //weight: 1
        $x_1_3 = "epicplay.com" ascii //weight: 1
        $x_1_4 = "GAM-SRS-T3" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (2 of ($x*))
}

rule __Adware_Win32_GameVance_11
{
    meta:
        author = "defender2yara"
        detection_name = "!#Adware:Win32/GameVance"
        threat_id = "1879049673"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "2"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {2b d0 8a 0c 02 80 f1 ?? 88 08 74 08 46 40 3b 74 24 08 7c ee}  //weight: 1, accuracy: Low
        $x_1_2 = {04 73 10 8b ?? 08 0f be 14 ?? 83 f2 ?? 88 14 ?? (40|41) eb e8}  //weight: 1, accuracy: Low
        $x_1_3 = "|mac=%s|" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (2 of ($x*))
}

rule __Adware_Win32_GameVance_12
{
    meta:
        author = "defender2yara"
        detection_name = "!#Adware:Win32/GameVance"
        threat_id = "1879049673"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "2"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {58 30 58 30 [0-48] 59 30 59 30 [0-48] 4c 49 4c 49}  //weight: 1, accuracy: Low
        $x_1_2 = {68 d0 4f e8 56 9c 81 ?? ?? ?? 31 b0 17 a9 9d ff 15 ?? ?? ?? ?? eb}  //weight: 1, accuracy: Low
        $x_1_3 = {03 04 24 89 04 24 58 0d 00 81 c0 ?? ?? ?? ?? 81 2c 24 01}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (2 of ($x*))
}

rule __Adware_Win32_GameVance_13
{
    meta:
        author = "defender2yara"
        detection_name = "!#Adware:Win32/GameVance"
        threat_id = "1879049673"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {67 61 6d 65 76 61 6e 63 65 2e (63|6e)}  //weight: 1, accuracy: Low
        $x_1_2 = "wm_fire_big_popup" ascii //weight: 1
        $x_1_3 = "my_thr_mut_%d" ascii //weight: 1
        $x_1_4 = "72.232.43.226" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __Adware_Win32_GameVance_14
{
    meta:
        author = "defender2yara"
        detection_name = "!#Adware:Win32/GameVance"
        threat_id = "1879049673"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {3e 81 bd 50 e9 ff ff 54 59 54 59 eb 05 90 3e d0 67 65 75 20 eb 04}  //weight: 1, accuracy: High
        $x_1_2 = {3e 81 bd a0 e8 ff ff 4c 49 4c 49 eb 05 9c 9e 74 07 a4 0f 84 0b 02 00 00 eb 01}  //weight: 1, accuracy: High
        $x_1_3 = {3e 81 bd a0 e8 ff ff 58 30 58 30 eb 01 1e 0f 84 b8 02 00 00 eb 05}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __Adware_Win32_GameVance_15
{
    meta:
        author = "defender2yara"
        detection_name = "!#Adware:Win32/GameVance"
        threat_id = "1879049673"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {89 45 f8 8b 45 f8 8b 4d f8 03 48 3c 89 4d d0}  //weight: 1, accuracy: High
        $x_1_2 = {83 bd 64 ff ff ff 10}  //weight: 1, accuracy: High
        $x_1_3 = {83 7d 8c 14}  //weight: 1, accuracy: High
        $x_2_4 = {9c 81 44 24 04 ?? ?? ?? ?? 9d 6a 00}  //weight: 2, accuracy: Low
        $x_1_5 = {9c 81 45 a0 ?? ?? ?? ?? 9d}  //weight: 1, accuracy: Low
        $x_1_6 = {8a 88 14 01 00 00 88 4a 04}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (
            ((5 of ($x_1_*))) or
            ((1 of ($x_2_*) and 3 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule __Adware_Win32_GameVance_16
{
    meta:
        author = "defender2yara"
        detection_name = "!#Adware:Win32/GameVance"
        threat_id = "1879049673"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "2"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "PPTextLinks" ascii //weight: 1
        $x_1_2 = "cf.plpickle.com" ascii //weight: 1
        $x_1_3 = "pp_config_thread_mtx" ascii //weight: 1
        $x_1_4 = "PlayPickleText.Toolbar" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (2 of ($x*))
}

rule __Adware_Win32_GameVance_17
{
    meta:
        author = "defender2yara"
        detection_name = "!#Adware:Win32/GameVance"
        threat_id = "1879049673"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "2"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "AppDataLow\\FreeWorkzSettings" ascii //weight: 1
        $x_1_2 = "content.freeworkzgames.com" ascii //weight: 1
        $x_1_3 = "links@freeworkz.com" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (2 of ($x*))
}

rule __Adware_Win32_GameVance_18
{
    meta:
        author = "defender2yara"
        detection_name = "!#Adware:Win32/GameVance"
        threat_id = "1879049673"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "2"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "textlinks@lplay.com" ascii //weight: 1
        $x_1_2 = "lp_config_thread_mtx" ascii //weight: 1
        $x_1_3 = "LivingPlay Games" ascii //weight: 1
        $x_1_4 = "cf.livingplay.com" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (2 of ($x*))
}

rule __Adware_Win32_GameVance_19
{
    meta:
        author = "defender2yara"
        detection_name = "!#Adware:Win32/GameVance"
        threat_id = "1879049673"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {67 61 6d 65 76 61 6e 63 65 2e 63 6f 6d 00}  //weight: 1, accuracy: High
        $x_1_2 = "GamevanceText.Linker.1" ascii //weight: 1
        $x_1_3 = {64 61 74 61 2e 35 74 68 72 65 76 6f 6c 75 74 69 6f 6e 2e 63 6f 6d 00}  //weight: 1, accuracy: High
        $x_1_4 = "Software\\gvtl" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (3 of ($x*))
}

rule __Adware_Win32_GameVance_20
{
    meta:
        author = "defender2yara"
        detection_name = "!#Adware:Win32/GameVance"
        threat_id = "1879049673"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {65 78 65 2e 32 33 65 63 6e 61 76 65 6d 61 67 00}  //weight: 1, accuracy: High
        $x_1_2 = ".noitallatsni ecnavemaG" ascii //weight: 1
        $x_1_3 = {6c 74 76 67 5c 65 72 61 77 74 66 6f 53 00}  //weight: 1, accuracy: High
        $x_1_4 = {6d 6f 63 2e 6e 6f 69 74 75 6c 6f 76 65 72 68 74 35 2e 61 74 61 64 00}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (3 of ($x*))
}

rule __Adware_Win32_GameVance_21
{
    meta:
        author = "defender2yara"
        detection_name = "!#Adware:Win32/GameVance"
        threat_id = "1879049673"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Gamevance\\ars.cfg" wide //weight: 1
        $x_1_2 = "GamevanceText." ascii //weight: 1
        $x_1_3 = {67 61 6d 65 76 61 6e 63 65 2e 63 6f 6d 00}  //weight: 1, accuracy: High
        $x_1_4 = "AVCGamevanceTextModule@@" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (3 of ($x*))
}

rule __Adware_Win32_GameVance_22
{
    meta:
        author = "defender2yara"
        detection_name = "!#Adware:Win32/GameVance"
        threat_id = "1879049673"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {63 6c 69 65 6e 74 5f 69 6e 73 74 61 6c 6c 5f 6d 74 78 5f 41 42 43 44 00}  //weight: 1, accuracy: High
        $x_1_2 = "ars.cfg" ascii //weight: 1
        $x_1_3 = {70 6c 61 79 70 69 63 6b 6c 65 77 6e 61 6d 65 00 70 6c 61 79 70 69 63 6b 6c 65 63 6c 61 73 73 00}  //weight: 1, accuracy: High
        $x_1_4 = "pp_ringeraja" ascii //weight: 1
        $x_1_5 = "grs_zz_pp" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (4 of ($x*))
}

rule __Adware_Win32_GameVance_23
{
    meta:
        author = "defender2yara"
        detection_name = "!#Adware:Win32/GameVance"
        threat_id = "1879049673"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "21"
        strings_accuracy = "Low"
    strings:
        $x_10_1 = {47 61 6d 65 76 61 6e 63 65 [0-4] 2e 44 4c 4c [0-2] 44 6c 6c 43 61 6e 55 6e 6c 6f 61 64 4e 6f 77}  //weight: 10, accuracy: Low
        $x_10_2 = ".gamevance.com" ascii //weight: 10
        $x_1_3 = "\\gvtl" ascii //weight: 1
        $x_1_4 = "72.232.43.226" ascii //weight: 1
        $x_1_5 = "5threvolution.com" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((2 of ($x_10_*) and 1 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule __Adware_Win32_GameVance_24
{
    meta:
        author = "defender2yara"
        detection_name = "!#Adware:Win32/GameVance"
        threat_id = "1879049673"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "2"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {67 61 6d 65 76 61 6e 63 65 6c 69 62 33 32 2e 64 6c 6c 00 44 6c 6c 43 61 6e 55 6e 6c 6f 61 64 4e 6f 77 00 44 6c 6c 47 65 74 43 6c 61 73 73 4f 62 6a 65 63 74 00 44 6c 6c 52 65 67 69 73 74 65 72 53 65 72 76 65 72 00 44 6c 6c 55 6e 72 65 67 69 73 74 65 72 53 65 72 76 65 72}  //weight: 1, accuracy: High
        $x_1_2 = {9c 81 44 24 04 ?? ?? ?? ?? 9d}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __Adware_Win32_GameVance_25
{
    meta:
        author = "defender2yara"
        detection_name = "!#Adware:Win32/GameVance"
        threat_id = "1879049673"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {9c 81 44 24 04 ?? ?? ?? ?? 9d}  //weight: 1, accuracy: Low
        $x_1_2 = {ff 70 3c 81 c1 ?? ?? ?? ?? 81 2c 24 ?? ?? ?? ?? 03 0c 24 89 0c 24}  //weight: 1, accuracy: Low
        $x_1_3 = {ff 75 08 59 ff 70 5c 81 c1 ?? ?? ?? ?? 81 2c 24 ?? ?? ?? ?? 03 0c 24}  //weight: 1, accuracy: Low
        $x_1_4 = {67 76 74 6c 66 2e 64 6c 6c 00 4e 53 47 65 74 4d 6f 64 75 6c 65 00}  //weight: 1, accuracy: High
        $x_1_5 = {00 43 72 79 70 74 47 65 74 48 61 73 68 50 61 72 61 6d 00}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (4 of ($x*))
}

rule __Adware_Win32_GameVance_26
{
    meta:
        author = "defender2yara"
        detection_name = "!#Adware:Win32/GameVance"
        threat_id = "1879049673"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "3"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {ff ff 02 00 00 00 eb 3e c7 85 ?? ?? ff ff 00 00 00 00 eb eb 3e 81 bd ?? ?? ff ff 8c 00 00 00 eb}  //weight: 1, accuracy: Low
        $x_2_2 = {fd ff ff 47 eb [0-8] 3e c6 85 ?? ?? ff ff 65 eb [0-8] 3e c6 85 ?? ?? ff ff 74 eb [0-8] 3e c6 85 ?? ?? ff ff 4d eb [0-8] 3e c6 85 ?? ?? ff ff 6f eb [0-8] 3e c6 85 ?? ?? ff ff 64 eb}  //weight: 2, accuracy: Low
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __Adware_Win32_GameVance_27
{
    meta:
        author = "defender2yara"
        detection_name = "!#Adware:Win32/GameVance"
        threat_id = "1879049673"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "2"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {c6 85 08 fe ff ff 47 c6 85 09 fe ff ff 65 c6 85 0a fe ff ff 74 c6 85 0b fe ff ff 53 c6 85 0c fe ff ff 79 c6 85 0d fe ff ff 73}  //weight: 1, accuracy: High
        $x_1_2 = {ff ff 2e 72 73 72 (75|eb)}  //weight: 1, accuracy: Low
        $x_1_3 = {9c 81 44 24 04 ?? ?? ?? ?? 9d}  //weight: 1, accuracy: Low
        $x_1_4 = {72 eb 04 59 3e d3 0a 3e c6 85 69 eb ff ff 72 eb 03 48 a4 45 3e c6 85 6a eb ff ff 6f eb 03 a4 5a 27 3e c6 85 6b eb ff ff 72}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (2 of ($x*))
}

rule __Adware_Win32_GameVance_28
{
    meta:
        author = "defender2yara"
        detection_name = "!#Adware:Win32/GameVance"
        threat_id = "1879049673"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {63 6c 69 65 6e 74 5f 69 6e 73 74 61 6c 6c 5f 6d 74 78 5f 41 42 43 44 00}  //weight: 1, accuracy: High
        $x_1_2 = {67 72 73 63 6c 61 73 73 00}  //weight: 1, accuracy: High
        $x_1_3 = {70 6c 61 79 70 69 63 6b 6c 65 77 6e 61 6d 65 00 70 6c 61 79 70 69 63 6b 6c 65 63 6c 61 73 73 00}  //weight: 1, accuracy: High
        $x_1_4 = {70 70 5f 69 6e 73 74 61 6c 6c 65 72 5f 6d 74 78 00}  //weight: 1, accuracy: High
        $x_1_5 = {62 6c 6c 65 66 6b 62 70 62 65 66 64 6f 64 69 69 65 66 70 6b 63 6e 69 67 70 69 63 6d 68 6f 68 65 00}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (4 of ($x*))
}

rule __Adware_Win32_GameVance_29
{
    meta:
        author = "defender2yara"
        detection_name = "!#Adware:Win32/GameVance"
        threat_id = "1879049673"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {47 61 6d 65 76 61 6e 63 65 20 54 65 78 74 20 70 6c 75 67 69 6e 2e 00}  //weight: 1, accuracy: High
        $x_1_2 = "\\AppDataLow\\gvtl" ascii //weight: 1
        $x_1_3 = {6c 75 2e 67 61 6d 65 76 61 6e 63 65 2e 63 6f 6d 00}  //weight: 1, accuracy: High
        $x_1_4 = "cid:%d|uid:%s|lid:%d|jss:%d|sc2c1:%d|sc2c2:%d|fl:%s|ti:%s|crc:%s" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (3 of ($x*))
}

rule __Adware_Win32_GameVance_30
{
    meta:
        author = "defender2yara"
        detection_name = "!#Adware:Win32/GameVance"
        threat_id = "1879049673"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "3"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {ff ff 2e 72 73 72 75}  //weight: 1, accuracy: High
        $x_1_2 = {9c 81 44 24 04 ?? ?? ?? ?? 9d 8b 85 ?? ?? ff ff 8b 48 ?? ff d1}  //weight: 1, accuracy: Low
        $x_1_3 = {ff ff 55 c6 85 ?? ?? ff ff 6e c6 85 ?? ?? ff ff 68 c6 85 ?? ?? ff ff 61 c6 85 ?? ?? ff ff 6e c6 85 ?? ?? ff ff 64 c6 85 ?? ?? ff ff 6c c6 85 ?? ?? ff ff 65 c6 85 ?? ?? ff ff 64 c6 85 ?? ?? ff ff 45 c6 85 ?? ?? ff ff 78 c6 85 ?? ?? ff ff 63 c6 85 ?? ?? ff ff 65 c6 85 ?? ?? ff ff 70}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __Adware_Win32_GameVance_31
{
    meta:
        author = "defender2yara"
        detection_name = "!#Adware:Win32/GameVance"
        threat_id = "1879049673"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "RivalGamingData" ascii //weight: 1
        $x_1_2 = "aj/deactivate.php" ascii //weight: 1
        $x_1_3 = "aj/inst.php" ascii //weight: 1
        $x_1_4 = "RivalGaming.xpt" ascii //weight: 1
        $x_1_5 = {6d 69 6e 67 2e 63 6f 6d 00 00 00 00 2e 72 69 76 61 6c 67 61 00}  //weight: 1, accuracy: High
        $x_1_6 = "rg_update.exe" ascii //weight: 1
        $x_1_7 = "rivalgaminggc.js" ascii //weight: 1
        $x_1_8 = {6d 65 74 65 78 5f 63 66 67 5f 72 75 6e 00}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (3 of ($x*))
}

rule __Adware_Win32_GameVance_32
{
    meta:
        author = "defender2yara"
        detection_name = "!#Adware:Win32/GameVance"
        threat_id = "1879049673"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "111"
        strings_accuracy = "Low"
    strings:
        $x_100_1 = "aj/deactivate.php" ascii //weight: 100
        $x_10_2 = "Freeworkz Uninstaller" ascii //weight: 10
        $x_10_3 = "Play Pickle Uninstaller" ascii //weight: 10
        $x_10_4 = "LivingPlay uninstaller" ascii //weight: 10
        $x_1_5 = {66 72 65 65 77 6f 72 6b 7a [0-8] 2e 64 6c 6c}  //weight: 1, accuracy: Low
        $x_1_6 = "playpicklebar32.dll" ascii //weight: 1
        $x_1_7 = "livingplaylib32.dll" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_100_*) and 1 of ($x_10_*) and 1 of ($x_1_*))) or
            ((1 of ($x_100_*) and 2 of ($x_10_*))) or
            (all of ($x*))
        )
}

rule __Adware_Win32_GameVance_33
{
    meta:
        author = "defender2yara"
        detection_name = "!#Adware:Win32/GameVance"
        threat_id = "1879049673"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {ff ff 41 c6 85 ?? ?? ff ff 64 c6 85 ?? ?? ff ff 64 c6 85 ?? ?? ff ff 56 c6 85 ?? ?? ff ff 65 c6 85 ?? ?? ff ff 63 c6 85 ?? ?? ff ff 74}  //weight: 1, accuracy: Low
        $x_1_2 = {ff ff 43 c6 85 ?? ?? ff ff 72 c6 85 ?? ?? ff ff 65 c6 85 ?? ?? ff ff 61 c6 85 ?? ?? ff ff 74 c6 85 ?? ?? ff ff 65 c6 85 ?? ?? ff ff 46}  //weight: 1, accuracy: Low
        $x_1_3 = {43 00 00 00 66 89 95 ?? fc ff ff b8 3a 00 00 00 66 89 85 ?? fc ff ff b9 5c 00 00 00}  //weight: 1, accuracy: Low
        $x_1_4 = {54 49 00 00 66 89 85 ?? fc ff ff b9 54 59 00 00 66 89 8d ?? fc ff ff}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __Adware_Win32_GameVance_34
{
    meta:
        author = "defender2yara"
        detection_name = "!#Adware:Win32/GameVance"
        threat_id = "1879049673"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "20"
        strings_accuracy = "Low"
    strings:
        $x_10_1 = {ff ff 54 49 54 49 [0-21] 3e 81 bd ?? ?? ff ff 54 49 54 49 [0-21] 3e 81 bd ?? ?? ff ff 58 30 58 30}  //weight: 10, accuracy: Low
        $x_10_2 = {ff ff 4c 49 4c 49 [0-37] 3e 81 bd ?? ?? ff ff 57 57 57 57 [0-37] 3e 81 bd ?? ?? ff ff 54 59 54 59}  //weight: 10, accuracy: Low
        $x_20_3 = {ff ff 54 49 54 49 77 35 81 bd ?? ?? ff ff 54 49 54 49 0f 84 ?? 00 00 00 81 bd ?? ?? ff ff 58 30 58 30 0f 84 ?? ?? 00 00 81 bd ?? ?? ff ff 4c 49 4c 49 0f 84 ?? ?? 00 00 e9 ?? ?? 00 00 81 bd ?? ?? ff ff 57 57 57 57 74 15 81 bd ?? ?? ff ff 54 59 54 59 0f 84 ?? 00 00 00 e9 ?? ?? 00 00 81 bd ?? ?? ff ff 57 57 57 00}  //weight: 20, accuracy: Low
    condition:
        (filesize < 20MB) and
        (
            ((2 of ($x_10_*))) or
            ((1 of ($x_20_*))) or
            (all of ($x*))
        )
}

rule __Adware_Win32_GameVance_35
{
    meta:
        author = "defender2yara"
        detection_name = "!#Adware:Win32/GameVance"
        threat_id = "1879049673"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "3"
        strings_accuracy = "Low"
    strings:
        $x_2_1 = {fc ab 83 c1 0f eb 83 e1 0f eb 3e 8b 94 8d ?? ?? ff ff eb 52}  //weight: 2, accuracy: Low
        $x_2_2 = {b9 fb ff ff ff eb f7 d9 eb 3e 8b 85 ?? ?? ff ff eb d3 e0 eb 25}  //weight: 2, accuracy: Low
        $x_1_3 = {ff ff 02 00 00 00 eb 3e c7 85 ?? ?? ff ff 00 00 00 00 eb eb 3e 81 bd ?? ?? ff ff 8c 00 00 00 eb}  //weight: 1, accuracy: Low
        $x_1_4 = {3e c7 45 fc 02 00 00 00 eb 3e c7 45 f8 00 00 00 00 eb eb 3e 81 7d f8 ?? 00 00 00 eb}  //weight: 1, accuracy: Low
        $x_2_5 = {ff ff 47 eb 06 ?? ?? ?? ?? ?? ?? 3e c6 85 ?? ?? ff ff 65 eb 3e c6 85 ?? ?? ff ff 74 eb 3e c6 85 ?? ?? ff ff 4d eb 3e c6 85 ?? ?? ff ff 6f eb 3e c6 85 ?? ?? ff ff 64 eb}  //weight: 2, accuracy: Low
        $x_2_6 = {ff ff 47 eb 06 ?? ?? ?? ?? ?? ?? 3e c6 85 ?? ?? ff ff 65 eb 3e c6 85 ?? ?? ff ff 74 eb 3e c6 85 ?? ?? ff ff 4c eb 3e c6 85 ?? ?? ff ff 61 eb 3e c6 85 ?? ?? ff ff 73 eb}  //weight: 2, accuracy: Low
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_2_*) and 1 of ($x_1_*))) or
            ((2 of ($x_2_*))) or
            (all of ($x*))
        )
}

rule __Adware_Win32_GameVance_36
{
    meta:
        author = "defender2yara"
        detection_name = "!#Adware:Win32/GameVance"
        threat_id = "1879049673"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "31"
        strings_accuracy = "Low"
    strings:
        $x_10_1 = {67 61 6d 65 72 6f 63 6b 73 74 61 72 00}  //weight: 10, accuracy: High
        $x_10_2 = {63 6c 69 65 6e 74 5f 69 6e 73 74 61 6c 6c 5f 6d 74 78 5f 41 42 43 44 00}  //weight: 10, accuracy: High
        $x_10_3 = {67 72 73 63 6c 61 73 73 00}  //weight: 10, accuracy: High
        $x_10_4 = {5f 69 6e 73 74 61 6c 6c 65 72 5f 6d 74 78 03 00 (6d|6c)}  //weight: 10, accuracy: Low
        $x_10_5 = {67 61 6d 65 76 61 6e 63 65 2e (63|6e)}  //weight: 10, accuracy: Low
        $x_10_6 = "BFGAMEURL_FAIL" ascii //weight: 10
        $x_10_7 = "NoNoItsNotHere" ascii //weight: 10
        $x_1_8 = {6c 6c 65 72 5f 6d 74 78 00 00 00 00 ?? ?? ?? 5f 69 6e 73 74 61}  //weight: 1, accuracy: Low
        $x_1_9 = {70 61 67 65 73 2e 6c 69 76 69 6e 67 70 6c 61 79 2e 63 6f 6d 2f 61 6a 2f (62 75|69 6e) 2e 70 68 70 00}  //weight: 1, accuracy: Low
        $x_1_10 = {70 6c 61 79 70 69 63 6b 6c 65 77 6e 61 6d 65 00 70 6c 61 79 70 69 63 6b 6c 65 63 6c 61 73 73 00}  //weight: 1, accuracy: High
        $x_10_11 = "GAM-SRS-T3" ascii //weight: 10
        $x_1_12 = {6c 70 6c 61 79 63 6c 61 73 73 00 00 6c 70 6c 61 79 77 6e 61 6d 65 00}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (
            ((3 of ($x_10_*) and 1 of ($x_1_*))) or
            ((4 of ($x_10_*))) or
            (all of ($x*))
        )
}

rule __Adware_Win32_GameVance_37
{
    meta:
        author = "defender2yara"
        detection_name = "!#Adware:Win32/GameVance"
        threat_id = "1879049673"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {c6 85 d9 fe ff ff 41 [0-16] c6 85 da fe ff ff 63 [0-16] c6 85 db fe ff ff 71 [0-16] c6 85 dc fe ff ff 75 [0-16] c6 85 dd fe ff ff 69 [0-16] c6 85 de fe ff ff 72 [0-16] c6 85 df fe ff ff 65 [0-16] c6 85 e0 fe ff ff 43}  //weight: 1, accuracy: Low
        $x_1_2 = {c6 85 5c ff ff ff 43 [0-16] c6 85 5d ff ff ff 72 [0-16] c6 85 5e ff ff ff 79 [0-16] c6 85 5f ff ff ff 70 [0-16] c6 85 60 ff ff ff 74 [0-16] c6 85 61 ff ff ff 44 [0-16] c6 85 62 ff ff ff 65 [0-16] c6 85 63 ff ff ff 73}  //weight: 1, accuracy: Low
        $x_1_3 = {c6 85 1c fe ff ff 48 [0-16] c6 85 1d fe ff ff 61 [0-16] c6 85 1e fe ff ff 73 [0-16] c6 85 1f fe ff ff 68 [0-16] c6 85 20 fe ff ff 50 [0-16] c6 85 21 fe ff ff 61 [0-16] c6 85 22 fe ff ff 72 [0-16] c6 85 23 fe ff ff 61 [0-16] c6 85 24 fe ff ff 6d}  //weight: 1, accuracy: Low
        $x_1_4 = {c6 85 a1 fe ff ff 50 [0-17] c6 85 a2 fe ff ff 72 [0-17] c6 85 a3 fe ff ff 69 [0-17] c6 85 a4 fe ff ff 6f [0-17] c6 85 a5 fe ff ff 72 [0-17] c6 85 a6 fe ff ff 69}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_MinerGate_0
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:MinerGate"
        threat_id = "1879049706"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "minergate.com" ascii //weight: 2
        $x_2_2 = ".miners_lock" ascii //weight: 2
        $x_1_3 = "cryptonight-lite" ascii //weight: 1
        $x_1_4 = "ethereum" ascii //weight: 1
        $x_1_5 = "NvOptimusEnablementCuda" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_2_*) and 2 of ($x_1_*))) or
            ((2 of ($x_2_*))) or
            (all of ($x*))
        )
}

rule __PUA_Block_MobiDash_A_0
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:MobiDash.A"
        threat_id = "1879049718"
        signature_type = "SIGNATURE_TYPE_DEXHSTR_EXT"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "StartAppAd" ascii //weight: 1
        $x_1_2 = "Audio628999_PlaylistManager" ascii //weight: 1
        $x_1_3 = "FileDownloader" ascii //weight: 1
        $x_1_4 = "goldmeltingcalci.db" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (3 of ($x*))
}

rule __PUA_Block_OptimizerPro_0
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:OptimizerPro"
        threat_id = "1879049746"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "totalpccare.com/live-chat" ascii //weight: 2
        $x_1_2 = "avqtools.com" ascii //weight: 1
        $x_1_3 = "UsageStat.ini" ascii //weight: 1
        $x_1_4 = "ReceiveLinkSpeed" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_SaveNow_0
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:SaveNow"
        threat_id = "1879049797"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "WhenUOffers" ascii //weight: 1
        $x_1_2 = "savenow.htm" ascii //weight: 1
        $x_1_3 = "savenow.db" ascii //weight: 1
        $x_1_4 = "SOFTWARE\\WhenU\\SaveNow" ascii //weight: 1
        $x_1_5 = "savenowupdate.exe" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (3 of ($x*))
}

rule __PUA_Block_AirInstaller_0
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:AirInstaller"
        threat_id = "1879049822"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "AirInstaller.exe" ascii //weight: 1
        $x_1_2 = "AirInstaller Inc." ascii //weight: 1
        $x_1_3 = "Flash Player Pro" ascii //weight: 1
        $n_100_4 = "Uninst.exe" ascii //weight: -100
        $n_100_5 = "Uninstall.exe" ascii //weight: -100
    condition:
        (filesize < 20MB) and
        (not (any of ($n*))) and
        (all of ($x*))
}

rule __PUA_Block_AirInstaller_1
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:AirInstaller"
        threat_id = "1879049822"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "AirInstallerDistributed.pdb" ascii //weight: 2
        $x_1_2 = "DeclineOffer" ascii //weight: 1
        $x_1_3 = "AcceptOffer" ascii //weight: 1
        $x_1_4 = "Skip all on offer:" ascii //weight: 1
        $x_1_5 = "www.iminent.com" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_2_*) and 3 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule __PUA_Block_Coupish_0
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:Coupish"
        threat_id = "1879049835"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "www.coupish.com" ascii //weight: 2
        $x_1_2 = "Shopping offers" ascii //weight: 1
        $x_1_3 = "coupish_en.ini" ascii //weight: 1
        $x_1_4 = "Toolbar_Phpnuke.exe" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __Adware_Win32_Gabpath_0
{
    meta:
        author = "defender2yara"
        detection_name = "!#Adware:Win32/Gabpath"
        threat_id = "1879049858"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "mutexGPRec" ascii //weight: 1
        $x_1_2 = "gabpath.com/upd.php" ascii //weight: 1
        $x_1_3 = "contextuel_popper\\exe\\src\\GPInstallerLite" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __Adware_Win32_Gabpath_1
{
    meta:
        author = "defender2yara"
        detection_name = "!#Adware:Win32/Gabpath"
        threat_id = "1879049858"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "WorkProjects\\NetNucleosProjects\\WhereSphere_Rebranding\\gabpath" ascii //weight: 1
        $x_1_2 = "GPFF3Component" ascii //weight: 1
        $x_1_3 = "GPFF3Com.dll" wide //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __Adware_Win32_Gabpath_2
{
    meta:
        author = "defender2yara"
        detection_name = "!#Adware:Win32/Gabpath"
        threat_id = "1879049858"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "gabpath_recover_only\\code\\projets\\contextuel_popper\\exe\\src\\saccrecover" ascii //weight: 1
        $x_1_2 = "GPRecover.exe" ascii //weight: 1
        $x_1_3 = "mutexGPRec" wide //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __Adware_Win32_Gabpath_3
{
    meta:
        author = "defender2yara"
        detection_name = "!#Adware:Win32/Gabpath"
        threat_id = "1879049858"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "\\contextuel_popper\\" ascii //weight: 1
        $x_1_2 = "\\Minoral.pdb" ascii //weight: 1
        $x_1_3 = "Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\Network" ascii //weight: 1
        $x_1_4 = "Software\\UpdChecker" ascii //weight: 1
        $x_1_5 = "&mac=" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (4 of ($x*))
}

rule __Adware_Win32_Gabpath_4
{
    meta:
        author = "defender2yara"
        detection_name = "!#Adware:Win32/Gabpath"
        threat_id = "1879049858"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "GP Bar" ascii //weight: 1
        $x_1_2 = "C:\\GP.mht" ascii //weight: 1
        $x_1_3 = "mutexGP" wide //weight: 1
        $x_1_4 = "access_to_cfg_gp" wide //weight: 1
        $x_1_5 = "{4D5C8C25-D075-11d0-B416-00C04FB90376}" wide //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __Adware_Win32_Gabpath_5
{
    meta:
        author = "defender2yara"
        detection_name = "!#Adware:Win32/Gabpath"
        threat_id = "1879049858"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "FP Bar" ascii //weight: 1
        $x_1_2 = "C:\\FP.mht" ascii //weight: 1
        $x_1_3 = "mutexFP" wide //weight: 1
        $x_1_4 = "access_to_cfg_fp" wide //weight: 1
        $x_1_5 = "{4D5C8C25-D075-11d0-B416-00C04FB90376}" wide //weight: 1
        $x_1_6 = "mingroizonz" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (5 of ($x*))
}

rule __Adware_Win32_Gabpath_6
{
    meta:
        author = "defender2yara"
        detection_name = "!#Adware:Win32/Gabpath"
        threat_id = "1879049858"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "b23650b342e78904a093ee34a6c389f2e318414c14c15ba022cecf3ded49469a" ascii //weight: 1
        $x_1_2 = "9e125a27ad897b787ce8b20be02378fd2dcfd39d757bfa394bbc1c0e61d587cd" ascii //weight: 1
        $x_1_3 = "03cec64fe6ae66bc2f2f354eefdbd2f9" ascii //weight: 1
        $x_1_4 = "CDHMCCJ2C9GMADR1CLJ32DJ6" ascii //weight: 1
        $x_1_5 = "mingroizonz" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (4 of ($x*))
}

rule __Adware_Win32_Gabpath_7
{
    meta:
        author = "defender2yara"
        detection_name = "!#Adware:Win32/Gabpath"
        threat_id = "1879049858"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "b23650b342e78904a093ee34a6c389f2e318414c14c15ba022cecf3ded49469a" ascii //weight: 1
        $x_1_2 = "5afe5a81dacbb7e838489ca961e4d07a66bb7ba6d433514a9dc9e103f67aa21d" ascii //weight: 1
        $x_1_3 = "d2570979d562b6812995b33ff62007dd" ascii //weight: 1
        $x_1_4 = "CDHMCCJ2C9GMADR1CLJ32DJ6" ascii //weight: 1
        $x_1_5 = "=j&&LZ66lA??~" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __Adware_Win32_Gabpath_8
{
    meta:
        author = "defender2yara"
        detection_name = "!#Adware:Win32/Gabpath"
        threat_id = "1879049858"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {88 86 03 01 00 00 88 96 02 01 00 00 0f b6 14 31 5f 88 96 04 01 00 00 8b c6}  //weight: 1, accuracy: High
        $x_1_2 = "GPFF3Component" ascii //weight: 1
        $x_1_3 = "Fmingroizonz" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __Adware_Win32_Gabpath_9
{
    meta:
        author = "defender2yara"
        detection_name = "!#Adware:Win32/Gabpath"
        threat_id = "1879049858"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "2"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {88 55 13 02 cb 8b 5d fc 0f b6 d1 8d 3c 02 8a 17 88 14 03 8a 55 13}  //weight: 1, accuracy: High
        $x_1_2 = {bf 40 42 0f 00 8b ff e8 ?? ?? ?? ?? e8 ?? ?? ?? ?? e8 ?? ?? ?? ?? 83 ef 01 75 ec bf 40 42 0f 00 8d a4 24 00 00 00 00 e8}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __Adware_Win32_Gabpath_10
{
    meta:
        author = "defender2yara"
        detection_name = "!#Adware:Win32/Gabpath"
        threat_id = "1879049858"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "8"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {80 3e 3f 75 ?? 68 ff 07 00 00 8d ?? 01 ?? 8d}  //weight: 1, accuracy: Low
        $x_1_2 = "/upd.php?f=" ascii //weight: 1
        $x_2_3 = "/fbck.php" ascii //weight: 2
        $x_5_4 = "/hide /tkey:%s /tlock:%s" ascii //weight: 5
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_5_*) and 1 of ($x_2_*) and 1 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule __Adware_Win32_Gabpath_11
{
    meta:
        author = "defender2yara"
        detection_name = "!#Adware:Win32/Gabpath"
        threat_id = "1879049858"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "3"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {40 42 0f 00 73 41 e8 ?? ?? ?? ?? 89 45 ?? db 45 ?? d9 5d ?? e8}  //weight: 1, accuracy: Low
        $x_1_2 = {8b ec 81 3d ?? ?? ?? ?? 30 75 00 00 7d 0f a1 ?? ?? ?? ?? 03 45 08 a3 ?? ?? ?? ?? eb 0a}  //weight: 1, accuracy: Low
        $x_1_3 = {83 f8 42 73 0c 6a 0d e8 ?? ?? ?? ?? 83 c4 04 eb 0a 6a 16}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __Adware_Win32_Gabpath_12
{
    meta:
        author = "defender2yara"
        detection_name = "!#Adware:Win32/Gabpath"
        threat_id = "1879049858"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "3"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {2f 66 33 2f 61 32 30 30 2e 65 78 65 3f 46 61 26 [0-16] 70 6f 70 6f 72 2e 65 78 65 00}  //weight: 1, accuracy: Low
        $x_1_2 = {5f 43 72 65 61 74 65 4b 65 79 00 fd 95 80 5c 4d 50 41 63 63 65 73 73 [0-10] 2e 65 78 65 00}  //weight: 1, accuracy: Low
        $x_1_3 = {2f 61 30 2e 65 78 65 3f 46 61 00 4d 4d 2e 65 78 65 00}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __Adware_Win32_Gabpath_13
{
    meta:
        author = "defender2yara"
        detection_name = "!#Adware:Win32/Gabpath"
        threat_id = "1879049858"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {63 6f 6e 66 69 67 2e 63 66 67 00 6e 62 74 2e 65 78 65}  //weight: 1, accuracy: High
        $x_1_2 = "clients.newbrandtest.com/" ascii //weight: 1
        $x_1_3 = {72 65 63 6f 76 65 72 2f 4e 42 54 52 65 63 6f 76 65 72 2e 65 78 65 00}  //weight: 1, accuracy: High
        $x_1_4 = {44 69 73 70 6c 61 79 4e 61 6d 65 00 4e 42 54}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (3 of ($x*))
}

rule __Adware_Win32_Gabpath_14
{
    meta:
        author = "defender2yara"
        detection_name = "!#Adware:Win32/Gabpath"
        threat_id = "1879049858"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {68 28 71 02 00 8d}  //weight: 1, accuracy: High
        $x_1_2 = {8b d6 c1 ea 1a 8a 92 ?? ?? ?? ?? 88 13 43 c1 e6 06 ff 4d f8 75 ea ff 4d f4 75}  //weight: 1, accuracy: Low
        $x_1_3 = "Restart_main_exe_%d" wide //weight: 1
        $x_1_4 = "Downloadt_main_exe_%d" wide //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __Adware_Win32_Gabpath_15
{
    meta:
        author = "defender2yara"
        detection_name = "!#Adware:Win32/Gabpath"
        threat_id = "1879049858"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "111"
        strings_accuracy = "High"
    strings:
        $x_100_1 = "GPFF3Component" ascii //weight: 100
        $x_10_2 = {c6 45 e4 6d c6 45 e5 69 c6 45 e6 6e c6 45 e7 67 c6 45 e8 72 c6 45 e9 6f c6 45 ea 69 c6 45 eb 7a}  //weight: 10, accuracy: High
        $x_10_3 = {c6 45 e0 61 c6 45 e1 73 c6 45 e2 73 c6 45 e3 68 c6 45 e4 6f c6 45 e5 6c c6 45 e6 65}  //weight: 10, accuracy: High
        $x_1_4 = {32 c8 5f 88 86 04 01 00 00 88 8e 03 01 00 00 5e 8a c1}  //weight: 1, accuracy: High
        $x_1_5 = {32 d9 88 98 03 01 00 00 88 88 04 01 00 00 5e 8a c3}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_100_*) and 1 of ($x_10_*) and 1 of ($x_1_*))) or
            ((1 of ($x_100_*) and 2 of ($x_10_*))) or
            (all of ($x*))
        )
}

rule __Adware_Win32_Gabpath_16
{
    meta:
        author = "defender2yara"
        detection_name = "!#Adware:Win32/Gabpath"
        threat_id = "1879049858"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {5c 47 61 62 50 61 74 68 5c 63 6f 6e 66 69 67 2e 63 66 67 00}  //weight: 1, accuracy: High
        $x_1_2 = "&hwd=%s&cfg=%s&time_since_install=%i&cfg_dl=%s&sadata=%s&vinfo=%s" ascii //weight: 1
        $x_1_3 = {8a 54 24 24 c7 06 00 00 00 00 00 17 0f b6 07 83 c5 01 23 c3 83 fd 0b 76 08 33 d2 f7 74 24 1c 8b c2 3b 44 24 1c 77 b9}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __Adware_Win32_Gabpath_17
{
    meta:
        author = "defender2yara"
        detection_name = "!#Adware:Win32/Gabpath"
        threat_id = "1879049858"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "11"
        strings_accuracy = "Low"
    strings:
        $x_10_1 = {73 19 8b 45 ?? 8b 4d ?? 8d 54 01 ff 2b 55 ?? 8b 45 08 03 45 ?? 8a 08 88 0a}  //weight: 10, accuracy: Low
        $x_1_2 = "Streaming Music - MediaPass.lnk" wide //weight: 1
        $x_1_3 = {55 70 64 55 72 6c 00 00 53 6f 66 74 77 61 72 65 5c 55 70 64 43 68 65 63 6b 65 72 00}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_10_*) and 1 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule __Adware_Win32_Gabpath_18
{
    meta:
        author = "defender2yara"
        detection_name = "!#Adware:Win32/Gabpath"
        threat_id = "1879049858"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "upd.php?" ascii //weight: 1
        $x_1_2 = ".new.exe" ascii //weight: 1
        $x_1_3 = "mutexFP" ascii //weight: 1
        $x_1_4 = "Software\\Flipopia" ascii //weight: 1
        $x_1_5 = "clients.flipopia.com" ascii //weight: 1
        $x_1_6 = "User-Agent: FPInstaller" ascii //weight: 1
        $x_1_7 = {46 6c 69 70 6f 70 69 61 2e 70 64 62 00}  //weight: 1, accuracy: High
        $x_1_8 = "\\contextuel_popper" ascii //weight: 1
        $x_1_9 = "AVCRelatedSearch@@" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (3 of ($x*))
}

rule __Adware_Win32_Gabpath_19
{
    meta:
        author = "defender2yara"
        detection_name = "!#Adware:Win32/Gabpath"
        threat_id = "1879049858"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "7"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Files required by GabPath have been removed." ascii //weight: 1
        $x_1_2 = {4d 4e 6d 74 78 00}  //weight: 1, accuracy: High
        $x_1_3 = {44 63 52 65 63 4d 75 74 65 53 78 00}  //weight: 1, accuracy: High
        $x_1_4 = {47 61 62 00}  //weight: 1, accuracy: High
        $x_1_5 = {50 61 74 68 00}  //weight: 1, accuracy: High
        $x_1_6 = "http://clients.lb1networks.com/upd.php?" ascii //weight: 1
        $x_1_7 = {2f 72 65 63 6f 76 65 72 20 2f 76 65 72 73 69 6f 6e 3a 25 69 20 2f 6e 72 3a 25 69 20 2f 6e 64 3a 25 69 00}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __Adware_Win32_Gabpath_20
{
    meta:
        author = "defender2yara"
        detection_name = "!#Adware:Win32/Gabpath"
        threat_id = "1879049858"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "6"
        strings_accuracy = "Low"
    strings:
        $x_5_1 = "mingroizonz" ascii //weight: 5
        $x_1_2 = "\\contextuel_popper\\" ascii //weight: 1
        $x_1_3 = "gabpath_" ascii //weight: 1
        $x_1_4 = {03 d1 81 e2 ff 00 00 00 8b 4d ?? 0f b6 14 11 8b 4d ?? 0f b6 14 11 33 c2}  //weight: 1, accuracy: Low
        $x_1_5 = {03 c8 81 e1 ff 00 00 00 8b 45 ?? 0f b6 0c 08 8b 45 ?? 0f b6 0c 08 33 d1}  //weight: 1, accuracy: Low
        $x_1_6 = {03 c2 25 ff 00 00 00 8b 4d ?? 0f b6 14 01 89 55 ?? 0f b6 45 08 8b 4d f4 03 4d fc 0f b6 11 33 c2}  //weight: 1, accuracy: Low
        $x_1_7 = {03 c2 25 ff 00 00 00 32 0c 30 8a 44 24 08 32 c8}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (
            ((6 of ($x_1_*))) or
            ((1 of ($x_5_*) and 1 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule __Adware_Win32_Gabpath_21
{
    meta:
        author = "defender2yara"
        detection_name = "!#Adware:Win32/Gabpath"
        threat_id = "1879049858"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Blammi was successfully removed from your computer." ascii //weight: 1
        $x_1_2 = {41 72 65 20 79 6f 75 20 73 75 72 65 3f 20 59 6f 75 20 77 61 6e 74 20 74 6f 20 75 6e 69 6e 73 74 61 6c 6c 20 42 6c 61 6d 6d 69 20 3f 00}  //weight: 1, accuracy: High
        $x_1_3 = {42 6d 53 65 72 76 69 63 65 00}  //weight: 1, accuracy: High
        $x_1_4 = {50 6f 6c 69 63 69 65 73 5c 45 78 70 6c 6f 72 65 72 00 4e 6f 52 75 6e 00 00 00 4e 6f 44 72 69 76 65 73 00 00 00 00 52 65 73 74 72 69 63 74 52 75 6e}  //weight: 1, accuracy: High
        $x_1_5 = "Software\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\Blammi" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (4 of ($x*))
}

rule __Adware_Win32_Gabpath_22
{
    meta:
        author = "defender2yara"
        detection_name = "!#Adware:Win32/Gabpath"
        threat_id = "1879049858"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "upd.php" ascii //weight: 1
        $x_1_2 = {75 70 64 63 68 65 63 6b 65 72 2e 65 78 65 00}  //weight: 1, accuracy: High
        $x_1_3 = {44 61 74 61 5c 55 70 64 63 68 65 63 6b 65 72 00}  //weight: 1, accuracy: High
        $x_1_4 = "clients.blammi.com" ascii //weight: 1
        $x_1_5 = {42 4d 52 65 63 4d 75 74 65 78 00}  //weight: 1, accuracy: High
        $x_1_6 = {42 6c 61 6d 6d 69 2e 65 78 65 00}  //weight: 1, accuracy: High
        $x_1_7 = {2f 66 62 63 6b 2e 70 68 70 00}  //weight: 1, accuracy: High
        $x_1_8 = {53 00 6f 00 66 00 74 00 77 00 61 00 72 00 65 00 5c 00 42 00 6c 00 61 00 6d 00 6d 00 69 00 00 00}  //weight: 1, accuracy: High
        $x_1_9 = "Files required by Blammi have been removed." ascii //weight: 1
        $x_1_10 = {42 4d 55 70 64 4d 75 74 00}  //weight: 1, accuracy: High
        $x_1_11 = "kgjtsrcvrtkgj" ascii //weight: 1
        $x_1_12 = "=j&&LZ66lA??~" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (4 of ($x*))
}

rule __Adware_Win32_Gabpath_23
{
    meta:
        author = "defender2yara"
        detection_name = "!#Adware:Win32/Gabpath"
        threat_id = "1879049858"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {47 50 20 42 61 72 00}  //weight: 1, accuracy: High
        $x_1_2 = {53 6f 66 74 77 61 72 65 5c 47 61 62 50 61 74 68 00}  //weight: 1, accuracy: High
        $x_1_3 = "gabpath.com/upd.php" ascii //weight: 1
        $x_1_4 = "mutexgp" ascii //weight: 1
        $x_1_5 = "GPRecMutex" ascii //weight: 1
        $x_1_6 = "mingroizonz" ascii //weight: 1
        $x_1_7 = "access_to_cfg_gp" wide //weight: 1
        $x_1_8 = {47 50 55 70 64 61 74 65 72 00}  //weight: 1, accuracy: High
        $x_1_9 = {67 61 62 70 61 74 68 2e 6e 65 77 2e 65 78 65 00}  //weight: 1, accuracy: High
        $x_1_10 = {67 61 62 70 61 74 68 5c 63 6f 6e 66 69 67 2e 63 66 67 00}  //weight: 1, accuracy: High
        $x_1_11 = "clients.lb1networks.com/upd.php" ascii //weight: 1
        $x_1_12 = {47 50 72 65 63 2e 65 78 65 00}  //weight: 1, accuracy: High
        $x_1_13 = {67 61 62 70 61 74 68 2e 65 78 65 00}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (3 of ($x*))
}

rule __Adware_Win32_Gabpath_24
{
    meta:
        author = "defender2yara"
        detection_name = "!#Adware:Win32/Gabpath"
        threat_id = "1879049858"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "upd.php?" ascii //weight: 1
        $x_1_2 = "clients.minoral.com" ascii //weight: 1
        $x_1_3 = "clients.mn-secure.com" ascii //weight: 1
        $x_1_4 = {4d 4e 72 65 63 2e 65 78 65 00}  //weight: 1, accuracy: High
        $x_1_5 = {47 50 72 65 63 2e 65 78 65 00}  //weight: 1, accuracy: High
        $x_1_6 = {5c 4d 69 6e 6f 72 61 6c 00}  //weight: 1, accuracy: High
        $x_1_7 = {5c 47 61 62 50 61 74 68 00}  //weight: 1, accuracy: High
        $x_1_8 = {4d 4e 55 70 64 61 74 65 72 00}  //weight: 1, accuracy: High
        $x_1_9 = {4d 4e 55 70 64 4d 75 74 00}  //weight: 1, accuracy: High
        $x_1_10 = {4d 4e 52 65 63 4d 75 74 65 78 00}  //weight: 1, accuracy: High
        $x_1_11 = "MNInstaller" ascii //weight: 1
        $x_1_12 = {4d 4e 55 6e 69 6e 73 74 61 6c 6c 00}  //weight: 1, accuracy: High
        $x_1_13 = "gpdcount.php?" ascii //weight: 1
        $x_1_14 = "Minoral.exe" ascii //weight: 1
        $x_1_15 = {75 70 64 63 68 65 63 6b 65 72 2e 65 78 65 00}  //weight: 1, accuracy: High
        $x_1_16 = ".?AVCupdcheckerApp@@" ascii //weight: 1
        $x_1_17 = "Software\\UpdChecker" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (4 of ($x*))
}

rule __Adware_Win32_Gabpath_25
{
    meta:
        author = "defender2yara"
        detection_name = "!#Adware:Win32/Gabpath"
        threat_id = "1879049858"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {6d 75 74 65 78 4f 43 52 65 63 00}  //weight: 1, accuracy: High
        $x_1_2 = {4f 43 55 70 64 61 74 65 72 00}  //weight: 1, accuracy: High
        $x_1_3 = {6f 6e 63 75 65 73 2e 6e 65 77 2e 65 78 65 00}  //weight: 1, accuracy: High
        $x_1_4 = {6f 6e 63 75 65 73 2e 65 78 65 00}  //weight: 1, accuracy: High
        $x_1_5 = "gabpath.com/upd.php" ascii //weight: 1
        $x_1_6 = "clients.oncues.com" ascii //weight: 1
        $x_1_7 = {53 6f 66 74 77 61 72 65 5c 5c 4f 6e 63 75 65 73 00}  //weight: 1, accuracy: High
        $x_1_8 = "OnCues\\OCComponents" ascii //weight: 1
        $x_1_9 = "/OCFF3Component/" ascii //weight: 1
        $x_1_10 = ".?AVCFF3Component@@" ascii //weight: 1
        $x_1_11 = ".?AVCOCInstallerApp@@" ascii //weight: 1
        $x_1_12 = {41 70 70 6c 69 63 61 74 69 6f 6e 20 44 61 74 61 5c 6f 6e 63 75 65 73 00}  //weight: 1, accuracy: High
        $x_1_13 = "454d4fxdwfsdfmsv984o58jfum324t5234235v43" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (4 of ($x*))
}

rule __Adware_Win32_Gabpath_26
{
    meta:
        author = "defender2yara"
        detection_name = "!#Adware:Win32/Gabpath"
        threat_id = "1879049858"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "=%s&SubId=%s&OS=%s&mac=%s" wide //weight: 2
        $x_2_2 = "&bnav=%d&nomatch=%d&match=%d&ntp=%d&matchex=%d&gath=%d&lpop=%d" wide //weight: 2
        $x_2_3 = "ver=%i&saccu=%i&ac=%s&sac=%s&hwd=%s&cfg=%s&time_since_install=%i&cfg_dl=%s&sadata=%s&vinfo=%s" wide //weight: 2
        $x_2_4 = "cfg_ver=parachute&validitytest=%d" wide //weight: 2
        $x_1_5 = "newbrandtest.com" wide //weight: 1
        $x_1_6 = "secured-networks.com" wide //weight: 1
        $x_1_7 = "browsing_error_history" wide //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((2 of ($x_2_*) and 2 of ($x_1_*))) or
            ((3 of ($x_2_*))) or
            (all of ($x*))
        )
}

rule __Adware_Win32_Gabpath_27
{
    meta:
        author = "defender2yara"
        detection_name = "!#Adware:Win32/Gabpath"
        threat_id = "1879049858"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "2"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = "access_to_cfg_gp" wide //weight: 1
        $x_1_2 = "cfg_access" wide //weight: 1
        $x_1_3 = "networkgp.com" ascii //weight: 1
        $x_1_4 = "access_to_cfg_nb" wide //weight: 1
        $x_1_5 = "gpdcount.php?" ascii //weight: 1
        $x_1_6 = "feedbak_ComputeCKey_SaveRegStrValues_Error" ascii //weight: 1
        $x_1_7 = "start_DownloadExecuteUpdater" ascii //weight: 1
        $x_1_8 = "adshow.php?VER=%s&SubId=%s&mac=%s" ascii //weight: 1
        $x_1_9 = "start_ComputeCKey" ascii //weight: 1
        $x_1_10 = {72 65 74 30 [0-3] 43 6f 6d 70 75 74 65 43 4b 65 79}  //weight: 1, accuracy: Low
        $x_1_11 = {72 65 74 31 [0-3] 43 6f 6d 70 75 74 65 43 4b 65 79}  //weight: 1, accuracy: Low
        $x_1_12 = {72 65 74 30 43 6f 6d 70 43 4b 65 79 00}  //weight: 1, accuracy: High
        $x_1_13 = {72 65 74 31 43 6f 6d 70 43 4b 65 79 00}  //weight: 1, accuracy: High
        $x_1_14 = "Files required by GabPath have been removed." ascii //weight: 1
        $x_1_15 = "GPFF3Component" ascii //weight: 1
        $x_1_16 = {83 c4 04 83 f8 05 75 0a 6a 2c e8}  //weight: 1, accuracy: High
        $x_1_17 = {8a 46 01 88 86 00 01 00 00 8a 46 03 88 86 01 01 00 00 8a 46 05 88 86 02 01 00 00 8a 46 07 88 86 03 01 00 00 0f b6 45 ff}  //weight: 1, accuracy: High
        $x_1_18 = {8a 41 01 88 81 00 01 00 00 8a 41 03 88 81 01 01 00 00 8a 41 05 88 81 02 01 00 00 8a 41 07 88 81 03 01 00 00 0f b6 45 ff}  //weight: 1, accuracy: High
        $x_1_19 = {8a 41 0c 88 81 0b 01 00 00 8a 41 0e 88 81 0c 01 00 00 8a 41 10 88 81 0d 01 00 00 8a 41 12 88 81 0e 01 00 00 0f b6 45 ff}  //weight: 1, accuracy: High
        $x_1_20 = {8a 46 0c 88 86 0b 01 00 00 8a 46 0e 88 86 0c 01 00 00 8a 46 10 88 86 0d 01 00 00 8a 46 12 88 86 0e 01 00 00 0f b6 45 ff}  //weight: 1, accuracy: High
        $x_1_21 = {88 86 00 01 00 00 0f b6 46 07 88 8e 01 01 00 00 0f b6 4c 24 ?? 88 86 03 01 00 00 88 96 02 01 00 00 0f b6 14 31}  //weight: 1, accuracy: Low
        $x_1_22 = {0f b6 88 03 01 00 00 8b 55 f4 0f b6 04 0a 8b 4d f4 0f b6 91 04 01 00 00}  //weight: 1, accuracy: High
        $x_1_23 = {eb 0f 8b 85 ?? ?? ?? ?? 83 c0 01 89 85 ?? ?? ?? ?? 81 bd ?? ?? ?? ?? 20 a1 07 00 0f 83 98 00 00 00 e8}  //weight: 1, accuracy: Low
        $x_1_24 = {bb 20 a1 07 00 e8 ?? ?? ?? ?? e8 ?? ?? ?? ?? e8 ?? ?? ?? ?? 4b 75 ee ff ?? 3b 45 ?? 76 fb}  //weight: 1, accuracy: Low
        $x_1_25 = {be 20 a1 07 00 [0-5] e8 ?? ?? ?? ?? e8 ?? ?? ?? ?? e8 ?? ?? ?? ?? 83 ee 01 75 ec ff ?? 3b c7 76 fc}  //weight: 1, accuracy: Low
        $x_1_26 = {eb 0f 8b 95 ?? ?? ?? ?? 83 c2 01 89 95 ?? ?? ?? ?? 81 bd ?? ?? ?? ?? 20 a1 07 00 0f 83}  //weight: 1, accuracy: Low
        $x_1_27 = {bf e0 93 04 00 [0-5] e8 ?? ?? ?? ?? e8 ?? ?? ?? ?? e8 ?? ?? ?? ?? 83 ef 01 75 ec ff ?? 3b c3 76 fc}  //weight: 1, accuracy: Low
        $x_1_28 = {64 0f 8c f4 fd ff ff e9 ba fd ff ff c7 45 ?? ?? ?? ?? 00 ff 15 ?? ?? ?? ?? 89 45 ?? 8b 4d ?? 3b 4d ?? 77 02 eb f6}  //weight: 1, accuracy: Low
        $x_1_29 = {55 8b ec 81 3d ?? ?? ?? ?? 30 75 00 00 7e 0a c7 05 ?? ?? ?? ?? 00 00 00 00 a1 ?? ?? ?? ?? 03 45 08 a3}  //weight: 1, accuracy: Low
        $x_1_30 = {bb 40 42 0f 00 59 89 5d ?? e8 ?? ?? ?? ?? e8 ?? ?? ?? ?? e8 ?? ?? ?? ?? ff 4d ?? 75 ec e8}  //weight: 1, accuracy: Low
        $x_1_31 = {be 40 42 0f 00 e8 ?? ?? ?? ?? e8 ?? ?? ?? ?? e8 ?? ?? ?? ?? 83 ee 01 75 ec be 40 42 0f 00 8d a4 24 00 00 00 00 e8}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (2 of ($x*))
}

rule __Adware_Win32_Gabpath_28
{
    meta:
        author = "defender2yara"
        detection_name = "!#Adware:Win32/Gabpath"
        threat_id = "1879049858"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "3"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = "AVCRelatedSearch@@" ascii //weight: 1
        $x_1_2 = "\\contextuel_popper\\" ascii //weight: 1
        $x_1_3 = "advbherr.dat" ascii //weight: 1
        $x_1_4 = "access_to_cfg_gp" wide //weight: 1
        $x_1_5 = "access_to_cfg_nb" wide //weight: 1
        $x_1_6 = "access_to_cfg_da" wide //weight: 1
        $x_1_7 = "cfg_access" wide //weight: 1
        $x_1_8 = {47 50 6d 75 74 65 78 00}  //weight: 1, accuracy: High
        $x_1_9 = "NuRecMut" ascii //weight: 1
        $x_1_10 = "NaUpdMut" ascii //weight: 1
        $x_1_11 = "FCMBPopupOpen" ascii //weight: 1
        $x_1_12 = {47 50 52 65 63 4d 75 74 65 78 00}  //weight: 1, accuracy: High
        $x_1_13 = {47 50 55 70 64 61 74 65 72 32 00}  //weight: 1, accuracy: High
        $x_1_14 = {47 50 52 65 63 6f 76 65 72 32 00}  //weight: 1, accuracy: High
        $x_1_15 = {47 50 49 6e 73 74 61 6c 6c 65 72 32 00}  //weight: 1, accuracy: High
        $x_1_16 = {47 50 55 6e 69 6e 73 74 61 6c 6c 00}  //weight: 1, accuracy: High
        $x_1_17 = {4e 6f 46 69 78 47 50 00}  //weight: 1, accuracy: High
        $x_1_18 = "Oncues\\oncues.exe" ascii //weight: 1
        $x_1_19 = "mutexOCRec" wide //weight: 1
        $x_1_20 = {2f 66 62 63 6b 2e 70 68 70 00}  //weight: 1, accuracy: High
        $x_1_21 = {67 70 75 70 64 2e 70 68 70 3f 56 45 52 3d 25 73 26 53 75 62 49 64 3d 25 73 26 4f 53 3d 25 73 26 6d 61 63 3d 25 73 00}  //weight: 1, accuracy: High
        $x_1_22 = "adshow.php?VER=%s&SubId=%s&mac=%s" ascii //weight: 1
        $x_1_23 = {67 70 68 62 2e 70 68 70 3f 56 45 52 53 49 4f 4e 3d 25 73 26 53 75 62 49 64 3d 25 73 26 6d 61 63 3d 25 73 00}  //weight: 1, accuracy: High
        $x_1_24 = {67 61 62 70 61 74 68 2e 6e 65 77 2e 65 78 65 00}  //weight: 1, accuracy: High
        $x_1_25 = "networkgp.com" ascii //weight: 1
        $x_1_26 = {67 70 75 70 64 61 74 65 00}  //weight: 1, accuracy: High
        $x_1_27 = {2f 72 65 63 6f 76 65 72 00 2f 76 65 72 73 69 6f 6e 3a 25 69 00 2f 6e 72 3a 25 69 00 2f 6e 64 3a 25 69}  //weight: 1, accuracy: High
        $x_1_28 = {72 65 63 5f 63 6c 65 61 6e 75 70 00 57 61 72 6e 69 6e 67}  //weight: 1, accuracy: High
        $x_1_29 = {47 61 62 50 61 74 68 2e 63 6f 6d 00}  //weight: 1, accuracy: High
        $x_1_30 = {47 61 62 50 61 74 68 2e 65 78 65 00}  //weight: 1, accuracy: High
        $x_1_31 = {47 61 62 70 61 74 68 00}  //weight: 1, accuracy: High
        $x_1_32 = {47 50 55 6e 69 6e 73 74 61 6c 6c 2e 65 78 65 00}  //weight: 1, accuracy: High
        $x_1_33 = {67 70 64 65 6c 72 65 63 2e 62 61 74 00}  //weight: 1, accuracy: High
        $x_1_34 = {53 6f 66 74 77 61 72 65 5c 47 61 62 50 61 74 68 00}  //weight: 1, accuracy: High
        $x_1_35 = {53 6f 66 74 77 61 72 65 5c 5c 47 61 62 50 61 74 68 00}  //weight: 1, accuracy: High
        $x_1_36 = {55 6e 69 6e 73 74 61 6c 6c 5c 47 61 62 50 61 74 68 00}  //weight: 1, accuracy: High
        $x_1_37 = {72 65 74 30 43 6f 6d 70 43 4b 65 79 00}  //weight: 1, accuracy: High
        $x_1_38 = "Files required by GabPath have been removed." ascii //weight: 1
        $x_1_39 = "johnnyslave_log" wide //weight: 1
        $x_1_40 = {3d 30 75 00 00 7e 02 33 c0 03 44 24 04 a3}  //weight: 1, accuracy: High
        $x_1_41 = {03 c2 25 ff 00 00 00 32 0c 30 8a 44 24 08 32 c8}  //weight: 1, accuracy: High
        $x_1_42 = {30 75 00 00 7e 07 83 25 ?? ?? ?? ?? 00 08 00 73 ?? 81 3d}  //weight: 1, accuracy: Low
        $x_1_43 = "mingroizonz" ascii //weight: 1
        $x_1_44 = "mingr123oizonz" ascii //weight: 1
        $x_1_45 = "nsbgliaus" ascii //weight: 1
        $x_1_46 = "kincringriri" ascii //weight: 1
        $x_1_47 = "=j&&LZ66lA??~" ascii //weight: 1
        $x_1_48 = "egdhtirkdgs" ascii //weight: 1
        $x_1_49 = "$%#FG&v%$%" ascii //weight: 1
        $x_1_50 = "i:%d;a:4:{s:2:\"ts\";s:%d:\"%s\";s:2:\"td\";" ascii //weight: 1
        $x_1_51 = {c6 45 dc 6d c6 45 dd 65 c6 45 de 67 c6 45 df 61 c6 45 e0 70 c6 45 e1 61 c6 45 e2 73 c6 45 e3 73}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (3 of ($x*))
}

rule __Adware_Win32_Gabpath_29
{
    meta:
        author = "defender2yara"
        detection_name = "!#Adware:Win32/Gabpath"
        threat_id = "1879049858"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "upd.php?" wide //weight: 1
        $x_1_2 = "newbrandtest.com" wide //weight: 1
        $x_1_3 = {4e 00 42 00 54 00 55 00 70 00 64 00 61 00 74 00 65 00 72 00 5f 00 4d 00 75 00 74 00 65 00 78 00 00 00}  //weight: 1, accuracy: High
        $x_1_4 = {6d 00 75 00 74 00 65 00 78 00 4e 00 42 00 54 00 00 00}  //weight: 1, accuracy: High
        $x_1_5 = {4e 00 42 00 54 00 2e 00 65 00 78 00 65 00 00 00}  //weight: 1, accuracy: High
        $x_1_6 = {4e 00 42 00 54 00 2e 00 6e 00 65 00 77 00 2e 00 65 00 78 00 65 00 00 00}  //weight: 1, accuracy: High
        $x_1_7 = {4e 00 42 00 54 00 45 00 42 00 4d 00 68 00 74 00 46 00 6f 00 6f 00 74 00 65 00 72 00 00 00}  //weight: 1, accuracy: High
        $x_1_8 = {61 00 63 00 63 00 65 00 73 00 73 00 5f 00 74 00 6f 00 5f 00 63 00 66 00 67 00 5f 00 6e 00 62 00 74 00 00 00}  //weight: 1, accuracy: High
        $x_1_9 = {53 00 6f 00 66 00 74 00 77 00 61 00 72 00 65 00 5c 00 4e 00 42 00 54 00 00 00}  //weight: 1, accuracy: High
        $x_1_10 = "gpdcount.php?" wide //weight: 1
        $x_1_11 = "gpupd.php?" wide //weight: 1
        $x_1_12 = "NBT was successfully removed from your computer." wide //weight: 1
        $x_1_13 = "ver=%i&saccu=%i&ac=%s&sac=%s&hwd=%s&cfg=%s&time_since_install=%i&cfg_dl=%s&sadata=%s&vinfo=%s" wide //weight: 1
        $x_1_14 = "&bnav=%d&nomatch=%d&match=%d&ntp=%d&matchex=%d&gath=%d&lpop=%d" wide //weight: 1
        $x_1_15 = "runnbt" wide //weight: 1
        $x_1_16 = "securedebugdata.com" wide //weight: 1
        $x_1_17 = "NBTSecondaryUserAgent" wide //weight: 1
        $x_1_18 = {61 00 63 00 63 00 65 00 73 00 73 00 5f 00 63 00 66 00 67 00 00 00}  //weight: 1, accuracy: High
        $x_1_19 = {6d 00 74 00 78 00 4d 00 4e 00 00 00}  //weight: 1, accuracy: High
        $x_1_20 = {6d 00 74 00 78 00 42 00 4d 00 00 00}  //weight: 1, accuracy: High
        $x_1_21 = {63 00 66 00 67 00 5f 00 76 00 65 00 72 00 3d 00 6e 00 6f 00 63 00 66 00 67 00 26 00 67 00 7a 00 3d 00 31 00 00 00}  //weight: 1, accuracy: High
        $x_1_22 = "Files required by NBT have been removed. Would you like to re-install the missing files?" wide //weight: 1
        $x_1_23 = {61 00 63 00 63 00 65 00 73 00 73 00 63 00 66 00 67 00 00 00}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (4 of ($x*))
}

rule __HSTR_MacrobeCException_0
{
    meta:
        author = "defender2yara"
        detection_name = "!#HSTR:MacrobeCException"
        threat_id = "1879049907"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "@aristocrat.com" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __HSTR_MacrobeCException_1
{
    meta:
        author = "defender2yara"
        detection_name = "!#HSTR:MacrobeCException"
        threat_id = "1879049907"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "InStrRev(AdInfo, \"DC=expressmaree\"" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __HSTR_MacrobeCException_2
{
    meta:
        author = "defender2yara"
        detection_name = "!#HSTR:MacrobeCException"
        threat_id = "1879049907"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "PN1 - ERP Production" ascii //weight: 1
        $x_1_2 = "KT3 Overview" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (1 of ($x*))
}

rule __HSTR_MacrobeCException_3
{
    meta:
        author = "defender2yara"
        detection_name = "!#HSTR:MacrobeCException"
        threat_id = "1879049907"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "If Dir(\"c:\\cms\\ini\\wordOptMacro.ini.sv_kyodo\") = \"\" Then" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __HSTR_MacrobeCException_4
{
    meta:
        author = "defender2yara"
        detection_name = "!#HSTR:MacrobeCException"
        threat_id = "1879049907"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "\"c:\\calrec\\quotes\"" ascii //weight: 1
        $x_1_2 = "gotobrowser(\"http://www.more4apps.com/" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (1 of ($x*))
}

rule __HSTR_MacrobeCException_5
{
    meta:
        author = "defender2yara"
        detection_name = "!#HSTR:MacrobeCException"
        threat_id = "1879049907"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "c:\\webs\\qs\\dev\\include\\srf\\devmerchmaintenance\\xls\\templates\\dmm_template.xls" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __HSTR_MacrobeCException_6
{
    meta:
        author = "defender2yara"
        detection_name = "!#HSTR:MacrobeCException"
        threat_id = "1879049907"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Attribute InsertNewRow.VB_Description = \"Macro recorded 20/09/2010 by lcheung1\"" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __HSTR_MacrobeCException_7
{
    meta:
        author = "defender2yara"
        detection_name = "!#HSTR:MacrobeCException"
        threat_id = "1879049907"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "VB_Name = \"mUtil\"" ascii //weight: 1
        $x_1_2 = "VB_Name = \"EdigraphMacros\"" ascii //weight: 1
        $x_1_3 = "Attribute VB_Name = \"ufRenewalWarning\"" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (1 of ($x*))
}

rule __HSTR_MacrobeCException_8
{
    meta:
        author = "defender2yara"
        detection_name = "!#HSTR:MacrobeCException"
        threat_id = "1879049907"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "2"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = "Viser guidelines i documentet" ascii //weight: 1
        $x_1_2 = {48 69 64 65 47 75 69 64 65 6c 69 6e 65 73 44 6f 63 20 4d 61 63 72 6f [0-5] 53 6b 6a 75 6c 65 72 20 67 75 69 64 65 6c 69 6e 65 73 20 69 20 64 6f 63 75 6d 65 6e 74 65 74}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __HSTR_MacrobeCException_9
{
    meta:
        author = "defender2yara"
        detection_name = "!#HSTR:MacrobeCException"
        threat_id = "1879049907"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Hyperion Solutions, Corp." ascii //weight: 1
        $x_1_2 = "Please insert Opera Property code" ascii //weight: 1
        $x_1_3 = {55 74 69 6c 69 7a 65 20 6f 20 42 6f 74 e3 6f 20 53 61 6c 76 61 72 20 50 6c 61 6e 69 6c 68 61}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (1 of ($x*))
}

rule __HSTR_MacrobeCException_10
{
    meta:
        author = "defender2yara"
        detection_name = "!#HSTR:MacrobeCException"
        threat_id = "1879049907"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "2"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Pathagoras will now scan the documents in the target folder" ascii //weight: 1
        $x_1_2 = "DocAssemblyWinName= the AskTable doc" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __HSTR_MacrobeCException_11
{
    meta:
        author = "defender2yara"
        detection_name = "!#HSTR:MacrobeCException"
        threat_id = "1879049907"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "2"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Attribute VB_Name = \"cAdLibBaseData\"" ascii //weight: 1
        $x_1_2 = "Attribute VB_Base = \"0{FCFB3D2A-A0FA-1068-A738-08002B3371B5}\"" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __HSTR_MacrobeCException_12
{
    meta:
        author = "defender2yara"
        detection_name = "!#HSTR:MacrobeCException"
        threat_id = "1879049907"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Sub SAYFA_SEKMELER" ascii //weight: 1
        $x_1_2 = "Attribute VB_Name = \"Sayfa1\"" ascii //weight: 1
        $x_1_3 = "syf.Protect (\"shellleblebi\"), DrawingObjects:=True" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __HSTR_MacrobeCException_13
{
    meta:
        author = "defender2yara"
        detection_name = "!#HSTR:MacrobeCException"
        threat_id = "1879049907"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "10"
        strings_accuracy = "High"
    strings:
        $x_10_1 = "CustomDocumentProperties(\"EBMSoftwareVersion\")" ascii //weight: 10
        $x_10_2 = {43 6f 70 79 72 69 67 68 74 20 ef bf bd 20 32 30 31 32 2d 32 30 31 39 20 45 6e 64 72 65 73 20 41 63 74 75 61 72 69 61 6c 20 43 6f 6e 73 75 6c 74 69 6e 67 20 4c 4c 43}  //weight: 10, accuracy: High
    condition:
        (filesize < 20MB) and
        (1 of ($x*))
}

rule __HSTR_MacrobeCException_14
{
    meta:
        author = "defender2yara"
        detection_name = "!#HSTR:MacrobeCException"
        threat_id = "1879049907"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "2"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "ShowInstructions.VB_Description = \"Macro recorded 29-06-2009 by Melissa Roberts\"" ascii //weight: 1
        $x_1_2 = "Project.NewMacros.HideInstructions" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __HSTR_MacrobeCException_15
{
    meta:
        author = "defender2yara"
        detection_name = "!#HSTR:MacrobeCException"
        threat_id = "1879049907"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Private Function Get_Employee_Number" ascii //weight: 1
        $x_1_2 = "Attribute VB_Name = \"appMain\"" ascii //weight: 1
        $x_1_3 = "M4APS_package As String = \"m4aps_transwizard\"" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __HSTR_MacrobeCException_16
{
    meta:
        author = "defender2yara"
        detection_name = "!#HSTR:MacrobeCException"
        threat_id = "1879049907"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Attribute VB_Name = \"Module6\"" ascii //weight: 1
        $x_1_2 = "Sub BEO_UpdateEEs()" ascii //weight: 1
        $x_1_3 = "BEO_UpdateEEs Macro" ascii //weight: 1
        $x_1_4 = "Const strPass  As String = \"csvtimesheet\"" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (3 of ($x*))
}

rule __HSTR_MacrobeCException_17
{
    meta:
        author = "defender2yara"
        detection_name = "!#HSTR:MacrobeCException"
        threat_id = "1879049907"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Software\\ZigWare\\Brandic" ascii //weight: 1
        $x_1_2 = "This software is owned by ZIGWARE GmbH" ascii //weight: 1
        $x_1_3 = "SaveSetting \"Brandic\", \"Development\", \"DebugMode\", \"ON\"" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __HSTR_MacrobeCException_18
{
    meta:
        author = "defender2yara"
        detection_name = "!#HSTR:MacrobeCException"
        threat_id = "1879049907"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "2"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "fileName = GetAppDataFolder() + \"\\MetadataEvidenceFile.xml\"" ascii //weight: 1
        $x_1_2 = "Call AddCustDocProp(\"Signoff \" + CStr(signoffNodeIndex + 1), signoff)" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __HSTR_MacrobeCException_19
{
    meta:
        author = "defender2yara"
        detection_name = "!#HSTR:MacrobeCException"
        threat_id = "1879049907"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Sub ExporterPDF2()" ascii //weight: 1
        $x_1_2 = "dirBureau = WshShell(\"desktop\")" ascii //weight: 1
        $x_1_3 = "ActiveSheet.ExportAsFixedFormat Type:=xlTypePDF, Filename:= _" ascii //weight: 1
        $x_1_4 = "DateAujourdhui & \".pdf\"" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __HSTR_MacrobeCException_20
{
    meta:
        author = "defender2yara"
        detection_name = "!#HSTR:MacrobeCException"
        threat_id = "1879049907"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Attribute VB_Name = \"MsgGlobal\"" ascii //weight: 1
        $x_1_2 = "'*     Copyright (c) 2005 Agilent Technologies," ascii //weight: 1
        $x_1_3 = "Public Const MSG_SELECT_PORT" ascii //weight: 1
        $x_1_4 = "Public Const STR_ASSIGN_ERROR" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __HSTR_MacrobeCException_21
{
    meta:
        author = "defender2yara"
        detection_name = "!#HSTR:MacrobeCException"
        threat_id = "1879049907"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "2"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "\"\\\\fsprd01n\\Root\\Ger_Fat_Varejo_Gdes_Ctas\\Faturamento\\Gerot - Cadastro\\Ajuste de Cadastro\\TESTE\"" ascii //weight: 2
        $x_1_2 = "Glovia.GloviaConnect" ascii //weight: 1
        $x_1_3 = "\"L:\\Snagging\\CRE Snagging\\\"" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((2 of ($x_1_*))) or
            ((1 of ($x_2_*))) or
            (all of ($x*))
        )
}

rule __HSTR_MacrobeCException_22
{
    meta:
        author = "defender2yara"
        detection_name = "!#HSTR:MacrobeCException"
        threat_id = "1879049907"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "2"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "\"http://endresactuarial.com/" ascii //weight: 1
        $x_1_2 = "GetSettingX(\"EAC\", EACTitle4, \"Agreed\", \"\")" ascii //weight: 1
        $x_1_3 = "Function PrintBar(m_code, m_Height" ascii //weight: 1
        $x_1_4 = "t_BAR_Pattern = Array(\"11011001100\"" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (2 of ($x*))
}

rule __HSTR_MacrobeCException_23
{
    meta:
        author = "defender2yara"
        detection_name = "!#HSTR:MacrobeCException"
        threat_id = "1879049907"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "2"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "XpptIniFile = Environ$(\"APPDATA\") & \"\\\" & ADDINID & \"\\Xppt.ini\"" ascii //weight: 1
        $x_1_2 = "XPPT Add-In is designed for Power Point" ascii //weight: 1
        $x_1_3 = "Private Const MODULE As String = \"modAutoOpen\"" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (2 of ($x*))
}

rule __HSTR_MacrobeCException_24
{
    meta:
        author = "defender2yara"
        detection_name = "!#HSTR:MacrobeCException"
        threat_id = "1879049907"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "URL = \"http://tracker.civas.co/UserTracker_deploy/requesthandler.aspx" ascii //weight: 1
        $x_1_2 = "sTemplateName = \"ROI Multi-Tenant DirCap" ascii //weight: 1
        $x_1_3 = "If c.Title = \"Asgn.InterestsAppraised\" Then" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __HSTR_MacrobeCException_25
{
    meta:
        author = "defender2yara"
        detection_name = "!#HSTR:MacrobeCException"
        threat_id = "1879049907"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "3"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {50 72 69 76 61 74 65 20 53 75 62 20 57 6f 72 6b 73 68 65 65 74 5f 20 00 28 42 79 56 61 6c 20 54 61 72 67 65 74 20 41 73 20 52 61 6e 67}  //weight: 1, accuracy: Low
        $x_1_2 = "Attribute VB_Control = \"CBExpiring, 8, 0, MSForms, CommandButton\"" ascii //weight: 1
        $x_1_3 = "Sheets(\"WorkSheet\").Unprotect Password:=\"benny\"" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __HSTR_MacrobeCException_26
{
    meta:
        author = "defender2yara"
        detection_name = "!#HSTR:MacrobeCException"
        threat_id = "1879049907"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "TekExcelToolbar.xla" ascii //weight: 1
        $x_1_2 = "DlgInternational" ascii //weight: 1
        $x_1_3 = "A4/letter resize" ascii //weight: 1
        $x_1_4 = "Label_Free4Corp" ascii //weight: 1
        $x_1_5 = "Oracle Corporation" ascii //weight: 1
        $x_1_6 = "generated by Concept" ascii //weight: 1
        $x_1_7 = "Intellution," ascii //weight: 1
        $x_1_8 = "LinuxForm Form" ascii //weight: 1
        $x_1_9 = "allen Modulen stehen" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (1 of ($x*))
}

rule __HSTR_MacrobeCException_27
{
    meta:
        author = "defender2yara"
        detection_name = "!#HSTR:MacrobeCException"
        threat_id = "1879049907"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "7"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Public Sub cmsCancelRubi()" ascii //weight: 1
        $x_1_2 = "c.Run (\"CancelRubi\")" ascii //weight: 1
        $x_1_3 = "Public Sub cmsOverwiteSaveFile()" ascii //weight: 1
        $x_1_4 = "c.Run (\"OverwiteSaveFile\")" ascii //weight: 1
        $x_1_5 = "Public Sub cmsSaveFileNaming()" ascii //weight: 1
        $x_1_6 = "c.Run (\"SaveFileNaming\")" ascii //weight: 1
        $x_1_7 = "Set c = GetManagedClass(Me)" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __HSTR_MacrobeCException_28
{
    meta:
        author = "defender2yara"
        detection_name = "!#HSTR:MacrobeCException"
        threat_id = "1879049907"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "If Environ(\"USERDNSDOMAIN\") Like \"*.CPQCORP.NET\" Or Environ(\"USERDNSDOMAIN\") Like \"*SVC.ACCENTURE.COM\" Or Environ(\"USERDNSDOMAIN\") Like \"*AUTH*HPICORP.NET\" Then" ascii //weight: 1
        $x_1_2 = "strURL = \"http://www.un-bc.petrobras.com.br/aplicativo/li" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (1 of ($x*))
}

rule __HSTR_MacrobeCException_29
{
    meta:
        author = "defender2yara"
        detection_name = "!#HSTR:MacrobeCException"
        threat_id = "1879049907"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Public Sub cmsDisplayControlRubi()" ascii //weight: 1
        $x_1_2 = "Public Sub cmsRemakeDocCommands()" ascii //weight: 1
        $x_1_3 = "Public Sub cmsSetWordOpt()" ascii //weight: 1
        $x_1_4 = "Public Sub cmsSetBreak()" ascii //weight: 1
        $x_1_5 = "Public Sub cmsSendManuscript()" ascii //weight: 1
        $x_1_6 = "Options.AutoFormatAsYouTypeReplaceFarEastDashes = False" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __HSTR_MacrobeCException_30
{
    meta:
        author = "defender2yara"
        detection_name = "!#HSTR:MacrobeCException"
        threat_id = "1879049907"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "3"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {50 72 69 76 61 74 65 20 53 75 62 20 57 6f 72 6b 73 68 65 65 74 5f 20 00 28 42 79 56 61 6c 20 54 61 72 67 65 74 20 41 73 20 52 61 6e 67}  //weight: 1, accuracy: Low
        $x_1_2 = "name = Typ & \"_mode_\" & extension & \".tm.spcdrv\"" ascii //weight: 1
        $x_1_3 = "LicenseAgreement_B30.ShowEulaIfNeeded \"Software\\Design Control Software\\Measures mastering helper\\Prototype setting helper\"" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __HSTR_MacrobeCException_31
{
    meta:
        author = "defender2yara"
        detection_name = "!#HSTR:MacrobeCException"
        threat_id = "1879049907"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "TekExcelToolbar.xla" ascii //weight: 1
        $x_1_2 = "DlgInternational" ascii //weight: 1
        $x_1_3 = "Saifon Dorizzi" ascii //weight: 1
        $x_1_4 = "Bloomberg LP" ascii //weight: 1
        $x_1_5 = "WorleyParsons" ascii //weight: 1
        $x_1_6 = "UserTracker_deploy" ascii //weight: 1
        $x_1_7 = "(\"Base_Mes\").Visible" ascii //weight: 1
        $x_1_8 = "ASAsummary" ascii //weight: 1
        $x_1_9 = "www.orimi.com/pdf-test.pdf" ascii //weight: 1
        $x_1_10 = "Software\\\\SchmaleGmbH" ascii //weight: 1
        $x_1_11 = "Private Sub md5_transform(state()" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (1 of ($x*))
}

rule __HSTR_MacrobeCException_32
{
    meta:
        author = "defender2yara"
        detection_name = "!#HSTR:MacrobeCException"
        threat_id = "1879049907"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "InventoryCountlistVBA.HandleWorkbookBeforeSave(saveAsUI)" ascii //weight: 1
        $x_1_2 = "ValidateCountlistOtherBatchAndSerialnumber excelRange.Row, False, True" ascii //weight: 1
        $x_1_3 = "Private Const MODULE_NAME = \"CountlistOther\"" ascii //weight: 1
        $x_1_4 = "eWorksIO.SaveFile \"tortoiseproc.exe /command:commit /path:\"\"\" & vbaRepositoryPath & \"\"\" /closeonend:1" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (3 of ($x*))
}

rule __HSTR_MacrobeCException_33
{
    meta:
        author = "defender2yara"
        detection_name = "!#HSTR:MacrobeCException"
        threat_id = "1879049907"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Attribute VB_Name = \"ING__SaleCode_Analyse\"" ascii //weight: 1
        $x_1_2 = "Call update_count(\"z_ING__SaleCode_Analyse\")" ascii //weight: 1
        $x_1_3 = ".Value = \"Retrieving VEQB data...\"" ascii //weight: 1
        $x_1_4 = ".Value = \"Log on region '\" & REGION_PLANT" ascii //weight: 1
        $x_1_5 = ".Value = Excel.Sheets(\"BOM-RESULT\").Range(result_acell)" ascii //weight: 1
        $x_1_6 = "Function Check_salecode$(CHASSIS, sc, REGION_PLANT)" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (4 of ($x*))
}

rule __HSTR_MacrobeCException_34
{
    meta:
        author = "defender2yara"
        detection_name = "!#HSTR:MacrobeCException"
        threat_id = "1879049907"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Date: 2014-10-20: changed method of summing lines - total words quantity / wordsperline" ascii //weight: 1
        $x_1_2 = "Sheets(\"StartUp\").Visible = Not blnVisible" ascii //weight: 1
        $x_1_3 = "Sheets(\"SDATE00\").Activate" ascii //weight: 1
        $x_1_4 = "xRef = \"C:\\Program Files (x86)\\PDFCreator\\PDFCreator.exe\"" ascii //weight: 1
        $x_1_5 = "http://globalink/financenet" ascii //weight: 1
        $x_1_6 = "If Workbooks(\"DaMenu.xls\").Path & \"\\BACKUP\" = lblPath.Caption Then" ascii //weight: 1
        $x_1_7 = "END_POINT_DEV As String = \"https://devcellsegovapiwebapp.azurewebsites.net/\"" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (1 of ($x*))
}

rule __HSTR_MacrobeCException_35
{
    meta:
        author = "defender2yara"
        detection_name = "!#HSTR:MacrobeCException"
        threat_id = "1879049907"
        signature_type = "SIGNATURE_TYPE_MACROHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "SunGard" ascii //weight: 1
        $x_1_2 = "@td.com\"" ascii //weight: 1
        $x_1_3 = "UpdateLink Name:=\"C:\\Rate View\\" ascii //weight: 1
        $x_1_4 = ".uk.cbi.com/outgoing" ascii //weight: 1
        $x_1_5 = "Attribute VB_Name = \"Berechnungen\"" ascii //weight: 1
        $x_1_6 = "\"specgroup/spec[name='" ascii //weight: 1
        $x_1_7 = "CreateFilterString(\"EzApp Files (EzApp*.xls)\"" ascii //weight: 1
        $x_1_8 = "'Written by Russell Kuemper" ascii //weight: 1
        $x_1_9 = "http://www.greenpartnership.jp" ascii //weight: 1
        $x_1_10 = "Addinsoft are registered trademarks of Addinsoft." ascii //weight: 1
        $x_1_11 = "Traffic_Central_Automation" ascii //weight: 1
        $x_1_12 = "http://dafshare-org.eu.paccar.com" ascii //weight: 1
        $x_1_13 = "Workbooks.OpenText Filename:=\"P:\\FTP\\Marketing\\Download" ascii //weight: 1
        $x_1_14 = "https://www.elcom.admin.ch" ascii //weight: 1
        $x_1_15 = {50 72 6f 20 4b 69 6e 64 20 62 65 74 72 e4 67 74 20 64 65 72 20 48 f6 63 68 73 74 61 6e 73 61 74 7a}  //weight: 1, accuracy: High
        $x_1_16 = "Erstattungsanspruch Gerichtskosten" ascii //weight: 1
        $x_1_17 = "(c) Thomas Wilmes" ascii //weight: 1
        $x_1_18 = {54 68 6f 6d 61 73 20 42 6c f6 6d 6b 65 72}  //weight: 1, accuracy: High
        $x_1_19 = "V:\\Commodities\\GSCI\\RTR\\CSP\\CSPDELTA.csv" ascii //weight: 1
        $x_1_20 = "\"http://www.kssoftware.ch" ascii //weight: 1
        $x_1_21 = "MsgBox ME_MUST_HASSEINO," ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (1 of ($x*))
}

rule __PUA_Block_MultiSetup_0
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:MultiSetup"
        threat_id = "1879049936"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "8"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "operasetup.exe" ascii //weight: 1
        $x_1_2 = "MSetup.exe" ascii //weight: 1
        $x_1_3 = "\\Boo\\Code\\Offergate\\MultiSetup" ascii //weight: 1
        $x_1_4 = "PlayGames.pro" ascii //weight: 1
        $x_1_5 = "360totalsecurity.com" ascii //weight: 1
        $x_1_6 = "adblockfast.com" ascii //weight: 1
        $x_1_7 = "usedOffers" ascii //weight: 1
        $x_1_8 = "offers" ascii //weight: 1
        $x_1_9 = "offerMatch" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (8 of ($x*))
}

rule __PUA_Block_MultiSetup_1
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:MultiSetup"
        threat_id = "1879049936"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "7"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "offersRejectionDialogMessage" ascii //weight: 1
        $x_1_2 = "offersRejectionDialogTitle" ascii //weight: 1
        $x_1_3 = "hvrOfferNext" ascii //weight: 1
        $x_1_4 = "msgScreenOfferDescription" ascii //weight: 1
        $x_1_5 = "usedOffers" ascii //weight: 1
        $x_1_6 = "Avast Free Antivirus" ascii //weight: 1
        $x_1_7 = "multisetup_logo.png" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_MultiSetup_2
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:MultiSetup"
        threat_id = "1879049936"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "SCREEN_DECLINE_OFFER_AFTER_SELECTED_PROGRAM" ascii //weight: 1
        $x_1_2 = "api/executeoffer/bundle_id//json/1/" ascii //weight: 1
        $x_1_3 = "list_offer_test.png" ascii //weight: 1
        $x_1_4 = "Adblock Fast" ascii //weight: 1
        $x_1_5 = "C:\\Program files\\Yandex\\YandexBrowser\\Application\\browser.exe" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_MultiSetup_3
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:MultiSetup"
        threat_id = "1879049936"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "9"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "usedOffers" ascii //weight: 1
        $x_1_2 = "deniedOffers" ascii //weight: 1
        $x_1_3 = "bundleId" ascii //weight: 1
        $x_1_4 = "urlDownload" ascii //weight: 1
        $x_1_5 = "silentParameter" ascii //weight: 1
        $x_1_6 = "\\msetup\\msetup.exe" ascii //weight: 1
        $x_1_7 = "yandex.ru/soft/distribution/" ascii //weight: 1
        $x_1_8 = "Software\\Opera Software" ascii //weight: 1
        $x_1_9 = "SOFTWARE\\AVAST Software\\Avast" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_MultiSetup_4
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:MultiSetup"
        threat_id = "1879049936"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "7"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "ProgramsListOffer" ascii //weight: 1
        $x_1_2 = "hvrOfferNext" ascii //weight: 1
        $x_1_3 = "msetup" ascii //weight: 1
        $x_1_4 = "msgScreenOfferDescription" ascii //weight: 1
        $x_1_5 = "program_for_catalog_offer.cpp" ascii //weight: 1
        $x_1_6 = "YABROWSER" ascii //weight: 1
        $x_1_7 = "complaint_reporting_window.cpp" ascii //weight: 1
        $n_100_8 = "Uninst.exe" ascii //weight: -100
        $n_100_9 = "Uninstaller.exe" ascii //weight: -100
        $n_100_10 = "Uninstal.exe" ascii //weight: -100
    condition:
        (filesize < 20MB) and
        (not (any of ($n*))) and
        (all of ($x*))
}

rule __PUA_Block_Linkular_0
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:Linkular"
        threat_id = "1879049954"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "www.ppdistro.us" ascii //weight: 2
        $x_1_2 = "profiles.ini" ascii //weight: 1
        $x_1_3 = "offer_screen_type" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_WinExecSvc_0
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:WinExecSvc"
        threat_id = "1879049956"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "winexesvcCtrlHandler" ascii //weight: 1
        $x_1_2 = "ahexec_stdout%08X" ascii //weight: 1
        $x_1_3 = "Unrecognized opcode %ld" ascii //weight: 1
        $x_1_4 = "Returning the Main Thread" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (3 of ($x*))
}

rule __PUA_Block_Kraddare_0
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:Kraddare"
        threat_id = "1879049968"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "www.bsalsa.com" ascii //weight: 1
        $x_1_2 = "velly.co.kr" ascii //weight: 1
        $x_1_3 = "toolbar" ascii //weight: 1
        $x_1_4 = "taskbar" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_Kraddare_1
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:Kraddare"
        threat_id = "1879049968"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = "utilmon" ascii //weight: 1
        $x_1_2 = "autoutil" ascii //weight: 1
        $x_1_3 = "utilmania" ascii //weight: 1
        $x_1_4 = {75 00 74 00 69 00 6c 00 [0-4] 2e 00 63 00 6f 00 6d 00}  //weight: 1, accuracy: Low
        $x_1_5 = {75 74 69 6c [0-4] 2e 63 6f 6d}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (4 of ($x*))
}

rule __PUA_Block_Kraddare_2
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:Kraddare"
        threat_id = "1879049968"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "ShellBrowser" ascii //weight: 1
        $x_1_2 = "open.hantools.co.kr/v2/ck.asp" ascii //weight: 1
        $x_1_3 = "mmnneo.com" ascii //weight: 1
        $x_1_4 = "Software\\1gram" ascii //weight: 1
        $x_1_5 = "TaskbarCreated" ascii //weight: 1
        $x_1_6 = "CHROME.EXE" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_Kraddare_3
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:Kraddare"
        threat_id = "1879049968"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "default.cloudweb.co.kr" ascii //weight: 1
        $x_1_2 = "http://{{CONFIG_DOMAIN}}/cloud_patch.php" ascii //weight: 1
        $x_1_3 = "Software\\Cloud-Web" ascii //weight: 1
        $x_1_4 = "PROGRAMFILES%\\Cloud-Web\\Cloud-Web_run.exe" ascii //weight: 1
        $x_1_5 = "cloud_report.php" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (4 of ($x*))
}

rule __PUA_Block_Kraddare_4
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:Kraddare"
        threat_id = "1879049968"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "7"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "11st.co.kr" ascii //weight: 1
        $x_1_2 = "gmarket.co.kr" ascii //weight: 1
        $x_1_3 = "auction.co.kr" ascii //weight: 1
        $x_1_4 = "interpark.co.kr" ascii //weight: 1
        $x_1_5 = "cl.ncclick.co.kr" ascii //weight: 1
        $x_1_6 = "barogagy.co.kr/sidebar/shop_keyword.asp?sword=" ascii //weight: 1
        $x_1_7 = "WBPatchopen.exe" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_Wews87_0
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:Wews87"
        threat_id = "1879049982"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "d.wanyouxi7.com" ascii //weight: 2
        $x_1_2 = "37jzcq.exe" ascii //weight: 1
        $x_1_3 = "jzcq/official/app.ini" ascii //weight: 1
        $x_1_4 = "lander.pdb" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_Wews87_1
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:Wews87"
        threat_id = "1879049982"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "://d.wanyouxi7.com/37/dts/official/Setup_37dts.exe" ascii //weight: 1
        $x_1_2 = "lander.pdb" ascii //weight: 1
        $x_1_3 = "37LanderUpgrade.exe" ascii //weight: 1
        $n_100_4 = "Uninst.exe" ascii //weight: -100
        $n_100_5 = "Uninstall.exe" ascii //weight: -100
    condition:
        (filesize < 20MB) and
        (not (any of ($n*))) and
        (all of ($x*))
}

rule __PUA_Block_Wews87_2
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:Wews87"
        threat_id = "1879049982"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "d:\\37Work\\pc_code\\lander\\template\\lianyun\\Bin\\lander.pdb" ascii //weight: 1
        $x_1_2 = "iconAnimate.exe" ascii //weight: 1
        $x_1_3 = "Lander.ini" ascii //weight: 1
        $x_1_4 = "d.wanyouxi7.com" ascii //weight: 1
        $x_1_5 = "37wancom" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_Wews87_3
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:Wews87"
        threat_id = "1879049982"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "d.wanyouxi7.com" ascii //weight: 2
        $x_1_2 = "37.com" ascii //weight: 1
        $x_1_3 = "a.clickdata.37wan.com" ascii //weight: 1
        $x_1_4 = "d.wanyouxi7.com/37/xz/official/37xz.exe" ascii //weight: 1
        $x_1_5 = "lander.pdb" ascii //weight: 1
        $x_1_6 = "iconAnimate.pdb" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((5 of ($x_1_*))) or
            ((1 of ($x_2_*) and 3 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule __PUA_Block_Wews87_4
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:Wews87"
        threat_id = "1879049982"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "d.wanyouxi7.com/37/cqby/official/app.ini" ascii //weight: 1
        $x_1_2 = "a.clickdata.37wan.com/controller/istat.controller.php" ascii //weight: 1
        $x_1_3 = "Txwu.exe" ascii //weight: 1
        $x_1_4 = "Lander.ini" ascii //weight: 1
        $x_1_5 = "3\\Bin\\lander.pdb" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_Wews87_5
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:Wews87"
        threat_id = "1879049982"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "\\xz\\config.ini" ascii //weight: 1
        $x_1_2 = "\\Application Data\\xz\\config.dll" ascii //weight: 1
        $x_1_3 = "gameCore_cef.exe" ascii //weight: 1
        $x_1_4 = "d.wanyouxi7.com/37/xz/official/37xz.exe" ascii //weight: 1
        $x_1_5 = "a.clickdata.37wan.com/controller/istat.controller.php?" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (4 of ($x*))
}

rule __PUA_Block_Wews87_6
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:Wews87"
        threat_id = "1879049982"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "d.wanyouxi7.com/37/cqby/official/app.ini" ascii //weight: 1
        $x_1_2 = "Lander.ini" ascii //weight: 1
        $x_1_3 = "gameapp.37.com/controller/client.php" ascii //weight: 1
        $x_1_4 = "dts.37.com/gonglue/" ascii //weight: 1
        $x_1_5 = "E:\\37WanWork\\delphicode\\vcLander\\cqby_version3\\04" ascii //weight: 1
        $x_1_6 = "\\Bin\\lander.pdb" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __HSTR_PUA_Win32_Obfuse_PR_AMTB_0
{
    meta:
        author = "defender2yara"
        detection_name = "!#HSTR:PUA:Win32/Obfuse.PR!AMTB"
        threat_id = "1879050007"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "BCryptGenRandom" ascii //weight: 1
        $x_1_2 = "RmStartSession" ascii //weight: 1
        $x_1_3 = "Sleep" ascii //weight: 1
        $x_1_4 = "robloxsolarascript" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __HSTR_PUA_Win32_Obfuse_PR_AMTB_1
{
    meta:
        author = "defender2yara"
        detection_name = "!#HSTR:PUA:Win32/Obfuse.PR!AMTB"
        threat_id = "1879050007"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "2"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "AppData" ascii //weight: 1
        $x_1_2 = "http://win-ott.55kantu.com/" ascii //weight: 1
        $x_1_3 = "http://jtt-win.55kantu.com/" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (2 of ($x*))
}

rule __HSTR_PUA_Win32_Obfuse_PR_AMTB_2
{
    meta:
        author = "defender2yara"
        detection_name = "!#HSTR:PUA:Win32/Obfuse.PR!AMTB"
        threat_id = "1879050007"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "/autorun" ascii //weight: 1
        $x_1_2 = "tp://shredder.91toolbox.com" ascii //weight: 1
        $x_1_3 = "\\Registry\\User\\" ascii //weight: 1
        $x_1_4 = "UltraShredder" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __HSTR_PUA_Win32_Obfuse_PR_AMTB_3
{
    meta:
        author = "defender2yara"
        detection_name = "!#HSTR:PUA:Win32/Obfuse.PR!AMTB"
        threat_id = "1879050007"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "ftp://162.250.124.82/Output.zip" ascii //weight: 1
        $x_1_2 = "Password=B?i8g5v97.KJKh*825&" ascii //weight: 1
        $x_1_3 = "IdealWeight Setup Package" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __HSTR_PUA_Win32_Obfuse_PR_AMTB_4
{
    meta:
        author = "defender2yara"
        detection_name = "!#HSTR:PUA:Win32/Obfuse.PR!AMTB"
        threat_id = "1879050007"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "\\BaseNamedObjects\\Restricted\\" ascii //weight: 1
        $x_1_2 = "rE4847ED08866458F8DD35F94B37001C0" ascii //weight: 1
        $x_1_3 = "/restart" ascii //weight: 1
        $x_1_4 = "/force" ascii //weight: 1
        $x_1_5 = "Browser_Search" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __HSTR_PUA_Win32_Obfuse_PR_AMTB_5
{
    meta:
        author = "defender2yara"
        detection_name = "!#HSTR:PUA:Win32/Obfuse.PR!AMTB"
        threat_id = "1879050007"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "7"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "WriteProcessMemory" ascii //weight: 1
        $x_1_2 = "ReplaceFile" ascii //weight: 1
        $x_1_3 = "Sleep" ascii //weight: 1
        $x_1_4 = "VirtualAlloc" ascii //weight: 1
        $x_1_5 = "VirtualProtect" ascii //weight: 1
        $x_1_6 = "OneStart.ai" ascii //weight: 1
        $x_1_7 = "OneStart Installer" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __HSTR_PUA_Win32_Obfuse_PR_AMTB_6
{
    meta:
        author = "defender2yara"
        detection_name = "!#HSTR:PUA:Win32/Obfuse.PR!AMTB"
        threat_id = "1879050007"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "http://down.chatsou.cc/" ascii //weight: 1
        $x_1_2 = "SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run" ascii //weight: 1
        $x_1_3 = "GptBrowserAppbarAutoStart" ascii //weight: 1
        $x_1_4 = "\\GPT Chrome.lnk" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __HSTR_PUA_Win32_Obfuse_PR_AMTB_7
{
    meta:
        author = "defender2yara"
        detection_name = "!#HSTR:PUA:Win32/Obfuse.PR!AMTB"
        threat_id = "1879050007"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "purchase_clicked" ascii //weight: 1
        $x_1_2 = "Output\\x64\\Release\\iBoysoftDataRecovery.pdb" ascii //weight: 1
        $x_1_3 = "ForceRemove" ascii //weight: 1
        $x_1_4 = "M3 Data Recovery" ascii //weight: 1
        $x_1_5 = "iBoysoft Data Recovery" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __HSTR_PUA_Win32_Obfuse_PR_AMTB_8
{
    meta:
        author = "defender2yara"
        detection_name = "!#HSTR:PUA:Win32/Obfuse.PR!AMTB"
        threat_id = "1879050007"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "\\Registry\\Machine\\System\\CurrentControlSet\\Services\\" ascii //weight: 1
        $x_1_2 = "\\Device\\TrueSight" ascii //weight: 1
        $x_1_3 = "Antirootkit module" ascii //weight: 1
        $x_1_4 = "Adlice Software" ascii //weight: 1
        $x_1_5 = "Truesight" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __HSTR_PUA_Win32_Obfuse_PR_AMTB_9
{
    meta:
        author = "defender2yara"
        detection_name = "!#HSTR:PUA:Win32/Obfuse.PR!AMTB"
        threat_id = "1879050007"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "7"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "RestartByRestartManager" ascii //weight: 1
        $x_1_2 = "aMFCLink_Url" ascii //weight: 1
        $x_1_3 = "BarName" ascii //weight: 1
        $x_1_4 = "cmdiclient" ascii //weight: 1
        $x_1_5 = "hkey_current_user\\software\\" ascii //weight: 1
        $x_1_6 = "HWelcomePage" ascii //weight: 1
        $x_1_7 = "kApartment" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __HSTR_PUA_Win32_Obfuse_PR_AMTB_10
{
    meta:
        author = "defender2yara"
        detection_name = "!#HSTR:PUA:Win32/Obfuse.PR!AMTB"
        threat_id = "1879050007"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "VirtualAlloc" ascii //weight: 1
        $x_1_2 = "VirtualFree" ascii //weight: 1
        $x_1_3 = "LoadLibrary" ascii //weight: 1
        $x_1_4 = "https://update-pic.2345.cc/pic/picnews/index.php" ascii //weight: 1
        $x_1_5 = "pic_ad_random.dat" ascii //weight: 1
        $x_1_6 = "ROOT\\CIMV2" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __HSTR_PUA_Win32_Obfuse_PR_AMTB_11
{
    meta:
        author = "defender2yara"
        detection_name = "!#HSTR:PUA:Win32/Obfuse.PR!AMTB"
        threat_id = "1879050007"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Deep Software Inc." ascii //weight: 1
        $x_1_2 = "SoftActivity Monitor client app" ascii //weight: 1
        $x_1_3 = "Stop &Recording" ascii //weight: 1
        $x_1_4 = "stop recording user activity and tracking your work time?" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __HSTR_PUA_Win32_Obfuse_PR_AMTB_12
{
    meta:
        author = "defender2yara"
        detection_name = "!#HSTR:PUA:Win32/Obfuse.PR!AMTB"
        threat_id = "1879050007"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "8"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "StartMinimized" ascii //weight: 1
        $x_1_2 = "restartappcmd" ascii //weight: 1
        $x_1_3 = "startappfirst" ascii //weight: 1
        $x_1_4 = "silentall" ascii //weight: 1
        $x_1_5 = "APPDIR" ascii //weight: 1
        $x_1_6 = "AutoUpdatePolicy" ascii //weight: 1
        $x_1_7 = "caphyon-advinst-updater" ascii //weight: 1
        $x_1_8 = "Replaces" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __HSTR_PUA_Win32_Obfuse_PR_AMTB_13
{
    meta:
        author = "defender2yara"
        detection_name = "!#HSTR:PUA:Win32/Obfuse.PR!AMTB"
        threat_id = "1879050007"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "BFishPow" ascii //weight: 1
        $x_1_2 = "gPlugin\\DataCenterStub.dll" ascii //weight: 1
        $x_1_3 = "http://s.cityhuitech.com/bfishsearch" ascii //weight: 1
        $x_1_4 = "BigFishBuider.dll" ascii //weight: 1
        $x_1_5 = "SOFTWARE\\BigFishSearch" ascii //weight: 1
        $x_1_6 = "BigFishSearchData" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __HSTR_PUA_Win32_Obfuse_PR_AMTB_14
{
    meta:
        author = "defender2yara"
        detection_name = "!#HSTR:PUA:Win32/Obfuse.PR!AMTB"
        threat_id = "1879050007"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "8"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Winapi.Qos" ascii //weight: 1
        $x_1_2 = "VirtualProtect" ascii //weight: 1
        $x_1_3 = "Sleep" ascii //weight: 1
        $x_1_4 = "VirtualAlloc" ascii //weight: 1
        $x_1_5 = "johab" ascii //weight: 1
        $x_1_6 = "JLZMADecompSmall" ascii //weight: 1
        $x_1_7 = "This installation was built with Inno Setup." ascii //weight: 1
        $x_1_8 = "IMDownloader " ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __HSTR_PUA_Win32_Obfuse_PR_AMTB_15
{
    meta:
        author = "defender2yara"
        detection_name = "!#HSTR:PUA:Win32/Obfuse.PR!AMTB"
        threat_id = "1879050007"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "7"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "TMonitor.TSpinLock" ascii //weight: 1
        $x_1_2 = "TMBCSEncoding" ascii //weight: 1
        $x_1_3 = "Invoke" ascii //weight: 1
        $x_1_4 = "Destroy" ascii //weight: 1
        $x_1_5 = "{sd}\\Games\\Game Name" ascii //weight: 1
        $x_1_6 = "This installation was built with Inno Setup." ascii //weight: 1
        $x_1_7 = "SKD Installer Setup" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __HSTR_PUA_Win32_Obfuse_PR_AMTB_16
{
    meta:
        author = "defender2yara"
        detection_name = "!#HSTR:PUA:Win32/Obfuse.PR!AMTB"
        threat_id = "1879050007"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "StartIndex" ascii //weight: 1
        $x_1_2 = "Sleep" ascii //weight: 1
        $x_1_3 = "GetCommandLine" ascii //weight: 1
        $x_1_4 = "n00010203040506070809101112131415161718192021" ascii //weight: 1
        $x_1_5 = "This installation was built with Inno Setup." ascii //weight: 1
        $x_1_6 = "Origami Studios" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __HSTR_PUA_Win32_Obfuse_PR_AMTB_17
{
    meta:
        author = "defender2yara"
        detection_name = "!#HSTR:PUA:Win32/Obfuse.PR!AMTB"
        threat_id = "1879050007"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "https://raw.githubusercontent.com/acidicoala/" ascii //weight: 1
        $x_1_2 = "\\SmokeAPI\\SmokeAPI\\KoalaBox\\src\\koalabox\\dll_monitor.cpp" ascii //weight: 1
        $x_1_3 = "\\SmokeAPI\\SmokeAPI\\KoalaBox\\src\\koalabox\\hook.cpp" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __HSTR_PUA_Win32_Obfuse_PR_AMTB_18
{
    meta:
        author = "defender2yara"
        detection_name = "!#HSTR:PUA:Win32/Obfuse.PR!AMTB"
        threat_id = "1879050007"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "8"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "HideWindow" ascii //weight: 1
        $x_1_2 = "Exec: command=" ascii //weight: 1
        $x_1_3 = "CopyFiles" ascii //weight: 1
        $x_1_4 = "DeleteRegKey:" ascii //weight: 1
        $x_1_5 = "WriteRegBin" ascii //weight: 1
        $x_1_6 = "install.log" ascii //weight: 1
        $x_1_7 = "Software\\Microsoft\\Windows\\CurrentVersion" ascii //weight: 1
        $x_1_8 = "C:\\TEMP\\FYCADEditor" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __HSTR_PUA_Win32_Obfuse_PR_AMTB_19
{
    meta:
        author = "defender2yara"
        detection_name = "!#HSTR:PUA:Win32/Obfuse.PR!AMTB"
        threat_id = "1879050007"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "2"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "http://win.down.55kantu.com/" ascii //weight: 1
        $x_1_2 = "SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run" ascii //weight: 1
        $x_1_3 = "http://recharge.55kantu.com/" ascii //weight: 1
        $x_1_4 = "http://win.55kantu.com/" ascii //weight: 1
        $x_1_5 = "http://api.55kantu.com/" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (2 of ($x*))
}

rule __HSTR_PUA_Win32_Obfuse_PR_AMTB_20
{
    meta:
        author = "defender2yara"
        detection_name = "!#HSTR:PUA:Win32/Obfuse.PR!AMTB"
        threat_id = "1879050007"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "infatica-service-app.exe" ascii //weight: 1
        $x_1_2 = "Creating registry entries" ascii //weight: 1
        $x_1_3 = "Password" ascii //weight: 1
        $x_1_4 = "RestartReplace" ascii //weight: 1
        $x_1_5 = "The setup files are corrupted" ascii //weight: 1
        $x_1_6 = "This installation was built with Inno Setup" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __HSTR_PUA_Win32_Obfuse_PR_AMTB_21
{
    meta:
        author = "defender2yara"
        detection_name = "!#HSTR:PUA:Win32/Obfuse.PR!AMTB"
        threat_id = "1879050007"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "19ff3e9c3602ae8e841925bb461a0adb064a1f1903667a5e0d87e8f608f425ac" ascii //weight: 1
        $x_1_2 = "Cryptic.dll" ascii //weight: 1
        $x_1_3 = "hostfxr_main_bundle_startupinfo" ascii //weight: 1
        $x_1_4 = "\\corehost\\apphost\\standalone\\apphost.pdb" ascii //weight: 1
        $x_1_5 = "hostfxr.dll" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __HSTR_PUA_Win32_Obfuse_PR_AMTB_22
{
    meta:
        author = "defender2yara"
        detection_name = "!#HSTR:PUA:Win32/Obfuse.PR!AMTB"
        threat_id = "1879050007"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "10"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "@.tvmp" ascii //weight: 1
        $x_1_2 = ".dict" ascii //weight: 1
        $x_1_3 = "GetModuleHandleA" ascii //weight: 1
        $x_1_4 = "LoadLibraryA" ascii //weight: 1
        $x_1_5 = "RegCreateKeyExA" ascii //weight: 1
        $x_1_6 = "waveOutUnprepareHeader" ascii //weight: 1
        $x_1_7 = "GetSystemTimeAsFileTime" ascii //weight: 1
        $x_1_8 = "stardict_Key" ascii //weight: 1
        $x_1_9 = "stardict_aliyun" ascii //weight: 1
        $x_1_10 = "stardict-editor.dll" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __HSTR_PUA_Win32_Obfuse_PR_AMTB_23
{
    meta:
        author = "defender2yara"
        detection_name = "!#HSTR:PUA:Win32/Obfuse.PR!AMTB"
        threat_id = "1879050007"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Caphyon.AI.ExtUI.IEClickSoundRemover" ascii //weight: 1
        $x_1_2 = "c/cmdloc " ascii //weight: 1
        $x_1_3 = "Software\\Microsoft\\Windows\\CurrentVersion\\RunOnce" ascii //weight: 1
        $x_1_4 = "CreateShortcut" ascii //weight: 1
        $x_1_5 = "\\setup\\eventsystem\\InstallMonitor.cpp" ascii //weight: 1
        $x_1_6 = "Nitro PDF Pro\\nitro_pro14_x64.msi" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __HSTR_PUA_Win32_Obfuse_PR_AMTB_24
{
    meta:
        author = "defender2yara"
        detection_name = "!#HSTR:PUA:Win32/Obfuse.PR!AMTB"
        threat_id = "1879050007"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "hkey_local_machine\\software\\" ascii //weight: 1
        $x_1_2 = "RestartByRestartManager" ascii //weight: 1
        $x_1_3 = "CppSetup, Version" ascii //weight: 1
        $x_1_4 = "Another setup is already running, please close it and try again" ascii //weight: 1
        $x_1_5 = "Global\\CppSetup" ascii //weight: 1
        $x_1_6 = "\\DS-Platform\\CppInstaller\\CppSetup\\bin\\Win32\\Release\\CppSetup.pdb" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __HSTR_PUA_Win32_Obfuse_PR_AMTB_25
{
    meta:
        author = "defender2yara"
        detection_name = "!#HSTR:PUA:Win32/Obfuse.PR!AMTB"
        threat_id = "1879050007"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "10"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "mini_installer.exe" ascii //weight: 1
        $x_1_2 = "ConvertSidToStringSid" ascii //weight: 1
        $x_1_3 = "ConvertStringSecurityDescriptorToSecurityDescriptor" ascii //weight: 1
        $x_1_4 = "CryptEncrypt" ascii //weight: 1
        $x_1_5 = "CryptImportKey" ascii //weight: 1
        $x_1_6 = "GetStartupInfo" ascii //weight: 1
        $x_1_7 = "Sleep" ascii //weight: 1
        $x_1_8 = "OneStart Installer" ascii //weight: 1
        $x_1_9 = "OneStart.ai" ascii //weight: 1
        $x_1_10 = "17e1317f6960e3a0bf9dcc371613c98a6d7db701" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __HSTR_PUA_Win32_Obfuse_PR_AMTB_26
{
    meta:
        author = "defender2yara"
        detection_name = "!#HSTR:PUA:Win32/Obfuse.PR!AMTB"
        threat_id = "1879050007"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "8"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "MiCCPPhotoshop ICC profile" ascii //weight: 1
        $x_1_2 = "binaries\\x86ret\\bin\\i386\\\\msvcp140_2.i386.pdb" ascii //weight: 1
        $x_1_3 = "C:\\TEMP\\FYVideoConverter\\InstallExe.exe" ascii //weight: 1
        $x_1_4 = "CreateDirectory: \"%s\" (%d)" ascii //weight: 1
        $x_1_5 = "RMDir: \"%s\"" ascii //weight: 1
        $x_1_6 = "HideWindow" ascii //weight: 1
        $x_1_7 = "CopyFiles \"%s\"->\"%s\"" ascii //weight: 1
        $x_1_8 = "Software\\Microsoft\\Windows\\CurrentVersion" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __HSTR_PUA_Win32_Obfuse_PR_AMTB_27
{
    meta:
        author = "defender2yara"
        detection_name = "!#HSTR:PUA:Win32/Obfuse.PR!AMTB"
        threat_id = "1879050007"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "9"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "GetInstallDetailsPayload" ascii //weight: 1
        $x_1_2 = "IsBrowserProcess" ascii //weight: 1
        $x_1_3 = "IsExtensionPointDisableSet" ascii //weight: 1
        $x_1_4 = "SignalChromeElf" ascii //weight: 1
        $x_1_5 = "SignalInitializeCrashReporting" ascii //weight: 1
        $x_1_6 = "\\chromium-browser-scripts\\src\\out\\Release\\initialexe\\chrome.exe.pdb" ascii //weight: 1
        $x_1_7 = "IsDebuggerPresent" ascii //weight: 1
        $x_1_8 = "VirtualProtect" ascii //weight: 1
        $x_1_9 = "chrome_elf.dll" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __HSTR_PUA_Win32_Obfuse_PR_AMTB_28
{
    meta:
        author = "defender2yara"
        detection_name = "!#HSTR:PUA:Win32/Obfuse.PR!AMTB"
        threat_id = "1879050007"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "7"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "EXCEEDED MAX NUMBER OF OFFERS IN FLOW" ascii //weight: 1
        $x_1_2 = "SKIP ALL AFTER DECLINE OFFER DECLINED" ascii //weight: 1
        $x_1_3 = "\\DS-Platform\\CppInstaller\\CppSetup\\bin\\Win32\\Release\\CppSetup.pdb" ascii //weight: 1
        $x_1_4 = "CreateMutex" ascii //weight: 1
        $x_1_5 = "GlobalAlloc" ascii //weight: 1
        $x_1_6 = "GetStartupInfo" ascii //weight: 1
        $x_1_7 = "<WELCOME_TEXT>This will download {PRODUCT_TITLE} on your computer." ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __HSTR_PUA_Win32_Obfuse_PR_AMTB_29
{
    meta:
        author = "defender2yara"
        detection_name = "!#HSTR:PUA:Win32/Obfuse.PR!AMTB"
        threat_id = "1879050007"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "10"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "\\touch\\TOUCH" ascii //weight: 1
        $x_1_2 = ".exe\" /RegServer" ascii //weight: 1
        $x_1_3 = "Software\\CLASSES\\.gps" ascii //weight: 1
        $x_1_4 = "GOMMODULEUPDATE.EXE" ascii //weight: 1
        $x_1_5 = "HTTP\\shell\\open\\command" ascii //weight: 1
        $x_1_6 = "AppXq0fevzme2pys62n3e0fbqa7peapykr8v" ascii //weight: 1
        $x_1_7 = "\\FinishWelcome.bmp" ascii //weight: 1
        $x_1_8 = "Installer corrupted: invalid opcode" ascii //weight: 1
        $x_1_9 = "Afrow Soft Ltd" ascii //weight: 1
        $x_1_10 = "ButtonEvent Dynamic Link Library" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __HSTR_PUA_Win32_Obfuse_PR_AMTB_30
{
    meta:
        author = "defender2yara"
        detection_name = "!#HSTR:PUA:Win32/Obfuse.PR!AMTB"
        threat_id = "1879050007"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "8"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = "https://visit.keyguardai.com/click" ascii //weight: 1
        $x_1_2 = "ZG93bmxvYWRfYnJvd3Nlcg==" ascii //weight: 1
        $x_1_3 = {68 00 74 00 74 00 70 00 73 00 3a 00 2f 00 2f 00 [0-10] 2e 00 74 00 68 00 69 00 73 00 69 00 6c 00 69 00 65 00 6e 00 74 00 2e 00 63 00 6f 00 6d 00}  //weight: 1, accuracy: Low
        $x_1_4 = {68 74 74 70 73 3a 2f 2f [0-10] 2e 74 68 69 73 69 6c 69 65 6e 74 2e 63 6f 6d}  //weight: 1, accuracy: Low
        $x_1_5 = "\\ZipThisApp.lnk" ascii //weight: 1
        $x_1_6 = "https://www.zipthisapp.com/success" ascii //weight: 1
        $x_1_7 = "update_task_ad.ps1" ascii //weight: 1
        $x_1_8 = "update_task.ps1" ascii //weight: 1
        $x_1_9 = "\\ZipThisApp.exe" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (8 of ($x*))
}

rule __HSTR_PUA_Win32_Obfuse_PR_AMTB_31
{
    meta:
        author = "defender2yara"
        detection_name = "!#HSTR:PUA:Win32/Obfuse.PR!AMTB"
        threat_id = "1879050007"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "8"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Documents Suggest Russia Tried to Attack US Voter Registration Records.txt" ascii //weight: 1
        $x_1_2 = "Experts Examine Links Between Brain Injuries and American Football.txt" ascii //weight: 1
        $x_1_3 = "orange\\games\\game4.htm" ascii //weight: 1
        $x_1_4 = "Website.lnk" ascii //weight: 1
        $x_1_5 = "Software\\Microsoft\\Windows\\CurrentVersion\\Run" ascii //weight: 1
        $x_1_6 = "TypeRun" ascii //weight: 1
        $x_1_7 = "SelfDel.dll" ascii //weight: 1
        $x_1_8 = "65B70DE7540C42759156483165E35215" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __HSTR_PUA_Win32_Obfuse_PR_AMTB_32
{
    meta:
        author = "defender2yara"
        detection_name = "!#HSTR:PUA:Win32/Obfuse.PR!AMTB"
        threat_id = "1879050007"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "http://ss.shanhutech.cn/url3?" ascii //weight: 1
        $x_1_2 = "http://ss.didapaper.com/dot?" ascii //weight: 1
        $x_1_3 = "http://ss.yingyankantu.com/dot?" ascii //weight: 1
        $x_1_4 = "http://ss.goodseepic.com/dot?" ascii //weight: 1
        $x_1_5 = "http://ss.dolphinpaper.com/dot?" ascii //weight: 1
        $x_1_6 = "http://ss.halopaper.cn/dot?" ascii //weight: 1
        $x_1_7 = "http://ss.ccmouse.com/dot?" ascii //weight: 1
        $x_1_8 = "http://ss.whaleprotect.cn/dot?" ascii //weight: 1
        $x_1_9 = "http://ss.bluewhalechat.com/dot?" ascii //weight: 1
        $x_1_10 = "http://ss.pcjiami.cn/dot?" ascii //weight: 1
        $x_1_11 = "http://ss.halopet.cn/dot?" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (6 of ($x*))
}

rule __PUA_Block_Passware_0
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:Passware"
        threat_id = "1879050023"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "6"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {50 00 61 00 73 00 73 00 77 00 61 00 72 00 65 00 20 00 4b 00 69 00 74 00 20 00 45 00 6e 00 74 00 65 00 72 00 70 00 72 00 69 00 73 00 65 00 [0-5] 53 00 65 00 74 00 75 00 70 00}  //weight: 1, accuracy: Low
        $x_1_2 = {50 61 73 73 77 61 72 65 20 4b 69 74 20 45 6e 74 65 72 70 72 69 73 65 [0-5] 53 65 74 75 70}  //weight: 1, accuracy: Low
        $x_1_3 = "moneykey.exe" ascii //weight: 1
        $x_1_4 = "LostPassword.com" ascii //weight: 1
        $x_1_5 = "password recovery" ascii //weight: 1
        $x_1_6 = "serial.ini" ascii //weight: 1
        $x_1_7 = "\\123key.exe" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (6 of ($x*))
}

rule __PUA_Block_WeatherAlerts_0
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:WeatherAlerts"
        threat_id = "1879050028"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "SuperBackup.ini" ascii //weight: 1
        $x_1_2 = "SuperBackup" ascii //weight: 1
        $x_1_3 = "SuperBackup.exe" ascii //weight: 1
        $n_100_4 = "Uninst.exe" ascii //weight: -100
        $n_100_5 = "Uninstall.exe" ascii //weight: -100
    condition:
        (filesize < 20MB) and
        (not (any of ($n*))) and
        (all of ($x*))
}

rule __PUA_Block_WeatherAlerts_1
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:WeatherAlerts"
        threat_id = "1879050028"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "WeatherAlerts.exe" ascii //weight: 1
        $x_1_2 = "WeatherAlerts" ascii //weight: 1
        $x_1_3 = "Local Weather LLC" ascii //weight: 1
        $x_1_4 = "Severe Weather Alert" ascii //weight: 1
        $n_100_5 = "Uninst.exe" ascii //weight: -100
        $n_100_6 = "Uninstall.exe" ascii //weight: -100
    condition:
        (filesize < 20MB) and
        (not (any of ($n*))) and
        (all of ($x*))
}

rule __PUA_Block_WeatherAlerts_2
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:WeatherAlerts"
        threat_id = "1879050028"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "BlitzMediaPlayerApp.exe" ascii //weight: 1
        $x_1_2 = "BlitzMediaPlayerApp.Properties" ascii //weight: 1
        $x_1_3 = "BlitzMediaPlayerApp" ascii //weight: 1
        $x_1_4 = "BlitzMediaPlayerApp.Resources.btnMinimizeHover.bmp" ascii //weight: 1
        $n_100_5 = "Uninst.exe" ascii //weight: -100
        $n_100_6 = "Uninstall.exe" ascii //weight: -100
    condition:
        (filesize < 20MB) and
        (not (any of ($n*))) and
        (all of ($x*))
}

rule __do_vmmgrow_rescan_0
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_vmmgrow_rescan"
        threat_id = "1879050083"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "hel32hkern" ascii //weight: 1
        $x_1_2 = "hllochualahvirt" ascii //weight: 1
        $x_1_3 = "hrotehualphvirt" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_vmmgrow_rescan_1
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_vmmgrow_rescan"
        threat_id = "1879050083"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {81 3a 00 8b 7d 0c 0f 85 ?? ?? ff ff}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_vmmgrow_rescan_2
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_vmmgrow_rescan"
        threat_id = "1879050083"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {41 39 c1 7e 12 48 89 c2 83 e2 03 41 8a 14 10 30 14 01}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_vmmgrow_rescan_3
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_vmmgrow_rescan"
        threat_id = "1879050083"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {ff 8b 45 08 0f 85 ?? ?? ff ff 02 00 81}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_vmmgrow_rescan_4
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_vmmgrow_rescan"
        threat_id = "1879050083"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {01 c1 e8 2c 06 00 00 00 00 39 74 00 00 00 00 00 57 00 77 48}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_vmmgrow_rescan_5
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_vmmgrow_rescan"
        threat_id = "1879050083"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {ff 15 5a 8c 04 00 4c 63 c3 31 d2 48 89 c1 ff 15 44 8c 04 00 49 89 c1}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_vmmgrow_rescan_6
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_vmmgrow_rescan"
        threat_id = "1879050083"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {e8 a3 07 00 00 00 65 00 6e 65 75 69 52 49 00 44 70 ?? 4e 00 00 00 34 00 33 6f ?? 77 4f}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_vmmgrow_rescan_7
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_vmmgrow_rescan"
        threat_id = "1879050083"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {81 38 c9 c2 10 00 0f 85 ?? ?? ff ff}  //weight: 1, accuracy: Low
        $x_1_2 = {66 8b 08 81 f1 4d e0 00 00 0f 84 ?? ?? 00 00}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (1 of ($x*))
}

rule __do_vmmgrow_rescan_8
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_vmmgrow_rescan"
        threat_id = "1879050083"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "Low"
    strings:
        $x_2_1 = {68 f4 01 00 00 68 99 00 00 00}  //weight: 2, accuracy: High
        $x_2_2 = {81 7d dc 68 58 4d 56}  //weight: 2, accuracy: High
        $x_2_3 = {68 6e 0f 00 00 6a 10 68 ?? ?? ?? ?? e8}  //weight: 2, accuracy: Low
    condition:
        (filesize < 20MB) and
        (2 of ($x*))
}

rule __do_vmmgrow_rescan_9
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_vmmgrow_rescan"
        threat_id = "1879050083"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "10"
        strings_accuracy = "Low"
    strings:
        $x_10_1 = {ff 37 00 00 [0-32] (7d|0f 8d) [0-32] 7f 02 00 00 [0-32] (7d|0f 8d) [0-32] 7f [0-32] (7f|0f 8f)}  //weight: 10, accuracy: Low
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_vmmgrow_rescan_10
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_vmmgrow_rescan"
        threat_id = "1879050083"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {65 48 8b 04 25 60 00 00 00 83 b8 18 01 00 00 06 74 0e 83 b8 18 01 00 00 0a 74 50 e9 3f 01 00 00 83 b8 1c 01 00 00 01 74 1f 83 b8 1c 01 00 00 02 0f 84 ce 00 00 00 83 b8 1c 01 00 00 03}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_vmmgrow_rescan_11
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_vmmgrow_rescan"
        threat_id = "1879050083"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "2"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {26 00 41 00 62 00 6f 00 75 00 74 00 20 00 45 00 76 00 65 00 6e 00 74 00 4d 00 6f 00 6e 00 69 00 74 00 6f 00 72 00 2e 00 2e 00 2e 00 00 00}  //weight: 1, accuracy: High
        $x_1_2 = {45 00 76 00 65 00 6e 00 74 00 20 00 4d 00 6f 00 6e 00 69 00 74 00 6f 00 72 00 00 00}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __do_vmmgrow_rescan_12
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_vmmgrow_rescan"
        threat_id = "1879050083"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "11"
        strings_accuracy = "Low"
    strings:
        $x_10_1 = {68 40 00 00 00 ff ?? 89 ?? [0-2] 81 ?? ?? ?? ?? ?? [0-2] 89 ?? [0-2] 68}  //weight: 10, accuracy: Low
        $x_1_2 = {74 04 89 ec 5d c3 0b 00 89 ?? c1 ?? ?? 81 ?? ?? 00 00 00}  //weight: 1, accuracy: Low
        $x_1_3 = {74 04 89 ec 5d c3 07 00 89 ?? c1 ?? ?? 85}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_10_*) and 1 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule __do_vmmgrow_rescan_13
{
    meta:
        author = "defender2yara"
        detection_name = "!#do_vmmgrow_rescan"
        threat_id = "1879050083"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {c9 c2 10 00 0f 85 ?? ?? ff ff 05 00 8b ?? ?? 81}  //weight: 1, accuracy: Low
        $x_1_2 = {c9 c2 0c 00 0f 85 ?? ?? ff ff 05 00 8b ?? ?? 81}  //weight: 1, accuracy: Low
        $x_1_3 = {c9 c2 14 00 0f 85 ?? ?? ff ff 05 00 8b ?? ?? 81}  //weight: 1, accuracy: Low
        $x_1_4 = {c9 c2 1c 00 0f 85 ?? ?? ff ff 05 00 8b ?? ?? 81}  //weight: 1, accuracy: Low
        $x_1_5 = {c9 c2 00 00 85 ff 75 05 00 8b ?? ?? 81}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (1 of ($x*))
}

rule __PUA_Block_Pisivic_0
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:Pisivic"
        threat_id = "1879050089"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Kernel Debug Log Messages (using debug agent)" ascii //weight: 1
        $x_1_2 = "GeoIP Lookup" ascii //weight: 1
        $x_1_3 = "WoW (Windows on Windows) 64-bit OS to 32-bit application Injection Manager" ascii //weight: 1
        $x_1_4 = "Moz Text Scraping Collection Tool & scripts" ascii //weight: 1
        $x_1_5 = "Lotus Notes Collector" ascii //weight: 1
        $x_1_6 = "All data sent to data manager (like seeing data on the server)" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __HSTR_Win32_Obfuse_PR_AMTB_0
{
    meta:
        author = "defender2yara"
        detection_name = "!#HSTR:Win32/Obfuse.PR!AMTB"
        threat_id = "1879050095"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {45 33 ca 49 c1 e1 20 4c 0b c9 49 8b c9 45 88 0c 03 48 c1 e9 [0-2] 41 88 4c 03 01}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __HSTR_Win32_Obfuse_PR_AMTB_1
{
    meta:
        author = "defender2yara"
        detection_name = "!#HSTR:Win32/Obfuse.PR!AMTB"
        threat_id = "1879050095"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "localhost/w3svc" ascii //weight: 1
        $x_1_2 = "C:\\inetpub\\innosetup" ascii //weight: 1
        $x_1_3 = "http://tinyurl.com/2ruw3dak" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __HSTR_Win32_Obfuse_PR_AMTB_2
{
    meta:
        author = "defender2yara"
        detection_name = "!#HSTR:Win32/Obfuse.PR!AMTB"
        threat_id = "1879050095"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "macex" ascii //weight: 1
        $x_1_2 = "freshCake.dll" ascii //weight: 1
        $x_1_3 = "VirtualAlloc" ascii //weight: 1
        $x_1_4 = "VirtualFree" ascii //weight: 1
        $x_1_5 = "LoadLibrary" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __HSTR_Win32_Obfuse_PR_AMTB_3
{
    meta:
        author = "defender2yara"
        detection_name = "!#HSTR:Win32/Obfuse.PR!AMTB"
        threat_id = "1879050095"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "autocalcwidth" ascii //weight: 1
        $x_1_2 = "WinUpdate.exe" ascii //weight: 1
        $x_1_3 = "http://win.55kantu.com/" ascii //weight: 1
        $x_1_4 = "About.exe" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __HSTR_Win32_Obfuse_PR_AMTB_4
{
    meta:
        author = "defender2yara"
        detection_name = "!#HSTR:Win32/Obfuse.PR!AMTB"
        threat_id = "1879050095"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "VirtualAlloc" ascii //weight: 1
        $x_1_2 = "XcvDataW" ascii //weight: 1
        $x_1_3 = "Crack.xxd" ascii //weight: 1
        $x_1_4 = "LoadLibraryA" ascii //weight: 1
        $x_1_5 = "GetProcAddress" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __HSTR_Win32_Obfuse_PR_AMTB_5
{
    meta:
        author = "defender2yara"
        detection_name = "!#HSTR:Win32/Obfuse.PR!AMTB"
        threat_id = "1879050095"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "ryptOpenAlgori80" ascii //weight: 1
        $x_1_2 = "WriteFile" ascii //weight: 1
        $x_1_3 = "bedash.dll" ascii //weight: 1
        $x_1_4 = "pepinella.dll" ascii //weight: 1
        $x_1_5 = "endognathion" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __HSTR_Win32_Obfuse_PR_AMTB_6
{
    meta:
        author = "defender2yara"
        detection_name = "!#HSTR:Win32/Obfuse.PR!AMTB"
        threat_id = "1879050095"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "2"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "syntaksanalyserne codevelop" ascii //weight: 1
        $x_1_2 = "haervaerk pendanter" ascii //weight: 1
        $x_1_3 = "smitsommeste rdlerets" ascii //weight: 1
        $x_1_4 = "mononitride fiskekutter injects" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (2 of ($x*))
}

rule __HSTR_Win32_Obfuse_PR_AMTB_7
{
    meta:
        author = "defender2yara"
        detection_name = "!#HSTR:Win32/Obfuse.PR!AMTB"
        threat_id = "1879050095"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "2"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "C:\\Users\\runneradmin\\AppData\\Local\\Temp\\pkg.d7c6a10fb0263a69b4596321\\node\\" ascii //weight: 1
        $x_1_2 = "GyMdkHmsSEDFwWahKzYeugAZvcLQqVUOXxrbB" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __HSTR_Win32_Obfuse_PR_AMTB_8
{
    meta:
        author = "defender2yara"
        detection_name = "!#HSTR:Win32/Obfuse.PR!AMTB"
        threat_id = "1879050095"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "delete[]" ascii //weight: 1
        $x_1_2 = "\\IntelliSpacePACSMediaViewer.exe" ascii //weight: 1
        $x_1_3 = "IsDebuggerPresent" ascii //weight: 1
        $x_1_4 = "CopyFile" ascii //weight: 1
        $x_1_5 = "Sleep" ascii //weight: 1
        $x_1_6 = "Philips Media Viewer Launcher" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __HSTR_Win32_Obfuse_PR_AMTB_9
{
    meta:
        author = "defender2yara"
        detection_name = "!#HSTR:Win32/Obfuse.PR!AMTB"
        threat_id = "1879050095"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "7"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "VirtualProtect" ascii //weight: 1
        $x_1_2 = "Sleep" ascii //weight: 1
        $x_1_3 = "GetTickCount64" ascii //weight: 1
        $x_1_4 = "GlobalMemoryStatus" ascii //weight: 1
        $x_1_5 = "CheckRemoteDebuggerPresent" ascii //weight: 1
        $x_1_6 = "GetStartupInfo" ascii //weight: 1
        $x_1_7 = "dllhostpgd.exe" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __HSTR_Win32_Obfuse_PR_AMTB_10
{
    meta:
        author = "defender2yara"
        detection_name = "!#HSTR:Win32/Obfuse.PR!AMTB"
        threat_id = "1879050095"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "JLZMADecompSmall" ascii //weight: 1
        $x_1_2 = "n00010203040506070809101112131415161718192021" ascii //weight: 1
        $x_1_3 = "This installation was built with Inno Setup." ascii //weight: 1
        $x_1_4 = "Epsilon Menu.exe   " ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __HSTR_Win32_Obfuse_PR_AMTB_11
{
    meta:
        author = "defender2yara"
        detection_name = "!#HSTR:Win32/Obfuse.PR!AMTB"
        threat_id = "1879050095"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "7"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "GptBrowser.exe" ascii //weight: 1
        $x_1_2 = "IsSandboxedProcess" ascii //weight: 1
        $x_1_3 = "Sleep" ascii //weight: 1
        $x_1_4 = "VirtualProtect" ascii //weight: 1
        $x_1_5 = ".\\pipe\\mojo.%lu.%lu.%" ascii //weight: 1
        $x_1_6 = "ImplicitAppShortcuts" ascii //weight: 1
        $x_1_7 = "Chrome_MessageWindow" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __HSTR_Win32_Obfuse_PR_AMTB_12
{
    meta:
        author = "defender2yara"
        detection_name = "!#HSTR:Win32/Obfuse.PR!AMTB"
        threat_id = "1879050095"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "7"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Invoke" ascii //weight: 1
        $x_1_2 = "PowerShell" ascii //weight: 1
        $x_1_3 = "Replace" ascii //weight: 1
        $x_1_4 = "FromBase64String" ascii //weight: 1
        $x_1_5 = "GetString" ascii //weight: 1
        $x_1_6 = "ZjAtOTY4NS1mZjViYjI2MGRmMmUgNGY5NzFlODkt" ascii //weight: 1
        $x_1_7 = "OWYtYTI3Yi00NzZiMWQwMWM5MzYgMSI=" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __HSTR_Win32_Obfuse_PR_AMTB_13
{
    meta:
        author = "defender2yara"
        detection_name = "!#HSTR:Win32/Obfuse.PR!AMTB"
        threat_id = "1879050095"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "9"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Corehost.Static\\singlefilehost.pdb" ascii //weight: 1
        $x_1_2 = ".CLR_UEF" ascii //weight: 1
        $x_1_3 = ".didat$" ascii //weight: 1
        $x_1_4 = "_RDATA" ascii //weight: 1
        $x_1_5 = "Sleep" ascii //weight: 1
        $x_1_6 = "VirtualAlloc" ascii //weight: 1
        $x_1_7 = "VirtualFree" ascii //weight: 1
        $x_1_8 = "VirtualProtect" ascii //weight: 1
        $x_1_9 = "TelestoStartupEvent" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __HSTR_Win32_Obfuse_PR_AMTB_14
{
    meta:
        author = "defender2yara"
        detection_name = "!#HSTR:Win32/Obfuse.PR!AMTB"
        threat_id = "1879050095"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "\\zen\\file_access.cpp" ascii //weight: 1
        $x_1_2 = "exist in this directory? You're kidding" ascii //weight: 1
        $x_1_3 = "\\zen\\zstring.cpp" ascii //weight: 1
        $x_1_4 = "\\Build\\Bin\\RealtimeSync_x64.pdb" ascii //weight: 1
        $x_1_5 = "VirtualAlloc" ascii //weight: 1
        $x_1_6 = "VirtualProtect" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __HSTR_Win32_Obfuse_PR_AMTB_15
{
    meta:
        author = "defender2yara"
        detection_name = "!#HSTR:Win32/Obfuse.PR!AMTB"
        threat_id = "1879050095"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "9"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "GlobalAlloc" ascii //weight: 1
        $x_1_2 = "LoadLibrary" ascii //weight: 1
        $x_1_3 = "VirtualProtect" ascii //weight: 1
        $x_1_4 = "DllCanUnloadNow" ascii //weight: 1
        $x_1_5 = "C:\\ProgramData\\Steam\\Launcher" ascii //weight: 1
        $x_1_6 = "Copy to" ascii //weight: 1
        $x_1_7 = "Steam Setup" ascii //weight: 1
        $x_1_8 = "Valve Corporation" ascii //weight: 1
        $x_1_9 = "Steam" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __HSTR_Win32_Obfuse_PR_AMTB_16
{
    meta:
        author = "defender2yara"
        detection_name = "!#HSTR:Win32/Obfuse.PR!AMTB"
        threat_id = "1879050095"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "tin9999.tmp" ascii //weight: 1
        $x_1_2 = "Software\\Microsoft\\Windows\\CurrentVersion\\RunOnce" ascii //weight: 1
        $x_1_3 = "This archive is corrupted" ascii //weight: 1
        $x_1_4 = "[AppDataFolder]MadeInC\\Makaroni\\prerequisites" ascii //weight: 1
        $x_1_5 = "/forcecleanup  /wintime " ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __HSTR_Win32_Obfuse_PR_AMTB_17
{
    meta:
        author = "defender2yara"
        detection_name = "!#HSTR:Win32/Obfuse.PR!AMTB"
        threat_id = "1879050095"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "7"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "WDCLEAN.EXE" ascii //weight: 1
        $x_1_2 = "Software\\Microsoft\\Windows\\CurrentVersion\\App Paths\\%s.exe" ascii //weight: 1
        $x_1_3 = "SILENT" ascii //weight: 1
        $x_1_4 = "RELANCE" ascii //weight: 1
        $x_1_5 = "ZIP_SOURCE" ascii //weight: 1
        $x_1_6 = "INFOWDZ" ascii //weight: 1
        $x_1_7 = "S:\\TheFlex\\Installation\\InstallationTheFlex.exe" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __HSTR_Win32_Obfuse_PR_AMTB_18
{
    meta:
        author = "defender2yara"
        detection_name = "!#HSTR:Win32/Obfuse.PR!AMTB"
        threat_id = "1879050095"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "7"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "DisableThreadLibraryCalls" ascii //weight: 1
        $x_1_2 = "VirtualProtect" ascii //weight: 1
        $x_1_3 = "RegOrganizer.exe" ascii //weight: 1
        $x_1_4 = "C:\\WINDOWS\\SYSTEM32\\version.dll" ascii //weight: 1
        $x_1_5 = "WAREZD-OWNFOR-FORUMR-UBOARD-COMINC-RACKWE-TRUSTW-AREZDO-WNWD" ascii //weight: 1
        $x_1_6 = "Warez_Down" ascii //weight: 1
        $x_1_7 = "Proxy DLL" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __HSTR_Win32_Obfuse_PR_AMTB_19
{
    meta:
        author = "defender2yara"
        detection_name = "!#HSTR:Win32/Obfuse.PR!AMTB"
        threat_id = "1879050095"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "8"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "DecodePointer" ascii //weight: 1
        $x_1_2 = "TerminateProcess" ascii //weight: 1
        $x_1_3 = "IsProcessorFeaturePresent" ascii //weight: 1
        $x_1_4 = "IsDebuggerPresent" ascii //weight: 1
        $x_1_5 = "RtlPcToFileHeader" ascii //weight: 1
        $x_1_6 = "hostfxr_main_startupinfo" ascii //weight: 1
        $x_1_7 = "does not contain the expected entry point." ascii //weight: 1
        $x_1_8 = "CVE-2023-27532" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __HSTR_Win32_Obfuse_PR_AMTB_20
{
    meta:
        author = "defender2yara"
        detection_name = "!#HSTR:Win32/Obfuse.PR!AMTB"
        threat_id = "1879050095"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "7"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "huuf0cBFxQAwvm5Z35oGTOSmF5U5WlXqk52vW" ascii //weight: 1
        $x_1_2 = "SSJVro2hagHpqBczVWcswBz" ascii //weight: 1
        $x_1_3 = "UIsbiS7d77FNx9eeMAuowQMOMaM5NBMs4IrLBZ" ascii //weight: 1
        $x_1_4 = "BFojk5eZ8XKdxSdb7xoBCPIBwKympJ2Q==" ascii //weight: 1
        $x_1_5 = "atlmfc\\include\\afxwin1.inl" ascii //weight: 1
        $x_1_6 = "ClipView.pdb" ascii //weight: 1
        $x_1_7 = "ClipView.exe" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __HSTR_Win32_Obfuse_PR_AMTB_21
{
    meta:
        author = "defender2yara"
        detection_name = "!#HSTR:Win32/Obfuse.PR!AMTB"
        threat_id = "1879050095"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "7"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "IsolatedComponent" ascii //weight: 1
        $x_1_2 = "AES Decrypt" ascii //weight: 1
        $x_1_3 = "Downloading resource files archive..." ascii //weight: 1
        $x_1_4 = "C:\\ProfyUse.msi" ascii //weight: 1
        $x_1_5 = "Deleting extracted files..." ascii //weight: 1
        $x_1_6 = "EXE_CMD_LINE=\"/forcecleanup  /wintime" ascii //weight: 1
        $x_1_7 = "Software\\Microsoft\\Windows\\CurrentVersion\\RunOnce" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __HSTR_Win32_Obfuse_PR_AMTB_22
{
    meta:
        author = "defender2yara"
        detection_name = "!#HSTR:Win32/Obfuse.PR!AMTB"
        threat_id = "1879050095"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "RegDelete, HKEY_LOCAL_MACHINE, SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run, StartTools" ascii //weight: 1
        $x_1_2 = "UrlDownloadToFile" ascii //weight: 1
        $x_1_3 = "Iniread, PutTools, %A_AppData%\\ArizonaTools.start, OutPut, PutTools" ascii //weight: 1
        $x_1_4 = "IfNotExist, %A_AppData%\\loadingatools.mp4" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __HSTR_Win32_Obfuse_PR_AMTB_23
{
    meta:
        author = "defender2yara"
        detection_name = "!#HSTR:Win32/Obfuse.PR!AMTB"
        threat_id = "1879050095"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "8"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "http://update.qiyujiasu.com/" ascii //weight: 1
        $x_1_2 = "http://update.taojike.com.cn/" ascii //weight: 1
        $x_1_3 = "Couponbox.exe" ascii //weight: 1
        $x_1_4 = "HaloDesktop.exe" ascii //weight: 1
        $x_1_5 = "Bin\\360Desktop.exe" ascii //weight: 1
        $x_1_6 = "YxhGamever.dll" ascii //weight: 1
        $x_1_7 = "LeyouGamever.dll" ascii //weight: 1
        $x_1_8 = "SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\App Paths\\360wpapp.exe" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __HSTR_Win32_Obfuse_PR_AMTB_24
{
    meta:
        author = "defender2yara"
        detection_name = "!#HSTR:Win32/Obfuse.PR!AMTB"
        threat_id = "1879050095"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion" ascii //weight: 1
        $x_1_2 = "The setup files are corrupted. Please obtain a new copy of the program." ascii //weight: 1
        $x_1_3 = "This installation was built with Inno Setup." ascii //weight: 1
        $x_1_4 = "Wow64DisableWow64FsRedirection" ascii //weight: 1
        $x_1_5 = "Wow64RevertWow64FsRedirection" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (4 of ($x*))
}

rule __HSTR_Win32_Obfuse_PR_AMTB_25
{
    meta:
        author = "defender2yara"
        detection_name = "!#HSTR:Win32/Obfuse.PR!AMTB"
        threat_id = "1879050095"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "9"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "UnkownCPU" ascii //weight: 1
        $x_1_2 = "Software\\Microsoft\\Windows\\CurrentVersion\\Run" ascii //weight: 1
        $x_1_3 = "https://" ascii //weight: 1
        $x_1_4 = "RemoveEnvironmentStrings" ascii //weight: 1
        $x_1_5 = "RemoveFiles" ascii //weight: 1
        $x_1_6 = "Copy URL In Clipboard" ascii //weight: 1
        $x_1_7 = "AES Decrypt" ascii //weight: 1
        $x_1_8 = "Deleting extracted files..." ascii //weight: 1
        $x_1_9 = "Cancel+Downloaded file does not have expected size" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __HSTR_Win32_Obfuse_PR_AMTB_26
{
    meta:
        author = "defender2yara"
        detection_name = "!#HSTR:Win32/Obfuse.PR!AMTB"
        threat_id = "1879050095"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "8"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = "DllCanUnloadNow" ascii //weight: 1
        $x_1_2 = "${REDIST_TEMP_DIR}\\vcredist_x86.exe\" /install /quiet /norestart" ascii //weight: 1
        $x_1_3 = "errorExtractDLLTempDir" ascii //weight: 1
        $x_1_4 = {74 00 6f 00 72 00 72 00 65 00 6e 00 74 00 5c 00 75 00 70 00 64 00 61 00 74 00 65 00 73 00 5c 00 [0-20] 74 00 6f 00 72 00 72 00 65 00 6e 00 74 00 2e 00 65 00 78 00 65 00}  //weight: 1, accuracy: Low
        $x_1_5 = {74 6f 72 72 65 6e 74 5c 75 70 64 61 74 65 73 5c [0-20] 74 6f 72 72 65 6e 74 2e 65 78 65}  //weight: 1, accuracy: Low
        $x_1_6 = "errorCopyDLLDirUpdate" ascii //weight: 1
        $x_1_7 = "cleanInstall" ascii //weight: 1
        $x_1_8 = "A&cepto" ascii //weight: 1
        $x_1_9 = "/SILENT" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (8 of ($x*))
}

rule __HSTR_Win32_Obfuse_PR_AMTB_27
{
    meta:
        author = "defender2yara"
        detection_name = "!#HSTR:Win32/Obfuse.PR!AMTB"
        threat_id = "1879050095"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "15"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Sleep" ascii //weight: 1
        $x_1_2 = "Cancel" ascii //weight: 1
        $x_1_3 = "VariantClear" ascii //weight: 1
        $x_1_4 = "WriteFile" ascii //weight: 1
        $x_1_5 = "IsDebuggerPresent" ascii //weight: 1
        $x_1_6 = "rust_panic" ascii //weight: 1
        $x_1_7 = "directinstall" ascii //weight: 1
        $x_1_8 = "NetApiBufferFree" ascii //weight: 1
        $x_1_9 = "NetUserGetInfo" ascii //weight: 1
        $x_1_10 = "AcquireCredentialsHandle" ascii //weight: 1
        $x_1_11 = "DecryptMessage" ascii //weight: 1
        $x_1_12 = "DeleteSecurityContext" ascii //weight: 1
        $x_1_13 = "EncryptMessage" ascii //weight: 1
        $x_1_14 = "FreeCredentialsHandle" ascii //weight: 1
        $x_1_15 = "LsaEnumerateLogonSessions" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __HSTR_Win32_Obfuse_PR_AMTB_28
{
    meta:
        author = "defender2yara"
        detection_name = "!#HSTR:Win32/Obfuse.PR!AMTB"
        threat_id = "1879050095"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "12"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "TInternalEraInfoRecord" ascii //weight: 1
        $x_1_2 = "Winapi.IpExport" ascii //weight: 1
        $x_1_3 = "GetStartupInfo" ascii //weight: 1
        $x_1_4 = "VirtualAlloc" ascii //weight: 1
        $x_1_5 = "ConvertSidToStringSid" ascii //weight: 1
        $x_1_6 = "__dbk_fcall_wrapper" ascii //weight: 1
        $x_1_7 = "dbkFCallWrapperAddr" ascii //weight: 1
        $x_1_8 = "SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion" ascii //weight: 1
        $x_1_9 = "Wow64DisableWow64FsRedirection" ascii //weight: 1
        $x_1_10 = "This installation was built with Inno Setup." ascii //weight: 1
        $x_1_11 = "VariantCopy" ascii //weight: 1
        $x_1_12 = "CallWindowProc" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __HSTR_Win32_Obfuse_PR_AMTB_29
{
    meta:
        author = "defender2yara"
        detection_name = "!#HSTR:Win32/Obfuse.PR!AMTB"
        threat_id = "1879050095"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "8"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = "kernel32::GetCurrentProcess" ascii //weight: 1
        $x_1_2 = "kernel32::IsWow64Process2" ascii //weight: 1
        $x_1_3 = "VirtualAlloc" ascii //weight: 1
        $x_1_4 = "VirtualProtect" ascii //weight: 1
        $x_1_5 = "\\2bViY4IuP08xBE6awes6ucR0Qzv" ascii //weight: 1
        $x_1_6 = "\\2ZZjFzLkyuDAG0xBiiTfqTO2Li9" ascii //weight: 1
        $x_1_7 = "\\7z-out\\" ascii //weight: 1
        $x_1_8 = {43 00 61 00 6e 00 27 00 74 00 20 00 6d 00 6f 00 64 00 69 00 66 00 79 00 20 00 22 00 [0-100] 22 00 27 00 73 00 20 00 66 00 69 00 6c 00 65 00 73 00}  //weight: 1, accuracy: Low
        $x_1_9 = {43 61 6e 27 74 20 6d 6f 64 69 66 79 20 22 [0-100] 22 27 73 20 66 69 6c 65 73}  //weight: 1, accuracy: Low
        $x_1_10 = {4b 00 65 00 72 00 6e 00 65 00 6c 00 33 00 32 00 3a 00 3a 00 53 00 65 00 74 00 45 00 6e 00 76 00 69 00 72 00 6f 00 6e 00 6d 00 65 00 6e 00 74 00 56 00 61 00 72 00 69 00 61 00 62 00 6c 00 65 00 28 00 74 00 2c 00 20 00 74 00 29 00 69 00 20 00 28 00 22 00 50 00 4f 00 52 00 54 00 41 00 42 00 4c 00 45 00 5f 00 45 00 58 00 45 00 43 00 55 00 54 00 41 00 42 00 4c 00 45 00 5f 00 41 00 50 00 50 00 5f 00 46 00 49 00 4c 00 45 00 4e 00 41 00 4d 00 45 00 22 00 2c 00 20 00 22 00 [0-32] 22 00 29 00 2e 00 72 00 30 00}  //weight: 1, accuracy: Low
        $x_1_11 = {4b 65 72 6e 65 6c 33 32 3a 3a 53 65 74 45 6e 76 69 72 6f 6e 6d 65 6e 74 56 61 72 69 61 62 6c 65 28 74 2c 20 74 29 69 20 28 22 50 4f 52 54 41 42 4c 45 5f 45 58 45 43 55 54 41 42 4c 45 5f 41 50 50 5f 46 49 4c 45 4e 41 4d 45 22 2c 20 22 [0-32] 22 29 2e 72 30}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (8 of ($x*))
}

rule __PUA_Block_AdGazelle_0
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:AdGazelle"
        threat_id = "1879050122"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "2"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "popajar3\\SDKObfuscation\\Obfuscator\\WrapperXtraLITE\\WrapperXtraLITE.pdb" ascii //weight: 2
        $x_1_2 = "getoffers.validatedinstallation.com" ascii //weight: 1
        $x_1_3 = "AdGazelle" ascii //weight: 1
        $x_1_4 = "AGInstallerLibrary" ascii //weight: 1
        $x_1_5 = "--install-from-webstore=" ascii //weight: 1
        $x_1_6 = "popajar3\\Installers\\ValidationScriptLibrary.pdb" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((2 of ($x_1_*))) or
            ((1 of ($x_2_*))) or
            (all of ($x*))
        )
}

rule __PUA_Block_AdGazelle_1
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:AdGazelle"
        threat_id = "1879050122"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "AdGazelle" ascii //weight: 2
        $x_1_2 = "show_eula_offer" ascii //weight: 1
        $x_1_3 = "third party" ascii //weight: 1
        $x_1_4 = "adgazelle.com" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_AdGazelle_2
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:AdGazelle"
        threat_id = "1879050122"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "fuggdownloads102.com" ascii //weight: 2
        $x_1_2 = "WrapperXtraLITE.pdb" ascii //weight: 1
        $x_1_3 = "ads102.com" ascii //weight: 1
        $x_1_4 = "setup.enc" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __Lowfi_ICLoader_0
{
    meta:
        author = "defender2yara"
        detection_name = "!#Lowfi:ICLoader"
        threat_id = "1879050238"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "IC Loader" wide //weight: 2
        $x_2_2 = "cmd.exe /C ping 1.1.1.1 -n 1 -w 3000" wide //weight: 2
        $x_1_3 = "file_url_domain" ascii //weight: 1
        $x_1_4 = "install_conditions" ascii //weight: 1
        $x_1_5 = "user=loader&key= " ascii //weight: 1
        $x_1_6 = "%APPDATA%\\ICL\\data.dat" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_2_*) and 3 of ($x_1_*))) or
            ((2 of ($x_2_*) and 1 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule __ALF_Trojan_Linux_SamDust_A_dha_0
{
    meta:
        author = "defender2yara"
        detection_name = "!#ALF:Trojan:Linux/SamDust.A!dha"
        threat_id = "1879050271"
        signature_type = "SIGNATURE_TYPE_ELFHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_4_1 = "MAD!" ascii //weight: 4
        $x_4_2 = "P@i}B~70lHZ[z+c Cy_jKDFEJ{?u]3#<s;o/kGT:>p,8UhW.Qw^X\\IegMY)La16t=q5O`$9|*&4Nx-d2\"Vbfrv'%(nASmR!" ascii //weight: 4
        $x_4_3 = "]6<q*u'-ic{1tKD|?$ly}7#kNs,e3SH n5J4AVBp!\\I8Q)T/:`wOUv0\"YWhFa_&9m@Mb;(~C.Xg2oz[rx%RGL>f=EjP+^Zd" ascii //weight: 4
        $x_4_4 = "4enL4n)aL04[<nARJJ9/n$jD" ascii //weight: 4
        $x_4_5 = ")99\\p44<\\9LaDAL/DJ^4a\\</\\)\\" ascii //weight: 4
        $x_4_6 = "anyGayGyan\"yany\"ayn\"AanA\"P+#P+#P" ascii //weight: 4
        $x_4_7 = "YT:_Yt*<2B:_" ascii //weight: 4
        $x_4_8 = "bTN<27:S{V{iWt[yWrQo2tP$" ascii //weight: 4
        $x_1_9 = "/sbin/shs" ascii //weight: 1
        $x_1_10 = "THE_PASS" ascii //weight: 1
        $x_1_11 = "[Welcome Master]" ascii //weight: 1
        $x_1_12 = "sc_encode" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((4 of ($x_1_*))) or
            ((1 of ($x_4_*))) or
            (all of ($x*))
        )
}

rule __PUA_Block_DotBundler_0
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:DotBundler"
        threat_id = "1879050288"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "7"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "SDKAPIImpl::setOfferWindow" ascii //weight: 1
        $x_1_2 = "SDKAPIImpl::showOffer" ascii //weight: 1
        $x_1_3 = "adsdk  showOffer" ascii //weight: 1
        $x_1_4 = "download_getOffer" ascii //weight: 1
        $x_1_5 = "download_acceptOffer" ascii //weight: 1
        $x_1_6 = "DotSetupSDK.dll" ascii //weight: 1
        $x_1_7 = "LDPlayer Installer" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_FakeAdBlocker_A_0
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:FakeAdBlocker.A"
        threat_id = "1879050304"
        signature_type = "SIGNATURE_TYPE_DEXHSTR_EXT"
        threshold = "5"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = "PersistedInstallation" ascii //weight: 1
        $x_1_2 = "Ads Blocker" ascii //weight: 1
        $x_1_3 = "androidClientInfo" ascii //weight: 1
        $x_1_4 = "CleanUpAge=" ascii //weight: 1
        $x_1_5 = {69 6e 74 65 6e 73 [0-20] 49 4c 6f 61 64 41 70 6b}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __LoD_VirTool_Win32_Obfuscator_ACW_0
{
    meta:
        author = "defender2yara"
        detection_name = "!#LoD:VirTool:Win32/Obfuscator.ACW"
        threat_id = "1879050423"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "1"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {53 89 d8 89 e7 bf b6 74 75 5d e8 ?? 00 00 00 5b 50 89 d8 89 e7 bf 22 07 e4 71 e8 ?? 00 00 00 89 c2}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __LoD_VirTool_Win32_Obfuscator_ACW_1
{
    meta:
        author = "defender2yara"
        detection_name = "!#LoD:VirTool:Win32/Obfuscator.ACW"
        threat_id = "1879050423"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "2"
        strings_accuracy = "Low"
    strings:
        $x_2_1 = {bf b6 74 75 5d e8 ?? ?? 00 00 5b 50 89 d8 89 e7 bf 22 07 e4 71 (eb|e8 ?? ??)}  //weight: 2, accuracy: Low
        $x_2_2 = {89 85 f4 fd ff ff 58 68 b6 74 75 5d 50 e8 ?? ?? 00 00 fc 89 85 ec fd ff ff}  //weight: 2, accuracy: Low
        $x_2_3 = {bf b6 74 75 5d e8 ?? ?? 00 00 [0-8] 89 d8 89 e7 bf 22 07 e4 71 e8 ?? ?? 00 00}  //weight: 2, accuracy: Low
        $x_2_4 = {29 ff 81 ef 4a 8b 8a a2 ?? e8 ?? ?? 00 00 [0-16] 81 c7 22 07 e4 71}  //weight: 2, accuracy: Low
        $x_2_5 = {89 85 f4 fd ff ff 68 b6 74 75 5d 57 e8 ?? ?? 00 00}  //weight: 2, accuracy: Low
        $x_2_6 = {bf b6 74 75 5d e8 ?? ?? 00 00 5b [0-1] 50 89 d8 89 ef bf 22 07 e4 71 e8 ?? ?? 00 00}  //weight: 2, accuracy: Low
        $x_2_7 = {89 85 f4 fd ff ff 68 b6 74 75 5d 57 ?? e8 ?? ?? 00 00 89 85 ec fd ff ff}  //weight: 2, accuracy: Low
        $x_1_8 = {53 89 d8 89 e7 bf b6 74 75 5d e8 ?? ?? 00 00}  //weight: 1, accuracy: Low
        $x_1_9 = {50 89 d8 89 ef bf 22 07 e4 71 e8 ?? ?? 00 00}  //weight: 1, accuracy: Low
        $x_1_10 = {bf b6 74 75 5d e8 ?? ?? 00 00 5b 50 89 d8 89 e7}  //weight: 1, accuracy: Low
        $x_1_11 = {bf 22 07 e4 71 e8 ?? ?? 00 00}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (
            ((2 of ($x_1_*))) or
            ((1 of ($x_2_*))) or
            (all of ($x*))
        )
}

rule __Adware_Win32_ArcadeWeb_0
{
    meta:
        author = "defender2yara"
        detection_name = "!#Adware:Win32/ArcadeWeb"
        threat_id = "1879050574"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {50 53 54 65 78 74 2e 44 4c 4c 00 44 6c 6c}  //weight: 1, accuracy: High
        $x_1_2 = "playsushislide" ascii //weight: 1
        $x_1_3 = "/psconf.php" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __Adware_Win32_ArcadeWeb_1
{
    meta:
        author = "defender2yara"
        detection_name = "!#Adware:Win32/ArcadeWeb"
        threat_id = "1879050574"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "arcadeweb32.dll" ascii //weight: 1
        $x_1_2 = "arcadewebslide" ascii //weight: 1
        $x_1_3 = "arcadeweb.com/aj/update.php" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __Adware_Win32_ArcadeWeb_2
{
    meta:
        author = "defender2yara"
        detection_name = "!#Adware:Win32/ArcadeWeb"
        threat_id = "1879050574"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "FirefoxPlugin.dll" ascii //weight: 1
        $x_1_2 = "cf.arcadeweb.com" ascii //weight: 1
        $x_1_3 = "AppDataLow\\AWGAMECONFIG" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __Adware_Win32_ArcadeWeb_3
{
    meta:
        author = "defender2yara"
        detection_name = "!#Adware:Win32/ArcadeWeb"
        threat_id = "1879050574"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "12"
        strings_accuracy = "High"
    strings:
        $x_10_1 = "ArcadeWeb Installer" ascii //weight: 10
        $x_1_2 = "Uninstall\\Arcadeweb" ascii //weight: 1
        $x_1_3 = "arcadewebfirefox.dll" ascii //weight: 1
        $x_1_4 = "arcadewebchrome.dll" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_10_*) and 2 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule __Adware_Win32_ArcadeWeb_4
{
    meta:
        author = "defender2yara"
        detection_name = "!#Adware:Win32/ArcadeWeb"
        threat_id = "1879050574"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "111"
        strings_accuracy = "High"
    strings:
        $x_100_1 = "aj/deactivate.php" ascii //weight: 100
        $x_10_2 = "ArcadeWeb Uninstaller" ascii //weight: 10
        $x_10_3 = "PlaySushi uninstaller" ascii //weight: 10
        $x_1_4 = "arcadeweb32.dll" ascii //weight: 1
        $x_1_5 = "PlaySushi32.DLL" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_100_*) and 1 of ($x_10_*) and 1 of ($x_1_*))) or
            ((1 of ($x_100_*) and 2 of ($x_10_*))) or
            (all of ($x*))
        )
}

rule __Adware_Win32_ArcadeWeb_5
{
    meta:
        author = "defender2yara"
        detection_name = "!#Adware:Win32/ArcadeWeb"
        threat_id = "1879050574"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "landingpages.playsushi.com" ascii //weight: 1
        $x_1_2 = "textlinks@playsushi.com" ascii //weight: 1
        $x_1_3 = {50 53 54 65 78 74 2e 44 4c 4c 00 44 6c 6c 43 61 6e 55 6e 6c 6f 61 64 4e 6f 77}  //weight: 1, accuracy: High
        $x_1_4 = "psid:%d|uid:%s|loc:%d|stjs:%d" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (3 of ($x*))
}

rule __Adware_Win32_ArcadeWeb_6
{
    meta:
        author = "defender2yara"
        detection_name = "!#Adware:Win32/ArcadeWeb"
        threat_id = "1879050574"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "12"
        strings_accuracy = "High"
    strings:
        $x_10_1 = {8a 04 01 3c 2b 74 25 3c 2f 74 1a 3c 3d 74 0f 3c 7e 74 04 88 07}  //weight: 10, accuracy: High
        $x_1_2 = "livingplay.com" ascii //weight: 1
        $x_1_3 = "MozillaPlugins\\npDisplayEngine" ascii //weight: 1
        $x_1_4 = "ArcadeWeb Extension" ascii //weight: 1
        $x_1_5 = "arcadewebchrome.dll" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_10_*) and 2 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule __Adware_Win32_ArcadeWeb_7
{
    meta:
        author = "defender2yara"
        detection_name = "!#Adware:Win32/ArcadeWeb"
        threat_id = "1879050574"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "awiontraymtx" ascii //weight: 1
        $x_1_2 = "AppDataLow\\AWGAMECONFIG" ascii //weight: 1
        $x_1_3 = "arcadeweb.com" ascii //weight: 1
        $x_1_4 = "ArcadeWeb Extension" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (3 of ($x*))
}

rule __Adware_Win32_ArcadeWeb_8
{
    meta:
        author = "defender2yara"
        detection_name = "!#Adware:Win32/ArcadeWeb"
        threat_id = "1879050574"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {41 72 63 61 64 65 57 65 62 20 55 6e 69 6e 73 74 61 6c 6c 65 72 00}  //weight: 1, accuracy: High
        $x_1_2 = {25 73 5c 61 72 63 61 64 65 77 65 62 33 32 2e 64 6c 6c 00}  //weight: 1, accuracy: High
        $x_1_3 = {53 6f 66 74 77 61 72 65 5c 41 70 70 44 61 74 61 4c 6f 77 5c 41 72 63 61 64 65 57 65 62 00}  //weight: 1, accuracy: High
        $x_1_4 = "arcadeweb.com/aj/deactivate.php" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (3 of ($x*))
}

rule __Adware_Win32_ArcadeWeb_9
{
    meta:
        author = "defender2yara"
        detection_name = "!#Adware:Win32/ArcadeWeb"
        threat_id = "1879050574"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "awun.exe" ascii //weight: 1
        $x_1_2 = "Please reboot your system manualy!" ascii //weight: 1
        $x_1_3 = "ArcadeWeb Uninstaller Finish" ascii //weight: 1
        $x_1_4 = "arcadeweb32.dll" ascii //weight: 1
        $x_1_5 = "aj/deactivate.ph" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (4 of ($x*))
}

rule __Adware_Win32_ArcadeWeb_10
{
    meta:
        author = "defender2yara"
        detection_name = "!#Adware:Win32/ArcadeWeb"
        threat_id = "1879050574"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = "AW Registry removal" ascii //weight: 1
        $x_1_2 = {61 72 63 61 64 65 77 65 62 66 69 72 65 66 6f 78 [0-1] 2e 64 6c 6c}  //weight: 1, accuracy: Low
        $x_1_3 = "%s\\arcadeweb32.dll" ascii //weight: 1
        $x_1_4 = "aw_install_uninstall_safeguard" ascii //weight: 1
        $x_1_5 = "AWGAMECONFIG" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __Adware_Win32_ArcadeWeb_11
{
    meta:
        author = "defender2yara"
        detection_name = "!#Adware:Win32/ArcadeWeb"
        threat_id = "1879050574"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "AWextension.js.tmp" ascii //weight: 1
        $x_1_2 = "awun.exe" ascii //weight: 1
        $x_1_3 = "Element muzt be closed." ascii //weight: 1
        $x_1_4 = "Software\\AppDataLow\\AWGAMECONFIG" ascii //weight: 1
        $x_1_5 = "ArcadeWeb Software Installer" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (4 of ($x*))
}

rule __Adware_Win32_ArcadeWeb_12
{
    meta:
        author = "defender2yara"
        detection_name = "!#Adware:Win32/ArcadeWeb"
        threat_id = "1879050574"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Arcadeweb Gaming Add-on" ascii //weight: 1
        $x_1_2 = "AWGames.Addon" ascii //weight: 1
        $x_1_3 = "{2A04A1D0-1969-400e-A53C-6A5433A4B658}" ascii //weight: 1
        $x_1_4 = "domain=.arcadeweb.com;" ascii //weight: 1
        $x_1_5 = "aw/getExternalGamesInfo/ticket=" ascii //weight: 1
        $x_1_6 = "Software\\AppDataLow\\AWGAMECONFIG" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (4 of ($x*))
}

rule __Adware_Win32_ArcadeWeb_13
{
    meta:
        author = "defender2yara"
        detection_name = "!#Adware:Win32/ArcadeWeb"
        threat_id = "1879050574"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {41 72 63 61 64 65 57 65 62 20 53 6f 66 74 77 61 72 65 20 49 6e 73 74 61 6c 6c 65 72 00}  //weight: 1, accuracy: High
        $x_1_2 = {61 72 63 61 64 65 77 65 62 63 68 72 6f 6d 65 2e 64 6c 6c 00}  //weight: 1, accuracy: High
        $x_1_3 = {41 72 63 61 64 65 57 65 62 20 69 6e 73 74 61 6c 6c 61 74 69 6f 6e 20 69 73 20 63 6f 6d 70 6c 65 74 65 64 2e 00}  //weight: 1, accuracy: High
        $x_1_4 = {49 6e 73 74 61 6c 6c 69 6e 67 20 41 72 63 61 64 65 57 65 62 20 43 6c 69 65 6e 74 2e 2e 2e 00}  //weight: 1, accuracy: High
        $x_1_5 = {74 65 78 74 6c 69 6e 6b 73 40 61 72 63 61 64 65 77 65 62 2e 63 6f 6d 00}  //weight: 1, accuracy: High
        $x_1_6 = "arcadeweb.com/aj/inst.php" ascii //weight: 1
        $x_1_7 = {41 57 20 54 72 61 79 49 63 6f 6e 00}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (5 of ($x*))
}

rule __Adware_Win32_ArcadeWeb_14
{
    meta:
        author = "defender2yara"
        detection_name = "!#Adware:Win32/ArcadeWeb"
        threat_id = "1879050574"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "3"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {c6 45 ec 69 c6 45 ed 65 c6 45 ee 78 c6 45 ef 70 c6 45 f0 6c c6 45 f1 6f c6 45 f2 72 c6 45 f3 65 c6 45 f4 2e c6 45 f5 65 c6 45 f6 78 c6 45 f7 65 88 5d f8 ff 15}  //weight: 1, accuracy: High
        $x_1_2 = {5c 41 70 70 44 61 74 61 4c 6f 77 5c 41 57 47 ?? 4d 45 43 4f 4e 46 49 47}  //weight: 1, accuracy: Low
        $x_1_3 = {41 00 72 00 63 00 61 00 64 00 65 00 [0-4] 57 00 65 00 62 00 20 00 4c 00 4c 00 43 00}  //weight: 1, accuracy: Low
        $x_1_4 = "arcadeweb32.dll" ascii //weight: 1
        $x_1_5 = {49 6e 73 74 61 6c 6c 69 6e 67 20 41 72 63 61 64 65 57 65 62 20 43 6c 69 65 6e 74 2e 2e 2e 00}  //weight: 1, accuracy: High
        $x_1_6 = "Game Add-on ArcadeWeb" ascii //weight: 1
        $x_1_7 = {65 77 65 62 00 00 00 00 61 72 63 61 64 00 00 00 68 74 74 70 3a 2f 2f 63 66}  //weight: 1, accuracy: High
        $x_1_8 = "bcfg.BackupRise.com" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (3 of ($x*))
}

rule __Adware_Win32_ArcadeWeb_15
{
    meta:
        author = "defender2yara"
        detection_name = "!#Adware:Win32/ArcadeWeb"
        threat_id = "1879050574"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {41 57 5f 54 52 41 59 5f 49 43 4f 4e 5f 4d 54 58 00}  //weight: 1, accuracy: High
        $x_1_2 = {41 57 20 54 72 61 79 49 63 6f 6e 00}  //weight: 1, accuracy: High
        $x_1_3 = "arcadeweb.com/games.php?rel=tray" ascii //weight: 1
        $x_1_4 = {61 77 75 70 64 61 74 65 2e 65 78 65 00}  //weight: 1, accuracy: High
        $x_1_5 = {70 6c 61 79 73 75 73 68 69 73 6c 69 64 65 74 69 74 6c 65 00}  //weight: 1, accuracy: High
        $x_1_6 = {53 6f 66 74 77 61 72 65 5c 41 70 70 44 61 74 61 4c 6f 77 5c 41 72 63 61 64 65 57 65 62 00}  //weight: 1, accuracy: High
        $x_1_7 = "AVCAWSystemTray@@" ascii //weight: 1
        $x_1_8 = "= s 'ArcadeWeb Class'" ascii //weight: 1
        $x_1_9 = "awmtraymtx" ascii //weight: 1
        $x_1_10 = {69 6e 73 65 72 74 5f 65 78 70 69 72 65 5f 74 69 6d 65 00 00 69 6e 73 65 72 74 5f 6a 73}  //weight: 1, accuracy: High
        $x_1_11 = "256s>' is not wel-formed." ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (4 of ($x*))
}

rule __PUA_Block_BitComet_BundleInstaller_0
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:BitComet_BundleInstaller"
        threat_id = "1879050647"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "GETOFFERSARRAY" ascii //weight: 1
        $x_1_2 = "PAGEOFFERACTIVATE" ascii //weight: 1
        $x_1_3 = "CHECKOFFER" ascii //weight: 1
        $x_1_4 = "INSTALLOFFERS" ascii //weight: 1
        $x_1_5 = "\\BitComet\\BitComet.exe" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_Soctuseer_0
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:Soctuseer"
        threat_id = "1879050720"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "7"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "LocalService" wide //weight: 1
        $x_1_2 = "Service stopped" wide //weight: 1
        $x_1_3 = "Could not open Service Manager" wide //weight: 1
        $x_5_4 = "WajaIntEn Monitor" wide //weight: 5
        $x_1_5 = "browser.enabled_labs_experiments" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_5_*) and 2 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule __PUA_Block_Soctuseer_1
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:Soctuseer"
        threat_id = "1879050720"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "wajam_64.pdb" ascii //weight: 2
        $x_1_2 = "exception_ptr.hpp" ascii //weight: 1
        $x_1_3 = "string_path.hpp" ascii //weight: 1
        $x_1_4 = "Wajam Web Enhancer Monitor" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_Soctuseer_2
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:Soctuseer"
        threat_id = "1879050720"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "Wajam" ascii //weight: 2
        $x_1_2 = "ciuvo.com" ascii //weight: 1
        $x_1_3 = "it.tuto4pc.com" ascii //weight: 1
        $x_1_4 = "337.eleximg.com" ascii //weight: 1
        $x_1_5 = "profiles.ini" ascii //weight: 1
        $x_1_6 = "free offers and discounts" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_2_*) and 4 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule __PUA_Block_Soctuseer_3
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:Soctuseer"
        threat_id = "1879050720"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "\\Release\\WajamInternetEnhancer.pdb" ascii //weight: 1
        $x_1_2 = "WajamInternetEnhancer.exe" ascii //weight: 1
        $x_1_3 = "Wajam.Proxy.Attach" ascii //weight: 1
        $x_1_4 = "WJProxy.FiddlerCore.dll" ascii //weight: 1
        $x_1_5 = "WajamMutext" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_Soctuseer_4
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:Soctuseer"
        threat_id = "1879050720"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "3"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = "downloadfallback.wajam.com" ascii //weight: 1
        $x_1_2 = "SOFTWARE\\Wajam\\Update" ascii //weight: 1
        $x_1_3 = {55 00 70 00 64 00 61 00 74 00 65 00 72 00 5c 00 [0-15] 5c 00 52 00 65 00 6c 00 65 00 61 00 73 00 65 00 5c 00 [0-31] 2e 00 70 00 64 00 62 00}  //weight: 1, accuracy: Low
        $x_1_4 = {55 70 64 61 74 65 72 5c [0-15] 5c 52 65 6c 65 61 73 65 5c [0-31] 2e 70 64 62}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (3 of ($x*))
}

rule __PUA_Block_Soctuseer_5
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:Soctuseer"
        threat_id = "1879050720"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "WajamInternetEnhancer.exe" ascii //weight: 1
        $x_1_2 = "WAJAM_REG_KEY" ascii //weight: 1
        $x_1_3 = "FakeTunnel" ascii //weight: 1
        $x_1_4 = "no decryption for you :)" ascii //weight: 1
        $x_1_5 = "Global\\Wajam.Proxy.AbnormalTermination" ascii //weight: 1
        $x_1_6 = "WajamMutext" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (5 of ($x*))
}

rule __PUA_Block_Soctuseer_6
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:Soctuseer"
        threat_id = "1879050720"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "www.wajam.com" ascii //weight: 1
        $x_1_2 = "WajamInternetEnhancerService.pdb" ascii //weight: 1
        $x_1_3 = "software\\Wajam\\Wajam Internet Enhancer" ascii //weight: 1
        $x_1_4 = "WJProxyTools.exe" ascii //weight: 1
        $x_1_5 = "Global\\Wajam.Proxy.Event" ascii //weight: 1
        $x_1_6 = "WJManifest" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (4 of ($x*))
}

rule __PUA_Block_Soctuseer_7
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:Soctuseer"
        threat_id = "1879050720"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "http://www.wajam.com/webenhancer/logging" ascii //weight: 2
        $x_1_2 = "network.http.spdy.enabled" ascii //weight: 1
        $x_2_3 = "wajam.pdb" ascii //weight: 2
        $x_2_4 = "Wajam Web Enhancer" ascii //weight: 2
        $x_1_5 = "Rijndael-256" ascii //weight: 1
        $n_100_6 = "WnUninst.exe" ascii //weight: -100
        $n_100_7 = "Uninst.exe" ascii //weight: -100
        $n_100_8 = "Uninstall.exe" ascii //weight: -100
    condition:
        (filesize < 20MB) and
        (not (any of ($n*))) and
        (
            ((1 of ($x_2_*) and 2 of ($x_1_*))) or
            ((2 of ($x_2_*))) or
            (all of ($x*))
        )
}

rule __PUA_Block_Soctuseer_8
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:Soctuseer"
        threat_id = "1879050720"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "IE_BHO\\source\\wajam\\Release\\priam_bho.pdb" ascii //weight: 1
        $x_1_2 = "wajam.WajamBHO.1 = s 'Wajam'" ascii //weight: 1
        $x_1_3 = "Software\\Wajam" ascii //weight: 1
        $x_1_4 = "wajam.com/update/InternetExplorer/update_bho.xml" ascii //weight: 1
        $x_1_5 = "wajam_ie_addon_installed=1" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __PUA_Block_Soctuseer_9
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:Block:Soctuseer"
        threat_id = "1879050720"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "d:\\Projects\\Visual Studio\\NSIS Plugins\\IpConfig\\Output\\Plugins\\IpConfig.pdb" ascii //weight: 1
        $x_1_2 = "Wajam Web Enhancer" ascii //weight: 1
        $x_2_3 = "wajam_64.exe" ascii //weight: 2
        $x_1_4 = "/silent" ascii //weight: 1
        $x_1_5 = "homedepot.ico" ascii //weight: 1
        $n_100_6 = "Uninst.exe" ascii //weight: -100
        $n_100_7 = "Uninstaller.exe" ascii //weight: -100
        $n_100_8 = "Uninstal.exe" ascii //weight: -100
    condition:
        (filesize < 20MB) and
        (not (any of ($n*))) and
        (
            ((1 of ($x_2_*) and 3 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule __PUA_ML_Blocked_Kuaiba_0
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:ML:Blocked:Kuaiba"
        threat_id = "1879050721"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "css.jipinfeiche.cn" wide //weight: 1
        $x_1_2 = "css.suzhouleizhen.com" wide //weight: 1
        $x_1_3 = "advertcheck" wide //weight: 1
        $x_1_4 = "Tencent\\TencentTraveler\\100\\TtConf.dat" wide //weight: 1
        $x_1_5 = "GMGameStart\\bin\\release_static\\GMUnPacker.pdb" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (4 of ($x*))
}

rule __PUA_ML_Blocked_Kuaiba_1
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:ML:Blocked:Kuaiba"
        threat_id = "1879050721"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "kuai8box.com" ascii //weight: 1
        $x_1_2 = "MiniPageAd" ascii //weight: 1
        $x_1_3 = "Kuai8-MiniPage" ascii //weight: 1
        $x_1_4 = "GMMiniTipWeb" ascii //weight: 1
        $x_1_5 = "KuaibaNewsLastDay" ascii //weight: 1
        $x_1_6 = "KuaibaNewsCount" ascii //weight: 1
        $x_1_7 = "K8MiniPage.pdb" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (5 of ($x*))
}

rule __PUA_ML_Blocked_Toptools_0
{
    meta:
        author = "defender2yara"
        detection_name = "!#PUA:ML:Blocked:Toptools"
        threat_id = "1879050804"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "thescreensnapshot.com" wide //weight: 1
        $x_1_2 = "\\Common\\I18N\\conf.db" ascii //weight: 1
        $x_1_3 = "Global\\Mutex_TOOLSI18NGUID_" wide //weight: 1
        $x_1_4 = "ScreenSnapshot.pdb" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (3 of ($x*))
}

rule __ALF_Trojan_Win32_Tnega_MTB_0
{
    meta:
        author = "defender2yara"
        detection_name = "!#ALF:Trojan:Win32/Tnega!MTB"
        threat_id = "1879050823"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "sup112.exe" ascii //weight: 1
        $x_1_2 = "sup113.tmp" ascii //weight: 1
        $x_1_3 = "net start" ascii //weight: 1
        $x_1_4 = "dreaker_win.pdb" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ALF_Trojan_Win32_Tnega_MTB_1
{
    meta:
        author = "defender2yara"
        detection_name = "!#ALF:Trojan:Win32/Tnega!MTB"
        threat_id = "1879050823"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "timeout (sec)" ascii //weight: 1
        $x_1_2 = "Error sending close message" ascii //weight: 1
        $x_1_3 = "Close message sent" ascii //weight: 1
        $x_1_4 = "closewnd.pdb" ascii //weight: 1
        $x_1_5 = "closewnd.exe" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ALF_Trojan_Win32_Tnega_MTB_2
{
    meta:
        author = "defender2yara"
        detection_name = "!#ALF:Trojan:Win32/Tnega!MTB"
        threat_id = "1879050823"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "90.yayou.zhcgj888.com/guajiRM/guaji/" ascii //weight: 1
        $x_1_2 = "guajiRM" ascii //weight: 1
        $x_1_3 = "Update\\AutoUpdatePlus.exe" ascii //weight: 1
        $x_1_4 = "KillAppFile" ascii //weight: 1
        $x_1_5 = "D:\\zhc_new2\\startup\\WD" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule __ALF_Trojan_Win32_Tnega_MTB_3
{
    meta:
        author = "defender2yara"
        detection_name = "!#ALF:Trojan:Win32/Tnega!MTB"
        threat_id = "1879050823"
        signature_type = "SIGNATURE_TYPE_PEHSTR_EXT"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "Subaru DimeMods ECU Reg.pdb" ascii //weight: 1
        $x_1_2 = "Subaru DimeMods ECU Reg" ascii //weight: 1
        $x_1_3 = "CheckForSync" ascii //weight: 1
        $x_1_4 = "DebuggerHiddenAttribute" ascii //weight: 1
        $x_1_5 = "Activator" ascii //weight: 1
        $x_1_6 = "Subaru DimeMods ECU Reg\\Subaru DimeMods ECU Reg" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule MPSpyTestFile_High_0
{
    meta:
        author = "defender2yara"
        detection_name = "MPSpyTestFile-High"
        threat_id = "2147483638"
        severity = "High"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "MS AVAS SpyTestFile-High" ascii //weight: 1
        $x_1_2 = "Internal test only! Do not distribute outside your team!" ascii //weight: 1
        $x_1_3 = "8832e15e-f94c-4ed6-bc60-4bb973a0fa8a" ascii //weight: 1
        $x_1_4 = "39db3ce7-8994-491b-ade5-5390890c7ce7" ascii //weight: 1
        $x_1_5 = "b640c330-24be-49ef-8ab6-3ed1b1b69861" ascii //weight: 1
        $x_1_6 = "ea538257-33af-4bdf-b2c4-8d07693f0534" ascii //weight: 1
        $x_1_7 = "77048032-b107-4a59-89dc-2351bff41a37" ascii //weight: 1
        $x_1_8 = "f583f841-7139-4854-b6ab-519c3319856b" ascii //weight: 1
        $x_1_9 = "857f53dd-a36a-4f2c-aec9-dd710f287591" ascii //weight: 1
        $x_1_10 = "56079eff-c733-4f09-9d2e-cb13a09cf781" ascii //weight: 1
        $x_1_11 = "c18aa30b-01f8-450f-9121-092e4540cbc4" ascii //weight: 1
        $x_1_12 = "91768a93-45f1-45ba-885c-cc8a80c6115a" ascii //weight: 1
        $x_1_13 = "ac93cea0-9d9a-4c44-9b0d-2679fb6ce157" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (6 of ($x*))
}

rule MPSpyTestFile_0
{
    meta:
        author = "defender2yara"
        detection_name = "MPSpyTestFile"
        threat_id = "2147483639"
        severity = "Critical"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "MS AVAS SpyTestFile-Gen" ascii //weight: 1
        $x_1_2 = "Internal test only! Do not distribute outside your team!" ascii //weight: 1
        $x_1_3 = "bf373478-11d8-4192-86b5-2d3f0341dddc" ascii //weight: 1
        $x_1_4 = "2ae7edeb-32b4-49f6-bbf3-23a50e0c0bbf" ascii //weight: 1
        $x_1_5 = "786a8de1-dd4c-40ca-b4f4-64f28dd62738" ascii //weight: 1
        $x_1_6 = "e72796e8-3ff4-4155-870d-797dc2d7d1f5" ascii //weight: 1
        $x_1_7 = "e1abaec3-c490-4f8f-9885-9e0db490f22d" ascii //weight: 1
        $x_1_8 = "6e1d1350-4035-42fa-887c-2c0dd716b2f5" ascii //weight: 1
        $x_1_9 = "bb3d2c44-a176-4709-ab3c-46e2b28df822" ascii //weight: 1
        $x_1_10 = "d2b160e3-fe87-4be9-bc55-bd62ccd8683c" ascii //weight: 1
        $x_1_11 = "7503667c-4575-4d04-be94-62c89dcfe42c" ascii //weight: 1
        $x_1_12 = "ec78caf3-b654-4690-b086-fae746d7faf1" ascii //weight: 1
        $x_1_13 = "8fffab9b-3704-4bcc-807f-03bed940c9f9" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (6 of ($x*))
}

rule MPSpyTestFile_Med_0
{
    meta:
        author = "defender2yara"
        detection_name = "MPSpyTestFile-Med"
        threat_id = "2147483640"
        severity = "Mid"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "MS AVAS SpyTestFile-Medium" ascii //weight: 1
        $x_1_2 = "Internal test only! Do not distribute outside your team!" ascii //weight: 1
        $x_1_3 = "eb737543-5d1c-48e3-997d-3d9fa5a328e4" ascii //weight: 1
        $x_1_4 = "846de648-b5ab-4c42-bc8c-4e3e8f07e9e4" ascii //weight: 1
        $x_1_5 = "3e1792f5-c367-4818-acbb-88dd9ababe72" ascii //weight: 1
        $x_1_6 = "85859f33-81f9-4230-9fa7-e8fa84b24942" ascii //weight: 1
        $x_1_7 = "c2c7f762-6377-4aa8-a905-06a94d3b42ed" ascii //weight: 1
        $x_1_8 = "9b89202f-d7d7-4169-b517-91771c670713" ascii //weight: 1
        $x_1_9 = "ddc668cc-0217-481b-9c5f-a05b78604869" ascii //weight: 1
        $x_1_10 = "e22d93af-d022-4851-af00-6e07bf001be8" ascii //weight: 1
        $x_1_11 = "cd7f4f8e-3723-4a6d-8429-54b290f96ccb" ascii //weight: 1
        $x_1_12 = "6f5c97c6-f661-4bde-89b0-d32b9517f81d" ascii //weight: 1
        $x_1_13 = "0594c18b-b2d0-4bb1-969c-b692944420a8" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (6 of ($x*))
}

rule MPSpyTestFile_Low_0
{
    meta:
        author = "defender2yara"
        detection_name = "MPSpyTestFile-Low"
        threat_id = "2147483641"
        severity = "Low"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "MS AVAS SpyTestFile-Low" ascii //weight: 1
        $x_1_2 = "Internal test only! Do not distribute outside your team!" ascii //weight: 1
        $x_1_3 = "8b426ea0-9afe-442b-a0d8-023d3bdea734" ascii //weight: 1
        $x_1_4 = "4353a0db-cb20-4124-bfa7-9832856a2858" ascii //weight: 1
        $x_1_5 = "d2f891e3-4ab4-449a-8b88-5929c2bf7577" ascii //weight: 1
        $x_1_6 = "3c5ec4f4-ae8b-46aa-b29b-bc77e687b21e" ascii //weight: 1
        $x_1_7 = "0b9ee403-b35c-407a-906b-a04dc2e5c61e" ascii //weight: 1
        $x_1_8 = "46bd83a4-9ed1-4f62-8bb6-547f6ae14d3b" ascii //weight: 1
        $x_1_9 = "dd61a320-9f3a-4e41-b738-2672be08e5a3" ascii //weight: 1
        $x_1_10 = "dc682936-fced-491c-b68c-716854d310ea" ascii //weight: 1
        $x_1_11 = "b69781dc-4499-4012-b069-c0adbb4c7286" ascii //weight: 1
        $x_1_12 = "4d0c8a3d-60cd-4b5b-8e96-f14c559dff8c" ascii //weight: 1
        $x_1_13 = "ab39d9f3-4826-4af0-b3f9-39bbf481f7ef" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (6 of ($x*))
}

rule MPSpyTestFile_0
{
    meta:
        author = "defender2yara"
        detection_name = "MPSpyTestFile"
        threat_id = "2147483645"
        severity = "6"
        signature_type = "SIGNATURE_TYPE_PEHSTR"
        threshold = "6"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "MS AVAS SpyTestFile" ascii //weight: 1
        $x_1_2 = "Internal test only! Do not distribute outside your team!" ascii //weight: 1
        $x_1_3 = "hAgBAACJBmaBfgSz1w+FwwAAAGTgRqAP826IPm" ascii //weight: 1
        $x_1_4 = "G$MeZMSrNkHKAMKe-+TGF23pEV26cqPT4Xa" ascii //weight: 1
        $x_1_5 = "qXcBfDr2(2XfiMrmal$D--(KqHQB@$UIq`&[dJ#9" ascii //weight: 1
        $x_1_6 = "Je@ep(Kqll[$Vk@IPXaNHe#k2#HVkYKZ" ascii //weight: 1
        $x_1_7 = "SIPEe)I9!6k%,B'5lr%a1H[qjm(*K" ascii //weight: 1
        $x_1_8 = "d&XjfH3l6JrPVj[$YZ*Bq(pPcPR-blQZb" ascii //weight: 1
        $x_1_9 = "HVNNA&@R1!cP!C6S-84dIKk+&i3q4JKqDd)#4UAG4" ascii //weight: 1
        $x_1_10 = "-MZDLCr00k&2NJ*jk8!,@B'H@`km#Z1`+ki#[U-#Y" ascii //weight: 1
        $x_1_11 = "9MHqK6mZEbUBD&X@e*zP&[A4QMa@C@&p" ascii //weight: 1
        $x_1_12 = "ImYpjRrRmRirm[mI3rZa2cIjIeBRjIbH$I1aIcIiiZ" ascii //weight: 1
        $x_1_13 = "MjNrRcpT0ND$fcabG!8(M))5GpDIGKPVZ" ascii //weight: 1
        $n_100_14 = "Med severity spyware test file" ascii //weight: -100
        $n_100_15 = "Low severity spyware test file" ascii //weight: -100
    condition:
        (filesize < 20MB) and
        (not (any of ($n*))) and
        (6 of ($x*))
}

