rule Exploit_Java_CVE_2012_1723_P_2147659098_0
{
    meta:
        author = "defender2yara"
        detection_name = "Exploit:Java/CVE-2012-1723.P"
        threat_id = "2147659098"
        type = "Exploit"
        platform = "Java: Java binaries (classes)"
        family = "CVE-2012-1723"
        severity = "Critical"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "2"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {15 08 12 0b a2 00 10 19 06 01 b6 00 ?? 57 84 08 01 a7 ff ef}  //weight: 1, accuracy: Low
        $x_1_2 = "ur0l0" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Exploit_Java_CVE_2012_1723_P_2147659098_1
{
    meta:
        author = "defender2yara"
        detection_name = "Exploit:Java/CVE-2012-1723.P"
        threat_id = "2147659098"
        type = "Exploit"
        platform = "Java: Java binaries (classes)"
        family = "CVE-2012-1723"
        severity = "Critical"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "3"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {1c 12 05 a2 00 0f 2b 01 b6 00 ?? 57 84 02 01 a7 ff f1}  //weight: 1, accuracy: Low
        $x_1_2 = "confuse" ascii //weight: 1
        $x_1_3 = "ConfusingClassLoader" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Exploit_Java_CVE_2012_1723_2147659851_0
{
    meta:
        author = "defender2yara"
        detection_name = "Exploit:Java/CVE-2012-1723"
        threat_id = "2147659851"
        type = "Exploit"
        platform = "Java: Java binaries (classes)"
        family = "CVE-2012-1723"
        severity = "124"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "4"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {4c 6a 61 76 61 2f 6c 61 6e 67 2f 43 6c 61 73 73 4c 6f 61 64 65 72 3b 01 00 02 ?? ?? 01 00}  //weight: 1, accuracy: Low
        $x_1_2 = {33 38 01 00 03 ?? 33 39 01 00 03 ?? 34 30 01 00 03 ?? 34 31 01 00 03 ?? 34 32 01 00 03 ?? 34 33 01 00 03}  //weight: 1, accuracy: Low
        $x_1_3 = {54 68 72 65 61 64 01 00 0d 63 75 72 72 65 6e 74 54 68 72 65 61 64 01 00}  //weight: 1, accuracy: High
        $x_1_4 = "sleep" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Exploit_Java_CVE_2012_1723_AHQ_2147665298_0
{
    meta:
        author = "defender2yara"
        detection_name = "Exploit:Java/CVE-2012-1723.AHQ"
        threat_id = "2147665298"
        type = "Exploit"
        platform = "Java: Java binaries (classes)"
        family = "CVE-2012-1723"
        severity = "Critical"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "2"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {32 b6 4c 2b b6 3d 1c bc 4e 2b 2d 03 1c b6 57 2d b0 4c 01 b0 03 00 2a b2}  //weight: 1, accuracy: Low
        $x_1_2 = {2a b6 b6 b6 (4c|2d|4e|3a) b2 (03|2d|08) 32 (4c|2d|4e|3a) b2 (03|2d|08) 32 3a (2d|(2b|2c|19)) b8 (b1|a7 ??)}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Exploit_Java_CVE_2012_1723_BVA_2147665561_0
{
    meta:
        author = "defender2yara"
        detection_name = "Exploit:Java/CVE-2012-1723.BVA"
        threat_id = "2147665561"
        type = "Exploit"
        platform = "Java: Java binaries (classes)"
        family = "CVE-2012-1723"
        severity = "Critical"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "9"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {01 00 14 28 29 4c 6a 61 76 61 2f 6c 61 6e 67 2f 4f 62 6a 65 63 74 3b}  //weight: 1, accuracy: High
        $x_1_2 = {01 00 17 28 4c 6a 61 76 61 2f 6c 61 6e 67 2f 4f 62 6a 65 63 74 3b 29 4c 7a 3b}  //weight: 1, accuracy: High
        $x_1_3 = {01 00 1b 6a 61 76 61 2f 73 65 63 75 72 69 74 79 2f 41 6c 6c 50 65 72 6d 69 73 73 69 6f 6e}  //weight: 1, accuracy: High
        $x_1_4 = {01 00 1d 28 4c 6a 61 76 61 2f 73 65 63 75 72 69 74 79 2f 50 65 72 6d 69 73 73 69 6f 6e 3b 29 56}  //weight: 1, accuracy: High
        $x_1_5 = {01 00 1e 6a 61 76 61 2f 73 65 63 75 72 69 74 79 2f 50 72 6f 74 65 63 74 69 6f 6e 44 6f 6d 61 69 6e}  //weight: 1, accuracy: High
        $x_1_6 = {01 00 19 6a 61 76 61 2f 73 65 63 75 72 69 74 79 2f 50 65 72 6d 69 73 73 69 6f 6e 73}  //weight: 1, accuracy: High
        $x_1_7 = {01 00 26 28 4c 7a 3b 4c 6a 61 76 61 2f 73 65 63 75 72 69 74 79 2f 50 72 6f 74 65 63 74 69 6f 6e 44 6f 6d 61 69 6e 3b 29 56}  //weight: 1, accuracy: High
        $x_1_8 = {01 00 41 28 4c 6a 61 76 61 2f 73 65 63 75 72 69 74 79 2f 43 6f 64 65 53 6f 75 72 63 65 3b 4c 6a 61 76 61 2f 73 65 63 75 72 69 74 79 2f 50 65 72 6d 69 73 73 69 6f 6e 43 6f 6c 6c 65 63 74 69 6f 6e 3b 29 56}  //weight: 1, accuracy: High
        $x_1_9 = {4d 2c bb 00 07 00 bb 00 ?? 59 b7 00 ?? 4d 2c bb 00 ?? 59 b7 00 ?? b6 00 ?? 2b b8 00 ?? b6 00 ?? bb 00 ?? 59 01 2c b7 00 ?? b8 00 ?? a7 00 04}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Exploit_Java_CVE_2012_1723_BVB_2147665562_0
{
    meta:
        author = "defender2yara"
        detection_name = "Exploit:Java/CVE-2012-1723.BVB"
        threat_id = "2147665562"
        type = "Exploit"
        platform = "Java: Java binaries (classes)"
        family = "CVE-2012-1723"
        severity = "Critical"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "4"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {01 00 49 28 4c 6a 61 76 61 2f 6c 61 6e 67 2f 53 74 72 69 6e 67 3b 5b 42 49 49 4c 6a 61 76 61 2f 73 65 63 75 72 69 74 79 2f 50 72 6f 74 65 63 74 69 6f 6e 44 6f 6d 61 69 6e 3b 29 4c 6a 61 76 61 2f 6c 61 6e 67 2f 43 6c 61 73 73 3b}  //weight: 1, accuracy: High
        $x_1_2 = {01 00 14 28 29 4c 6a 61 76 61 2f 6c 61 6e 67 2f 4f 62 6a 65 63 74 3b}  //weight: 1, accuracy: High
        $x_1_3 = {01 00 12 4c 6a 61 76 61 2f 6c 61 6e 67 2f 53 74 72 69 6e 67 3b}  //weight: 1, accuracy: High
        $x_1_4 = {3d 2a b2 00 03 00 b2 00 ?? 3d 2a b2 00 ?? b2 00 03 03 b2 00 03 be 2b b6 00 04 57 2a 12 05 b2 00 06 03 b2 00 06 be 2b b6 00 04 b6 00 07 57 1c 99 00}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Exploit_Java_CVE_2012_1723_BVC_2147665564_0
{
    meta:
        author = "defender2yara"
        detection_name = "Exploit:Java/CVE-2012-1723.BVC"
        threat_id = "2147665564"
        type = "Exploit"
        platform = "Java: Java binaries (classes)"
        family = "CVE-2012-1723"
        severity = "Critical"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "5"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {01 00 06 61 61 74 74 61 79}  //weight: 1, accuracy: High
        $x_1_2 = {01 00 06 61 61 74 74 62 79}  //weight: 1, accuracy: High
        $x_1_3 = {01 00 10 6a 61 76 61 2f 6c 61 6e 67 2f 4f 62 6a 65 63 74}  //weight: 1, accuracy: High
        $x_1_4 = {01 00 12 4c 6a 61 76 61 2f 6c 61 6e 67 2f 53 74 72 69 6e 67 3b}  //weight: 1, accuracy: High
        $x_1_5 = {2a b7 00 01 00 00 2a b7 00 01 2a 12 02 b5 00 03 2a 12 04 b5 00 05 2a 12 06 b5 00 07 2a 12 08 b5 00 09 2a 12 0a b5 00 0b 2a 12 0c b5 00 0d 12 0e 4c 12 0f 4d b1}  //weight: 1, accuracy: Low
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Exploit_Java_CVE_2012_1723_BXA_2147665954_0
{
    meta:
        author = "defender2yara"
        detection_name = "Exploit:Java/CVE-2012-1723.BXA"
        threat_id = "2147665954"
        type = "Exploit"
        platform = "Java: Java binaries (classes)"
        family = "CVE-2012-1723"
        severity = "Critical"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "11"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {2b 2a b6 b6 b6 4e 04 bd 59 03 12 53 3a 04 bd 59 03 12 53 3a}  //weight: 1, accuracy: High
        $x_1_2 = {2c 2a b6 b6 2b b6 4e 05 bd 59 03 12 53 59 04 12 53 3a}  //weight: 1, accuracy: High
        $x_1_3 = {2b 2a b6 b6 b6 4d 2c b8 a7 4d 2c b6 b1}  //weight: 1, accuracy: High
        $x_10_4 = {4d 2a b6 2b b6 4e 11 bc 3a 2d 19 03 19 be b6 59 36 02 9f}  //weight: 10, accuracy: High
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_10_*) and 1 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule Exploit_Java_CVE_2012_1723_BXT_2147666048_0
{
    meta:
        author = "defender2yara"
        detection_name = "Exploit:Java/CVE-2012-1723.BXT"
        threat_id = "2147666048"
        type = "Exploit"
        platform = "Java: Java binaries (classes)"
        family = "CVE-2012-1723"
        severity = "Critical"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "7"
        strings_accuracy = "High"
    strings:
        $x_1_1 = {01 00 13 6a 61 76 61 2f 69 6f 2f 50 72 69 6e 74 53 74 72 65 61 6d}  //weight: 1, accuracy: High
        $x_1_2 = {01 00 15 4c 6a 61 76 61 2f 69 6f 2f 50 72 69 6e 74 53 74 72 65 61 6d 3b}  //weight: 1, accuracy: High
        $x_1_3 = {01 00 10 6a 61 76 61 2f 6c 61 6e 67 2f 53 79 73 74 65 6d}  //weight: 1, accuracy: High
        $x_1_4 = {01 00 07 70 72 69 6e 74 6c 6e}  //weight: 1, accuracy: High
        $x_1_5 = {01 00 17 4c 6a 61 76 61 2f 6c 61 6e 67 2f 43 6c 61 73 73 4c 6f 61 64 65 72 3b}  //weight: 1, accuracy: High
        $x_1_6 = {01 00 15 28 4c 6a 61 76 61 2f 6c 61 6e 67 2f 4f 62 6a 65 63 74 3b 29 56}  //weight: 1, accuracy: High
        $x_1_7 = {b2 2a 57 b2 b6 2a 2b b5 2a b4 c6}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Exploit_Java_CVE_2012_1723_ZUC_2147667456_0
{
    meta:
        author = "defender2yara"
        detection_name = "Exploit:Java/CVE-2012-1723.ZUC"
        threat_id = "2147667456"
        type = "Exploit"
        platform = "Java: Java binaries (classes)"
        family = "CVE-2012-1723"
        severity = "Critical"
        signature_type = "SIGNATURE_TYPE_JAVAHSTR_EXT"
        threshold = "1"
        strings_accuracy = "Low"
    strings:
        $x_1_1 = {9a c6 a7 bf 2b b4 b0 bf (2a|2b) b4 (1c|1d) 9a c6 a7 bf 2b b4 b0 bf 00 b4 01 9a c6 a7 bf 2b b4 b0 bf 00 b4 01 9a c6 a7 bf 2b b4 b0 bf 00 b4 01 9a c6 a7 bf 2b b4 b0 bf 00 b4 01 9a c6 a7 bf 2b b4 b0 bf 00 b4 01 9a c6 a7 bf 2b b4 b0 bf 00 b4 01 9a c6 a7 bf 2b b4 b0 bf 00 b4 01}  //weight: 1, accuracy: Low
        $x_1_2 = {b2 36 b2 03 32 4c 2a 4d 2a b4 15 9a c6 a7 bf 2c b4 b0 bf 2a b4 15 9a c6 a7 bf 2c b4 b0 bf 2a b4 15 9a c6 a7 bf 2c b4 b0 bf 2a b4 15 9a c6 a7 bf 2c b4 b0 bf 2a b4 15 9a c6 a7 bf 2c b4 b0 bf 2a b4 15 9a c6 a7 bf 2c b4 b0 bf 2a b4 15 9a c6 a7 bf 2c b4 b0 bf 2a b4 15 9a c6 a7 bf 2c b4 b0 bf}  //weight: 1, accuracy: High
        $x_1_3 = {b2 36 b2 4c 2a 4d 2a b4 15 9a c6 a7 bf 2c b4 b0 bf 2a b4 15 9a c6 a7 bf 2c b4 b0 bf 2a b4 15 9a c6 a7 bf 2c b4 b0 bf 2a b4 15 9a c6 a7 bf 2c b4 b0 bf 2a b4 15 9a c6 a7 bf 2c b4 b0 bf 2a b4 15 9a c6 a7 bf 2c b4 b0 bf 2a b4 15 9a c6 a7 bf 2c b4 b0 bf 2a b4 15 9a c6 a7 bf 2c b4 b0 bf}  //weight: 1, accuracy: High
        $x_1_4 = {b2 36 b2 05 32 4c 2a 4d 2a b4 15 9a c6 a7 bf 2c b4 b0 bf 2a b4 15 9a c6 a7 bf 2c b4 b0 bf 2a b4 15 9a c6 a7 bf 2c b4 b0 bf 2a b4 15 9a c6 a7 bf 2c b4 b0 bf 2a b4 15 9a c6 a7 bf 2c b4 b0 bf 2a b4 15 9a c6 a7 bf 2c b4 b0 bf 2a b4 15 9a c6 a7 bf 2c b4 b0 bf 2a b4 15 9a c6 a7 bf 2c b4 b0 bf}  //weight: 1, accuracy: High
    condition:
        (filesize < 20MB) and
        (1 of ($x*))
}

